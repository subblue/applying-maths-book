
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fourier Transforms &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 7 - 15" href="Fourier-questions-7-15.html" />
    <link rel="prev" title="Questions 1 - 6" href="Fourier-questions-1-6.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Applying Maths in the Chemical and Biomolecular Sciences.
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1. Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-C.html">
     Euler’s theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-27.html">
     Questions 14 - 27
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     Differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     Limits, l’Hopital’s rule, max and min and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4. Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     Integration by substitution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     Using parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     Calculating an Average Value.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     Multiple integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     Calculating the energy of a chemical bond using molecular orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     Rotation matrices: moving molecules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     Solving equations using matrices. Eigenvectors &amp; Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-K.html">
     Calculating a bond length using moments of inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61.html">
     Question 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     Principal axes for Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q62.html">
     Question 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-A-B.html">
     Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-D.html">
     Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-E.html">
     Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-F.html">
     The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-2D-Diffraction.html">
     The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-tomography.html">
     Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     Integrating factors can solve differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     Partial Differential Equations, PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     PDE examples continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     Monte - Carlo Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     Solving rate equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     Modelling data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter-1/chapter1-E.html">
   SI units, Rounding, converting units &amp; Glossary.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/References.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/Python%20crib.html">
   Some basic Python instructions with a few examples.
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapter-9/Fourier-C.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/chapter-9/Fourier-C.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation-and-concept">
   Motivation and concept
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fourier-transform-equations">
   5.1 Fourier transform equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-ftir-instrument">
   5.2 The FTIR instrument
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nmr">
   5.3 NMR
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#x-ray-diffraction">
   5.4 X-ray diffraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-transforms">
   5.5 Linear transforms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-transform">
   5.6 The Transform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fourier-series-and-transforms">
   5.7 Fourier Series and Transforms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-fourier-transform-equations">
   6 The Fourier Transform equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-transforms">
   6.1 Plotting transforms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-functions-can-be-transformed">
   6.2 What functions can be transformed?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-calculate-and-plot-a-fourier-transform">
   6.3 How to calculate and plot a Fourier transform
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-finite-wave-train">
     <strong>
      (1) A finite wave train
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-exponential-decay">
     <strong>
      (ii) Exponential decay
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-electromagnetic-waves-in-a-laser-cavity">
     <strong>
      (iii) Electromagnetic waves in a laser cavity
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-the-fourier-transform-works">
   6.4 How the Fourier transform works
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phase-sensitive-detection-and-the-lock-in-amplifier">
   6.5 Phase sensitive detection and the lock-in amplifier
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parseval-or-plancherel-theorem">
   6.6 Parseval or Plancherel  theorem.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-delta-function-as-an-integral">
     <strong>
      The delta function as an integral
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-delta-function-and-comb-of-delta-functions">
     <strong>
      The delta function and comb of delta functions.
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uncertainty-principle">
   6.7 Uncertainty Principle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-a-gaussian-shaped-pulse">
     <strong>
      (i) A Gaussian shaped pulse
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-excited-state-decay">
     <strong>
      (ii) Excited state decay
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-finite-wave-train">
     <strong>
      (iii) Finite wave-train
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-heisenberg-uncertainty">
     <strong>
      (iv) Heisenberg Uncertainty
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary-of-some-fourier-transform-properties">
   6.8 Summary of some  Fourier Transform properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-useful-transforms">
   6.9 Table of useful transforms
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="fourier-transforms">
<h1>Fourier Transforms<a class="headerlink" href="#fourier-transforms" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="n">init_printing</span><span class="p">()</span>                         <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="motivation-and-concept">
<h2>Motivation and concept<a class="headerlink" href="#motivation-and-concept" title="Permalink to this headline">¶</a></h2>
<p>Fourier transforms are of fundamental importance in the analysis of signals from many types of experiments; these range from infra-red spectroscopy, to x-ray crystallography, to images from MRI and CT scans and to seismology. Even in everyday life, Fourier transforms are important because they are used to produce the images observed in a digital television, in music and in most other forms of digital information processing.</p>
<p>Usually, the data, which might be a string of values taken at many sequential times, is transformed to allow the frequencies present be displayed and analysed. More fundamentally, the instruments used to measure infrared and NMR spectra produce data that is itself the Fourier transform of the spectrum, and similarly, in X-ray crystallography, the image of spots produced on the detector is the Fourier transform of the planes of atoms in a crystal.</p>
<p>Although we concentrate on Fourier transforms, they are only one in a class of <em>integral</em> transforms. The Abel transform is an integral transform that is used to recover the three-dimensional information from its two-dimensional image. It is used in such diverse areas as astronomy and the study of the photo-dissociation pathways of molecules. In photo-dissociation experiments, the fragments (atoms, ions, electrons) are spatially dispersed depending on where the breaking bond is pointing at the instant of dissociation. Their image is captured on a camera as 2D information and by transforming this, the geometry of the dissociation process can be determined (Whittaker 2007). Other transforms are the Hilbert, used in signal processing, and the Laplace, used to solve differential equations.</p>
<p>Folklore has it that Fourier transforms are formidably difficult and abstruse things. We know that they form the basis of the FTIR and NMR instrument, but secretly hope that nobody asks us how or why. In fact, Fourier transforms are quite straightforward but must be treated with respect. We are used to seeing the NMR or IR spectrum as a set of lines at different fixed frequencies and feel comfortable with this, but the raw data produced is a wiggly signal in which the information needed is almost totally obscured. This makes the process of unravelling this in a Fourier transform seems mysterious: ‘I cannot understand the data so where does the spectrum come from?’ Contrariwise, we are used to interpreting speech and music that are oscillating signals in time, and would not easily understand either of them if Fourier transformed and viewed or heard as a continuously changing spectrum of frequencies.</p>
<p>We shall come back to this shortly but, briefly, a Fourier transform is an integral and therefore it can be evaluated by any of the methods used to solve integrals.</p>
</div>
<div class="section" id="fourier-transform-equations">
<h2>5.1 Fourier transform equations<a class="headerlink" href="#fourier-transform-equations" title="Permalink to this headline">¶</a></h2>
<p>The Fourier transform integral is one of several types of integral transforms that have the general form</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(k)=\int f(x)G(k,x)dx      \tag{23}\]</div>
<p>The <em>transformed</em> function is <span class="math notranslate nohighlight">\(g\)</span> and the function being transformed is <span class="math notranslate nohighlight">\(f\)</span>. The algebraic expression <span class="math notranslate nohighlight">\(G\)</span> is called the <em>kernel</em> and this changes depending on the type of transform, Fourier, Abel, etc. The kernel for the Fourier transform is <span class="math notranslate nohighlight">\(\exp(\pm ikx)\)</span> and so the forward transform takes a function <span class="math notranslate nohighlight">\(f(x)\)</span> and returns <span class="math notranslate nohighlight">\(g(k)\)</span>. We could write this as <span class="math notranslate nohighlight">\(F(f(x))=g(k)\)</span> and similarly the reverse transform <span class="math notranslate nohighlight">\(F^{-1}(g(k))=f(x)\)</span>. We shall only occasionally need to use this operator notation but for example <span class="math notranslate nohighlight">\(F(df(x)/dx)\)</span> means make the fourier transform of the differential of <span class="math notranslate nohighlight">\(f(x)\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span>. The fourier forwards and reverse equations are</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty f(x)e^{-ikx}dx \quad\text{ or }\quad F(f(x))=g(k)\quad\text{ forward fourier transform}  \tag{23a}\]</div>
<div class="math notranslate nohighlight">
\[\displaystyle  f(x) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty g(k)e^{+ikx}dk \quad\text{ or }\quad F^{-1}(g(k))=f(x)\quad\text{ reverse fourier transform}\tag{23b}\]</div>
<p>However, whatever form the transform takes it always occurs between pairs of conjugate variables, which are <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(k\)</span> in equation (23). Often these conjugate pairs are time (seconds) and frequency (1/seconds), or distance (<span class="math notranslate nohighlight">\(x\)</span>) and 1/distance (<span class="math notranslate nohighlight">\(k\)</span>). The reciprocal relationship between variables is why the transform converts time into frequency, changing, for example, an oscillating time profile into a spectrum.</p>
<p>A second property is that these integral transforms are reversible, also called <em>invertible</em>, which means that <span class="math notranslate nohighlight">\(f\)</span> can be changed into <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(g\)</span> can be changed into <span class="math notranslate nohighlight">\(f\)</span> depending on which one we start with.</p>
<p>The notation and normalisation (<span class="math notranslate nohighlight">\(1/\sqrt{2\pi}\)</span>) varies quite a lot in the literature. It is common to add a hat or tilde to denote the transform thus if the function is <span class="math notranslate nohighlight">\(f\)</span> the transform may be <span class="math notranslate nohighlight">\(F\)</span> or <span class="math notranslate nohighlight">\(\hat F\)</span> or <span class="math notranslate nohighlight">\(\tilde f\)</span> etc. Sometimes <span class="math notranslate nohighlight">\(F^{-1}\)</span> is used to describe the reverse transform as above. We shall use <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> to denote the transform and its reverse respectively. Similarly the symbols used for the conjugate variables vary, <span class="math notranslate nohighlight">\(u,v\)</span> are common for general use, usually  <span class="math notranslate nohighlight">\(x,k\)</span> for distance <span class="math notranslate nohighlight">\(x\)</span> and inverse distance (wavevector <span class="math notranslate nohighlight">\(k\)</span>) and <span class="math notranslate nohighlight">\(t,\omega\)</span> for time and natural frequency.</p>
<p>Solving the Fourier transform integral both algebraically and numerically will be described starting in Section 5.5, but first the role of the Fourier transform in FTIR and NMR experiments, and in X-ray crystallography is outlined.</p>
</div>
<div class="section" id="the-ftir-instrument">
<h2>5.2 The FTIR instrument<a class="headerlink" href="#the-ftir-instrument" title="Permalink to this headline">¶</a></h2>
<p>The Fourier transform infra-red (FTIR) spectrometer directly generates the autocorrelation of the spectrum by mechanically moving one mirror of a Michelson interferometer and measuring the oscillating signal generated by the change in the interference of the two infra-red beams on the detector produced by the difference in pathlength. This signal is then fourier transformed to produce the spectrum. Beams from both arms of the interferometer pass through the sample and all wavelengths are simultaneously measured on the detector. Figure 11 shows a (simulated) example of the raw data from the instrument and the IR spectrum produced after this is transformed. The signal is measured as intensity vs optical pathlength difference (<span class="math notranslate nohighlight">\(2d\)</span>) of the two arms of the interferometer. After transformation, using the (discrete) fourier transform, the displacement from the centre of the (symmetrical) interference signal is in reciprocal distance or wavenumbers, cm<span class="math notranslate nohighlight">\(^{-1}\)</span>, which is proportional to the IR transition frequency.</p>
<p>The FTIR spectrometer is an interferometer, therefore, the waves that have travelled down each of its arms are combined and so interfere on the detector’s surface and this measures the intensity or the square of the sum of the two wave’s amplitudes, Fig. 12, as a function of displacement between the two arms. The detector is slow, i.e. it cannot possibly follow the electric field of the radiation directly, at any given displacement, and so this means that the signal at each displacement is averaged in time. The i.r. frequency is typically <span class="math notranslate nohighlight">\(400 \to 4000\; \mathrm{cm^{-1}}\)</span> or <span class="math notranslate nohighlight">\(\approx 10^{13}\to 10^{14}\;\mathrm{s^{-1}}\)</span>.</p>
<p>Constructive interference occurs when the path length in both arms differ by zero or a whole number of wavelengths; destructive interference occurs when they are exactly out of phase and the difference in length is an odd multiple of half a wavelength. Destructive interference means that the radiation is returned towards the source not the detector. Were only one wavelength present, changing the path-length <span class="math notranslate nohighlight">\(2d\)</span> would make the signal on the detector change sinusoidally. The ‘coherent’ broadband infrared ‘light’ from the source contains many wavelengths, and at a given path-length, some constructively and some destructively interfere, but the signal is always greatest when both paths are of the same length. The relative path-length of the two arms of the interferometer is changed by mechanically moving one mirror; the full interference pattern is mapped out as a function of path-length and this pattern decreases in an oscillatory manner to some constant, but not zero value, as the difference in path length increases. This is shown in the left of Fig. 11. Because changing either path’s length has the same effect, the signal is symmetrical about zero path difference. The general form of the interference pattern is that it is large at small path difference <span class="math notranslate nohighlight">\(d\)</span> and decreases thereafter. This is because long wavelengths (low frequency) remain mostly in phase for a small <span class="math notranslate nohighlight">\(d\)</span> and so do shorter wavelength waves,but less so and this leads to large oscillations when <span class="math notranslate nohighlight">\(d\)</span> is small, then at larger path difference many waves become more or less out of phase leading to a smaller oscillating signal.</p>
<p>When the sample is placed in the beam, it absorbs some frequencies only depending on its particular nature, which results in a change in the signal’s size on the detector and so the shape of the interferogram. The signal detected is <span class="math notranslate nohighlight">\(\langle |E(t)+E(t+\tau)|^2\rangle\)</span> where the average, indicated by brackets (<span class="math notranslate nohighlight">\(\langle\cdots \rangle\)</span>) is over time <span class="math notranslate nohighlight">\(t\)</span> (as mentioned previously the detector cannot follow the radiation’s electric field); <span class="math notranslate nohighlight">\(\tau=d/c\)</span> is the delay time introduced by the moving mirror. The electric field of the radiation is <span class="math notranslate nohighlight">\(E\)</span> and the total signal is the sum of that from both arms and is squared because the detector can only measure intensity or <span class="math notranslate nohighlight">\(E^2\)</span>. On multiplying out this expression we find that the signal is proportional to the <em>autocorrelation</em> of the electric field of the radiation which is  <span class="math notranslate nohighlight">\(\sim \langle E(t)E(t+\tau)\rangle \)</span>. The signal’s size at each displacement (<span class="math notranslate nohighlight">\(2d\)</span>) is proportional to the fourier transform of the autocorrelation via the Wiener-Kninchin theorem. Details of this are given later on in this chapter after autocorrelation is described.</p>
<p>The distance the mirrors are moved is accurately determined by using a visible laser that follows the same path in the interferometer, but does not pass through the sample. This laser produces an interference pattern on a second (photodiode) detector; the number of fringes passed as the arm of the interferometer moves is counted, by observing the signal zeros, and this is used to determine how far one mirror has moved relative to the other. As there is a limit to how far the moving mirror can be taken the interference signal is terminated prematurely compared to theory which would have it extend to infinity. The finite maximum delay limits the spectral resolution and additionally, at this point the signal can suddenly change in size and to avoid spurious lines caused by this, the transform may be multiplied by a decaying function to smoothly make its value zero at long excursion. This is called <em>apodising</em> and an example is given later on.</p>
<p>The FTIR spectrometer has the multiplex (Fellgett) advantage over a wavelength scanning instrument, because all wavelengths are simultaneously measured on a large area detector, which also receives a large and virtually noise free signal because slits to control spectral resolution are not needed as with a grating instrument, instead the ir radiation is made round and parallel. Avoiding an entrance slit and the extra light available as a result is called the Jaquinet advantage. Both Fellgett and Jaquinet advantages help to improve the signal to noise ratio. In comparison, in a scanning instrument, the radiation is detected through a narrow slit and the wavelength is changed by rotating a diffraction grating. In such an instrument the narrow slit, necessary for high resolution, is responsible for a poor signal to noise ratio because only a little radiation can reach the detector at any given wavelength. Scanning over the wavelengths also makes the experiment lengthy.</p>
<p>An example of producing an interferogram and its analysis given later on in this chapter after fourier transforms are described.</p>
<p><img alt="Drawing" src="../_images/fourier-fig11.png" /></p>
<p>Figure 11. Left: A simulated Fourier transform as might be produced directly by an FTIR spectrometer. (For clarity the large signal at zero delay has been clipped.) Right: The IR spectrum after Fourier transforming and converting into transmittance.</p>
<p><img alt="Drawing" src="../_images/fourier-fig12.png" /></p>
<p>Figure 12. Schematic of an FTIR spectrometer as an interferometer. The laser is used to measure the relative distance of the two arms and does not pass through the sample. The curved mirror makes the infra-red beam parallel and a mask gives it a circular cross section as it enters the instrument. All the beam is measured by a large area detector.</p>
</div>
<hr class="docutils" />
<div class="section" id="nmr">
<h2>5.3 NMR<a class="headerlink" href="#nmr" title="Permalink to this headline">¶</a></h2>
<p>Possibly the most important analytical technique for the synthetic chemist is NMR spectroscopy. In an NMR experiment, the nuclear magnetization, which is the vector sum of the individual nuclear spins, is tipped from its equilibrium direction, which is along the direction of the huge permanent magnetic field <span class="math notranslate nohighlight">\(B\)</span>, by a relatively weak RF pulse of short duration. By applying this short pulse along the <span class="math notranslate nohighlight">\(x\)</span>- or <span class="math notranslate nohighlight">\(y\)</span>-axis, and therefore at <span class="math notranslate nohighlight">\(90^\text{o}\)</span> to the permanent field, the magnetization is tipped away from the z-direction and experiences a torque and starts to precess. After the RF pulse has ended, the nuclear magnetization, and hence individual nuclear spins, undergoes a free induction decay (FID) by continuing to precess about the permanent magnetic field <span class="math notranslate nohighlight">\(B\)</span>. The rotating magnetization, Fig. 13, is measured by the detecting coil in the x-y plane as an oscillating and decaying signal, which, when Fourier transformed, produces the NMR spectrum.</p>
<p>In this experiment, the oscillating and decaying signal is converted into reciprocal time or frequency, which is ultimately displayed as a frequency shift <span class="math notranslate nohighlight">\(\delta\)</span> in ppm from a standard compound, such as tetramethylsilane. In a classical sense, it is possible imagine the rotating nuclear magnetization repeatedly passing in front of the detection coil, thereby inducing a current to flow in it as it does so, and which will cause the output signal to rise and fall. Many such magnetizations from the many groups of nuclear spins in different chemical environments produce many signals, resulting in a complicated oscillating FID. Figure 14 shows a synthesized NMR free induction decay of two spins with a frequency of <span class="math notranslate nohighlight">\(10\)</span> and <span class="math notranslate nohighlight">\(11\)</span> MHz, and the corresponding real and imaginary parts of the transform, which we will suppose is the NMR spectrum of two lines separated by <span class="math notranslate nohighlight">\(1\)</span> MHz. The RF pulse used to tip the magnetization contains many frequencies, as may be seen from the Fourier series of a square pulse, and simultaneously excites the nuclear spins in different magnetic environments in the molecule. The analysis of the spectrum provides information about the structure of the molecule, but not bond distances or angles unless sophisticated multiple pulse methods are used (Sanders &amp; Hunter 1987; Levitt 2001).</p>
<p>In an NMR experiment, the data is obtained as an FID rather than directly as a spectrum because this increases the speed of data acquisition and, more importantly, increases the signal to noise ratio over an instrument where the magnetic field is continuously changing in strength. In the FID, all frequencies are measured simultaneously, as in the FTIR instrument, giving the measurement a multiplex or Fellgett advantage. There are other reasons for measuring the FID, which is that the instrument now operates in real time; this allows multiples of RF pulses to be applied to the sample, and these allow the magnetization to be manipulated via multi-quantum processes.</p>
<p><img alt="Drawing" src="../_images/fourier-9-13.png" /></p>
<p>Figure 13. The sequence of the magnetization and the FID produced during a basic NMR experiment.</p>
<hr class="docutils" />
<p><img alt="Drawing" src="../_images/fourier-fig14.png" /></p>
<p>Figure 14. A simulated FID of two NMR transitions showing its real and ‘imaginary’ parts and the phase. The real part is the absorption spectrum or the normal NMR spectrum, the imaginary part the dispersion. The vertical dashed lines show the frequencies used in the calculation of the FID.</p>
</div>
<hr class="docutils" />
<div class="section" id="x-ray-diffraction">
<h2>5.4 X-ray diffraction<a class="headerlink" href="#x-ray-diffraction" title="Permalink to this headline">¶</a></h2>
<p>In FTIR and NMR, a conscious choice is made to perform a transform type of experiment. This is not so in X-ray diffraction, for the very nature of the experiment removes any choice. X-ray diffraction from a crystal produces a three-dimensional diffraction pattern caused by the X-rays that scatter off each atoms’s electron. The atoms are arranged in a regular and repeating manner in the crystal and because of this repeated regularity there are, in effect, many  numerous stacks of planes of atoms, like pages in a book, from which the X-rays are diffracted in phase. In a given direction a scattered wave’s amplitude is the superposition of these many scattered waves in proportion to all of the different, but regularly repeating, atom positions. This 3D scattering is projected onto the two-dimensional detector surface and is measured as a pattern of bright spots. This image is Fourier transformed and produces the distances between lattice planes from which the molecule’s structure can be determined. It is the <em>intensity</em> of the spots that contains the information about the molecules structure not their positions on the detector.</p>
<p>Scattering of the X-rays occurs because they interact with electrons and cause them to re-radiate, which they do in all directions. Only when waves originate from planes of atoms that satisfy the Bragg law, <span class="math notranslate nohighlight">\(n\lambda = 2d\sin(\theta)\)</span>, is there constructive interference, and an X-ray is detected using a device similar to a CCD. Everywhere else, there is destructive interference and no waves exist. The detector is similar in nature to the one in a digital camera or mobile phone and the brightness of a spot is proportional to the amplitude squared (intensity) of the X-ray waves arriving at that point.</p>
<p>The atoms in a crystal form repeating unit cells and each set of planes of atoms, in principle, will produce one spot on the detector and in a position proportional to the reciprocal of the lattice spacing between planes. Sometimes a crystal’s symmetry may cause extra interference between X-rays from different planes, which produces systematic absences in the X-ray image and these can be use to distinguish one particular type of crystal lattice from another.</p>
<p>It is important to note that it is not the locations of the spots on the detector that ultimately produces the molecular structure, a spot’s position is determined by the scattering planes. The <em>intensity</em> of the spots is determined by the positions of the atoms in the unit cell. This is explained in section 13.</p>
<p>The two-dimensional image on the detector has to be Fourier transformed into a representation of the crystal structure but, because the absolute value of the transform rather than its amplitude is produced on the detector, phase information is lost and this makes the interpretation of the image very much more difficult than it would otherwise be. This is the origin of the ‘phase’ problem and ingenious methods have had to be devised to overcome this (McKie &amp; McKie 1992; Giacovazzo et al. 1992). An example of the summation of several waves particular to this problem is described in chapter 1.</p>
<p>Two dimensional fourier transforms and a little more detail on x-ray diffraction are discusses later on in this chapter.</p>
<p>Fourier transforms are widely used in other areas, such as image processing, for example from star fields, MRI and X-ray CT scans (computed tomography) which is described later on in this chapter, and in unexpected areas such as aligning DNA sequences and in solving many types of differential equations such as those describing molecular diffusion or heat flow. Other uses of fourier transforms are image processing, for example filtering, blurring, sharpening and noise removal etc., data compression for example for music files, and in telecomms. These technologies show that it is essential to be familiar with Fourier transforms whether you are a chemist, physicist, biologist, or a clinician.</p>
</div>
<div class="section" id="linear-transforms">
<h2>5.5 Linear transforms<a class="headerlink" href="#linear-transforms" title="Permalink to this headline">¶</a></h2>
<p>The next few sections describe the Fourier transform in detail, but first some jargon has to be explained. Formally, a Fourier transform is defined as a linear integral transform of one function or set of data into another; see equation (23). The transform is reversible, or invertible, enabling the original function or data to be retrieved after an inverse transform. These last two sentences are in ‘math-speak’, so what do they really mean?</p>
<p>Integral simply means that the transform involves an integration as shown in equation (23). The word ‘linear’, in ‘linear transform, means that the transform <span class="math notranslate nohighlight">\(T\)</span> has the property, when operating on two regular functions <span class="math notranslate nohighlight">\(f_1\)</span> and <span class="math notranslate nohighlight">\(f_ 2\)</span>, that <span class="math notranslate nohighlight">\(T( f_1 + f_2) = T( f_1) + T( f_2)\)</span>. This means that the transform of the sum of <span class="math notranslate nohighlight">\(f_ 1\)</span> and <span class="math notranslate nohighlight">\(f_ 2\)</span> is the same as transforming <span class="math notranslate nohighlight">\(f_ 1\)</span>, and then transforming <span class="math notranslate nohighlight">\(f_2\)</span> and adding the result. In addition, the linear transform has the property <span class="math notranslate nohighlight">\(T(cf_1) = cT( f_1)\)</span> if <span class="math notranslate nohighlight">\(c\)</span> is a constant.</p>
<p>Reversible, or invertible, means that a reverse transform exists that reforms the initial function from the transform; formally this can be written as <span class="math notranslate nohighlight">\(f = T^{-1}[T[f]]\)</span> if <span class="math notranslate nohighlight">\(T^{-1}\)</span> is the inverse transform. Put another way, if a function <span class="math notranslate nohighlight">\(f\)</span> is transformed to form a new function <span class="math notranslate nohighlight">\(g\)</span>, as <span class="math notranslate nohighlight">\(T[f] = g\)</span>, then the inverse transform takes <span class="math notranslate nohighlight">\(g\)</span> and reforms <span class="math notranslate nohighlight">\(f\)</span> as <span class="math notranslate nohighlight">\(f = T^{-1}[g]\)</span>. This might seem to be rather abstract, but is, in fact, very common.</p>
<p>A straightforward example is the log and exponential functions, as they are convertible into one another as an operator pair: If <span class="math notranslate nohighlight">\(T\)</span> is the exponential operator <span class="math notranslate nohighlight">\(e^{( )}\)</span>, and <span class="math notranslate nohighlight">\(x^2\)</span> is the ‘function’, then <span class="math notranslate nohighlight">\(\displaystyle T[x^2] = e^{x^2}\)</span>. The inverse operator <span class="math notranslate nohighlight">\(T^{-1}\)</span> reproduces the original function: <span class="math notranslate nohighlight">\(T^{-1}[T[x^2]] = x^2\)</span> or, by substitution, it is true that <span class="math notranslate nohighlight">\(\displaystyle T^{-1}[e^{x^2}] = x^2\)</span> if <span class="math notranslate nohighlight">\(T^{-1}\)</span> is the logarithmic operator <span class="math notranslate nohighlight">\(\ln( )\)</span> because <span class="math notranslate nohighlight">\(\displaystyle \ln(e^{x^2}) = x^2\)</span>. The Fourier transform is only a
more complicated version of an operator than is <span class="math notranslate nohighlight">\(\ln( )\)</span> or <span class="math notranslate nohighlight">\(e^{( )}\)</span>.</p>
<p>The Fourier transform can be thought of as changing or ‘mapping’ the initial function <span class="math notranslate nohighlight">\(f\)</span> to another function <span class="math notranslate nohighlight">\(g\)</span>, but in a systematic way. The new function may not look like the original, but however one might modify the transformed function <span class="math notranslate nohighlight">\(g\)</span>, when transformed back to <span class="math notranslate nohighlight">\(f\)</span>, it is as if <span class="math notranslate nohighlight">\(f\)</span> itself had been modified. Although it is common to use the word ‘transform’, the word ‘operator’ could equally well be used although this is not usual in this context. Conversely, a matrix when acting on another matrix or a vector, performs a linear transform, however, a matrix is usually called a linear operator.</p>
</div>
<div class="section" id="the-transform">
<h2>5.6 The Transform<a class="headerlink" href="#the-transform" title="Permalink to this headline">¶</a></h2>
<p>The Fourier transform is used either because a problem is most easily solved in ‘transform space’, or, because of the way an experiment is performed, the data is produced in transform space and has then to be transformed back into ‘real space’. This ‘real space’ is usually either time or distance; the transform space is then frequency (as inverse time) or inverse distance. The time-to-frequency and the distance-to-inverse distance are both <em>conjugate pairs</em> of variables between which the Fourier transform operates. In practice, there are two ‘flavours’ of Fourier transforms. The simpler is the mathematical transformation of a function, such as a sine wave or exponential decay, the other is, effectively, the same process, but performed on real experimental data presented as a list of numbers. The latter is called the Discrete Fourier Transform (DFT). Because the transform is in reciprocal space, values near to zero on its abscissa correspond either to large values of frequency or  reciprocal distance depending on whether the conjugate variable is time or distance respectively.</p>
<p>The Fourier transform is always between pairs of conjugate variables, time <span class="math notranslate nohighlight">\(\leftrightharpoons\)</span> frequency, so that <span class="math notranslate nohighlight">\(\Delta t\Delta v = 1\)</span> or distance <span class="math notranslate nohighlight">\(\leftrightharpoons\)</span> 1/distance. As the transform changes one variable into its conjugate, it is possible in simple cases to visualize what the spectrum will look like without actually doing the calculation. A sine wave that has a single frequency has a Fourier transform that is a single line at the frequency of the wave. If there are two waves of different frequencies superimposed on one another, two lines will appear after transforming.</p>
<p>So far, so good, but the length of the waves is not specified. Are they of finite length and so contain only a finite number of oscillations, or are they of infinite extent? If a sine wave is infinitely long, then only one line is observed in the transform, and will be of infinitesimal width and occur at the frequency of the sine wave. This line is a delta function. If the waves are turned on at some point and off again at another, then there are discontinuities at these points, and some additional frequencies must be associated with turning the signal on and off, which will appear in the transformed spectrum as <em>new</em> frequencies. Think of how a waveform is made up of a sum of sine waves of different frequency, see Fig. 1. If a waveform is to be zero in some regions and not in others, then many waves have to be present to cancel out one another as necessary and these are the new frequencies needed. A broadening of the lines also occurs, because <span class="math notranslate nohighlight">\(\Delta t\Delta ν = 1\)</span> and if <span class="math notranslate nohighlight">\(\Delta t\)</span>, the length of the whole sine wave is finite, then <span class="math notranslate nohighlight">\(\Delta v\)</span> has a width associated with it. This is observed in FTIR and NMR spectra, but the software provided with many instruments can be set to remove as much of this broadening as possible by apodizing the lines (Sanders &amp; Hunter 1987). This means multiplying the function with a decreasing function such as <span class="math notranslate nohighlight">\(\displaystyle e^{-x}\)</span> before transforming.</p>
<p>The effect of Fourier transforming a short and a long rectangular pulse is shown below. The right-hand plots show the real part of the transform, which is a <em>sinc</em> (or Cardinal Sine) function, <span class="math notranslate nohighlight">\(\mathrm{sinc}(ax) \equiv \sin(ax)/ax\)</span>. The result of transforming is mathematically the same for both long and sort pulses, of course, but in a fixed frequency range the effect appears to be different. The short pulse has a wide central band set at zero and widely spaced side bands, which decay rapidly at frequencies away from zero and extend to infinity. The longer pulse has a narrower central band, also centred at zero, and higher frequency side bands than in the short pulse case; the results conform to <span class="math notranslate nohighlight">\(\Delta t\Delta v = 1\)</span>, i.e. short <span class="math notranslate nohighlight">\(\Delta t\)</span> with wide <span class="math notranslate nohighlight">\(\Delta v\)</span> and <em>vice versa</em>.</p>
<p>If a pulse is turned on and off, as shown in Fig. 15, the transform must have frequencies associated with these changes. Again, think of the pulse being made of many terms in a Fourier series. Fig. 1 shows a few of the terms, but the more of these there are each with a different frequency, the better is a sharp edge or pulse defined. The oscillations in the transform of Fig. 15 arise from the many terms needed to describe the rectangular pulse. In fact, to reproduce the original pulse exactly by reverse transforming, an infinite frequency range is needed. If the transform of Fig. 15 <em>exactly</em> as shown in the right-hand side were reverse transformed, the rectangular pulse shown on the left of the figure would not be produced, because on the plot the transform has a limited frequency range. In optics the shape of the transform is that produced by Fraunhofer diffraction from a long narrow slit and where in fig 15 time would be replaced by distance  and frequency by wavevector <span class="math notranslate nohighlight">\(k=2\pi/\lambda\)</span></p>
<p>To calculate the transform is straightforward as we know, by definition, that the function is zero outside the range <span class="math notranslate nohighlight">\(\pm a/2\)</span>, i.e. the width is <span class="math notranslate nohighlight">\(a\)</span> centred at zero. The transform using eqn 23 has limits <span class="math notranslate nohighlight">\(\pm a/2\)</span> instead of infinity and the function has magnitude <span class="math notranslate nohighlight">\(f(x)=1, a/2 \le x \le a/2 \)</span> and otherwise zero, which gives the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k) = \frac{1}{\sqrt{2\pi}}\int_{-a/2}^{a/2} e^{-ikx}dx =\frac{1}{\sqrt{2\pi}}\frac{e^{-ika/2}-e^{ika/2}}{-ik}=\frac{1}{\sqrt{2\pi}}\frac{2}{k}\sin\left(\frac{ka}{2}\right)\]</div>
<p>In the last step the definition of the sine as an exponential is used, <span class="math notranslate nohighlight">\(\sin(x)=(e^{ix}-e^{-ix})/2i\)</span>. This function is plotted in figure 15 vs. frequency <span class="math notranslate nohighlight">\(k\)</span>. The function <span class="math notranslate nohighlight">\(\sin(ax)/(ax)\equiv \text{sinc}(ax)\)</span> and occurs very often in transforms. If the transform is in time then <span class="math notranslate nohighlight">\(x\)</span> is replaced by <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(k\)</span> by the frequency <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
<p>The reciprocal nature of the function and its transform is also clear in these plots. The wider the function the narrower the transform and vice versa, this leads to an ‘uncertainty principle’ in which it is not possible to measure, at the same time, both the function and its transform with unlimited precision. This is described in detail later on. In Quantum mechanics this leads to the Heisenberg Uncertainty Principle.</p>
<p><img alt="Drawing" src="../_images/fourier-fig15.png" /></p>
<p>Figure 15. Example of the Fourier transform of a short and a long rectangular pulse each centred about zero and of total width <span class="math notranslate nohighlight">\(a\)</span>. Only the real part of the transform is shown, and is the sinc function, <span class="math notranslate nohighlight">\(\sin(ax)/ax\)</span>. The transform extends to <span class="math notranslate nohighlight">\(\pm \infty\)</span> and <span class="math notranslate nohighlight">\(a=2\)</span> in the top plots and <span class="math notranslate nohighlight">\(8\)</span> in the lower ones. The transform crosses zero at equally spaced points which are <span class="math notranslate nohighlight">\(\pm n\pi/a\)</span> where <span class="math notranslate nohighlight">\(n=1,2\cdots\)</span>.</p>
<hr class="docutils" />
<p>What is the transform of a cosine wave of finite length? The result is shown in the top row of Fig. 16 and is somewhat similar to that of the square pulse except that the transform frequency cannot be centred at zero because the cosine has a finite frequency. The main peak is at the cosine’s frequency, and the many other sidebands are needed to account for the fact that the wave is suddenly turned off. The transform is in effect a <em>convolution</em> of a top hat or square function with a cosine wave. The longer the wave persists the narrower is the resulting transform as expected due to the reciprocal relationship between the conjugate variables, time and frequency.</p>
<p>Now suppose that the cosine is damped by an exponential function and smoothly decreases in amplitude, then these side-band frequencies largely disappear, because at the end of the cosine wave there is no discontinuity; the exponential makes the cosine gently approach zero. The result is a widening of the feature at the frequency of the cosine wave, Fig. 17. The effect of the exponential decay is to <em>apodise</em> the transform. This is shown in the lower panel of figure 16.</p>
<p><img alt="Drawing" src="../_images/fourier-fig16A.png" /></p>
<p>Figure 16. Top panel. Left: A truncated cosine wave of frequency <span class="math notranslate nohighlight">\(1\)</span>, starting at zero and of length of <span class="math notranslate nohighlight">\(6.5\)</span> cycles. Right: The real part of its Fourier transform whch shown many side bands due to the sudden termination of the signal and is reminiscent of that of a square wave. The value of the wave’s frequency is marked with a vertical line. Lower panel. Left the same wave apodised with <span class="math notranslate nohighlight">\(e^{-t/\tau}\)</span> with <span class="math notranslate nohighlight">\(\tau=1\)</span> which makes the cosine diminish to zero before it ends.</p>
<p><img alt="Drawing" src="../_images/fourier-fig16b.png" /></p>
<p>Figure 17. The same cosine wave as above but extended for a longer time. Top Panel. Left the truncated wave and right its transform which is narrower in frequency, due to the reciprocal relationship between conjugate variables. Lower panel. The apodised wave and its transform. The apodising lifetime is now longer <span class="math notranslate nohighlight">\(\tau=5\)</span> and because the signal lasts for longer this results in a narrower and smooth transform than in figure 16 even though <span class="math notranslate nohighlight">\(\tau\)</span> is longer.</p>
</div>
<hr class="docutils" />
<div class="section" id="fourier-series-and-transforms">
<h2>5.7 Fourier Series and Transforms<a class="headerlink" href="#fourier-series-and-transforms" title="Permalink to this headline">¶</a></h2>
<p>The connection between the Fourier series and the Fourier transform is important, and it should not be ignored. To produce the Fourier series such as that which describes a rectangular pulse, infinitely many terms in the Fourier series will be needed, and of ever increasing frequency. The Fourier transform allows us to see these frequencies by transforming to frequency space, so that each frequency in the Fourier series appears as a feature.</p>
<p>In an NMR experiment, a square pulse of RF radiation is used to excite the nuclear spin states in the sample and, as has been seen, the Fourier transform of such a pulse illustrates that it has many frequencies contained within it. In an experiment, the pulse is made of sufficient duration to contain all those frequencies needed to excite the nuclear spins. Of course, these frequencies are not made by the transform, but are there all the time, because to form the pulse in the first place many different sine or cosine waves each of different frequency are added together in the electronic circuitry.</p>
<p>To illustrate this further, consider a laser pulse with the duration of a few femtoseconds. Such pulses are made by the process of mode-locking. For a laser to work, the light waves in the cavity must fit exactly into its length no matter what the colour of the light, and a node must occur at each of the mirrors; the restriction is that <span class="math notranslate nohighlight">\(n\)</span> half wavelengths must equal the cavity length, <span class="math notranslate nohighlight">\(n\lambda/2 = L\)</span>. If these waves, which have different frequencies for each <span class="math notranslate nohighlight">\(n\)</span>, can be forced to be in phase with one another, a pulse results; mode-locking is the process by which this is achieved. Making the phase the same means ensuring that each of the waves has a maximum in the same place, no matter what their frequency is. A pulse results because waves of different frequency must eventually fall out of step with one another away from zero or <span class="math notranslate nohighlight">\(\pm n\pi\)</span>, where they are in phase. Figure 18 shows that a pulse can only result from the addition of many different frequencies if they are in phase. The pulse is normalized to a maximum of <span class="math notranslate nohighlight">\(\pm 1\)</span> in the figure and shows the amplitude, a photodiode or CCD detector measure the intensity which is the square of this signal is always positive. In a mode-locked laser, <span class="math notranslate nohighlight">\(\approx 10^6\)</span> waves may be added together rather than the few shown; consequently, the laser pulse is far better defined.</p>
<p><img alt="Drawing" src="../_images/fourier-fig18.png" /></p>
<p>Figure 18. Top: Eleven cosine waves and their sum show that pulses can only be made by adding waves of different frequency together but only if they have the same phase. Top right: One possible sum when the waves are added with random phases. The waves are <span class="math notranslate nohighlight">\(\cos(nx/2)\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is an odd integer. The effect is more pronounced if more waves are used; the pulse becomes shorter and the random noise (right) becomes smaller in amplitude. Lower left and right. These two plots show the square of the signals in the upper ones, plotted on the same scale. The square is important because if the waves correspond to the photons electric field, the intensity measured is the square of this. The pulses and random noise are both clear.</p>
<hr class="docutils" />
<p>To realize mode-locking, a laser must have a broad emission spectrum and nowadays titanium sapphire is often used as the gain medium to produce femtosecond duration pulses, dye-lasers are sometimes still used to produce picosecond pulses. The Ti<span class="math notranslate nohighlight">\(^{3+}\)</span> ions have many different sites in the sapphire (<span class="math notranslate nohighlight">\(\mathrm{Al_2O_3}\)</span>) crystal lattice and therefore have a broad emission spectrum, which is in the far-red part of the visible spectrum and centred around <span class="math notranslate nohighlight">\(850\)</span> nm. The molecules or ions used to produce the fluorescence/luminescence which give rise to lasing, have a certain wavelength range caused by the nature of their potential energy surfaces and by the inhomogeneity of the host material a glass or liquid, for example, which shifts energy levels up and down. The coating on the mirrors, and perhaps added optical elements such as gratings, interference or birefringent (Lyot) filters, restrict the wavelengths over which the laser can operate, and this is done to enable the wavelength to be changed. However, if a short pulse is to be produced, the wavelength range has to be so wide that no filters are wanted, quite the opposite, as little restriction as possible on the wavelength range is desirable, as the product <span class="math notranslate nohighlight">\(\Delta v\Delta t\)</span> has a constant value. This means that a wide frequency (or wavelength) range is necessary if <span class="math notranslate nohighlight">\(\Delta t\)</span> is to be small. This is entirely consistent with the observation that many waves of different frequencies are needed to make a pulse. ( In practice is possible to produce  femtosecond pulses centred at different the wavelenghts as the spread in wavelength needed to produce the pulse is less than the possible wavelength range of the emission.)</p>
</div>
<div class="section" id="the-fourier-transform-equations">
<h2>6 The Fourier Transform equations<a class="headerlink" href="#the-fourier-transform-equations" title="Permalink to this headline">¶</a></h2>
<p>The derivation of the transform equations is now sketched out by starting with the Fourier series. Butkov (1968) gives the full derivation. The Fourier series, considered in Section 1, are all formed from periodic functions, but suppose that the function is thought of as having an infinite period, or to put it another way, if the limits are <span class="math notranslate nohighlight">\(-L \to L\)</span> then what happens when <span class="math notranslate nohighlight">\(L \to \infty \)</span>? It is easier here to use the complex exponential form of the series, equations (7), and write</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(x) = \sum_{n=-\infty}^{\infty}c_ne^{+in\pi x/L}    \tag{24} \]</div>
<p>with coefficients</p>
<div class="math notranslate nohighlight">
\[\displaystyle c_n= \frac{1}{2L}\int_{-L}^L f(x)e^{-in\pi x/L}    \tag{25} \]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is an integer specifying the position in the series, therefore, <span class="math notranslate nohighlight">\(c_n\)</span> is one of a series of numbers that could be plotted on a graph <span class="math notranslate nohighlight">\(c_n\)</span> vs <span class="math notranslate nohighlight">\(n\)</span>. To simplify (24), we define <span class="math notranslate nohighlight">\(k = n\pi /L\)</span>, which gives <span class="math notranslate nohighlight">\(\Delta k = (\pi/L)\Delta n\)</span> for a small change in <span class="math notranslate nohighlight">\(k\)</span>, and clearly, as <span class="math notranslate nohighlight">\(L\)</span> gets larger, <span class="math notranslate nohighlight">\(k\)</span> gets smaller. However, there is a problem here, for when <span class="math notranslate nohighlight">\(L\to \infty\)</span> it looks as though all values of <span class="math notranslate nohighlight">\(c_n\)</span>, equation (25), will go to zero, because <span class="math notranslate nohighlight">\(L\)</span> is in the denominator.</p>
<p>Instead of immediately taking the limit, suppose that the values of <span class="math notranslate nohighlight">\(n\)</span> describe adjacent points on a graph of <span class="math notranslate nohighlight">\(c_n\)</span> vs <span class="math notranslate nohighlight">\(n\)</span>, and because adjacent points are the smallest differences that <span class="math notranslate nohighlight">\(n\)</span> can have, then <span class="math notranslate nohighlight">\(\Delta n  = 1\)</span> and so <span class="math notranslate nohighlight">\(\Delta k = \pi /L\)</span> or <span class="math notranslate nohighlight">\((L/\pi )\Delta k = 1\)</span>. Equation (24) can now be multiplied by this factor without difficulty because it is <span class="math notranslate nohighlight">\(1\)</span>, giving</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(x)=\sum_{n=-\infty}^{\infty}\frac{L}{\pi}c_ne^{+ikx} \Delta k   \tag{26} \]</div>
<p>and <span class="math notranslate nohighlight">\(c_n\)</span> is given by equation (25). The limit <span class="math notranslate nohighlight">\(L\to \infty\)</span> also means that <span class="math notranslate nohighlight">\(\Delta k \to  0\)</span>, which makes <span class="math notranslate nohighlight">\(k\)</span> into a continuous variable, and the coefficients <span class="math notranslate nohighlight">\(c_n\)</span> can now be written as a function of <span class="math notranslate nohighlight">\(k\)</span>, i.e. as <span class="math notranslate nohighlight">\(c(k)\)</span> instead of the discrete values <span class="math notranslate nohighlight">\(c_n\)</span>. Taking this limit also changes <span class="math notranslate nohighlight">\(f(x)\)</span> to an integral, because <span class="math notranslate nohighlight">\(\Delta k \to  0\)</span>,</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(x)=\lim_{L \rightarrow \infty}\sum_{n=-\infty}^{\infty}\frac{L}{\pi}c_ce^{in\pi x/L}\Delta k =\int_{-\infty}^\infty c(k)e^{ikx} dk\]</div>
<p>and <span class="math notranslate nohighlight">\(c(k) = Lc_n/\pi \)</span> but from eqn. 25 <span class="math notranslate nohighlight">\(c(k)\)</span> is</p>
<div class="math notranslate nohighlight">
\[c(k)= \frac{1}{2\pi}\int_{-\infty}^\infty f(x)e^{-ikx}dx  \]</div>
<p>This equation is conventionally rewritten by defining a new function <span class="math notranslate nohighlight">\(g(k)\)</span>, where <span class="math notranslate nohighlight">\(g(k) = c(k)\sqrt{2π}\)</span>. This function is the <em>forward transform</em> and is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty f(x)e^{-ikx}dx \qquad\text{       forward transform} \tag{27}\]</div>
<p>and the reverse transform is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  f(x) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty g(k)e^{+ikx}dk \qquad\text{       reverse transform} \tag{28}\]</div>
<p>notice how the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(k\)</span> and the signs in the exponential change.</p>
<p>The two functions form a Fourier transform pair; the function <span class="math notranslate nohighlight">\(f(x)\)</span> with a positive exponential is the ‘reverse’ or ‘inverse’ transform, and <span class="math notranslate nohighlight">\(g(k)\)</span>, equation (27), with a negative exponential, the ‘forward’ transform because it converts the measured or known function <span class="math notranslate nohighlight">\(f(x)\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> might be distance, into the transformed space <span class="math notranslate nohighlight">\(k\)</span> which is inverse distance. Alternatively, if <span class="math notranslate nohighlight">\(x\)</span> represents time then <span class="math notranslate nohighlight">\(k\)</span> represents frequency.</p>
<p>As the equations involve <span class="math notranslate nohighlight">\(e^{ikx}\)</span> we can use de Moivre’s theorem to write them as sine and cosine, for example</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty f(x)\cos(kx)dx -\frac{i}{\sqrt{2\pi}}\int_{-\infty}^\infty f(x)\sin(kx)dx\]</div>
<p>and as is almost always easier to integrate an exponential, this form of the equation is rarely used.</p>
<p>There are some other points to note.</p>
<p><strong>(i)</strong> These equations give the value of the transform at one point only. To obtain the full transform, <span class="math notranslate nohighlight">\(k\)</span> has to be varied in principle from <span class="math notranslate nohighlight">\(-\infty\)</span> to +<span class="math notranslate nohighlight">\(\infty\)</span>, but, in practice, a value of <span class="math notranslate nohighlight">\(k\)</span> which is far less than infinity can be used because the transform often has an infinitesimal amplitude at large <span class="math notranslate nohighlight">\(k\)</span>; see Fig. 19 for an example.</p>
<p><strong>(ii)</strong> Because the integration involves a complex number, the result might be complex or it might be real; this just depends on what the function is and it might therefore be necessary to plot the real, imaginary, and absolute value of the transform.</p>
<p><strong>(iii)</strong> There are different forms of Fourier transform pairs that differ from one another by normalization constants, <span class="math notranslate nohighlight">\(1/\sqrt{ 2\pi}\)</span> in our notation. This can lead to confusion when comparing one calculation with another.</p>
<p><strong>(iv)</strong> Finally, note that some authors, engineers in particular, often define the forward transform with a positive sign in the exponential and negative in the reverse, which is a change of phase with respect to our notation. They also often use <span class="math notranslate nohighlight">\(j\)</span> instead of <span class="math notranslate nohighlight">\(i\)</span> to mean <span class="math notranslate nohighlight">\(\sqrt{-1}\)</span>.</p>
</div>
<div class="section" id="plotting-transforms">
<h2>6.1 Plotting transforms<a class="headerlink" href="#plotting-transforms" title="Permalink to this headline">¶</a></h2>
<p>Because the transform is normally a complex quantity, it has a real and imaginary part. In plotting the transform three graphs can be produced; one for each of the real and the imaginary components of the whole transform and one of the square of the absolute value, which is usually called the power or transform spectrum and is <span class="math notranslate nohighlight">\(g(k)^*g(k) = |g(k)|^2\)</span>, the asterisk indicating the complex conjugate.</p>
</div>
<div class="section" id="what-functions-can-be-transformed">
<h2>6.2 What functions can be transformed?<a class="headerlink" href="#what-functions-can-be-transformed" title="Permalink to this headline">¶</a></h2>
<p>To perform the transform, <span class="math notranslate nohighlight">\(f(x)\)</span> must be integrable and must converge when the integration limits are infinity; this generally means that <span class="math notranslate nohighlight">\(f(x) \to\)</span> 0 as <span class="math notranslate nohighlight">\(x \to \pm \infty\)</span>: a sufficient condition is that <span class="math notranslate nohighlight">\(\int_{-\infty}^{\infty} |f(x)|dx\)</span> exists.</p>
</div>
<div class="section" id="how-to-calculate-and-plot-a-fourier-transform">
<h2>6.3 How to calculate and plot a Fourier transform<a class="headerlink" href="#how-to-calculate-and-plot-a-fourier-transform" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-finite-wave-train">
<h3><strong>(1) A finite wave train</strong><a class="headerlink" href="#a-finite-wave-train" title="Permalink to this headline">¶</a></h3>
<p>A finite wave train can be described as a sine wave <span class="math notranslate nohighlight">\(f(x) = \sin(\omega x)\)</span> of  angular frequency <span class="math notranslate nohighlight">\(\omega = 2\pi/L\)</span> that exists only over the range <span class="math notranslate nohighlight">\(-L\)</span> to +<span class="math notranslate nohighlight">\(L\)</span>; this supposes also that the function <span class="math notranslate nohighlight">\(f(x)\)</span> is zero everywhere else, see Fig. 19. Choosing the sine function to have the argument <span class="math notranslate nohighlight">\(2\pi x/L\)</span> means that it is zero, i.e. has a node, at <span class="math notranslate nohighlight">\(x = \pm L\)</span>; note that the frequency need not be a multiple of the range of the transform, but the resulting equations are simpler if it is. Because the function is zero outside <span class="math notranslate nohighlight">\(\pm L\)</span>, so is the integral, and the integration limits of its fourier transform become <span class="math notranslate nohighlight">\(\pm L\)</span> rather than <span class="math notranslate nohighlight">\(\pm \infty\)</span>. The forward fourier transform eqn. 27 gives,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k) = \frac{1}{\sqrt{2\pi}}\int_{-L}^L \sin(2\pi x/L)e^{-ikx}dx \]</div>
<p>which is easily integrated using the exponential form of the sine. The result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k)= -\frac{4i\pi L \sin(Lk)}{k^2L^2-4\pi^2}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check using sympy  1j is the Sympy definition of mathematical &#39;i&#39; </span>

<span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span> <span class="s1">&#39;L, x, k&#39;</span><span class="p">,</span><span class="n">positive</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">f01</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span><span class="n">f01</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">),</span><span class="n">conds</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Fourier-C_8_0.png" src="../_images/Fourier-C_8_0.png" />
</div>
</div>
<p>which is the same result after converting the exponentials to the sine. This can be checked also by SymPy using the instructions <span class="math notranslate nohighlight">\( \mathtt{ simplify( g.rewrite(sin) )} \)</span>.</p>
<p>The Fourier transform is, in this particular example, wholly the imaginary part of a complex number. When <span class="math notranslate nohighlight">\(k  = 0\)</span> and when <span class="math notranslate nohighlight">\(Lk = \pm n \pi\)</span>, the transform is zero, except when <span class="math notranslate nohighlight">\(Lk = \pm 2\pi\)</span> where the maximum or minimum occurs. When <span class="math notranslate nohighlight">\(Lk = +2\pi\)</span>, the transform has the nominal value of <span class="math notranslate nohighlight">\(0/0\)</span>, which can be evaluated using l’Hopital’s rule (see Chapter 3). Remember to stop differentiating when either the top or bottom of the fraction is not zero, the result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \lim_{k \to 2\pi /L} \frac{-4\pi iL\sin(Lk)}{k^2L^2-4\pi^2} \to \frac{-4\pi i L^2\cos(Lk)}{2kL^2} = -\frac{2\pi i}{k} = -iL\]</div>
<p>which is the minimum value of the transform. The maximum occurs when <span class="math notranslate nohighlight">\(kL = -2\pi\)</span>, (see Fig. 19), which corresponds to the frequency <span class="math notranslate nohighlight">\(k = 2\pi /L \equiv \omega\)</span> in radians, or 1/<span class="math notranslate nohighlight">\(L\)</span> in Hz, if <span class="math notranslate nohighlight">\(L\)</span> measures time. If <span class="math notranslate nohighlight">\(L\)</span> is distance, cm for example, as in an FTIR spectrometer, then 1/<span class="math notranslate nohighlight">\(L\)</span> is in wavenumbers or cm<span class="math notranslate nohighlight">\(^{-1}\)</span>.</p>
<p>To plot the transform, it is necessary to plot either the imaginary part (fig 19) or its absolute value; there is no real part in this particular example. Notice that there appear to be two frequencies, one at about 0.5 and at -0.5; negative frequencies do not make any sense if the sine wave is a signal from an experiment and for real experimental data, the negative frequencies need to be ignored. If the range <span class="math notranslate nohighlight">\(\pm L\)</span> is kept the same, and instead of a sine, a cosine wave of the same frequency transformed, the real frequency part of the Fourier transform would now look like the imaginary part of Fig. 19.</p>
<p>As a sine wave of infinite extent has a single frequency the extra frequencies seen in Fig. 19 must arise due to the fact that this wave exists only between <span class="math notranslate nohighlight">\(\pm L\)</span>. The sudden change in value of the function at <span class="math notranslate nohighlight">\(\pm L\)</span> corresponds to having several different frequencies present, although they are not apparently there. Put another way, if a Fourier series of this truncated sine wave had to be formed very many sines or cosines of a different frequencies would have to be included. Why several terms? A single sine wave normally extends to infinity, many waves of different frequency are needed to reinforce the values near <span class="math notranslate nohighlight">\(k = 0\)</span> and simultaneously to cancel out the part where the amplitude is zero, between <span class="math notranslate nohighlight">\(-L \to -\infty\)</span> and <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(\infty\)</span>. Although, for practical purposes, these regions in the integration were ignored, this was only because the sine wave is zero here, but this does not mean that waves do not exist to make the amplitude zero. These terms produce the extra frequencies seen in the transform. Put another way, to understand the transform it is necessary to consider all the terms needed to describe the initial truncated function <span class="math notranslate nohighlight">\(f(x)\)</span> as a Fourier series because it is exactly these terms that appear as frequencies in the transform.</p>
<p><img alt="Drawing" src="../_images/fourier-fig19.png" /></p>
<p>Figure 19. Graphs of <span class="math notranslate nohighlight">\(\sin(\omega x)\)</span> from <span class="math notranslate nohighlight">\(\pm L\)</span> when <span class="math notranslate nohighlight">\(L = 10\)</span>; its Fourier transform, the imaginary part (top right), and its spectrum, the square of its absolute value (bottom right). The real part of the transform is zero because <span class="math notranslate nohighlight">\(\displaystyle g(k)= -\frac{4i\pi \sin(Lk)}{k^2L^2-4\pi^2}\)</span> has no real part. (The vertical scales are not the same, but the maximum value of the transform and its absolute value is <span class="math notranslate nohighlight">\(L\)</span>.)</p>
</div>
<hr class="docutils" />
<div class="section" id="ii-exponential-decay">
<h3><strong>(ii) Exponential decay</strong><a class="headerlink" href="#ii-exponential-decay" title="Permalink to this headline">¶</a></h3>
<p>The fourier transform of an exponential decay <span class="math notranslate nohighlight">\(e^{-kt}\)</span> has to be defined from zero as the decay has to start at <span class="math notranslate nohighlight">\(t=0\)</span>. The conjugate variable is <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}g(\omega)&amp;= \frac{1}{\sqrt{2\pi}}\int_0^\infty e^{-kt}e^{-i\omega t}dt\\
&amp;= \frac{1}{\sqrt{2\pi}}\int_0^\infty e^{-(k+i\omega) t}= \frac{1}{\sqrt{2\pi}}\frac{e^{-(k+i\omega) t} }{-(k+i\omega)}\Bigg|_0^\infty\\&amp;=\frac{1}{\sqrt{2\pi}} \frac{1}{{k+i\omega}}=\frac{1}{\sqrt{2\pi}}\left( \frac{k}{{k^2+\omega^2}} -i\frac{\omega}{{k^2+\omega^2}}\right) \end{align}\end{split}\]</div>
<p>If the absolute value of <span class="math notranslate nohighlight">\(t\)</span> is used <span class="math notranslate nohighlight">\(e^{-k|t|}\)</span> this means that when <span class="math notranslate nohighlight">\(t&gt;0\)</span> we use <span class="math notranslate nohighlight">\(e^{-kt}\)</span> and <span class="math notranslate nohighlight">\(e^{+kt}\)</span> otherwise. The function <span class="math notranslate nohighlight">\(e^{-k|t|}\)</span> is a double sided exponential that exponentially grows to maximum from negative <span class="math notranslate nohighlight">\(t\)</span> to zero then decays away at <span class="math notranslate nohighlight">\(t \gt 0\)</span>.</p>
<div class="math notranslate nohighlight">
\[g(\omega)= \frac{1}{\sqrt{2\pi}}\int_0^\infty e^{-kt}e^{-i\omega t}dt + \frac{1}{\sqrt{2\pi}}\int_{-\infty}^0 e^{+kt}e^{-i\omega t}dt\]</div>
<div class="math notranslate nohighlight">
\[=\frac{1}{\sqrt{2\pi}} \frac{1}{{k+i\omega}} +\frac{1}{\sqrt{2\pi}} \frac{1}{{k-i\omega}}= \sqrt{\frac{2}{\pi}}\frac{k}{{k^2+\omega^2}}\]</div>
<p>If we were measuring some emission decay (fluorescence, phosphorescence) from a molecule or atom then the complex conjugate is measure by the ‘square law’ detector such as a photodiode, photomultiplier or CCD etc, then after fourier transforming the time profile to get the spectrum the result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle g^*(\omega)*g(\omega) =\frac{1}{2\pi(k^2+\omega^2)}\]</div>
<p>which is a Lorenzian function and describes an ideal  spectral line as shown in fig 19a.</p>
<p>If however, the time range over which the decay is measured is limited then a wider transition is observed and which has oscillating side bands. The result of integrating to a time <span class="math notranslate nohighlight">\(t\)</span> instead of infinity and taking the complex conjugate is</p>
<div class="math notranslate nohighlight">
\[\displaystyle g^*(\omega)*g(\omega) =\frac{1}{2\pi(k^2+\omega^2)}+\frac{e^{-2kt}-2e^{-kt}\cos(\omega t)}{2\pi(k^2+\omega^2)}\]</div>
<p>which can be seen to be the ideal plus an exponentially decaying and oscillating part. At long times the second term tends to zero as it should.  The behaviour here is typical of what happens with a fourier transform pair, when measurement is limited in one variable, broadening response and oscillations occur in its conjugate variable.</p>
</div>
<div class="section" id="iii-electromagnetic-waves-in-a-laser-cavity">
<h3><strong>(iii) Electromagnetic waves in a laser cavity</strong><a class="headerlink" href="#iii-electromagnetic-waves-in-a-laser-cavity" title="Permalink to this headline">¶</a></h3>
<p>In a laser cavity an electromagnetic wave of frequency <span class="math notranslate nohighlight">\(\omega_0\)</span> builds up in amplitude to <span class="math notranslate nohighlight">\(E_0\)</span>. Suddenly the cavity is ‘opened’ at <span class="math notranslate nohighlight">\(t=0\)</span> and the radiation leaks out as <span class="math notranslate nohighlight">\(E(t)= E_0e^{-\omega_0 t/Q}e^{i\omega_0 t}\)</span>. The dimensionless parameter <span class="math notranslate nohighlight">\(Q\)</span> is the ratio of stored energy to energy loss /cycle and <span class="math notranslate nohighlight">\(\omega_0/Q\)</span> is the rate of decay of the radiation in the cavity or <span class="math notranslate nohighlight">\(Q/\omega\)</span> the radiation’s cavity lifetime. Calculate the intensity <span class="math notranslate nohighlight">\(I=|a(\omega)|^2\)</span> vs frequency, which is the spectrum of the output radiation where <span class="math notranslate nohighlight">\(a\)</span> is the fourier transform of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>The transform is</p>
<div class="math notranslate nohighlight">
\[\displaystyle a(\omega)=\frac{E_0}{\sqrt{2\pi}}\int_{0}^\infty e^{-\omega_0 t/Q}e^{i\omega_0 t}e^{-i\omega t} dt \]</div>
<p>rearranging and integrating gives,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  a(\omega)= \frac{E_0}{\sqrt{2\pi}}\int e^{ ( -i(\omega-\omega_0)t-\omega_0 t/Q}dt=\frac{E_0}{\sqrt{2\pi}} \frac{e^{ ( -i(\omega-\omega_0)t-\omega_0 t/(Q)}}{( -i(\omega-\omega_0)-\omega_0 /Q} \Bigg|_0^\infty=\frac{E_0}{\sqrt{2\pi}}\frac{1}{( i(\omega-\omega_0)+\omega_0 /Q}\]</div>
<p>The absolute value is <span class="math notranslate nohighlight">\(|a(\omega)|^2=a^*(\omega)a(\omega)\)</span> which is</p>
<div class="math notranslate nohighlight">
\[\displaystyle |a(\omega)|^2=\frac{E_0}{\sqrt{2\pi}}\frac{1}{( -i(\omega-\omega_0)+\omega_0 /Q}\frac{1}{( i(\omega-\omega_0)+\omega_0 /Q}=\frac{E_0}{\sqrt{2\pi}}\frac{1}{(\omega-\omega_0)^2-(\omega_0 /Q)^2}\]</div>
<p>where in the last step <span class="math notranslate nohighlight">\((a-b)(a+b)=(a^2-b^2)\)</span> was used. The shape of the is curve is called Lorenztian. As the <span class="math notranslate nohighlight">\(Q\)</span> of the cavity gets larger the sharper is the spectral (resonance) line width, i.e. the cavity produces radiation of a narrower bandwidth. A high-Q cavity is needed for example in a laser used for high resolution spectroscopy or to produce a Q-switched nanosecond laser pulse.</p>
<p><img alt="Drawing" src="../_images/fourier-fig19a.png" /></p>
<p>Figure 19a. Resonance lines with different Q. The peaks are normalised to 1 at <span class="math notranslate nohighlight">\(\omega_0\)</span> but in reality the lower Q has a smaller area, i.e. produced from a cavity with less stored energy.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="how-the-fourier-transform-works">
<h2>6.4 How the Fourier transform works<a class="headerlink" href="#how-the-fourier-transform-works" title="Permalink to this headline">¶</a></h2>
<p>The transform appears to have the effect of seeking out any repetitive features in a signal <span class="math notranslate nohighlight">\(f(x)\)</span>. This is true whether it is the discrete transform acting on real data, or the mathematical transform of a sine wave or other function. To understand what the transform does, we must look at eqn 27,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty f(x)e^{-ikx}dx \]</div>
<p>and recall that this only gives the value at one point <span class="math notranslate nohighlight">\(k\)</span>. To obtain the transform, <span class="math notranslate nohighlight">\(k\)</span> has to vary from -<span class="math notranslate nohighlight">\({\infty} \to \infty\)</span> although in practice only a limited range is needed to observe the major features of the transform. In this exponential form, the oscillating nature of the argument is not so apparent, but writing it as</p>
<div class="math notranslate nohighlight">
\[\displaystyle  g(k) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty f(x)(\cos(kx)-i\sin(kx))dx \]</div>
<p>shows that the function <span class="math notranslate nohighlight">\(f\)</span> is multiplied by a sine and cosine and integrated. Because <span class="math notranslate nohighlight">\(k\)</span> can take any value, the sine and cosine of all possible frequencies multiply <span class="math notranslate nohighlight">\(f\)</span>. Most of the time, multiplication results in a highly oscillatory function, with as many positive parts as negative ones, and the integral evaluates to zero or something very close to it.</p>
<p>When the period of <span class="math notranslate nohighlight">\(f\)</span> is close to, or the same as, that of the sine or cosine, when multiplied together these no longer integrate to give zero. Hence, the particular frequency determined by <span class="math notranslate nohighlight">\(k\)</span> gives the transform its value. This effect is pictured in Fig. 20. The left-hand column shows a function <span class="math notranslate nohighlight">\(f\)</span> (top image) with a long period compared to a particular frequency of the sine wave in the transform at some value of <span class="math notranslate nohighlight">\(k\)</span>, middle image left. The bottom left curve shows the product of these two curves. The integral of this product, the area under the curve, almost evaluates to zero, with the positive and negative parts cancelling.</p>
<p>The middle graph of the right-hand column shows a different frequency of the sine wave, because <span class="math notranslate nohighlight">\(k\)</span> now has a different value in <span class="math notranslate nohighlight">\(\sin(kx)\)</span>, and the sine wave’s period now matches that of the function <span class="math notranslate nohighlight">\(f\)</span>; their product is now positive and its integral is not zero. The Fourier transform therefore selects this frequency from among all others. Naturally, if there are several frequencies present in the function, these are each picked out in a similar manner as <span class="math notranslate nohighlight">\(k\)</span> changes.</p>
<p><img alt="Drawing" src="../_images/fourier-fig20.png" /></p>
<p>Figure 20. Left column: The function <span class="math notranslate nohighlight">\(f(x)\)</span> has a period that is very different from that of the sine wave <span class="math notranslate nohighlight">\(\sin(4kx)\)</span> middle curve. Their product, lowest left-hand curve, oscillates about zero and integrates to zero or very close to it and so appears as an insignificant feature in the transform. <br>
Right column: The period of the sine wave, (middle curve) which is determined by <span class="math notranslate nohighlight">\(k\)</span>, is now changed compared to the left-hand figure and now matches the period of the function. The product <span class="math notranslate nohighlight">\(f(x)\sin(kx)\)</span> is now only positive, and integrates to a finite number and so appears as a peak in the transform.</p>
</div>
<hr class="docutils" />
<div class="section" id="phase-sensitive-detection-and-the-lock-in-amplifier">
<h2>6.5 Phase sensitive detection and the lock-in amplifier<a class="headerlink" href="#phase-sensitive-detection-and-the-lock-in-amplifier" title="Permalink to this headline">¶</a></h2>
<p>In measuring signals buried in noise, the technique of phase sensitive detection is a very effective way of extracting the data and removing noise. In this method, the input to an experiment is modulated at a fixed frequency and the signal produced by the experiment is measured at this same frequency by a device known as a <em>lock-in amplifier</em>. This device illustrates the principle underlying the Fourier transform, although it is not a transform method.</p>
<p>In using a lock-in amplifier to measure fluorescence the light used to excite the molecules, and so stimulate the fluorescence, is modulated by rotating a slotted disc (chopper) in the exciting light’s path. The photomultiplier or photodiode detects the modulated (on - off ) fluorescence signal together with any noise and this signal is passed to the lock-in amplifier. The lock-in also receives a reference signal directly from the chopper and it electronically multiplies this with the fluorescence signal (see fig 20). The schematic of an instrument is shown in Fig.21.</p>
<p>Multiples (higher harmonics) of the fundamental reference frequency are filtered away, the resulting signal is integrated over many periods of the fundamental frequency, and a DC output signal is produced. As shown in Fig. 20, when the product of reference and signal is integrated, frequencies dissimilar to the reference, <span class="math notranslate nohighlight">\(f(x)\)</span> in the figure, will average to something approaching zero.</p>
<p>If the reference signal is <span class="math notranslate nohighlight">\(r = r_0\sin(\omega t)\)</span> and the noise free signal <span class="math notranslate nohighlight">\(s = s_0\sin(\omega t + \varphi)\)</span> then the output of the lock-in is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  V_s= \frac{r_0s_0}{T}\int_0^T \sin(\omega t + \varphi)\sin(\omega t)dt\]</div>
<p>where <span class="math notranslate nohighlight">\(T = 2\pi n/\omega\)</span> and <span class="math notranslate nohighlight">\(n \gg\)</span> 1 is an integer and <span class="math notranslate nohighlight">\(\varphi\)</span> is the phase (time) delay between the reference and the signal and is due to detectors and the amplifiers and other components in the experiment, but can be changed by the user. Expanding the sines and integrating gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle  V_s= \frac{r_0s_0}{T}\int_0^T \cos(\varphi)-\cos(2\omega t+\varphi)dt\\
=\frac{r_0s_0}{4\omega T}\big(\sin(\varphi)+2T\omega \cos(\varphi)-\sin(2\omega T+\varphi) \big) \end{split}\]</div>
<p>The sine at twice the reference frequency is electronically filtered away leaving a signal that is constant because <span class="math notranslate nohighlight">\(T\)</span> is the integration time set by the experimentalist and normally ranges from a few milliseconds to a few seconds. The measured signal is</p>
<div class="math notranslate nohighlight">
\[\displaystyle V_s=\frac{r_0s_0}{4\omega T} \big(\sin(\varphi)+2T\omega \cos(\varphi) \big)   \tag{29}\]</div>
<p>and as the phase <span class="math notranslate nohighlight">\(\varphi\)</span> can be adjusted by the user, this signal can be maximized.</p>
<p>Now consider the situation when noise is present and assume that this has a wide range of frequencies <span class="math notranslate nohighlight">\(\omega_{1,2..}\)</span> and amplitudes <span class="math notranslate nohighlight">\(n_{1,2..}\)</span>. The signal from an instrument is normally noisy and is represented as</p>
<div class="math notranslate nohighlight">
\[\displaystyle s_0\sin(\omega t+\varphi)+n_1\sin(\omega _1t+\varphi_1)+n_2\sin(\omega _2t+\varphi_2)+\cdots\]</div>
<p>where <span class="math notranslate nohighlight">\(s_0, \omega\)</span>, and <span class="math notranslate nohighlight">\(\varphi\)</span> are respectively the amplitude, frequency, and phase (relative to the reference) of the data.</p>
<p>The first term of the signal arises from the information we wish to measure and produces <span class="math notranslate nohighlight">\(V_s\)</span> equation (29). We need only consider one noise term, for all the others behave similarly. Multiplying by the reference at frequency <span class="math notranslate nohighlight">\(\omega\)</span> but ignoring the phase <span class="math notranslate nohighlight">\(\varphi\)</span>, as this adds nothing fundamental but makes the equations more complicated, gives the term,</p>
<div class="math notranslate nohighlight">
\[\displaystyle 2\sin(\omega_1 t)\sin(\omega t)=\cos((\omega-\omega_1)t)-\cos((\omega+\omega_1)t) \]</div>
<p>Integrating produces</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align} V_n &amp;= \frac{r_0n_1}{2T} \int_0^T \cos((\omega-\omega_1)t)-\cos((\omega+\omega_1)t) dt\\ &amp;=\frac{r_0n_1}{4T} \left( \frac{ \sin\big((\omega_1-\omega)T\big)}{\omega_1-\omega}  -\frac{\sin\big((\omega_1+\omega)T\big)}{\omega_1+\omega}  \right) \end{align}\end{split}\]</div>
<p>The sum frequency term is filtered by the instrument and is removed from the output leaving the term <span class="math notranslate nohighlight">\(\displaystyle \frac{ \sin((\omega_1-\omega)T)}{\omega_1-\omega}\)</span> which is the sinc function, see Fig. 15. Suppose that the frequency <span class="math notranslate nohighlight">\(\omega_1\)</span> represents white noise that contains all frequencies more or less equally. As these frequencies differ from <span class="math notranslate nohighlight">\(\omega\)</span> and the absolute value <span class="math notranslate nohighlight">\(| \omega_1-\omega |\)</span> becomes larger the sinc function rapidly becomes very small. This means that the reference sine wave picks out just that frequency containing the signal and rejects almost all of the noise. The total signal is <span class="math notranslate nohighlight">\(V + V_n\)</span> and although it still contains noise at the reference frequency <span class="math notranslate nohighlight">\(\omega\)</span> it contains very little at other frequencies, and the signal to noise ratio is increased very considerably. Often signals can be extracted from what appears to be completely noisy data.</p>
<p>As a practical consideration, the reference frequency should always be chosen to be a prime number so that the chance of detecting one of the multiples of electrical mains frequency is reduced. Also, this frequency should be in a region where the inherent noise of the experiment is low and if possible be of a high enough frequency to allow a short time <span class="math notranslate nohighlight">\(T\)</span> to be used in the integration step, allowing many separate measurements to be made in a reasonable time.</p>
<p><img alt="Drawing" src="../_images/fourier-fig21.png" /></p>
<p>Figure 21. Schematic of phase sensitive detection and a lock-in amplifier.</p>
</div>
<hr class="docutils" />
<div class="section" id="parseval-or-plancherel-theorem">
<h2>6.6 Parseval or Plancherel  theorem.<a class="headerlink" href="#parseval-or-plancherel-theorem" title="Permalink to this headline">¶</a></h2>
<p>This theorem is important because it proves that there is no loss of information when transforming between Fourier transform pairs. This is rather important because otherwise how would it be possible to tell what information has been lost or added? Fortunately, it can be shown that</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^{\infty} g^*(k)g(k)dk = \int_{-\infty}^{\infty} f^*(x)f(x)dx  \tag{30}\]</div>
<p>where the asterisk denotes the complex conjugate. The Fourier transform of <span class="math notranslate nohighlight">\(f(x)\)</span> is <span class="math notranslate nohighlight">\(g(k)\)</span>, which is integrated over its variable <span class="math notranslate nohighlight">\(k\)</span>, and similarly <span class="math notranslate nohighlight">\(f(x)\)</span> is integrated over its variable <span class="math notranslate nohighlight">\(x\)</span>. As the total integral taken over all coordinate space <span class="math notranslate nohighlight">\(x\)</span> and that over its conjugate variable <span class="math notranslate nohighlight">\(k\)</span> is the same, all the information in the original function is retained in the transformation, i.e. it looks as if the transform is a different beast but this is only a disguise as it contains exactly the same information. This, of course, means that if something is done to the transform, then, in effect, the same is done to the function.</p>
<p>The Plancherel theorem (also called Rayleigh’s theorem as it was first used by him in the theory of Black-Body radiation) is effectively the same but usually written as</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \int_{-\infty}^{\infty} |g(k)|^2dk = \int_{-\infty}^{\infty} |f(x)|^2 dx \]</div>
<p>Graphically it means that the shaded areas are the same. The figure shows the transform of a square wave as in fig 15. The transform is <span class="math notranslate nohighlight">\(\displaystyle g(k)=\frac{\sin(ak)}{ak}\)</span> where <span class="math notranslate nohighlight">\(a = 4\)</span>. The function <span class="math notranslate nohighlight">\(f(x) = 1 \)</span> in the range <span class="math notranslate nohighlight">\(-2\to 2\)</span> so <span class="math notranslate nohighlight">\(\int f(x)^2 dx= 4\)</span>.</p>
<p><img alt="Drawing" src="../_images/fourier-fig21a.png" /></p>
<p>Figure 21a. Illustrating the Parseval or Plancherel theorem. The shaded areas are the same size, although they do not appear to be. The absolute square of the transform <span class="math notranslate nohighlight">\(|g(k)|^2\)</span> extends to <span class="math notranslate nohighlight">\(\pm \infty\)</span> which makes up the area since the function is always positive a small part of which is shown magnified.</p>
<p>This theorem is very important in quantum mechanics. Should <span class="math notranslate nohighlight">\(f(x)\)</span> represent a wavefunction that varies as a function of distance <span class="math notranslate nohighlight">\(x\)</span>, which could be the displacement from equilibrium of an harmonic oscillator, then variable <span class="math notranslate nohighlight">\(k\)</span> can be interpreted as the momentum (usually given the letter <span class="math notranslate nohighlight">\(p\)</span>) making <span class="math notranslate nohighlight">\(g(k)\)</span> the wavefunction in ‘momentum space’. This means that calculations can be formed either in spatial coordinates, i.e. distance or in ‘momentum space’ depending upon which is the most convenient mathematically. The change in displacement, <span class="math notranslate nohighlight">\(\delta x\)</span>, and change in momentum, <span class="math notranslate nohighlight">\(\delta p\)</span>, are conjugate pairs of variables and are linked by the Heisenberg uncertainty principle <span class="math notranslate nohighlight">\(\delta x\delta p \ge \hbar/2\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(x\)</span> is time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(k\)</span> frequency <span class="math notranslate nohighlight">\(\omega\)</span> then Parseval’s theorem has a simple physical interpretation. On the right of the equation <span class="math notranslate nohighlight">\(f(t)\)</span> is the electric field of some radiation, for example i.r. in a spectrometer or a laser pulse, then <span class="math notranslate nohighlight">\(|f(t)|^2\)</span> is proportional to the total radiated power and the integral the total radiated energy.  On the left, <span class="math notranslate nohighlight">\(\int|g(\omega)|^2d\omega\)</span> is the total amplitude squared of the spectrum, and <span class="math notranslate nohighlight">\(g(\omega)\)</span> the energy per unit frequency interval. Thus Parseval’s theorem represents the conservation of energy.</p>
<div class="section" id="the-delta-function-as-an-integral">
<h3><strong>The delta function as an integral</strong><a class="headerlink" href="#the-delta-function-as-an-integral" title="Permalink to this headline">¶</a></h3>
<p>The Parseval theorem can be proved using the delta function in its integral form. First we find the delta function. Suppose that a fourier transform is inserted into itself, starting with eqn. 28,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  f(x) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty g(k)e^{+ikx}dk \tag{28}\]</div>
<p>then from eqn. 27 substitute <span class="math notranslate nohighlight">\(g(k)\)</span> and change the dummy integration variable to <span class="math notranslate nohighlight">\(x'\)</span> to avoid confusion,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  f(x) = \frac{1}{2\pi} \int_{-\infty}^\infty   \int_{-\infty}^\infty f(x')e^{-ikx'}dx'e^{+ikx}dk \]</div>
<p>and by sleight of hand, interchange order of integration,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  f(x) = \int_{-\infty}^\infty f(x') \left[\frac{1}{2\pi} \int_{-\infty}^\infty e^{-ik(x-x')}dk\right]dx'\]</div>
<p>For this equation to be true the expression in square brackets must now be interpreted as a delta function making</p>
<div class="math notranslate nohighlight">
\[\displaystyle \delta(x-x')=\frac{1}{2\pi} \int_{-\infty}^\infty e^{-ik(x-x')}dk\tag{28a}\]</div>
<p>which means that one side is interpreted as having the same effect as the other, <span class="math notranslate nohighlight">\(\delta(x-x')=1\)</span> if <span class="math notranslate nohighlight">\(x=x'\)</span> otherwise it is zero and similarly for the integral. Recall that the delta function <span class="math notranslate nohighlight">\(\delta(x-x')\)</span> picks out just one term in any integral at <span class="math notranslate nohighlight">\(x=x'\)</span>.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty f(x)\delta(x-x')dx = f(x')\tag{28b}\]</div>
<div class="math notranslate nohighlight">
\[\displaystyle \int_a^b\delta(x-x')dx = 1 \text{ if } a\lt x\lt b \text{ otherwise } 0\]</div>
<p>The delta function also has these properties</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{lll}\\ \hline \delta(x)&amp;=\delta(-x)\\ x\delta(x)&amp;=0\\ \delta(ax)&amp;=\displaystyle\frac{1}{|a|}\delta(x)\\ \delta(x^2-a^2)&amp;=\displaystyle\frac{1}{|a|}(\delta(x-a)+\delta(x+a))\\ \hline\end{array}\end{split}\]</div>
<p>To prove the Parseval theorem we start with <span class="math notranslate nohighlight">\(\int|f(x)|^2dx=\int f(x)^*f(x)dx \)</span> where * indicated the complex conjugate, substitute for <span class="math notranslate nohighlight">\(f(x)\)</span> using eqn 28</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\int_{-\infty}^{\infty} |f(x)|^2 dx &amp;=\int_{-\infty}^{\infty}dx\frac{1}{2\pi}\int_{-\infty}^\infty g^*(k)e^{-ikx}dk\int_{-\infty}^\infty g(k')e^{+ik'x}dk' \\ &amp;=\int_{-\infty}^{\infty} g^*(k)dk\int_{-\infty}^{\infty} g(k')dk'\left[\frac{1}{2\pi}\int_{-\infty}^\infty e^{i(k'-k)x} \right]dx\\&amp;=\int_{-\infty}^{\infty} g^*(k)dk\int_{-\infty}^{\infty} g(k')\delta(k'-k)dk'=\int_{-\infty}^{\infty} g^*(k)g(k)dk=\int_{-\infty}^{\infty} |g(k)|^2dk \end{align}\end{split}\]</div>
</div>
<div class="section" id="the-delta-function-and-comb-of-delta-functions">
<h3><strong>The delta function and comb of delta functions.</strong><a class="headerlink" href="#the-delta-function-and-comb-of-delta-functions" title="Permalink to this headline">¶</a></h3>
<p>Using a comb of delta functions and convoluting this with a more complex function is a direct way of making a repeated pattern such as an image or positioning molecules in each unit cell in a crystal. This image can then be fourier transformed to imitate the diffraction pattern expected from a given crystal.</p>
<p>A delta function has the property that it extracts just a single term from an integral, i.e.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty f(x)\delta(x-x_0)dx = f(x_0)\]</div>
<p>and is because <span class="math notranslate nohighlight">\(\delta(0)=1\)</span> and is otherwise zero. This is also its shifting property, the function is moved from <span class="math notranslate nohighlight">\(f(x)\)</span> to <span class="math notranslate nohighlight">\(f(x_0)\)</span>, which is equivalent to multiplying its transform by a phase factor <span class="math notranslate nohighlight">\(e^{-ikx_0}\)</span>.</p>
<p>The delta function’s transform is</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(k)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty \delta(x)e^{-ikx}dx =\frac{1}{\sqrt{2\pi}} e^{0}=\frac{1}{\sqrt{2\pi}}\]</div>
<p>and so the inverse transform of <span class="math notranslate nohighlight">\(\delta(x)\)</span> is <span class="math notranslate nohighlight">\(1\)</span> and so we can write</p>
<div class="math notranslate nohighlight">
\[\displaystyle \delta(x)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty e^{ikx}dk\]</div>
<p>and this means that the delta function is the transform of a constant value. The transform of <span class="math notranslate nohighlight">\(\cos(k_0x)\)</span> can now be found when the cosine is put into its exponential form.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align} g(k)&amp;=\frac{1}{2\sqrt{2\pi}}\int_{-\infty}^\infty (e^{ik_0x}-e^{-ik_0x})e^{-ikx} dx\\
&amp;=\frac{1}{2\sqrt{2\pi}}\int_{-\infty}^\infty e^{-i(k-k_0)x}-e^{-i(k+k_0)x} dx\\
&amp;=\frac{1}{2} (\delta (k-k_0)+\delta(k+k_0)) \end{align}\end{split}\]</div>
<p>which means that the transform has two spikes at wavevector <span class="math notranslate nohighlight">\(\pm k_0\)</span>.  This expression can be used to describe interference by two thin slits producing Young’s fringes. It also shows a single frequency in a transform corresponds to a cosine wave in ‘real’ space, i.e. an extended wave train containing a single frequency gives a ‘spike’ or a single line in its spectrum (i.e. its transform). This extends to several waves of different frequencies giving different lines in a spectrum. Of course, the negative frequency has no physical meaning.</p>
<p>The transform of a shifted delta function <span class="math notranslate nohighlight">\(\delta(x-x_0)\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(k)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty \delta(x-x_0)e^{-ikx} dx =\frac{1}{\sqrt{2\pi}} e^{-ikx_0}\]</div>
<p>A function that is itself a sequence of delta functions is called ‘comb’ or ‘sha’ function,</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(x)=\sum_n \delta(x-x_n)\]</div>
<p>has a transform</p>
<div class="math notranslate nohighlight">
\[\displaystyle g_n(k) =\frac{1}{\sqrt{2\pi}}\sum_ne^{-ikx_n}\]</div>
<p>When there is a series of equally spaced delta functions <span class="math notranslate nohighlight">\(f(x)=\sum_{n=-\infty}^\infty \delta(x-na)\)</span> the transform is also never ending a series of delta functions. To sum the transform it is necessary to suppose that <span class="math notranslate nohighlight">\(n\)</span> is a large number <span class="math notranslate nohighlight">\(N\)</span> and do the summation as a geometric series</p>
<div class="math notranslate nohighlight">
\[\displaystyle \sqrt{2\pi}g(x)=\sum_{n=-N}^N e^{-ikaN}=\frac{e^{iak(N+1)}-e^{-iakN} }{1-e^{-iak}}\]</div>
<p>which multiplying top and bottom by <span class="math notranslate nohighlight">\(e^{iak/2}\)</span> and using the definition of a sine; <span class="math notranslate nohighlight">\(\sin(x)=(e^{ix}-e^{-ix})/2i\)</span> produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(k)=\frac{1}{\sqrt{2\pi}}\frac{\sin\left((N+\frac{1}{2})ak\right)}{\sin\left(\frac{ak}{2}\right)}\tag{28c}\]</div>
<p>The function appears as a series of spikes separated by <span class="math notranslate nohighlight">\(2\pi/a\)</span> when <span class="math notranslate nohighlight">\(N\)</span> is large. Figure 21b shows the transform when <span class="math notranslate nohighlight">\(N=100, a=2\)</span>, and it is clear that the delta function is being approached even with small <span class="math notranslate nohighlight">\(N\)</span>. In the limit <span class="math notranslate nohighlight">\(N\to \infty\)</span> the transform of a comb of separation <span class="math notranslate nohighlight">\(a\)</span> is a comb of delta functions with separation <span class="math notranslate nohighlight">\(2\pi /a\)</span>.</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(x)=\sum_{n=-\infty}^\infty \delta(x-na), \qquad g(k)=\frac{1}{\sqrt{2\pi}}\sum_{n=-\infty}^\infty \delta(x-2\pi n/a)\tag{28d}\]</div>
<p><img alt="Drawing" src="../_images/fourier-fig21b.png" /></p>
<p>Figure 21b. The transform of a comb of separation <span class="math notranslate nohighlight">\(a\)</span> is a comb of separation <span class="math notranslate nohighlight">\(2\pi/a\)</span>. In this figure <span class="math notranslate nohighlight">\(N=100, a=2\)</span>. In the limit <span class="math notranslate nohighlight">\(N\to\infty\)</span> a comb of <span class="math notranslate nohighlight">\(\delta\)</span> functions result.</p>
<hr class="docutils" />
<p>The reason that the transform becomes more like a series of delta functions as <span class="math notranslate nohighlight">\(N\)</span> increases is that as <span class="math notranslate nohighlight">\(N\)</span> increases the frequency of the sine wave in the numerator increases but that of the denominator remains the same. These waves are only in phase at each <span class="math notranslate nohighlight">\(2\pi/a\)</span> and as the high frequency numerator is oscillating very rapidly  positive and negatively compared to <span class="math notranslate nohighlight">\(ak/2\)</span> it makes the ratio effectively zero elsewhere.</p>
</div>
</div>
<div class="section" id="uncertainty-principle">
<h2>6.7 Uncertainty Principle<a class="headerlink" href="#uncertainty-principle" title="Permalink to this headline">¶</a></h2>
<p>It is known from experiment that when an emission line from an atomic or molecular transition has a very broad frequency spread, then the lifetime <span class="math notranslate nohighlight">\(\tau\)</span> of the state involved is short lived and vice versa. This is called the ‘time-energy’ uncertainty relationship <span class="math notranslate nohighlight">\(\Delta E\tau \ge \hbar/2\)</span> or equivalently <span class="math notranslate nohighlight">\(v\tau\ge 1/2\)</span> as <span class="math notranslate nohighlight">\(E=hv\)</span>. A similar effect is observed when a time varying signal is measured for example a voltage  on an oscilloscope. The product of the signal’s duration and its bandwidth (its spread in frequency) has a certain minimum value. This is a consequence of the variables, time and frequency being related via a fourier transform. Time and frequency are called <em>conjugate</em> variables.</p>
<p>To show this can be quite tricky since the variance of the transform has to be calculated and this may not be integrable. The proof is given by Bracewell ‘The Fourier Transform and its Applications’. Instead of giving this proof to illustrate the effect some examples of particular cases are described.</p>
<p>As a measure of the spread in a value its standard deviation can be used, see Chapter 4 Integration eqn. 26. The square of the standard deviation is the variance and is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \sigma^2 =\langle x^2\rangle - \langle x\rangle^2\]</div>
<p>where the brackets <span class="math notranslate nohighlight">\(\langle \rangle\)</span> indicate the average value. The average value of a function <span class="math notranslate nohighlight">\(p(x)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle x_p\rangle= \frac{\int xp(x)dx}{\int p(x)dx}\]</div>
<p>and the average of the square</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle x_p^2\rangle= \frac{\int x^2p(x)dx}{\int p(x)dx}\]</div>
<p>The denominator is the normalisation. If the function is symmetrical about zero the mean is also zero and <span class="math notranslate nohighlight">\(\langle x\rangle=0\)</span> and can be ignored. All that is necessary is to calculate <span class="math notranslate nohighlight">\(\langle f^2\rangle\langle g^2\rangle\)</span> for a function <span class="math notranslate nohighlight">\(f\)</span> and its transform <span class="math notranslate nohighlight">\(g\)</span> and take the square root to obtain the standard deviation of the product.</p>
<p>Often the transform and function may not be good distributions in which case their square is taken as the function to use thus we make the average squared ( also called the Energy Function) as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle x^2\rangle= \frac{\int x^2f^*f dx}{\int f^*f dx}\]</div>
<p>and a similar equation for the transform <span class="math notranslate nohighlight">\(g\)</span>. As the function and transform is usually complex the square is obtained using the complex conjugate i.e. <span class="math notranslate nohighlight">\(p^2 \to p^*p\)</span>.</p>
<p>This method will be demonstrated below but sometimes the transform integrals become infinity, in this case we choose to take the deviation as the measure from the peak of the transform (<span class="math notranslate nohighlight">\(g\)</span>) to the first zero.</p>
<div class="section" id="i-a-gaussian-shaped-pulse">
<h3><strong>(i) A Gaussian shaped pulse</strong><a class="headerlink" href="#i-a-gaussian-shaped-pulse" title="Permalink to this headline">¶</a></h3>
<p>A wavepacket comprising several waves of varying frequency can have an overall profile that is Gaussian in shape. This can apply, for example, to a laser pulse or a summation of harmonic oscillator wavefunctions. The normalised Gaussian function is</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(t)= \frac{e^{-t^2/2\sigma^2}}{\sigma \sqrt{2\pi} } \]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the standard deviation, or width of the Gaussian, see figure 4, Chapter 13 ‘Data Analysis’. The transform of a Gaussian is also a Gaussian but with a different width.</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(v)= \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty f(t)e^{-ivt} dt = \frac{1}{\sqrt{2\pi}}e^{-i\sigma^2v^2/2}\]</div>
<p>As the standard deviation of <span class="math notranslate nohighlight">\(f\)</span> is by definition <span class="math notranslate nohighlight">\(\sigma\)</span> and by comparison the standard deviation of <span class="math notranslate nohighlight">\(g\)</span> must be <span class="math notranslate nohighlight">\(1/\sigma\)</span> hence <span class="math notranslate nohighlight">\(\sigma_t\sigma_v=\sigma/\sigma=1\)</span>.</p>
<p>Calculating using the method outlined above to find <span class="math notranslate nohighlight">\(\langle t^2\rangle\)</span> and <span class="math notranslate nohighlight">\(\langle v^2\rangle\)</span> we expect a different result because we now use the square of the function and transform.</p>
<p>Taking all integrations between <span class="math notranslate nohighlight">\(\pm\infty\)</span>, the function <span class="math notranslate nohighlight">\(\displaystyle  \int f(t)^2dt= \frac{1}{2a\sqrt{\pi}}\)</span> and <span class="math notranslate nohighlight">\(\displaystyle \int t^2f(t)^2dt = \frac{a}{4\sqrt{\pi}}\)</span> and their ratio is <span class="math notranslate nohighlight">\(\displaystyle \Delta t= \frac{a^2}{2}\)</span>.</p>
<p>The transform has similar integrals<span class="math notranslate nohighlight">\(\displaystyle  \int g(v)^2dv= \frac{1}{2a\sqrt{\pi}}\)</span> and <span class="math notranslate nohighlight">\(\displaystyle \int v^2g(v)^2dv = \frac{1}{4a^3\sqrt{\pi}}\)</span> and their ratio is <span class="math notranslate nohighlight">\(\displaystyle \Delta v= \frac{1}{2a^2}\)</span>.</p>
<p>The product of uncertainties after remembering that we calculate the square of the values is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \Delta t\Delta v = \frac{1}{2}\]</div>
<p>which is the minimum possible value.</p>
</div>
<div class="section" id="ii-excited-state-decay">
<h3><strong>(ii) Excited state decay</strong><a class="headerlink" href="#ii-excited-state-decay" title="Permalink to this headline">¶</a></h3>
<p>An excited electronic state can decay by emitting a photon, fluorescence if the transition is allowed, or phosphorescence if from a triplet excited state to a singlet ground state.  The time profile can be measured as can the spectral width of the transition and they demonstrate the time - energy/frequency relationship. The excited state has a lifetime <span class="math notranslate nohighlight">\(\tau\)</span> and transition frequency <span class="math notranslate nohighlight">\(\omega_0\)</span>. A spatial analogue is momentum broadening as a result of collisions, where the lifetime is replace by the mean free path.</p>
<p>The field of the emitted photon is <span class="math notranslate nohighlight">\(\displaystyle f(t)=e^{i\omega_0 t}e^{-t/2\tau}\)</span> which is that of a plane wave of frequency <span class="math notranslate nohighlight">\(\omega_0\)</span> that decays away (or is damped) with a lifetime <span class="math notranslate nohighlight">\(\tau\)</span>. The detector measures the ‘square’ or absolute value squared of this which is <span class="math notranslate nohighlight">\(|f(t)|^2\equiv f(t)^*f(t) = e^{-t/\tau}\)</span>.</p>
<p>The transform is</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(\omega)= \frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty f(t)e^{-i\omega t} dt = \sqrt{\frac{2}{\pi}}\left(\frac{1}{2i (\omega-\omega_0)+1/\tau}\right)\]</div>
<p>making the measured spectral profile, which has the shape of a Lorentzian curve,</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(\omega)^*g(\omega)=\frac{2}{\pi}\left( \frac{1}{4(\omega-\omega_0)^2+1/\tau^2} \right) \]</div>
<p>The full width at half maximum of this curve is <span class="math notranslate nohighlight">\(1/\tau\)</span> which makes <span class="math notranslate nohighlight">\(\Delta t\Delta \omega = \tau/\tau=1\)</span>.  Figure 54 in the answer to question 7 shows the exponential decay and the Lorentzian curves. As the energy is related to the frequency as <span class="math notranslate nohighlight">\(\Delta E =\hbar \Delta \omega\)</span> then <span class="math notranslate nohighlight">\(\tau\Delta E = \hbar\)</span></p>
<p>The calculation using <span class="math notranslate nohighlight">\(\displaystyle \int g(\omega)^2 d\omega\)</span> as in the previous example will not work here because this integral is infinite.</p>
</div>
<div class="section" id="iii-finite-wave-train">
<h3><strong>(iii) Finite wave-train</strong><a class="headerlink" href="#iii-finite-wave-train" title="Permalink to this headline">¶</a></h3>
<p>If a plane wave of frequency <span class="math notranslate nohighlight">\(\omega_0\)</span>  exists for a short time <span class="math notranslate nohighlight">\(\pm a\)</span> and is zero elsewhere then over this range <span class="math notranslate nohighlight">\(\displaystyle f(t)=e^{i\omega t};\quad -a\le t \le a\)</span>, see figure 19 where <span class="math notranslate nohighlight">\(a=10\)</span>.  The spread of the wave <span class="math notranslate nohighlight">\(\Delta x = a\)</span>.  The ‘square’ of <span class="math notranslate nohighlight">\(f\)</span> is <span class="math notranslate nohighlight">\(f(x)^*f(x)=1\)</span></p>
<p>The transform has the form of a sinc function</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(\omega)=\int_{-\infty}^\infty f(t)e^{-i\omega t}dt= \sqrt{\frac{2}{\pi}}\frac{\sin\left( a (\omega-\omega_0)\right)}{\omega-\omega_0}\]</div>
<p>The function <span class="math notranslate nohighlight">\(g^2\)</span> cannot be normalised easily as it produces another integral (the Sine integral) but it is clear that the zeros of the function are at the same place in <span class="math notranslate nohighlight">\(g\)</span> and its square and so we can take the spread <span class="math notranslate nohighlight">\(\Delta \omega\)</span> to be the value from <span class="math notranslate nohighlight">\(\omega_0\)</span> to the first minimum. The zeros of the sinc function occur at <span class="math notranslate nohighlight">\(\mathrm{sinc}(n\pi)\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is an integer greater than zero, thus the first zero occurs at <span class="math notranslate nohighlight">\(\pm \pi/a\)</span> from the central frequency, see figure 15.</p>
<p>If this zero is associated with <span class="math notranslate nohighlight">\(\Delta \omega\)</span> then <span class="math notranslate nohighlight">\(\Delta \omega =\pi/a\)</span> and the product <span class="math notranslate nohighlight">\(\Delta x\Delta \omega= \pi\)</span>.</p>
</div>
<div class="section" id="iv-heisenberg-uncertainty">
<h3><strong>(iv) Heisenberg Uncertainty</strong><a class="headerlink" href="#iv-heisenberg-uncertainty" title="Permalink to this headline">¶</a></h3>
<p>The relationship  <span class="math notranslate nohighlight">\(\Delta \omega\Delta x \ge 1\)</span> as described in the last example above is not an inherent property of quantum mechanics but is a property of Fourier Transforms. The last example shows that  it is not possible to form a train of electromagnetic  waves for which it is possible to measure, at the same time, the position and wavelength with complete accuracy.</p>
<p>However, when considering quantum mechanics a particle is given wavelike properties via the de-Broglie relation. Such a material particle (such as an electron or a molecule) of energy <span class="math notranslate nohighlight">\(E\)</span> and momentum <span class="math notranslate nohighlight">\(\vec p\)</span> is now associated with a wave of angular frequency <span class="math notranslate nohighlight">\(\omega=2\pi\nu\)</span> and wavevector <span class="math notranslate nohighlight">\(\vec k\)</span> i.e. <span class="math notranslate nohighlight">\(E=\hbar\omega; \vec p=\hbar \vec k\)</span> and leads to <span class="math notranslate nohighlight">\(\Delta x\Delta p \ge \hbar/2\)</span>. The fact that the Schroedinger equation is linear and homogeneous means that for particles a superposition principle applies which gives them wavelike properties. The small value of Planck’s constant makes the limitations of the uncertainty principle totally negligible for anything macroscopic, i.e. greater than approx micron size.</p>
</div>
</div>
<div class="section" id="summary-of-some-fourier-transform-properties">
<h2>6.8 Summary of some  Fourier Transform properties<a class="headerlink" href="#summary-of-some-fourier-transform-properties" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle 
\begin{array}{ll}
\hline
&amp;\text{The transform pair is} &amp;   f (x)&amp; \rightleftharpoons      &amp; g(k)\\[0.15cm] 
\text{(i)}&amp;\text{Shift or delay }   &amp;   f (x - x_0)    &amp; \rightleftharpoons &amp; e^{- ikx_0}g(k)\\[0.15cm]     
\text{(ii)}&amp;\text{frequency shift}  &amp;   f (x)e^{ik_0x} &amp; \rightleftharpoons &amp; g(k - k_0) \\[0.15cm]
\text{(ii)}&amp;\text{Scaling/Similarity} \quad a \gt 0  &amp; \displaystyle   f(ax) &amp; \rightleftharpoons &amp; \displaystyle \frac{1}{ |a|}g\left(\frac{k}{a}\right)\\[0.15cm]
\text{(iv)}&amp;\text{Reversal }            &amp;   f (-x)    &amp; \rightleftharpoons &amp; g(-k) \\[0.15cm]
\text{(v)}&amp;\text{Complex Conjugate }    &amp;   f (x)^*   &amp; \rightleftharpoons &amp; g(-k)^* \\[0.15cm]
\text{(vi)}&amp;\text{Derivative}      &amp; \displaystyle   F\left(\frac{d}{dx}f(x)\right) &amp; \rightleftharpoons &amp;ik\,g(k)\\[0.15cm]
\text{(vii)}&amp; n^{th}\text{ Derivative}     &amp; \displaystyle   F\left(\frac{d^n}{dx^n}f(x)\right) &amp; \rightleftharpoons &amp;(ik)^n\,g(k)\\[0.15cm]
\text{(viii)}&amp;\text{Derivative} &amp; \displaystyle F\left(\frac{d}{dt}f(x,t)\right)&amp; \rightleftharpoons &amp; \int \displaystyle \frac{d}{dt}g(k,t)e^{-ikx} dx \\[0.15cm]
\text{(ix)}&amp;\text{Product}      &amp; F(xf(x)) &amp; \rightleftharpoons &amp;\displaystyle i\,\frac{d}{dk}g(k)\\[0.15cm]
\text{(x)}&amp;\text{(linearity} &amp; F\left(af_a(x) + bf_b(x)\right)&amp; \rightleftharpoons &amp; ag_a(k) + bg_b(k)\\ 
\hline
\end{array}
\end{split}\]</div>
<p>The capital <span class="math notranslate nohighlight">\(F(\cdots)\)</span> means ‘do the transform’. The derivation of these results is given below.</p>
<p><strong>(i), (ii) Shift, delay.</strong></p>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>Let <span class="math notranslate nohighlight">\(s=x-x_0\)</span> then <span class="math notranslate nohighlight">\(ds=dx\)</span> and provided <span class="math notranslate nohighlight">\(f\)</span> exists at <span class="math notranslate nohighlight">\(x_0\)</span>,
$<span class="math notranslate nohighlight">\(\displaystyle F(f(x- x_0)) = \int_{-\infty}^{\infty} f(x- x_0)e^{-ik x}dx = \int_{-\infty}^{\infty} f(s)e^{-ik(s+ x_0)}ds = e^{-ik x_0} g(k)\)</span>$</p>
<p><strong>(iii) Scaling/Similarity.</strong></p>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>Make the substitution <span class="math notranslate nohighlight">\(s=ax,\; a&gt;0\)</span></p>
<div class="math notranslate nohighlight">
\[\displaystyle F(f(ax))=\int_{-\infty}^{\infty}f(ax)e^{-ikx}dx=\frac{1}{|a|}\int_{-\infty}^{\infty}f(s)e^{-iks/a}ds=\frac{1}{|a|}g\left(\frac{k}{a}\right)\]</div>
<p><strong>(iv) Reversal.</strong></p>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>Start with scaling (as above (iii) ) and let <span class="math notranslate nohighlight">\(a=-1\)</span> giving
$<span class="math notranslate nohighlight">\(\displaystyle F(f(-x)) = g(-k)\)</span>$</p>
<p><strong>(v) Complex conjugate.</strong></p>
<div class="math notranslate nohighlight">
\[\displaystyle g(-k)= \int_{-\infty}^\infty f(x)e^{ikx}dx\]</div>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>taking the complex conjugate of both sides gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(-k)^*= \int_{-\infty}^\infty f(x)^*e^{-ikx}dx=f(x)^*\]</div>
<p><strong>(vi)(vii) Fourier derivatives.</strong></p>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>These are important when solving differential equations. First derivative</p>
<div class="math notranslate nohighlight">
\[\displaystyle \begin{align} 
F\left(\frac{df}{dx}\right)  = \int_{-\infty}^\infty \frac{df}{dx}e^{-ikx}\, dx
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>Integrate by parts and let <span class="math notranslate nohighlight">\('u'=e^{-ikx}\)</span> and <span class="math notranslate nohighlight">\('v'=df/dx\)</span> using <span class="math notranslate nohighlight">\(\int udv=uv-\int vdu\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align} F\left(\frac{df}{dx}\right)&amp;= \left |\frac{df}{dx}e^{-ik x}\right |^\infty_{-\infty} + ik \int_{-\infty}^\infty f(x)e^{-ik x} \,dx\\  &amp; =0+ ik F\left( f(x)\right) \\ &amp; =  ik g(k) \end{align}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>By induction the <span class="math notranslate nohighlight">\(n^{th}\)</span> derivative’s transform is</p>
<div class="math notranslate nohighlight">
\[\displaystyle F\left(\frac{d^nf}{dx^n}\right)=(ik)^n g(k)\]</div>
<p><strong>(viii) Product.</strong></p>
<p><span class="math notranslate nohighlight">\(\qquad\)</span>The product <span class="math notranslate nohighlight">\(xf(x)\)</span> can be useful in solving differential equations.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}F\left(xf(x)\right)&amp;=\int_{-\infty}^{\infty} xf(x)e^{-ikx}dx =\int_{-\infty}^{\infty} f(x)\frac{d}{dk}\left(ie^{-ikx}\right) dx\\&amp;=i\frac{d}{dk}\int_{-\infty}^{\infty} f(x)e^{-ikx} dx=i\frac{d}{dk}g(k)\end{align}\end{split}\]</div>
</div>
<div class="section" id="table-of-useful-transforms">
<h2>6.9 Table of useful transforms<a class="headerlink" href="#table-of-useful-transforms" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{ll}
\hline
\text{(i) Gaussian} &amp;f(x)=e^{-ax^2}     &amp; F(f(x)) &amp; \rightleftharpoons &amp;\displaystyle \frac{1}{\sqrt{2a}}e^{-k^2/(4a)}\\[0.15cm]
\text{(ii) cosine }&amp;f(x)=\cos(2\pi k_0 x)    &amp; F(f(x)) &amp; \rightleftharpoons &amp;\frac{1}{2}(\delta(k-k_0)+\delta(k+k_0))  \\[0.15cm]
\text{(iii) sine }&amp;f(x)=\sin(2\pi k_0 x)    &amp; F(f(x)) &amp; \rightleftharpoons &amp;\frac{1}{2}i(\delta(k+k_0)-\delta(k-k_0))  \\[0.15cm]
\text{(iv) exponential }&amp;f(x)=e^{-2\pi k_0 |x|}    &amp; F(f(x)) &amp; \rightleftharpoons &amp;\displaystyle \frac{1}{\pi}\frac{k_0}{k^2+k_0^2}  \\[0.15cm]
\text{(v) sinc }&amp;f(x)=\sin(x)/x    &amp; F(f(x)) &amp; \rightleftharpoons  &amp; \text{top hat/rectangle }1 \text{ if } 1/2\le x\le 1/2\; \text{ else } 0 (\text{see fig. }15) \\[0.15cm]
\text{(vi) complex exponential }&amp;f(x)=e^{ik_0x}    &amp; F(f(x)) &amp; \rightleftharpoons &amp; \delta(k-k_0) \\[0.15cm]
\hline\end{array}\end{split}\]</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-9"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Fourier-questions-1-6.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 1 - 6</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Fourier-questions-7-15.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 7 - 15</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Godfrey Beddard<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>