
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>9 Discrete Fourier (DFT) and Fast Fourier transforms (FFT) &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11 The Hadamard Transform: Encoding and Decoding" href="Fourier-F.html" />
    <link rel="prev" title="Questions 16 - 21" href="Fourier-questions-16-21.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1 Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     1 Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     5 Trig, hyperbolic and inverse functions, waves, polar coordinates,  factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     1 Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     1 - 3.8 Differentiation, gradients &amp; basic functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     3.9 Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     4 Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     6 Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     9 Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     10 Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     11 Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     12 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4 Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     1 Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     6 Integration and parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     8 Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     9 The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     10 Multiple integrals, Change of variables: Jacobians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     12 Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     1 Series, averages, waves, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     6 Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     8 Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     9 Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     1 Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     6 Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     8 Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     12 Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     15 Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     18 Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     21 Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     1 Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     4 Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     6 Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     7 Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     9 Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     11 Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     12 Solving equations using matrices. Eigenvectors and Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     13 Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     14 Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     15 Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     16 Principal axes and Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     1 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     4 Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     5 Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-A-B.html">
     1 Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-C.html">
     5 Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-D.html">
     7 Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-F.html">
     11 The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-2D-Diffraction.html">
     12 The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Fourier-tomography.html">
     14 Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     1 Basics, Initial and Boundary Value problems, Steady state, Phase portrait, Chemical kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     9 First order equations &amp; Integrating factors. Second order equations, Newton’s laws and equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     12 The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     13 Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     14 Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     15 Partial Differential Equations, PDE. 1D &amp; 2D diffusion, Particle in a box, Lateral flow tests, Diffusion and Reaction, Cable equation, Algal Blooms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     16 PDE continued. Diffusion, Wave and Schroedinger eqns. Solution by the Fourier method. Transient grating.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     1 Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     4 Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     5 Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     6 The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     8 Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     9 Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     1 Monte - Carlo integration &amp; importance sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     2 Solving rate equations. The Gillespie method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     3 Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     4 Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     6 The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     1 Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     6 Modelling data. Least squares, chi squared, residuals, ANNOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     7 Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     10 Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-14/chapter14-intro.html">
   14 SI Units, Scientific Constants, unit conversion, Glossary, Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/chapter14-E.html">
     1 SI Units, Unit conversions, Scientific Constants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/Python%20crib.html">
     5 Appendix:  Some basic Python instructions with a few examples.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../references/references-intro.html">
   15 References and index
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/References.html">
     1 References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/index.html">
     2 Index
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-9/Fourier-E.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-9/Fourier-E.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-9/Fourier-E.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-9/Fourier-E.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concept">
   Concept
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dft-equations">
   9.1 DFT equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-four-point-dft">
   9.2 A four point DFT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-dft-via-a-circulant-matrix">
   9.3 The DFT via a Circulant Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fast-fourier-transform-fft-calculation">
   9.4 Fast Fourier transform ( FFT ) calculation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nyquist-critical-frequency-and-shannon-sampling-theorem">
   9.5 Nyquist Critical Frequency and Shannon Sampling Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerically-calculating-a-dft-using-the-fft-algorithm">
   9.6 Numerically calculating a ( DFT )  using the FFT algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aliasing">
   9.7 Aliasing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zero-filling">
   9.8 Zero filling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-fourier-transforms-for-filtering-smoothing-and-noise-reduction-on-data">
   10 Using Fourier transforms for filtering, smoothing, and noise reduction on data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   10.1 Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtering-and-apodising">
   10.2 Filtering and apodising
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtering-a-transform-to-remove-noise">
   10.3 Filtering a transform to remove noise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rolling-or-moving-average">
   10.4 Rolling or moving average
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-hilbert-transform-and-the-analytic-signal">
   10.5 The Hilbert Transform and the Analytic Signal
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concept">
   Concept
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dft-equations">
   9.1 DFT equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-four-point-dft">
   9.2 A four point DFT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-dft-via-a-circulant-matrix">
   9.3 The DFT via a Circulant Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fast-fourier-transform-fft-calculation">
   9.4 Fast Fourier transform ( FFT ) calculation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nyquist-critical-frequency-and-shannon-sampling-theorem">
   9.5 Nyquist Critical Frequency and Shannon Sampling Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerically-calculating-a-dft-using-the-fft-algorithm">
   9.6 Numerically calculating a ( DFT )  using the FFT algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aliasing">
   9.7 Aliasing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zero-filling">
   9.8 Zero filling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-fourier-transforms-for-filtering-smoothing-and-noise-reduction-on-data">
   10 Using Fourier transforms for filtering, smoothing, and noise reduction on data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   10.1 Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtering-and-apodising">
   10.2 Filtering and apodising
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtering-a-transform-to-remove-noise">
   10.3 Filtering a transform to remove noise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rolling-or-moving-average">
   10.4 Rolling or moving average
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-hilbert-transform-and-the-analytic-signal">
   10.5 The Hilbert Transform and the Analytic Signal
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="discrete-fourier-dft-and-fast-fourier-transforms-fft">
<h1>9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)<a class="headerlink" href="#discrete-fourier-dft-and-fast-fourier-transforms-fft" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">init_printing</span><span class="p">()</span>                      <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<section id="concept">
<h2>Concept<a class="headerlink" href="#concept" title="Permalink to this headline">#</a></h2>
<p>Data is normally produced by an instrument as a series of numbers measured at equal intervals, and not as an equation; therefore, any Fourier transform has to be calculated numerically. The sampling intervals could be time, distance, or some other quantity depending on the experiment. Time will be used in the following examples. The numerical transform is usually called a discrete Fourier Transform (DFT) and the algorithm used is called the fast Fourier Transform FFT. A frequently used algorithm was devised by Cooley and Tukey (1965) ( Bracewell 1986, p. 370 ). It is not necessary to devise one of these transforms, because the method is very well established and fast operating code has been written and checked. Explanations of its working can be found in texts such as Numerical Recipes (Prest et al. 1986). Python/Sympy, Maple and Mathematica each have built in discrete Fourier transform routines as do numerical packages such as python/numpy, MathCad, Matlab, IDL, IGOR and Origin. These routines can be used as black boxes, nevertheless a clear understanding of the discrete transform is essential to avoid making mistakes. Some examples of Fourier transforms are shown schematically in Fig. 36.</p>
</section>
<section id="dft-equations">
<h2>9.1 DFT equations<a class="headerlink" href="#dft-equations" title="Permalink to this headline">#</a></h2>
<p>The cosine transform produces two delta functions at frequencies <span class="math notranslate nohighlight">\(\pm 1/p\)</span> in the top figure, and <span class="math notranslate nohighlight">\(\pm 2/p\)</span> in the second figure. Because the cosine period is halved, the frequency is doubled. The ‘typical data’, row (C), is supposed to represent some experimental data and if ideally transformed, with an infinite number of sampled points, will give the schematic spectrum on the right, which is shown only as its real part. If the transform is complex then the ‘imaginary’ or absolute parts may also contain useful information. The data has a large number of low frequencies in it but few high frequencies, which is why the transform tails off as the frequency increases. The maximum frequency present in the data is found to be <span class="math notranslate nohighlight">\(\nu_m\)</span>. In row (D), the function is sampled at times starting at zero and separated by <span class="math notranslate nohighlight">\(\Delta\)</span>, and a discrete transform is calculated. The highest frequency present in the transformed data can only be <span class="math notranslate nohighlight">\(1/\Delta\)</span>; the lowest frequency is <span class="math notranslate nohighlight">\(1/T\)</span> where <span class="math notranslate nohighlight">\(T\)</span> is the length of the data. To correctly sample the data <span class="math notranslate nohighlight">\(1/(2\Delta) \equiv \nu_c \gt \nu_m\)</span>; this is known as the Nyquist condition and is explained further below.</p>
<p>The discrete transform is usually plotted in an unfolded form as shown in row (D), Fig. 36. Row (E) shows it in the same form as the ideal or mathematical transforms. Notice also that the frequency axis is <span class="math notranslate nohighlight">\(\nu/N\)</span>, where <span class="math notranslate nohighlight">\(\nu\)</span>, the frequency integer, is the index number of each point sampled and <span class="math notranslate nohighlight">\(N\)</span> is the number of sampled points. The ratio <span class="math notranslate nohighlight">\(\nu/N\)</span> is not the same as a conventional frequency, because both <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(N\)</span> are integers.</p>
<p>There are a number of important differences between discrete transforms that relate to real experimental data and the ideal transforms of mathematical functions. These all relate to how the often the data has been sampled, which means how many data points are measured compared to how rapidly the data changes with time. Typically, <span class="math notranslate nohighlight">\(2^{13} = 8192\)</span> to <span class="math notranslate nohighlight">\(2^{16} = 65536\)</span> data points will be needed with actual data but for ease of calculation, smaller numbers are used in the examples below.</p>
<p>The discrete transform <span class="math notranslate nohighlight">\(g(\nu)\)</span> of a signal <span class="math notranslate nohighlight">\(f(t)\)</span> <em>sampled at discrete points</em> <span class="math notranslate nohighlight">\(t\)</span>, is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(\nu)=\frac{1}{\sqrt{N}}\sum\limits_{t=0}^{N-1} f(t)e^{-2\pi i\, t\, \nu/N)  }  \qquad\tag{44}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the integer number of data points and <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(t\)</span> are also integers which means that <span class="math notranslate nohighlight">\(f(t)\)</span> is a vector of data points at <span class="math notranslate nohighlight">\(t=0,1,2\cdots\)</span>.  As <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(f\)</span> are vectors it is common write these with subscripts, for example <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(n\)</span> meaning that the equation becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle g_\nu=\frac{1}{\sqrt{N}}\sum\limits_{n=0}^{N-1} f_ne^{-2\pi i\, n\, \nu/N)  }\qquad\tag{44'}  \]</div>
<p>and this form is often how the transform is expressed. Notice that the exponential contains the product of two parameters <span class="math notranslate nohighlight">\(n\nu\)</span> divided by the length of the data <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>The ratio <span class="math notranslate nohighlight">\(\nu/N\)</span>, which can only take on certain values because both <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(N\)</span> are integers, is unlike a true frequency which can take any value. The values of <span class="math notranslate nohighlight">\(\nu\)</span> range from <span class="math notranslate nohighlight">\(0 \to N - 1\)</span>, and so the ratio <span class="math notranslate nohighlight">\(\nu/N\)</span> takes only <span class="math notranslate nohighlight">\(N\)</span> values which are</p>
<div class="math notranslate nohighlight">
\[\displaystyle \nu/N \to 0,\; 1/N, \cdots (N - 1)/N\]</div>
<p>Transforms with <span class="math notranslate nohighlight">\(\nu/N\)</span> above <span class="math notranslate nohighlight">\(1/2\)</span> do not contain any new data, but a copy of the earlier part of the spectrum. Therefore the transform must be treated with some care to avoid interpreting data in this second half of the spectrum as something different to that in the first. This means not interpreting a feature at an apparently high frequency as something different from its twin at low frequency. The first point, when <span class="math notranslate nohighlight">\(\nu\)</span> is zero, where each of the exponential terms is unity, is the sum of the experimental data points.</p>
<p>The symmetry of the transformed data is seen in Fig. 36. In terms of frequency, a point <span class="math notranslate nohighlight">\(\nu\)</span> has a frequency <span class="math notranslate nohighlight">\(f = \nu/(N\Delta)\)</span>, the maximum frequency is <span class="math notranslate nohighlight">\(f = (N - 1)/(N\Delta)\)</span> because the last point in the transform is numbered <span class="math notranslate nohighlight">\(N - 1\)</span> and as <span class="math notranslate nohighlight">\(\Delta\)</span> is the separation of any two data points, so <span class="math notranslate nohighlight">\(1/\Delta\)</span> is a frequency. See Bracewell (1986) and Prest et al. (1986) for a more detailed discussion.</p>
<p><img alt="Drawing" src="../_images/Fourier-fig36-top.png" />
<img alt="Drawing" src="../_images/Fourier-fig36-btm.png" /></p>
<p>Figure 36. Some Fourier transforms, (A) to (C), and a discrete transform (D). (Based in part on a web diagram of M. Levoy, Stanford University.)</p>
<hr class="docutils" />
<p>The discrete transform algorithms require <span class="math notranslate nohighlight">\(2N\)</span> sampled data points, where <span class="math notranslate nohighlight">\(N\)</span> is an integer. If the data does not contain exactly <span class="math notranslate nohighlight">\(2N\)</span> points, then zeros can be added to the end of the data to make up the number of points required. An example of a discrete transform is shown in Fig. 38; notice in particular where the data appears in the transform. The data being transformed is a set of points representing a square pulse and the transform in the figure is symmetrical about its centre except for the point at <span class="math notranslate nohighlight">\(\nu = 0\)</span>. Any data in the right-hand half of the transform can be ignored; it is a copy of that on the left. The complex exponential part of the transform, equation (44), represents the many roots of unity (Chapter 2) so can be represented as points on a circle on an Argand diagram Fig. 37.</p>
<p><img alt="Drawing" src="../_images/Fourier-fig37.png" /></p>
<p>Figure 37. Roots of a complex exponential represented as points on a circle.</p>
<hr class="docutils" />
<p>The zeroth and <span class="math notranslate nohighlight">\((N - 1)^{th}\)</span> points are adjacent on this circle as are the zeroth and first point; the <span class="math notranslate nohighlight">\(0^{th}\)</span> and <span class="math notranslate nohighlight">\(N^{th}\)</span> points are at the same position. This folding of the transform into a loop explains the symmetry. Points on the right-hand side have <span class="math notranslate nohighlight">\(1/2 \lt \nu/N \le (N - 1)/N\)</span>, which correspond to negative frequencies. The highest value <span class="math notranslate nohighlight">\(\nu/N\)</span> can have to represent the data is <span class="math notranslate nohighlight">\(1/2\)</span> for any number of data points. Suppose that the transform has <span class="math notranslate nohighlight">\(1024\)</span> points; a point at position <span class="math notranslate nohighlight">\(t\)</span> = 800 corresponds to</p>
<div class="math notranslate nohighlight">
\[\displaystyle \nu/N = 800/1024 \approx 0.7813\]</div>
<p>This ratio, however, should really be thought of as a negative frequency of</p>
<div class="math notranslate nohighlight">
\[\displaystyle f = (800 - 1024)/(1024\Delta) = -0.2187/\Delta\]</div>
<p>As Bracewell (1986) comments, ‘This anomaly is a distinct impediment to the visualisation of the connection between the Fourier transform and the Discrete Fourier transform’. It also presents a practical problem; it is always necessary to determine where the true data is going to lie when transformed, because not all computer programs will necessarily return this in the first half of the array that contains all the transformed data.</p>
<p><img alt="Drawing" src="../_images/fourier-fig38.png" /></p>
<p>Figure 38. The real part of the discrete Fourier transform of a square pulse showing the symmetrical positioning of the resulting points. The data in the second half of the abscissa is the mirror image of the first half, except for the point at <span class="math notranslate nohighlight">\(\nu\)</span> = 0. The smallest frequency is the reciprocal of the length of the sampled data, this is <span class="math notranslate nohighlight">\(T = N\Delta\)</span> so the frequency is <span class="math notranslate nohighlight">\(f = 1/N\Delta\)</span>.</p>
<hr class="docutils" />
<p>You may consider that the transform looks rather odd in Fig. 38; it looks better if the data is rotated by <span class="math notranslate nohighlight">\(N/2\)</span> points then it will look symmetrical. No new data is present - the effect is just cosmetic, but the result is more understandable and is shown in Fig. 39. The transform now looks like the mathematical transform of a square pulse; see the sinc function, Fig. 15. If the centre frequency is zero, the idea of positive and negative <span class="math notranslate nohighlight">\(\nu/N\)</span> now seems more intuitive. If you wish you can imagine the transform rolled round a cylinder, cut down the middle (at zero) it gives figure 38, cut down the opposite side fig 39.</p>
<p><img alt="Drawing" src="../_images/fourier-fig39.png" /></p>
<p>Figure 39. The transform of Fig. 38 rotated by <span class="math notranslate nohighlight">\(N/2\)</span> points, and clearly showing its symmetrical nature.</p>
</section>
<hr class="docutils" />
<section id="a-four-point-dft">
<h2>9.2 A four point DFT<a class="headerlink" href="#a-four-point-dft" title="Permalink to this headline">#</a></h2>
<p>As an example, suppose that we have four samples <span class="math notranslate nohighlight">\(f_4=a_0,a_1,a_2,a_3\)</span> at points <span class="math notranslate nohighlight">\(n=0,1,2,3\)</span> and use the notation of equation 44’. The first thing to note is that the exponential term is always one of the the complex roots of unity, i.e. satisfying <span class="math notranslate nohighlight">\(z^N=1\)</span>. Let the <span class="math notranslate nohighlight">\(k^{th}\)</span> root of the <span class="math notranslate nohighlight">\(N^{th}\)</span> power be <span class="math notranslate nohighlight">\(w_N^k\)</span> (as was done in section 2.5 in Matrices), then</p>
<div class="math notranslate nohighlight">
\[\displaystyle w_N^k = e^{-2\pi i k/N}\]</div>
<p>the value of <span class="math notranslate nohighlight">\(w\)</span> repeats because <span class="math notranslate nohighlight">\(w_N^N=e^{-2\pi i N/N} = -1\)</span> so that <span class="math notranslate nohighlight">\(w_n^{k+n}=w_n^kw_n^n=w_n^k\)</span>.</p>
<p>As <span class="math notranslate nohighlight">\(N=4\)</span> then</p>
<div class="math notranslate nohighlight">
\[\displaystyle w_4=e^{-\pi i/2}=-i\quad\text{and}\quad w_4^n=(e^{-\pi i/2})^n=(-i)^n\]</div>
<p>and we can use this to simplify the terms in the summation. The first term in the transform is the normalised sum of the signal because all the exponentials have a value of <span class="math notranslate nohighlight">\(1\)</span>. (The transform <span class="math notranslate nohighlight">\(g\)</span> is multiplied by the normalisation (2) only for clarity)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}
2g_0 &amp;= a_0e^0+a_1e^0+a_2e^0+a_3e^0   = a_0+a_1+a_2+a_3\\ \\
2g_1&amp;= a_0+a_1e^{(-2\pi i/4) 1}+a_2w_4^2+a_3w_4^3  \\ &amp;= a_0+a_1(-i) +a_2(-i)^{2}+a_3(-i)^{3}= a_0-a_1i-a_2 + a_3i\\ \\
2g_2&amp;= a_0+a_1w_4^2+a_2w_4^4+a_3w_4^6   =a_0-a_1+a_2-a_3\\ \\
2g_3&amp;= a_0+a_1w_4^3+a_2w_4^6+a_3w_4^9  =a_0+a_1i-a_2-a_3i \end{align}\end{split}\]</div>
<p>If the data is sampled from a sine wave of 1 Hz frequency at four equally spaced points <span class="math notranslate nohighlight">\(N=4\)</span> the data would be <span class="math notranslate nohighlight">\(f=\begin{bmatrix}0,1,-1,0\end{bmatrix}\)</span> measured at points <span class="math notranslate nohighlight">\(0, \pi/2, 3\pi/2, 2\pi\)</span> which we label as <span class="math notranslate nohighlight">\(n = \begin{bmatrix}0&amp;2&amp;3&amp;4\end{bmatrix}\)</span> in egn 44’. The transform with <span class="math notranslate nohighlight">\(a_0=0, a_1=1, a_2=-1,a_3=0\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle
g_0 = 0, \quad g_1 = -i+1, \quad g_2 = 0, \quad g_2 = i+1\]</div>
<p>If we plot what we would measure, which is the absolute value <span class="math notranslate nohighlight">\(g^*g\)</span>, this produces <span class="math notranslate nohighlight">\(\begin{bmatrix} 0&amp; 2 &amp; 0 &amp; 2\end{bmatrix}/2\)</span> which is a signal at frequency <span class="math notranslate nohighlight">\(1\)</span> and again at <span class="math notranslate nohighlight">\(3\)</span>. The sine-wave can only has one frequency, in this case its value is <span class="math notranslate nohighlight">\(1\)</span> so that any frequencies above <span class="math notranslate nohighlight">\(N/2\)</span> should be ignored. They add nothing new to the data, but are in effect a reflection.</p>
<p>Looking at the individual terms of <span class="math notranslate nohighlight">\(g\)</span> you can perhaps see that matrix of <span class="math notranslate nohighlight">\(w\)</span> terms with different powers could be extracted and also a vector of the set of <span class="math notranslate nohighlight">\(a\)</span> values. In the next section we show how the matrix form leads to a great simplification but doing the matrix-vector calculation in this form is very slow, however, by rearranging the matrices a fast algorithm, the Fast Fourier Transform is achieved.</p>
</section>
<section id="the-dft-via-a-circulant-matrix">
<h2>9.3 The DFT via a Circulant Matrix<a class="headerlink" href="#the-dft-via-a-circulant-matrix" title="Permalink to this headline">#</a></h2>
<p>The DFT equation (eqn. 44) requires a great deal of computation, the sum is over <span class="math notranslate nohighlight">\(N\)</span> points in time (<span class="math notranslate nohighlight">\(t=0\to N-1\)</span> and then this is repeated at each of the <span class="math notranslate nohighlight">\(N\)</span> frequencies <span class="math notranslate nohighlight">\(\nu\)</span>. This results in <span class="math notranslate nohighlight">\(N^2\)</span> terms to be multiplied together which produces a slow calculation when <span class="math notranslate nohighlight">\(N\)</span> is large. The important feature is the exponential which is <span class="math notranslate nohighlight">\(e^{-2\pi i/N(t/\nu)}\)</span> and as such is one of the roots of unity, i.e. one of the <span class="math notranslate nohighlight">\(N\)</span> solutions of the equation <span class="math notranslate nohighlight">\(z^N=1\)</span>, where <span class="math notranslate nohighlight">\(z\)</span> is a complex number and <span class="math notranslate nohighlight">\(w\)</span> a root which is also a complex number as just described in the four point example. Extracting a matrix from the <span class="math notranslate nohighlight">\(w\)</span> values in this example forms a Circulant Matrix.</p>
<p>In describing the Huckel model for calculating the <span class="math notranslate nohighlight">\(\pi\)</span> energies of aromatic molecules and also energy transfer on a polygon, circulant matrices were used (Chapter 7). These matrices are always square and are defined by just the first row and then all the other entries are made by rotating these values by one position row by row. This next matrix is circulant and also symmetrical</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{vmatrix} -a &amp; b &amp; 0  &amp; b \\ b &amp; -a &amp; b &amp; 0 \\0&amp; b &amp; -a &amp; b \\b &amp; 0 &amp; b &amp; -a\end{vmatrix}\end{split}\]</div>
<p>Remarkably, the eigenvectors of the symmetric circulant matrix are always the same and are the powers of the <span class="math notranslate nohighlight">\(N\)</span> roots of unity when the matrix is of size <span class="math notranslate nohighlight">\(N\)</span>. The eigenvectors <span class="math notranslate nohighlight">\(v_j,\;(j=0,1,2,\cdots n-1)\)</span> are,</p>
<div class="math notranslate nohighlight">
\[\displaystyle v_j=\begin{bmatrix} w_j^0&amp; w_j^1&amp;w_j^2&amp; \cdots &amp;w_j^{n-1} \end{bmatrix}^T\]</div>
<p>If all the different eigenvectors make the columns of a matrix the result is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \pmb x_n=\begin{bmatrix}1 &amp; 1&amp; 1&amp; 1&amp;\cdots\\1&amp; w_n^1 &amp; w_n^2 &amp; w_n^3&amp;\cdots \\1 &amp; w_n^2 &amp; w_n^4 &amp; w_n^6 &amp;\cdots \\1 &amp; w_n^3 &amp; w_n^6 &amp; w_n^9&amp;\cdots \\  \vdots &amp; &amp; &amp;\vdots\\1 &amp; w_n^{(n-1)k} &amp; &amp; &amp; w_n^{(n-1)^2}\end{bmatrix}\end{split}\]</div>
<p>and as <span class="math notranslate nohighlight">\(w^0=e^0 = 1\)</span> the entries in the first row and column are always <span class="math notranslate nohighlight">\(1\)</span>. This type of matrix is sometimes called the Fourier Matrix.</p>
<p>To apply the DFT right multiply by the the signal we have measured <span class="math notranslate nohighlight">\(f(t)\)</span>, or equivalently <span class="math notranslate nohighlight">\(f_n\)</span> eqn 44a, which we shall use as this is already a vector, giving</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad\qquad\vec g=\begin{bmatrix}1 &amp; 1&amp; 1&amp; 1&amp;\cdots\\1&amp; w_n^1 &amp; w_n^2 &amp; w_n^3&amp;\cdots \\1 &amp; w_n^2 &amp; w_n^4 &amp; w_n^6 &amp;\cdots \\1 &amp; w_n^3 &amp; w_n^6 &amp; w_n^9&amp;\cdots \\  \vdots &amp; &amp; &amp;\vdots\\1 &amp; w_n^{(n-1)k} &amp; &amp; &amp; w_n^{(n-1)^2}\end{bmatrix}\begin{bmatrix} f_0\\f_1\\f_2\\f_3\\ \vdots \\f_{N-1}\end{bmatrix}\qquad\text{or}\qquad \vec g=\pmb F\vec f\qquad\qquad\text{     (44a)}\end{split}\]</div>
<p>This is equivalent to the DFT equation 44 and could be written as <span class="math notranslate nohighlight">\(\vec g=\pmb F\vec f\)</span>.</p>
<p>Matrix-vector multiplication can be considered as a row-wise dot product which gives the resulting sum</p>
<div class="math notranslate nohighlight">
\[\displaystyle g_0= f_0+f_1+f_2+\cdots + f_{N-1}\]</div>
<p>from the first row, the next two values are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle g_1=f_0+ w_N^1f_1+w_N^2f_2+\cdots+w_N^{(N-1)}f_{N-1}\\ g_2=f_0+ w_N^2f_1+w_N^4f_2+\cdots+w_N^{2(N-1)}f_{N-1}\end{split}\]</div>
<p>and so on which means that the total calculation boils down to a simple, if perhaps rather large matrix, multiplication.</p>
<p>To help understand just what the matrix contains recall that the exponential part <span class="math notranslate nohighlight">\(e^{- 2\pi i t\nu/N}\)</span> represents one of the <span class="math notranslate nohighlight">\(N^{th}\)</span> roots of unity and this means that the exponential repeats itself with a period of <span class="math notranslate nohighlight">\(N\)</span>, just as sine and cosine do, i.e. <span class="math notranslate nohighlight">\(e^{i\theta}=\cos(\theta)+i\sin(\theta)\)</span>. Consequently the matrix <span class="math notranslate nohighlight">\(\pmb x\)</span> can be simplified quite considerably by examining each term. As it is written it would seem that <span class="math notranslate nohighlight">\(N^2\)</span> values would need to be calculated, but this is not so and in fact only <span class="math notranslate nohighlight">\(N\)</span> are needed.</p>
<p>The eigenvector matrix can easily be made directly, for example at position <span class="math notranslate nohighlight">\(j,k\)</span> the entry is</p>
<div class="math notranslate nohighlight">
\[\displaystyle x_n^{(j,k)} = w^{jk}=e^{-2\pi i/n( jk)}\]</div>
<p>Now because of the repeating nature of the roots of unity (and of sine and cosine) only <span class="math notranslate nohighlight">\(N\)</span> of the possible entries need to be calculated, in fact just a row and this is because the product <span class="math notranslate nohighlight">\(jk\)</span> in the exponential can be replaced with <span class="math notranslate nohighlight">\((jk)\; mod \;N\)</span>, which is the remainder after integer division of the product <span class="math notranslate nohighlight">\(jk\)</span> with <span class="math notranslate nohighlight">\(N\)</span> meaning that <span class="math notranslate nohighlight">\(jk\)</span> is replaced by a number always in the range <span class="math notranslate nohighlight">\(0\to N-1\)</span>.</p>
<p>This repeating effect can be understood from the properties of exponentials;</p>
<div class="math notranslate nohighlight">
\[\displaystyle w_N=e^{-2\pi i/N}\quad\text{then}\quad w_N^N=e^{-2\pi i}=1=w_n^0\]</div>
<p>Similarly when there is a multiple of <span class="math notranslate nohighlight">\(N\)</span> for example <span class="math notranslate nohighlight">\(mN\)</span> then</p>
<div class="math notranslate nohighlight">
\[\displaystyle w_N^{mN}=w_N^m=e^{-m2\pi i}\quad\text{or a sum}\quad w_N^{m+N} = w_N^Nw^m = w^m = e^{-m2\pi i}\]</div>
<p>An example should make this clearer. The matrix is of size <span class="math notranslate nohighlight">\(6\)</span> but <span class="math notranslate nohighlight">\(w_6^1\)</span> etc. is replace by <span class="math notranslate nohighlight">\( w^1\)</span> etc. just for clarity and we label it as <span class="math notranslate nohighlight">\(\pmb F\)</span> to indicate that it is a Fourier matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \pmb F_6=\begin{bmatrix}1 &amp; 1&amp; 1&amp; 1&amp;1&amp;1\\1&amp; w^1 &amp; w^2 &amp; w^3 &amp; w^4 &amp; w^5 \\1 &amp; w^2 &amp; w^4 &amp; w^6 &amp; w^8 &amp; w^{10}\\1 &amp; w^3 &amp; w^6 &amp; w^9 &amp; w^{12} &amp;w^{15} \\ 1 &amp; w^4 &amp; w^8 &amp; w^{12}&amp; w^{16} &amp; w^{20}\\1 &amp; w^5 &amp; w^{10} &amp; w^{15} &amp; w^{20} &amp; w^{25} \end{bmatrix}\end{split}\]</div>
<p>Applying the repeating nature of the powers produces</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \pmb F_6=\begin{bmatrix}1 &amp; 1&amp; 1&amp; 1&amp;1&amp;1\\1&amp; w^1 &amp; w^2 &amp; w^3 &amp; w^4 &amp; w^5 \\1 &amp; w^2 &amp; w^4 &amp; w^0 &amp; w^2 &amp; w^4\\1 &amp; w^3 &amp; w^0 &amp; w^3 &amp; w^0 &amp;w^3 \\ 1 &amp; w^4 &amp; w^2 &amp; w^0&amp; w^4 &amp; w^2\\1 &amp; w^5 &amp; w^4 &amp; w^3 &amp; w^2 &amp; w^1 \end{bmatrix}\end{split}\]</div>
<p>Simplifying the matrix this way may not seem like much but if <span class="math notranslate nohighlight">\(N\)</span> is large say <span class="math notranslate nohighlight">\(8000\)</span> then only these many exponentials have to be calculated instead of <span class="math notranslate nohighlight">\(64\)</span> million. However, matrix multiplication is rather slow in practice, and several methods of speeding up the calculation have been developed. The most commonly used method is a ‘divide and rule’ approach by Cooley and Tukey. This Fast Fourier Transform (FFT) algorithm works by computing the DFT for small subsets of the overall problem and then combining the results. For this reason it works fastest when <span class="math notranslate nohighlight">\(N\)</span> is a power of <span class="math notranslate nohighlight">\(2\)</span> and takes a time  <span class="math notranslate nohighlight">\(\approx n\log_2(n)\)</span> to complete the calculation vs. <span class="math notranslate nohighlight">\(n^2\)</span> for the direct DFT as shown above. This effect is actually rather dramatic, if <span class="math notranslate nohighlight">\(n=2^{12}=4096\)</span> then by FFT the calculation takes <span class="math notranslate nohighlight">\(\approx 50000\)</span> multiplications whereas a direct calculation <span class="math notranslate nohighlight">\(N^2\approx 17\cdot 10^6\)</span>, hundreds of times less. A lot of image analysis is done using FFT, noise removal etc., which would otherwise simply not be possible, an image containing <span class="math notranslate nohighlight">\(1064\times 1064\)</span> pixels would need <span class="math notranslate nohighlight">\(\sim 10^{12}\)</span> operations, which is impossible,  vs. <span class="math notranslate nohighlight">\(\sim 2\cdot 10^7\)</span> which is easy.</p>
</section>
<section id="fast-fourier-transform-fft-calculation">
<h2>9.4 Fast Fourier transform ( FFT ) calculation<a class="headerlink" href="#fast-fourier-transform-fft-calculation" title="Permalink to this headline">#</a></h2>
<p>The fast fourier transform idea works by dividing the data into two halves and then combining the result. The reason for doing this is that this will take <span class="math notranslate nohighlight">\(2(N/2)^2=N^2/2\)</span> operations which is only half as many as the direct DFT on <span class="math notranslate nohighlight">\(N\)</span> points. If the data is split in half again and then again and so on there is a similar reduction in the number of operations leading to the number <span class="math notranslate nohighlight">\(\approx N\log_2(N)\)</span> for large <span class="math notranslate nohighlight">\(N\)</span>. The algorithm does not involve any new maths but rearranging the contents of the DFT matrix and the order of the data points. There are several variations on algorithms to do this but all involve repeatedly dividing the data into two equal parts and using recursion. For this reason the calculation is fastest when <span class="math notranslate nohighlight">\(N\)</span> is a power of <span class="math notranslate nohighlight">\(2\)</span> but even if it is not zero padding to reach this condition is still worth it.</p>
<p>Suppose we split the summation of eqn 44 into summations of even and odd indices. The new indices are <span class="math notranslate nohighlight">\(2m\)</span> for even index terms <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(2m+1)\)</span> for odd where <span class="math notranslate nohighlight">\(m=0,1\cdots N/2-1\)</span>, and ignoring normalisation for clarity, gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle g_\nu = \sum_{m=0}^{N/2-1}f_{2m}e^{-2\pi i\nu (2m)/N}+\sum_{m=0}^{N/2-1}f_{2m+1}e^{-2\pi i\nu (2m+1)/N}\]</div>
<p>rearranging this gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle g_\nu = \sum_{m=0}^{N/2-1}f_{2m}e^{-2\pi i\nu (2m)/N}+e^{-2\pi i\nu/N}\sum_{m=0}^{N/2-1}f_{2m+1}e^{-2\pi i\nu (2m)/N}\qquad\tag{44b}\]</div>
<p>and it can be seen that only <span class="math notranslate nohighlight">\(N/2\)</span> summations are needed for each summation. The exponentials in the summations are the same in both halves and can be calculated before hand and saved. Furthermore, each summation can be further split into two parts and the odd and even <em>indices</em> of each part treated in the same way. Thus each part is recursive and can continue until just two terms remain in each summation.</p>
<p>The whole process can be made into a product of matrices, this looks very complicated but because most of the entries are zero or one the calculation is fast. The matrices are constructed in blocks of size <span class="math notranslate nohighlight">\(N/2 \times N/2\)</span>. The terms are <span class="math notranslate nohighlight">\(I_{N/2}\)</span> which is the identity matrix (diagonal <span class="math notranslate nohighlight">\(1\)</span>’s with the rest zero, <span class="math notranslate nohighlight">\(D\)</span> the diagonal of the powers of <span class="math notranslate nohighlight">\(w\)</span> to <span class="math notranslate nohighlight">\(N/2-1\)</span>, and <span class="math notranslate nohighlight">\(F_{N/2}\)</span> the fourier matrix for <span class="math notranslate nohighlight">\(N/2\)</span> points, and finally the even-odd matrix contains only <span class="math notranslate nohighlight">\(1\)</span> in any row at an even or odd position with all the rest being zero. This extracts the appropriate odd or even indexed term out of the <span class="math notranslate nohighlight">\(f\)</span> vector which are the data points. (Note that the first point has index <span class="math notranslate nohighlight">\(0\)</span>).</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad\qquad\qquad\qquad F_N= \begin{bmatrix}I_{N/2} &amp; D\\I_{N/2} &amp; -D\end{bmatrix}\begin{bmatrix}F_{N/2} &amp; 0\\0 &amp; F_{N/2}\end{bmatrix}\begin{bmatrix}even\\odd\end{bmatrix}\qquad\qquad\qquad\qquad\qquad \text{ (44c)}\end{split}\]</div>
<p>and the complete calculation is <span class="math notranslate nohighlight">\(\vec g_n=\pmb F_N\vec f_N\)</span>. An important point to note is that in calculating the <span class="math notranslate nohighlight">\(F_{N/2}\)</span> the <span class="math notranslate nohighlight">\(w\)</span> values are related to <span class="math notranslate nohighlight">\(w_N\)</span> as <span class="math notranslate nohighlight">\(w_N^2=w_{N/2}\)</span>. This shows just the first step, however, the matrices can be split into two again and so on and each time following the same procedure will speed up the calculation.</p>
<p>By direct calculation the <span class="math notranslate nohighlight">\(F_4\)</span> matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle F_4= \begin{bmatrix}1&amp;1&amp;1 &amp;1\\1&amp;w&amp;w^2&amp;w^3\\1&amp;w^2&amp;w^4&amp;w^6\\ 1&amp;w^3&amp;w^6&amp;w^9\end{bmatrix}\end{split}\]</div>
<p>and where <span class="math notranslate nohighlight">\(w=e^{-2\pi i/4} \)</span> and which can be dissected into parts</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle F_4= \begin{bmatrix}1&amp;0&amp;1 &amp;0\\0&amp;1&amp;0&amp;w\\1&amp;0&amp;-1&amp;0\\ 0&amp;1&amp;0&amp;-w\end{bmatrix}
\begin{bmatrix}1&amp;1&amp;0 &amp;0\\1&amp;w^2&amp;0&amp;0\\0&amp;0&amp;1&amp;1\\ 0&amp;0&amp;1&amp;w^2\end{bmatrix}
\begin{bmatrix}1&amp;0&amp;0 &amp;0\\0&amp;0&amp;1&amp;0\\0&amp;1&amp;0&amp;0\\ 0&amp;0&amp;0&amp;1\end{bmatrix}\end{split}\]</div>
<p>The reason <span class="math notranslate nohighlight">\(w^2\)</span> appears in the second matrix is that we used values from <span class="math notranslate nohighlight">\(F_4\)</span> not <span class="math notranslate nohighlight">\(F_2\)</span> because <span class="math notranslate nohighlight">\(w_N^2=w_{N/2}\)</span>.</p>
<p>The matrices can be understood starting the the right-hand one. We want to select even and odd terms out of the vector of data points <span class="math notranslate nohighlight">\(f_n\)</span>. As each row multiplied by <span class="math notranslate nohighlight">\(f\)</span> is a dot product which is the sum of the products of the two values one from each. The top row produces</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{bmatrix}1&amp;0&amp;0&amp;0\end{bmatrix}\cdot \begin{bmatrix}f_0\\f_1\\f_2\\f_3\end{bmatrix}= f_0+0f_1+0f_2+0f_3=f_0\end{split}\]</div>
<p>and the second row</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{bmatrix}0&amp;0&amp;1&amp;0\end{bmatrix}\cdot \begin{bmatrix}f_0\\f_1\\f_2\\f_3\end{bmatrix}= f_2\end{split}\]</div>
<p>and so on, so this matrix simply sorts even and odd indexed data.</p>
<p>The middle matrix <span class="math notranslate nohighlight">\(\begin{bmatrix}F_{N/2} &amp; 0\\0 &amp; F_{N/2}\end{bmatrix}\)</span> when multiplied by the even odd matrix to its right calculates each of the terms in the summations of eqn 44a and add them together. The left hand most matrix adds the <span class="math notranslate nohighlight">\(e^{-2\pi i \nu/N}\)</span> terms just the the second (odd indexed) summation. The identity in this matrix leaves the left hand summation in eqn 44 unchanged.</p>
<p>The next step is to halve the matrices again while still keeping the same overall size. Using the notation in eqn 44c this now becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad F_N= \begin{bmatrix}I_{N/4} &amp; D&amp;\cdots&amp;\cdots\\I_{N/4} &amp; -D &amp;\cdots&amp;\cdots\\\cdots&amp;\cdots&amp;I_{N/4}&amp; D\\\cdots&amp;\cdots&amp;I_{N/4}&amp; -D\end{bmatrix}\begin{bmatrix}F_{N/4} &amp; \cdots&amp;\cdots&amp;\cdots\\\cdots &amp;  F_{N/4}&amp;\cdots&amp;\cdots\\\cdots&amp;\cdots&amp;F_{N/4}&amp;\cdots\\ \cdots &amp;\cdots&amp; \cdots&amp;F_{N/4}\end{bmatrix}\begin{bmatrix}even\\odd\end{bmatrix} \qquad\qquad\qquad\text{(44d)}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is the diagonal of the powers of <span class="math notranslate nohighlight">\(w\)</span> with length <span class="math notranslate nohighlight">\(N/4\)</span> and the dots represent the appropriate number of zeros, and the even - odd matrix now has the order if <span class="math notranslate nohighlight">\(N=8\)</span> of <span class="math notranslate nohighlight">\(f_0,f_4,f_1,f_5,f_2,f_6,f_3,f_7\)</span> which is the original even - odd numbering with each of these split into even and odd indices. This is a permutation of the rows.  While such a doubling of each matrix may look cumbersome it is fast to achieve when coded as all that is involved is filling places in a matrix, no actual calculation until matrix multiplication begins.</p>
<p>Having explained all this in practice you should never need to write an FFT code, unless you crave the challenge,  but will always use built-in routines.</p>
</section>
<section id="nyquist-critical-frequency-and-shannon-sampling-theorem">
<h2>9.5 Nyquist Critical Frequency and Shannon Sampling Theorem<a class="headerlink" href="#nyquist-critical-frequency-and-shannon-sampling-theorem" title="Permalink to this headline">#</a></h2>
<p>The Nyquist critical frequency has been mentioned in passing, but now it is explained more fully. An experimental set of data is band-limited (bandwidth limited), if its maximum frequency has essentially zero amplitude, as sketch (C) shows in Fig. 36. Because the signal’s frequency has a maximum, this means that any feature in the signal cannot change faster than the reciprocal of this frequency. If the signal were conveying information, then anything changing faster than this frequency would be lost. The maximum sinusoidal wave that can be extracted or recovered from data by a discrete (Fourier) transform is given by the Nyquist critical frequency <span class="math notranslate nohighlight">\(\nu_c\)</span> = 1/2<span class="math notranslate nohighlight">\(\Delta\)</span>, where <span class="math notranslate nohighlight">\(\Delta\)</span> is the (time) interval between any two consecutive data points. Consider a set of experimental data points represented by a series of equally spaced points on the time axis separated by <span class="math notranslate nohighlight">\(\Delta\)</span>. The highest frequency in the data, is clearly when consecutive points have the opposite sign,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{lcc}
\mathrm{data} &amp;=[&amp;+1 &amp; -1 &amp; +1 &amp; -1 &amp; +1 &amp;\cdots] \\
\mathrm{index}\; n &amp;=[&amp; 0&amp; 1&amp; 2&amp; 3&amp; 4 &amp;\cdots]
\end{array}\end{split}\]</div>
<p>and this series is equivalent to the function <span class="math notranslate nohighlight">\(\displaystyle e^{i\pi n/\Delta}\)</span> if <span class="math notranslate nohighlight">\(\Delta =1, i=\sqrt{-1}\)</span> and <span class="math notranslate nohighlight">\(t\)</span> is the index number of a data point, 0, 1, 2… The exponential series with integer <span class="math notranslate nohighlight">\(n\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle e^0=1,\quad e^{i\pi}=-1,\quad e^{2i\pi}=1, \quad e^{3i\pi}=-1, \cdots\]</div>
<p>The highest frequency in the data <span class="math notranslate nohighlight">\(\omega_{max}\)</span> occurs when <span class="math notranslate nohighlight">\(\displaystyle e^{in\omega_{max}}=e^{i\pi n/\Delta}\)</span> or when <span class="math notranslate nohighlight">\(\omega_{max}=\pi/\Delta \)</span> and as <span class="math notranslate nohighlight">\(\omega = 2\pi\nu\)</span> the</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \text{Nyquist critical frequency (in Hz) is}\; \nu_c=\frac{1}{2\Delta}  \qquad\tag{45}\]</div>
<p>or two points per cycle. The lowest frequency is zero when all the points have the same value and sign; <span class="math notranslate nohighlight">\([+1 +1 +1 +1 +1 \cdots ]\)</span>. A general digitized waveform therefore has frequencies that can range from 0 to the Nyquist critical frequency; the data may contain higher frequencies than this, but these cannot be measured if they are higher than the critical frequency. Therefore, if twice as many data points than before are sampled in a given time period, the Nyquist frequency increases, because <span class="math notranslate nohighlight">\(\Delta\)</span> is then smaller and higher frequencies in the data can be transformed properly. Conversely, if <span class="math notranslate nohighlight">\(\Delta\)</span> is too large, not enough sampling occurs and the data is not properly described, but this begs the question; how many points are too many and how many too few? The Shannon sampling theorem dictates exactly the minimum number of data points needed to ensure that data of a certain frequency is properly sampled. This theorem states that,</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span> <strong>‘for reliable replication of any waveform, two or more data points per period are required to define each sinusoid in the data’</strong></p>
<p>which means that the sampling frequency must be greater than twice the highest frequency in the signal</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \text{Shannon theorem} \quad \nu_{sample} \ge 2\nu_{max}   \qquad\tag{46}\]</div>
<p>Whether the Nyquist or Shannon condition applies depends on your particular situation. If you have some data, and for an instrumental reason can sample no higher than a certain value, any frequencies higher than the Nyquist will be under-sampled and not be measured properly. If on the other hand you can sample as often as you wish, no more samples than those predicted by the Shannon limit are needed. However, this sampling rate must apply to all the data even though its value is dictated only by the highest frequency present. If the data is not sampled frequently enough, then aliasing occurs and extra false signals are observed in the Fourier transform. This effect is described after a discrete transform has been calculated.</p>
<p>The Nyquist frequency has great implications for NMR and effectively dictates how the experiment is performed. A typical spectrometer operates at 400 MHz so that sampling should be done at <span class="math notranslate nohighlight">\(800\)</span> MHz or every <span class="math notranslate nohighlight">\(1.25\)</span> ns, which is a very tall order even with today’s fast electronics. The amount of data collected would also be vast because the FID can last for several seconds, therefore, <span class="math notranslate nohighlight">\(\approx 8 \cdot 10^9\)</span> points over <span class="math notranslate nohighlight">\(10\)</span> seconds and perhaps four times as many bytes depending on the word size of the computer. However, the small frequency shift in the NMR signal from the RF frequency used to excite the nuclei comes to the rescue. This shift is only a few kHz, and if the NMR signal from the detector is mixed (heterodyned), with the frequency of the RF source beating will occur and the kHz frequency shift is extracted. (An analogue radio extracts the audio signal from the MHz broadcast frequency by a similar process.) After heterodyning, it is now relatively easy to sample the low frequency signal at a sufficiently high time resolution, in milliseconds not nanoseconds, to satisfy the Nyquist condition and accurately reproduce all frequencies in the signal. After a discrete Fourier transform, this signal becomes the NMR spectrum.</p>
<p><img alt="Drawing" src="../_images/fourier-fig40.png" /></p>
<p>Figure 40. A sine wave of decreasing amplitude and its sampling at two points per cycle; no more points are needed for such a sine wave. If the frequency changes with time, for example if the signal is chirped, then more data points are needed across the whole curve to describe the highest frequency correctly and for this reason most experiments over-sample the data.</p>
</section>
<hr class="docutils" />
<section id="numerically-calculating-a-dft-using-the-fft-algorithm">
<h2>9.6 Numerically calculating a ( DFT )  using the FFT algorithm<a class="headerlink" href="#numerically-calculating-a-dft-using-the-fft-algorithm" title="Permalink to this headline">#</a></h2>
<p>The DFT can easily be calculated using matrix multiplication as in equation 44a but its is very slow and instead a Fast Fourier Transform algorithm is universally used and built into most computer languages. As an illustration of numerically obtaining a discrete transform, some data will be synthesized and then transformed. Each data point is in principle a complex number, and therefore can be displayed in different forms: as the real and imaginary parts, as the absolute value, and as the phase. If <span class="math notranslate nohighlight">\(Z\)</span> is a complex number, recall that the absolute value, which is also called the modulus or magnitude, is <span class="math notranslate nohighlight">\(| Z^*Z|^{1/2}\)</span>. The square of this, when plotted against frequency, is called the <em>power spectrum</em>. The  <em>phase</em> of the signal, in radians, is defined as <span class="math notranslate nohighlight">\(\displaystyle \theta =\tan^{-1}\left(Im(Z)/Re(Z)  \right)\)</span>.</p>
<p>The data shown in Fig. 41, simulates the FID from a mock NMR experiment, with two spins producing NMR transition frequencies of <span class="math notranslate nohighlight">\(1/35\)</span> and <span class="math notranslate nohighlight">\(1/20\)</span> Hz. The FID comprises two cosines multiplied by an exponential decay with a <span class="math notranslate nohighlight">\(200\)</span> s decay time, and extends to <span class="math notranslate nohighlight">\(1000\)</span> seconds. In a real NMR experiment, <span class="math notranslate nohighlight">\(16384\; (2^{14})\)</span> points would be typically used and the total time range would be a fraction of a second to a few seconds duration. The transition frequencies are typically in the <span class="math notranslate nohighlight">\(100\)</span> to <span class="math notranslate nohighlight">\(500\)</span> MHz, region but the actual frequency depends on the strength of the permanent magnetic field.</p>
<p>The time between any two data points is <span class="math notranslate nohighlight">\(\Delta = T/N\)</span> where <span class="math notranslate nohighlight">\(T\)</span> is the total time range of the data. In this example, this is <span class="math notranslate nohighlight">\(1000\)</span> seconds, and the number of data points <span class="math notranslate nohighlight">\(N = 2048\)</span>. This time increment per point <span class="math notranslate nohighlight">\(\Delta\)</span> is called tp in the calculation, and is <span class="math notranslate nohighlight">\(1000/204 \approx 0.488\)</span>. The maximum, or Nyquist frequency that can be calculated using this data is 1/(2<span class="math notranslate nohighlight">\(\Delta\)</span>) or 1.024 Hz and both frequencies are well below this. The real, imaginary, and phase parts of the transform are calculated and plotted against frequency in Hz, which is <span class="math notranslate nohighlight">\(\nu /(t_p \times N)\)</span> where <span class="math notranslate nohighlight">\(\nu\)</span> is the index number. We could also plot against the index number itself, or against angular frequency <span class="math notranslate nohighlight">\(2\pi\nu /(t_p \times N)\)</span>. It is important to decide what units are to be plotted. Note that the Nyquist frequency is measured in Hz, not angular frequency.</p>
<p>The calculation using python/numpy/matplotlib is shown below. Note that only the first half of the data is plotted in the FFT. Once the FFT is calculated the .real and .imag parts are plotted as is the phase. The vertical lines on the FFT plots are the two frequencies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## example of calculating an FFT. </span>

<span class="n">fig1</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">16.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">))</span>    <span class="c1"># set up 4 plots in one window</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

<span class="n">nu1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">20.0</span>  <span class="c1"># frequency Hz  (only for plotting make this biggest frequency)</span>
<span class="n">nu2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">35.0</span>
<span class="n">FID</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="mi">200</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nu1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nu2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># FID</span>

<span class="n">maxt</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">12</span>                                <span class="c1"># number of data points</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">maxt</span><span class="o">/</span><span class="n">N</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">maxt</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>               <span class="c1"># make times to plot FID</span>
<span class="n">nu</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">tp</span><span class="o">*</span><span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>        <span class="c1"># make discrete frequencies to plot fft</span>

<span class="n">ft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">FID</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>                 <span class="c1"># do fft using in-built functions (use rfft as FID is not complex)</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># plot horizontal loine at zero </span>
<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">FID</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>         <span class="c1"># plot FID </span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FID&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t/sec&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># plot real part of FFT as line</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># plot real part of FFT as points</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FFT (real part)&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1"># plot imaginary</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FFT (imag part)&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="o">/</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FFT (phase)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radian&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">]:</span>                 <span class="c1"># plot common features</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">([</span><span class="n">nu1</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">([</span><span class="n">nu2</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nu1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency/Hz&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Fourier-E_7_0.png" src="../_images/Fourier-E_7_0.png" />
</div>
</div>
<p>Figures 41 &amp; 42 combined. Left: The time decaying FID, and next the real part of its discrete Fourier transform with frequencies of <span class="math notranslate nohighlight">\(1/35 = 0.0286\)</span> and <span class="math notranslate nohighlight">\(1/20\)</span> Hz. Only the first part of the spectrum is plotted; its mirror image at higher frequencies than the Nyquist limit of <span class="math notranslate nohighlight">\(1.024\)</span> Hz is not shown. Right: Imaginary and phase plot (far right) of the transformed data. The phase is in radians; <span class="math notranslate nohighlight">\(\pi\)</span> radians equals <span class="math notranslate nohighlight">\(180^\text{o}\)</span>. At larger frequencies, the phase approaches zero, reaching it at point <span class="math notranslate nohighlight">\(N/2\)</span> or <span class="math notranslate nohighlight">\(1.024\)</span> Hz, which is far to the right of the plotted range.</p>
</section>
<hr class="docutils" />
<section id="aliasing">
<h2>9.7 Aliasing<a class="headerlink" href="#aliasing" title="Permalink to this headline">#</a></h2>
<p>Under-sampling means sampling at less than twice the highest frequency component in the data. This means that adjacent sampling points do not have a small enough separation to represent the highest frequency feature. The consequence of under-sampling a signal is erroneously to fold high frequency parts into the lower frequency parts of the Fourier transform; the effect is called <em>aliasing</em>.</p>
<p>A sufficient condition for the proper sampling of a sinusoidal signal is that the sampling frequency <span class="math notranslate nohighlight">\(\nu_s\)</span> obeys <span class="math notranslate nohighlight">\(\nu_s /2 \ge \nu_{max}\)</span>. Suppose that for some reason, this condition cannot be met, then as the frequencies of sinusoids in the data increase from <span class="math notranslate nohighlight">\(\nu_s/2\)</span>, which is the maximum frequency for correct sampling, to <span class="math notranslate nohighlight">\(\nu_s\)</span>, these sinusoids are under-sampled and their apparent frequency moves down from <span class="math notranslate nohighlight">\(\nu_s/2\)</span> to zero. To emphasize this, another name for the Nyquist frequency <span class="math notranslate nohighlight">\(\nu_s/2\)</span> is the folding frequency, and the aliased data is sometimes called an ‘image’ or ‘replica’. When a sinusoid of frequency <span class="math notranslate nohighlight">\(\nu_1\)</span> is sampled with frequency <span class="math notranslate nohighlight">\(\nu_s\)</span>, the resulting samples are indistinguishable from those of replicate sinusoids at frequency <span class="math notranslate nohighlight">\(| \nu_1 - n\nu_s |\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is any integer. The replica signals occur because a cosine with frequency <span class="math notranslate nohighlight">\(2\pi\nu\)</span> is indistinguishable from one at frequency <span class="math notranslate nohighlight">\(2\pi\nu n\)</span>, because the cosine is periodic. When aliasing occurs, data from the adjacent higher frequency replica leak into the lowest primary one. The sketch, Fig. 43, attempts to show this. In the top sketch, the primary (normal) Fourier transform is shown as a solid line and replicates as dotted. When the sampling frequency <span class="math notranslate nohighlight">\(\nu_s\)</span> is at least twice the maximum frequency present in the data, <span class="math notranslate nohighlight">\(\nu_{max}\)</span> the replica and transform do not overlap. When this condition does not hold, lower sketch, then the transform and its replica do overlap, and frequencies are folded back into the transform, leading to erroneous data.</p>
<p>Choosing the sampling frequency may seem rather like the ‘chicken and egg’ situation, because the highest frequency has to be known before performing the transform to find out what the highest frequency is. However, knowing how often to sample the data is easy in practice and can be done in two ways: either ensure that several points sample any oscillatory feature, or frequency limit the data by filtering. More sampling points than are strictly necessary only make the computer calculation slower, but this is not nearly as much of a problem as it used to be. Alternatively, if your instrument cannot sample at the frequency you would like, the data should be filtered to remove frequencies above this in an attempt to limit the effects of aliasing. Such a filter is, not unsurprisingly, called an <em>anti-aliasing</em> filter.</p>
<p><img alt="Drawing" src="../_images/Fourier-fig43.png" /></p>
<p>Fig. 43 Correct sampling (top) and under-sampling (bottom) leading to aliasing.</p>
<hr class="docutils" />
<p>An everyday example of aliasing may be seen on your television. You may have noticed how the spokes of a car or wheel, or markings on a tyre appear to move slowly backwards or forwards at a rate far smaller than is expected to be the true rate of rotation. This is very apparent in F1 motor racing and also in old Westerns with horse-drawn carriages.</p>
<p>The effect is due to the camera sampling the scene at too slow a rate to measure rapidly moving objects properly. Suppose spoke 1 is observed when the image is sampled. A short time later, the image is updated on the screen, but the wheel has rotated by a large angle and at the next observation time spoke 2 or even 3 is in the same, or almost the same position, as was spoke 1. As all the spokes look alike, spoke 1 appears to have moved only a small amount forwards or even backwards and the effect is very odd because the rapidly moving vehicle is seen with its wheel apparently moving backwards. The same effect may also be observed directly from the spokes of a car wheel when viewed through vertical railings.</p>
<p>In the Fourier transform, aliasing has to be taken very seriously or data will be mis-interpreted. Consider the curves shown below Fig. 44; the one on the left is an under-sampled, damped sine wave. The data, which would be recorded as the set of points shown, would appear as an exponential decay. Alternatively, if the samples were taken at a different time a straight line along the axis would be reported or perhaps as a rising exponential. This shows that the phase of the sampling is important; phase here means only where sampling is started. On the right, the data is over-sampled; more data points are present than are strictly necessary, but this is not a problem.</p>
<p><img alt="Drawing" src="../_images/Fourier-fig44.png" /></p>
<p>Figure 44. The figure on the left shows the under-sampling of a sine wave. The data, which is recorded as the set of points (shown as circles), would erroneously appear as an exponential decay not as a damped sine wave. On the right, the data is over-sampled; more data points are present than strictly needed.</p>
<hr class="docutils" />
<p>The calculation shown in Fig. 45, illustrates the effect of aliasing on an oscillating signal with a constantly changing frequency. The data, accurately sampled with <span class="math notranslate nohighlight">\(4096\)</span> points, is shown on the left and that with <span class="math notranslate nohighlight">\(256\)</span> sampled points, on the right. The abscissa on each transform is <span class="math notranslate nohighlight">\(i/N\)</span> for index <span class="math notranslate nohighlight">\(i\)</span> and ranges from <span class="math notranslate nohighlight">\(0 \to 0.5\)</span>. The failure of the sampling to reproduce the high frequency part of the data is clearly seen in the under-sampled data (top right), where some data is missing.</p>
<p>The real part of the transform (bottom right), apparently has much higher frequency data present, but this is the effect of aliasing as seen by comparison with the accurate real part of the transform (bottom left). The inset shows details up to <span class="math notranslate nohighlight">\(i/N = 0.05\)</span>. The aliased transform does also contain some correctly transformed data but only up to the Nyquist critical frequency of the 256 data points. You can see how the inset (bottom left) has a similar form to that in the aliased transform at low frequency, but only up to about five periods of the wave. The amplitude is also smaller than the true transform, because the total amount of transformed data is the same but spread out over more frequencies. Reconstructing the data from the aliased transform by reverse transforming produces the curve (top right) which is a very different from the true waveform shown top left.</p>
<p>To prevent aliasing, either the sampling rate has to be increased, or if this is not possible, the original data has to be filtered to remove higher frequencies. If the latter, the remaining transform will then be accurate, but only up to a certain frequency depending upon how filtering is performed.</p>
<p>Finally note that aliasing is not the only way that erroneous transforms can be produced. If the data suddenly ends, the transform will ‘assume’ that there is a sudden change in frequency, in effect a step function, and this will generate many unwanted frequencies in the transform. As an example, see the transform of a rectangular pulse, Fig. 15. It is better to apodise the original data, so that the final values are close to zero to prevent this. Apodising means multiplying the original data by a function, <span class="math notranslate nohighlight">\(\displaystyle e^{-x}\)</span> for example, to make its values at long times, (its ‘feet’), effectively zero (see Sanders &amp; Hunter 1987).</p>
<p><img alt="Drawing" src="../_images/fourier-fig45.png" /></p>
<p>Figure 45. Calculations showing proper sampling, left-hand column, and under-sampling, (right), that produces the effect of aliasing. The transforms are plotted as a fraction of the total points. The inset has its <span class="math notranslate nohighlight">\(x\)</span> axis multiplied by <span class="math notranslate nohighlight">\(10\)</span>.</p>
</section>
<hr class="docutils" />
<section id="zero-filling">
<h2>9.8 Zero filling<a class="headerlink" href="#zero-filling" title="Permalink to this headline">#</a></h2>
<p>To increase resolution without increasing acquisition time, the data can be zero filled by adding enough zeros to the data to double its length, which means adding points to both the real and imaginary parts of the data, but only if the data has decayed to quasi-zero at the end of the acquisition period <span class="math notranslate nohighlight">\(T\)</span>. If the data has 2<span class="math notranslate nohighlight">\(N\)</span> points, this means that another 2<span class="math notranslate nohighlight">\(N\)</span> can be added to the end of the FID before Fourier transforming. The number of points in the real part of the spectrum is increased from the usual 2<span class="math notranslate nohighlight">\(N -1\)</span> to 2<span class="math notranslate nohighlight">\(N\)</span>. With a computer, it is easy to add sets of 2<span class="math notranslate nohighlight">\(N\)</span> points repeatedly to the end of the data. However, this does not increase resolution but in effect interpolates between data points. The effect is superficial; no extra information is obtained by adding a second and subsequent zero fills, but it does give nice smooth graphs.</p>
</section>
<section id="using-fourier-transforms-for-filtering-smoothing-and-noise-reduction-on-data">
<h2>10 Using Fourier transforms for filtering, smoothing, and noise reduction on data<a class="headerlink" href="#using-fourier-transforms-for-filtering-smoothing-and-noise-reduction-on-data" title="Permalink to this headline">#</a></h2>
</section>
<section id="motivation">
<h2>10.1 Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">#</a></h2>
<p>To the experimentalist, noisy data always presents a problem. The best option is always to go and do more experiments, but this is not always possible for any number of reasons. One option to improve the data is smoothing. Although it is rarely thought of as smoothing, one way of doing this on data showing a trend, is to perform a least-squares analysis. The parameters obtained, for example, the slope and gradient of a straight line with their associated standard deviations, provide a description of the data. If the data is not a straight line, then a polynomial fit may be used, and, if an exponential or other complex function, then a non-linear, least-squares may be necessary. However, smoothing data is often done independently and before any fitting is performed in an attempt to reduce the noise.</p>
<p>As a rule of thumb, the noise and data can be split into three approximate classes:</p>
<p><strong>(a)</strong> The data is a slowly changing function and the noise is spiky, i.e. of high frequency;</p>
<p><strong>(b)</strong> the converse, the noise is slowly varying and the data is of high frequency; and</p>
<p><strong>(c)</strong> noise and data are of a similar frequency.</p>
<p>In cases (i) and (ii) it is generally possible to separate noise and data; in (iii) this may not be possible.</p>
<p>The Savitsky - Golay method is an optimal polynomial fitting method that spans several data points at a time, replacing each with a mean value. It is available on most data analysis and graphics packages, the details of the calculation are complex and will not be examined here, but is a type of convolution and is good at removing noise spikes on data (Gorry 1990). If the data had an underlying slow trend on it, the rolling average method is also good if the noise is random and spiky on top of the data, see Section 10.4.</p>
<p>However, smoothing data is always a risky procedure because some of the data may inadvertently be removed with some of the noise, without you realizing it. Thus, the advice is always: <em>do not smooth the data if it can be avoided</em>. Having said this, a noisy signal must sometimes be ‘cleaned up’ to extract the signal from the noise, and a Fourier transform is a good way to do this. This approach is a little different to other smoothing methods, because by transforming the data it is possible to be very specific about what noise is removed. If the data to be improved is a one-dimensional time profile or a noisy image, the method is essentially the same: make a Fourier transform, look for the signal, remove unwanted frequencies and transform back again. If the noise is ‘white’ that is to say equally spread over all frequencies, and the signal wanted is a slowly varying periodic function or the converse then a Fourier transform may be what is needed.</p>
</section>
<section id="filtering-and-apodising">
<h2>10.2 Filtering and apodising<a class="headerlink" href="#filtering-and-apodising" title="Permalink to this headline">#</a></h2>
<p>To filter the data first transform it, then remove some of the frequencies with a filter function. This filter will probably have to be chosen by hand, and will involve some trial and error. Finally, reverse the transform to obtain the smoothed data. There are a number of functions that can be used as filters; they are designed to extract the data and not to add unwanted frequencies back into it after the calculation. Filtering is similar to apodising the data. Apodising means multiplying the signal by an exponential, Gaussian, or other function, before transforming. The apodising filters are designed to remove extra oscillations at the foot of the signal, hence their name, but they do have the effect of broadening any features. The Connes filter is commonly used in FTIR spectroscopy; it has the form <span class="math notranslate nohighlight">\((1 - (x - x_0)^2/a^2)^2\)</span> where <span class="math notranslate nohighlight">\(x = \nu/N\)</span> which ranges from 0 to 1, and <span class="math notranslate nohighlight">\(a\)</span> is a parameter that the user can vary to optimize the signal, and <span class="math notranslate nohighlight">\(x_0\)</span> is the position of the signal to be enhanced. This function looks very like the Gaussian bell-shaped curve. See Bracewell (1986) for several other filters.</p>
</section>
<section id="filtering-a-transform-to-remove-noise">
<h2>10.3 Filtering a transform to remove noise<a class="headerlink" href="#filtering-a-transform-to-remove-noise" title="Permalink to this headline">#</a></h2>
<p>The example of filtering described next uses a square filter function, but the method is quite general. It is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \text{ Transform }\to \text{ Filter }\to \text{ Inverse Transform }\]</div>
<p>In filtering, the data is transformed, this is then filtered, and finally this is reverse transformed to recover the filtered data. The target signal is a simple sinusoid buried in noise, and is <span class="math notranslate nohighlight">\(\cos(2\pi\omega_0 i)+\cos(2\pi\omega_1 i)\)</span> + rand(<span class="math notranslate nohighlight">\(-5,5\)</span> ), with <span class="math notranslate nohighlight">\(\omega_{0,1} = 50/n,30 /n\)</span> and where rand(<span class="math notranslate nohighlight">\(-5, 5\)</span>) is a uniformly distributed random number between <span class="math notranslate nohighlight">\(-5\)</span> and <span class="math notranslate nohighlight">\(5\)</span>, making the ‘noise’ from the random numbers rather large compared to the signal; <span class="math notranslate nohighlight">\(i\)</span> is the index number ranging from <span class="math notranslate nohighlight">\(1 \to n = 2^{10} = 1024\)</span>. The signal is so noisy that the casual observer might question whether it is anything but noise; Fig. 46. The Fourier transform immediately shows two frequencies and indicates that there is more that a single sine wave present; its frequency can be measured easily, but in most real experiments, the signal could be more complex so the data is filtered, then inverse transformed, to get at the true signal.</p>
<p><img alt="Drawing" src="../_images/fourier-fig46.png" /></p>
<p>Figure 46. Noisy data (left) (with the underlying double cosine superimposed in red) and its Fourier transform (right) illustrating the frequencies hidden in noise can be identified. Only the first part of each data set is shown.</p>
<hr class="docutils" />
<p>The vertical lines on the Fourier transform, fig 46, show the regions selected and figure 47 the recovered signal and for comparison the original one used to generate the data but without noise. In generating the filter all values are set to zero except inside the two regions illustrated. (If it is known that the transform cannot be negative then negative values in the filter can be set to zero before inverse transforming.) If the whole of the data between the outer vertical dotted lines is transformed then the quality of the recovered data is poorer because list of intermediate values are included which add noise, (as sine waves of different frequencies) to the recovered signal.</p>
<p><img alt="Drawing" src="../_images/fourier-fig47.png" />
Figure 47. Reconstructed data obtained by filtering the Fourier transform and reverse transforming. Because of the Shannon theorem, very few data points are needed to reconstruct this signal and are determined only by those between the dotted lines in fig 46 all the rest being zero.</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Due to random noise the figure produced may not be the same as in fig 46 or 47</span>

<span class="n">fig1</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">))</span>   <span class="c1"># calculate data in fig 46/47</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">10</span>
<span class="n">f01</span> <span class="o">=</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">50</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">30</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">f02</span><span class="o">=</span>  <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">50</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">30</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>

<span class="n">nu</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>

<span class="n">fft0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">f01</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f01</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f02</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;noisy signal&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span><span class="n">fft0</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.045</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.055</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.035</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;fourier transform&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">600</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Fourier-E_11_0.png" src="../_images/Fourier-E_11_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">[</span> <span class="n">fft0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">n</span> <span class="o">&gt;</span><span class="mf">0.045</span> <span class="ow">and</span> <span class="n">i</span><span class="o">/</span><span class="n">n</span> <span class="o">&lt;</span><span class="mf">0.055</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">n</span> <span class="o">&gt;</span><span class="mf">0.025</span> <span class="ow">and</span> <span class="n">i</span><span class="o">/</span><span class="n">n</span> <span class="o">&lt;</span><span class="mf">0.035</span><span class="p">)</span>  <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">recover</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">recover</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;recovered&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f02</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recovered signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Fourier-E_12_0.png" src="../_images/Fourier-E_12_0.png" />
</div>
</div>
<p>The filter function above removes all but a few non-zero data points. This is only possible because the spikes in the transform are very sharp because each is a single frequency. If the signal were an exponential decay instead of a sine wave, then this Fourier method would perform very badly. The exponential is not periodic and is not described by single frequency but by a range of them in the form of a Lorentzian; in this and many other circumstances it is not easy to isolate the data from the noise. If Fourier and other smoothing methods fail then least squares fitting to a line or polynomial may be acceptable as a last resort.</p>
</section>
<section id="rolling-or-moving-average">
<h2>10.4 Rolling or moving average<a class="headerlink" href="#rolling-or-moving-average" title="Permalink to this headline">#</a></h2>
<p>This method is widely used in the financial sector to smooth out fluctuations in the price of stocks and shares in an attempt to predict trends, it is also used to predict trends in data such as the number of infections and deaths in pandemics such as due to Covid-9. It is also a particularly good method of removing unwanted noise spikes in experimental data. These are not part of the noise normally expected on data but occur nevertheless because someone switches on an instrument elsewhere in the lab or there is a glitch in the mains power and so forth. Such spikes can completely ruin data so some way of removing them is necessary. The moving average method starts at the beginning of the data, and averages over a small odd number of the next few data points and this average is recorded. This averaging ‘window’ is moved by one point along the data and the new average recorded and so on. This process weights in some future and past data into any point and so if a spike is preset it is averaged away by the normal data on either side of it, see Fig. 48.</p>
<p>The mid-point moving average is is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle s_i=\frac{1}{2n+1}\sum_{j=i-n}^{i+n} y_j \]</div>
<p>where <span class="math notranslate nohighlight">\(2n + 1\)</span> is the width of the data window and <span class="math notranslate nohighlight">\(i\)</span> runs along the data starting at point <span class="math notranslate nohighlight">\(n\)</span> and ending <span class="math notranslate nohighlight">\(n - 1\)</span> points from the end.</p>
<p><img alt="Drawing" src="../_images/fourier-fig48a.png" /></p>
<p>The method can be made into a recursive algorithm where the updating equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle s_i = s_{i-1} + \frac{y(i+n) - y(i-n-1)}{2n + 1}\]</div>
<p>where the first point has to be explicitly calculated. The recursion works by considering the window at adjacent positions, subtracting the value that has just left the window and adding the one just entered. Although this method is not a Fourier method, it can be considered as a convolution of the data with a kernel function, which is a rectangular pulse with each of its <span class="math notranslate nohighlight">\(m\)</span> points of size <span class="math notranslate nohighlight">\(1/m\)</span>.</p>
<p><img alt="Drawing" src="../_images/fourier-fig48.png" /></p>
<p>Figure 48 . Left. Illustrating the moving averaging smoothing to remove spikes in noise. A filter with <span class="math notranslate nohighlight">\(n\)</span> = 3 was used which is a window of 7 points.  The original data is grey, the smoothed data, red. Right.  Daily deaths  due to Covid19 in the USA for a few weeks after March 4, 2020. The original data is grey, the rolling average data, red. A 5 day average was used.</p>
</section>
<hr class="docutils" />
<section id="the-hilbert-transform-and-the-analytic-signal">
<h2>10.5 The Hilbert Transform and the Analytic Signal<a class="headerlink" href="#the-hilbert-transform-and-the-analytic-signal" title="Permalink to this headline">#</a></h2>
<p>In some cases it is desirable to find the envelope of a signal, such as an FID or that of a pulse such as figure 35 in question 16. To do this the Hilbert transform is needed and with it the <em>analytic signal</em>. The analytic signal is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle s_A(t) = x(t) + iH\big(x(t)\big)\]</div>
<p>where <span class="math notranslate nohighlight">\(H(t)\)</span> is the Hilbert transform and <span class="math notranslate nohighlight">\(i=\sqrt{-1}\)</span>. If the function describing a time varying signal is <span class="math notranslate nohighlight">\(x(t)\)</span> and could be, for example, <span class="math notranslate nohighlight">\(\sin(2\pi t)e^{-at^2}\)</span>. This analytic function has the form of a complex number e.g. <span class="math notranslate nohighlight">\((a+ib)\)</span> and therefore can also be recast in a polar form as amplitude <span class="math notranslate nohighlight">\(a(t)\)</span> with an exponential phase part, in which case,</p>
<div class="math notranslate nohighlight">
\[\displaystyle s_A(t)=a(t)e^{i\theta(t)},\qquad a(t)=\sqrt{x(t)^2+ H\big(x(t)\big)^2}, \qquad \theta=\tan^{-1}\left(\frac{H\big(x(t)\big)}{x(t)}\right)\]</div>
<p>The envelope of the oscillating signal <span class="math notranslate nohighlight">\(V\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle V=\sqrt{x(t)^2+Re(iH\big(x(t)\big)^2}\]</div>
<p>and this is also the absolute value of the Hilbert transform or <span class="math notranslate nohighlight">\(|H\big(x(t)\big)|\)</span>. It is important to note that if the data <span class="math notranslate nohighlight">\(x(t)\)</span> does not have any offset/baseline removed the envelope will oscillate just as the original signal does rather than being a smooth function.</p>
<p>The Hilbert transform has the effect of changing the phase of a sinusoidal signal by <span class="math notranslate nohighlight">\(\pi/2\)</span> thus <span class="math notranslate nohighlight">\(\sin \leftrightharpoons \cos\)</span>. Formally it is</p>
<div class="math notranslate nohighlight">
\[\displaystyle H(t)=\frac{1}{\pi}\int_{-\infty}^\infty \frac{x(k)}{t-k}dk\]</div>
<p>and some transforms are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}
\hline
x(t) &amp; &amp;  H \\
\hline
\sin(\omega t)&amp; \to &amp; \sin(\omega t\pm\pi/2)&amp;  (\mathrm{- if\; \omega &gt;0\; else\;+})\\
\cos(\omega t)&amp; \to &amp; \cos(\omega t\pm\pi/2)&amp;  (\mathrm{- if\; \omega &gt;0\; else\;+})\\
e^{i\omega t}&amp; \to &amp; e^{i\omega t}e^{\pm\pi/2}&amp;  (\mathrm{- if\; \omega &gt;0\; else\;+})\\
\delta(t) &amp; \to &amp;\displaystyle  \frac{1}{\pi t}\\
\hline \end{array}\end{split}\]</div>
<p>The effect of forming the analytic signal is to remove negative frequencies. To understand how this happens suppose that <span class="math notranslate nohighlight">\(x=2\cos(\omega t)\)</span>. Rewriting this as exponentials using Euler’s equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle x=2\cos(\omega t)=e^{i\omega t}+e^{-i\omega t}\]</div>
<p>applying the Hilbert transform from the table above produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle H(t) = e^{i\omega t}e^{-i\pi/2}+e^{-i\omega t}e^{+i\pi/2}= -ie^{i\omega t}+ie^{-i\omega t}=2\sin(\omega t)\]</div>
<p>where the identity <span class="math notranslate nohighlight">\(e^{\pm i\pi/2}=\pm i\)</span> was used after the first step.</p>
<p>The analytic signal is then</p>
<div class="math notranslate nohighlight">
\[\displaystyle  x_A=x(t)+iH(t)=2\cos(\omega t)+2i\sin(\omega t)=2e^{i\omega t}\]</div>
<p>and the negative frequencies are lost.</p>
<p>In practice when we analyse an experimental signal the Hilbert transform has to be performed numerically. In this case the process can be split into three steps.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(a)</strong> Calculate the fourier transform (FFT) of the signal.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(b)</strong> Multiply positive frequencies by <span class="math notranslate nohighlight">\(-i\)</span>, negative by <span class="math notranslate nohighlight">\(i\)</span> and make <span class="math notranslate nohighlight">\(f(0)=1\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(c)</strong> Calculate the inverse fourier transform.</p>
<p>Step (b) effectively maps the negative frequencies  onto the positive ones so simply doubles the positive signal.</p>
<p>The python code to do this is shown below. The function is that used in question 16, <span class="math notranslate nohighlight">\(x(t)=\cos(\omega t/a)e^{-(t/a)^2/2}\)</span> with <span class="math notranslate nohighlight">\(a=5,\;\omega=10\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">aHilbert</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  <span class="c1"># Calculate Hilbert Transform</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>                 <span class="c1"># forwards FFT</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>        <span class="c1"># doubles positive frequencies (// is integer division)</span>
    <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">fx</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>              <span class="c1"># back FFT</span>
    <span class="k">return</span> <span class="n">H</span>
<span class="c1">#---------------------------</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>                                  <span class="c1"># number of data popints </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="n">w</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span> <span class="n">t</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>   <span class="c1"># function</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">aHilbert</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                          <span class="c1"># Hilbert transform real + imag parts </span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>                            <span class="c1"># envelope  </span>
<span class="n">xA</span><span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>                      <span class="c1"># analytic signal </span>

<span class="c1"># plot t vs V to see envelope, t vs x to see function.</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="Drawing" src="../_images/fourier-fig48c.png" /></p>
<p>Figure 48b. Left. The function <span class="math notranslate nohighlight">\(x(t)=\cos(\omega t/a)e^{-(t/a)^2/2}\)</span> with <span class="math notranslate nohighlight">\(a=5,\;\omega=10\)</span> and its envelope function <span class="math notranslate nohighlight">\(V=|H(x(t))|\)</span>  (red). The same function is shown in the middle panel, together  with the analytical signal <span class="math notranslate nohighlight">\(x_A\)</span>, and, right, are shown the real and imaginary parts of the Hilbert transform of <span class="math notranslate nohighlight">\(x(t)\)</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-9"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Fourier-questions-16-21.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 16 - 21</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Fourier-F.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">11 The Hadamard Transform: Encoding and Decoding</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2024.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>