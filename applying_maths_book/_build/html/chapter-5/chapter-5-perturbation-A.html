
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Perturbation Theory &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 45 - 48" href="chapter-5-perturbation-B-Q45-48.html" />
    <link rel="prev" title="Questions 35 - 44" href="chapter-5-G-Q35-44.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1. Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     Differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4 Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     Integration by substitution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     Using parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     Multiple integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-A.html">
     Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-E.html">
     Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-perturbation-C.html">
     Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     Solving equations using matrices. Eigenvectors &amp; Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     Principal axes for Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     First order eqns &amp; Integrating factors. Second order eqns, Newtons laws, equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     Partial Differential Equations, PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     PDE Continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     Monte - Carlo Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     Solving rate equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     Modelling data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter-1/chapter1-E.html">
   SI units, Rounding, converting units &amp; Glossary.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/References.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/Python%20crib.html">
   Appendix:  Some basic Python instructions with a few examples.
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-5/chapter-5-perturbation-A.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-5/chapter-5-perturbation-A.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-5/chapter-5-perturbation-A.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-5/chapter-5-perturbation-A.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perturbations">
   8 Perturbations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formal-derivation">
   8.1 Formal derivation.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-order-correction-to-the-energy">
     <strong>
      First order correction to the energy
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-wavefunctions">
     <strong>
      New wavefunctions
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perturbation-calculation-of-energy-of-a-particle-in-a-sloping-box">
   8.2 Perturbation calculation of energy of a particle in a sloping box.
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Perturbation Theory</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perturbations">
   8 Perturbations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formal-derivation">
   8.1 Formal derivation.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-order-correction-to-the-energy">
     <strong>
      First order correction to the energy
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-wavefunctions">
     <strong>
      New wavefunctions
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perturbation-calculation-of-energy-of-a-particle-in-a-sloping-box">
   8.2 Perturbation calculation of energy of a particle in a sloping box.
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="perturbation-theory">
<h1>Perturbation Theory<a class="headerlink" href="#perturbation-theory" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="n">init_printing</span><span class="p">()</span>                      <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<section id="perturbations">
<h2>8 Perturbations<a class="headerlink" href="#perturbations" title="Permalink to this headline">#</a></h2>
<p>Solving the Schroedinger for the energy levels of a molecule, using a model such as a harmonic oscillator or rigid rotor, allows us to predict the spectrum. These spectral lines may, however, only be close to the experimental values not exactly matching them because of small unsuspected interactions. To investigate how to improve our model to better understand the data, changes to the potential energy are necessary. The harmonic oscillator, for example, has the Hamiltonian,</p>
<div class="math notranslate nohighlight">
\[\displaystyle H^0=-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}+\frac{k}{2}x^2\]</div>
<p>where the potential energy <span class="math notranslate nohighlight">\(\displaystyle V(x)= kx^2/2\)</span>. We might try to improve on this, perhaps by adding cubic or quartic terms, such as <span class="math notranslate nohighlight">\(ax^3 + bx^4\)</span>, to describe the effect of the bond stretching. Similarly, we might consider adding terms in <span class="math notranslate nohighlight">\(J^4\)</span> to the rigid rotor model to allow for centrifugal distortion during rotation. Alternatively, the harmonic potential model may be satisfactory, but the experiments report on the effects of small changes to the spectrum caused by external electric or magnetic fields. In this case, if the electric field <span class="math notranslate nohighlight">\(E\)</span> is along the <em>x</em>-axis a term <span class="math notranslate nohighlight">\(E ex\)</span> could be added to the Hamiltonian to allow for this. The use of perturbation theory allows for the incorporation of these and many other small potential energy terms to extend our knowledge a little into unfamiliar territory by using what is already known as a starting point.</p>
<p>Our aim is to be able to express the perturbed energy levels <span class="math notranslate nohighlight">\(E_n\)</span> in terms of the unperturbed energies <span class="math notranslate nohighlight">\(E_n^0\)</span> and their wavefunctions <span class="math notranslate nohighlight">\(\psi _n^0\)</span> both of which are assumed to be known from solving <span class="math notranslate nohighlight">\(H^0\psi^0 = E^0\psi^0\)</span>.</p>
</section>
<section id="formal-derivation">
<h2>8.1 Formal derivation.<a class="headerlink" href="#formal-derivation" title="Permalink to this headline">#</a></h2>
<p>First, the formal derivation is presented in most of the important details and the rather simple results, equations (41) and (43), that describe the changes in energy and wavefunctions are produced. These equations are then applied to some examples. If you want to try the problems and are not interested in the derivation details, then these equations are the results you will need.</p>
<p>The Schroedinger equation whose solutions are known, is defined as,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  H^0\psi_n^0 = E_n^0\psi_n^0   \tag{31}\]</div>
<p>The superscript 0 indicate that the wavefunctions and energies are known for every quantum number <span class="math notranslate nohighlight">\(n\)</span> = 0, 1, 2, <span class="math notranslate nohighlight">\(\cdots\)</span>. Later on we use the notation <span class="math notranslate nohighlight">\(\psi^{(2)}\)</span> etc., explained further below, in which the brackets indicate the second derivative not the square. However when the supescript is zero we do not add brackets as it is unambiguous.</p>
<p>The wavefunctions form an <em>orthonormal set</em> so that</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \psi^{0*}_n\psi_m^0 d\tau = \delta_{nm}  \tag{32}\]</div>
<p>and formally the equation is solved by left multiplying equation (31) by a wavefunction
and integrating. The result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \psi^{0*}_nH^0\psi_m^0 d\tau =E_n^0\int \psi_n^{0*}\psi_m^0 d\tau = \delta_{nm}E_n^0  \tag{33}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_{nm}\)</span> is the Kronecker delta function which is zero unless <span class="math notranslate nohighlight">\(n = m\)</span> when it is unity. (Note that <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span> are both dummy indices labelling energy levels, it does not matter if they are exchanged; i.e. equation (31) could be labelled with <span class="math notranslate nohighlight">\(m\)</span>’s rather than <span class="math notranslate nohighlight">\(n\)</span>’s.)</p>
<p>An extra potential term is now added to the Hamiltonian operator, changing it from <span class="math notranslate nohighlight">\(\displaystyle H^0=-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}+V(x)\)</span>, whose solution is known to,</p>
<div class="math notranslate nohighlight">
\[\displaystyle H=H^0+\lambda V\]</div>
<p>whose solution is sought. It is assumed that the potential term <span class="math notranslate nohighlight">\(V \ll V_0\)</span> produces only a small perturbation to the system. The parameter <span class="math notranslate nohighlight">\(\lambda\)</span> is a dimensionless coefficient that is allowed to vary from zero, which is no perturbation, to one, the full perturbation. It is not necessary to know what <span class="math notranslate nohighlight">\(\lambda\)</span> is; it is only as a way of reaching an answer. To make the calculation simpler, the energy levels <span class="math notranslate nohighlight">\(E_n^0\)</span> are always assumed to be non-degenerate. Degenerate levels can be dealt with in a similar manner; see Atkins &amp; Friedmann (1997),</p>
<p>The perturbed Schroedinger equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  H\varphi_n = E_n\varphi_n \quad \mathrm{ or } \quad \left(H^0 + \lambda V\right)=\varphi_n=E_n\varphi_n  \tag{35}\]</div>
<p>where all the new wavefunctions <span class="math notranslate nohighlight">\(\varphi_n\)</span> and energies <span class="math notranslate nohighlight">\(E_n\)</span> are unknown so far. Both the wavefunction <span class="math notranslate nohighlight">\(\varphi\)</span> and energy are functions of the parameter <span class="math notranslate nohighlight">\(\lambda\)</span>. Our aim is to be able to express the perturbed energy levels <span class="math notranslate nohighlight">\(E_n\)</span> in terms of the unperturbed energies <span class="math notranslate nohighlight">\(E_n^0\)</span> and their wavefunctions <span class="math notranslate nohighlight">\(\psi_n^0\)</span> both of which are already known.
The assumption is now made that perturbed energies and wavefunctions can be expanded as Taylor series in <span class="math notranslate nohighlight">\(\lambda\)</span>; see equation (15). This assumption is justified by the validity of the final result. Expanding <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(\varphi\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_n = E_n\mid_{\lambda = 0} + \lambda \left[\frac{dE_n}{d\lambda} \right]_{\lambda = 0} +\frac{\lambda^2}{2!} \left[\frac{d^2E_n}{d\lambda^2} \right]_{\lambda = 0}+ \cdots \]</div>
<div class="math notranslate nohighlight">
\[\displaystyle \varphi_n = \varphi_n\mid_{\lambda = 0} + \lambda \left[\frac{d\varphi_n}{d\lambda} \right]_{\lambda = 0} +\frac{\lambda^2}{2!} \left[\frac{d^2\varphi_n}{d\lambda^2} \right]_{\lambda = 0}+ \cdots \]</div>
<p>A new notation is now introduced to make the equations simpler to read,</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_n^{(j)} = \left[ \frac{1}{j!} \frac{d^jE_n}{d\lambda^j} \right]_{\lambda=0} \qquad \varphi _n^{(j)} = \left[ \frac{1}{j!} \frac{d^j\varphi_n}{d\lambda^j} \right]_{\lambda=0} \]</div>
<p>therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_n = E_n^0 + \lambda E_n^{(1)} + \lambda ^2E_n^{(2)} + \cdots  \tag{36} \]</div>
<div class="math notranslate nohighlight">
\[\displaystyle \varphi_n = \psi_n^0 + \lambda \varphi_n^{(1)} + \lambda^2\varphi_n^{(2)} + \cdots  \tag{37}\]</div>
<p>Notice that <span class="math notranslate nohighlight">\(E(0) \equiv E^0\)</span> is the unperturbed energy and <span class="math notranslate nohighlight">\(\varphi(0) \equiv \psi^0\)</span> the unperturbed wave-
function. Next, <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(\varphi\)</span> are substituted into the perturbed Schroedinger equation (35) and an apparently very complicated equation results;</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\left(H^0+\lambda V\right)&amp;\left(\psi_n^0 + \lambda \varphi_n^{(1)} + \lambda^2\varphi_n^{(2)} + \cdots\right)\\&amp;=\left(E_n^0 + \lambda E_n^{(1)} + \lambda ^2E_n^{(2)} + \cdots\right)\left(\psi_n^0 + \lambda \varphi_n^{(1)} + \lambda^2\varphi_n^{(2)} + \cdots\right) \qquad\qquad\qquad\text{(38a)}\end{align}\end{split}\]</div>
<p>However, grouping terms with similar powers of <span class="math notranslate nohighlight">\(\lambda\)</span> allows equation (38) to be rearranged in a far clearer way;</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}&amp;(H^0+E_n^0)\psi_n^0 +\\ &amp;\lambda \left[(V-E_n^{(1)})\psi_n^0 + (H^0-E_n^{(0)})\varphi_n^{(1)} \right] + \\ &amp;\lambda^2 \left[(V-E_n^{(1)})\varphi_n^{(1)} + (H^0-E_n^{(0)})\varphi_n^{(2)}\right ] + \lambda^3\left[\cdots\right]+\cdots  =0\end{align} \end{split}\]</div>
<p>The zeroth-order term is the initial unperturbed equation. Technically it is multiplied by <span class="math notranslate nohighlight">\(\lambda^0\)</span> (<span class="math notranslate nohighlight">\(\lambda\)</span> to power 0) but as this is <span class="math notranslate nohighlight">\(1\)</span>, it is not written explicitly.  When each term multiplied by <span class="math notranslate nohighlight">\(\lambda\)</span> is added together  the sum is zero and thus each term in square brackets is itself zero.</p>
<section id="first-order-correction-to-the-energy">
<h3><strong>First order correction to the energy</strong><a class="headerlink" href="#first-order-correction-to-the-energy" title="Permalink to this headline">#</a></h3>
<p>To obtain the first-order correction to the energy it is assumed that <span class="math notranslate nohighlight">\(\lambda^2\)</span> is smaller than <span class="math notranslate nohighlight">\(\lambda\)</span> and similarly for higher powers and therefore these can be ignored. The first-order energy correction is obtained by extracting just the terms in <span class="math notranslate nohighlight">\(\lambda\)</span> and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle   \left(V-E_n^{(1)}\right)\psi_n^0 + \left(H^0-E_n^{(0)}\right)\varphi_n^{(1)} =0 \tag{38b} \]</div>
<p>The perturbed energies <span class="math notranslate nohighlight">\(E_n^{(1)}\)</span> are calculated from this last equation by left multiplying it by the complex conjugate of <span class="math notranslate nohighlight">\(\psi_n^0\)</span> and integrating. This is what is always done to form the expectation value to calculate the energy, see equation (33) and recall that <span class="math notranslate nohighlight">\(H^0\)</span> is an operator and must always act on terms to its right. It cannot be removed from the integration as can the energy, which is a constant. Integrating as indicated produces the result</p>
<div class="math notranslate nohighlight">
\[\displaystyle   \int \psi_n^{0*}\left(V-E_n^{(1)}\right)\psi_n^0d\tau + \int \psi_n^{0*}\left(H^0-E_n^{(0)}\right)\varphi_n^{(1)}d\tau =0 \tag{38c}\]</div>
<p>Expanding the brackets gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \psi_n^{0*}V\psi_n^0d\tau- E_n^{(1)}\int \psi_n^{0*}\psi_n^0d\tau+\int \psi_n^{0*}H^0\varphi_n^{(1)}d\tau -E_n^{(0)}\int \psi_n^{0*}\varphi_n^{(1)}d\tau =0\]</div>
<p>Using the fact that the wavefunctions are orthogonal and normalized allows a little simplification to the second term giving</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \psi_n^{0*}V\psi_n^0d\tau- E_n^{(1)}+\int \psi_n^{0*}H^0\varphi_n^{(1)}d\tau -E_n^{(0)}\int \psi_n^{0*}\varphi_n^{(1)}d\tau =0  \tag{39}\]</div>
<p>At this point we can go no further because we do not know how to deal with the <span class="math notranslate nohighlight">\(\varphi_n^{(1)}\)</span> wavefunctions; they are unknown.</p>
<p>An important step is now taken and this is to expand the unknown wavefunctions <span class="math notranslate nohighlight">\(\varphi\)</span> in the <em>basis set of our original watefunctions</em> <span class="math notranslate nohighlight">\(\psi^0\)</span> because these are a complete orthonormal set; this is a standard mathematical procedure taken from a study of linear algebra and often used in quantum mechanics (see chapters 6 and 8). Using the basis set <span class="math notranslate nohighlight">\(\psi\)</span>, the wavefunctions <span class="math notranslate nohighlight">\(\varphi^{(1)}\)</span> are defined by, and expanded in, an infinite series as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \varphi_n^{(1)}=\sum\limits_k a_k\psi_k^0   \tag{40}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_k\)</span> are the expansion coefficients. These have to be calculated if the new wavefunction is required but do not enter into the final equation for the perturbed energy. By substitution for <span class="math notranslate nohighlight">\(\varphi\)</span> the integrals in equation (39) become expressible in known wavefunctions and coefficients <span class="math notranslate nohighlight">\(a\)</span>. The result is clearly going to be complicated but will simplify greatly if each term is examined separately. The complete equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \psi_n^{0*}V\psi_n^0d\tau- E_n^{(1)}+\int \psi_n^{0*}H^0\sum\limits_k a_k\psi_k^0d\tau -E_n^0\int \psi_n^{0*}\sum\limits_k a_k\psi_k^0d\tau =0 \]</div>
<p>Expanding out the third term produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \psi_n^{0*}H^0\sum\limits_k a_k\psi_k^0d\tau =\int \psi_n^{0*}H^0(a_1\psi_1^0+a_2\psi_2^0 +\cdots +a_n\psi_n^0+\cdots)d\tau\]</div>
<p>However, because the <span class="math notranslate nohighlight">\(\psi\)</span>’s are orthonormal (equation (32)), only the <span class="math notranslate nohighlight">\(n\)</span><sup>th</sup> term remains after integration and all the others are zero. An individual <span class="math notranslate nohighlight">\(n\)</span> to <span class="math notranslate nohighlight">\(k\)</span> integral is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\psi_n^{0*}H^0\psi_k^0d\tau = E_n^0\int\psi_n^{0*}\psi_k^0d\tau =\delta_{kn}E_n^0    \tag{40a}\]</div>
<p>(see equation (33)); therefore only the term with index <span class="math notranslate nohighlight">\(n\)</span> remains producing <span class="math notranslate nohighlight">\(\displaystyle E_n^0 \int\psi_n^{0*} \psi_n^0 d\tau = E_n^0\)</span></p>
<p>Using the same procedure and arguments, the second of the two summations evaluates to <span class="math notranslate nohighlight">\(E_n^0\)</span> and therefore the sum of these two integrals is zero. The outcome is a simple and elegant equation for the first-order energy correction;</p>
<div class="math notranslate nohighlight">
\[\displaystyle  E_n^{(1)} = \int\psi_n^{0*}V\psi_n^0d\tau    \tag{41}\]</div>
<p>and the total energy is</p>
<div class="math notranslate nohighlight">
\[\displaystyle   E_n \approx E_n^0 + E_n^{(1)} = E_n^0 +  \int\psi_n^{0*}V\psi_n^0d\tau    \tag{42}\]</div>
<p>This equation tells us that to obtain the energy change to level <span class="math notranslate nohighlight">\(n\)</span> caused by the small perturbation <span class="math notranslate nohighlight">\(V\)</span>, only the wavefunctions belonging to quantum level <span class="math notranslate nohighlight">\(n\)</span> of the initial unperturbed Hamiltonian <span class="math notranslate nohighlight">\(H^0\)</span>, equation (31), need to be known. The energy change itself is the average of the perturbation potential <span class="math notranslate nohighlight">\(V\)</span> with the unperturbed wavefunctions.</p>
</section>
<section id="new-wavefunctions">
<h3><strong>New wavefunctions</strong><a class="headerlink" href="#new-wavefunctions" title="Permalink to this headline">#</a></h3>
<p>To calculate the correction to the wavefunction it is necessary to return to equation (38b) but this time left multiplying by <span class="math notranslate nohighlight">\(\psi_m^0\)</span> and integrating. ( <span class="math notranslate nohighlight">\(\,\psi_n^0\)</span> was used before) but now it is assumed that <span class="math notranslate nohighlight">\(m \ne n\)</span>.( When <span class="math notranslate nohighlight">\(n = m\)</span> the calculation follows that above). The equation becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle   \int \psi_m^{0*}(V-E_n^{(1)})\psi_n^0d\tau + \int \psi_m^{0*}(H^0-E_n^{(0)})\varphi_n^{(1)}d\tau =0 \tag{42b}\]</div>
<p>and substituting for <span class="math notranslate nohighlight">\(\varphi\)</span> from equations (40) and using (40a) and  <span class="math notranslate nohighlight">\(\int\psi_m^*\psi_nd\tau = \delta_{nm}\)</span> gives,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\psi_m^0V\psi_n^0d\tau - E_n^{(1)}\delta_{nm} + \sum\limits_k a_k(E_k^0-E_n^0)\delta_{mk} =0 \]</div>
<p>and in performing the sum only the <span class="math notranslate nohighlight">\(k=m\)</span> term survives;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\psi_m^0V\psi_n^0d\tau - E_n^{(1)}\delta_{nm} + a_m(E_m^0-E_n^0) =0 \]</div>
<p>As <span class="math notranslate nohighlight">\(n \ne m\)</span> the equation becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\psi_m^0V\psi_n^0d\tau  + a_m(E_m^0-E_n^0) =0 \]</div>
<p>which gives the coefficients <span class="math notranslate nohighlight">\(a\)</span> and therefore the <em>perturbed</em> part of the wavefunction for the <span class="math notranslate nohighlight">\(n^{th}\)</span> level is,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \varphi_n^{(1)}=\sum\limits_{n \ne k} a_k\psi_k^0 = \sum\limits_{n \ne k} \frac{\int\psi_k^{0*}V\psi_n^0d\tau}{E_n^0-E_k^0}\psi_k^0  \tag{43}\]</div>
<p>The correction to wavefunctions for each level are the summation of the basis set wavefunctions <span class="math notranslate nohighlight">\(\psi_0\)</span> weighted by the ratio of the perturbed energy to energy gap. The  wavefunction to first order is <span class="math notranslate nohighlight">\(\displaystyle \varphi_n \approx \varphi_n^{(0)}+ \varphi_n^{(1)} =\psi_n^0+ \varphi_n^{(1)}\)</span>. Notice also that <span class="math notranslate nohighlight">\(\varphi\)</span> is a function of coordinates, <span class="math notranslate nohighlight">\(\tau\)</span> in this example, in one dimension this would be <span class="math notranslate nohighlight">\(x\)</span> and that the <span class="math notranslate nohighlight">\(n = k\)</span> term is removed; otherwise this would lead to division by zero. The series forming <span class="math notranslate nohighlight">\(a\)</span> is then one of terms that are zero or progressively diminishing as the difference in energy of the <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(k\)</span> levels increases. Generally this means that <span class="math notranslate nohighlight">\(\varphi\)</span> does not differ greatly from <span class="math notranslate nohighlight">\(\psi\)</span>.</p>
<p>This result thus represents the correction to the wavefunction as a linear combination of the original ones with coefficients <span class="math notranslate nohighlight">\(a_k\)</span>, which are numbers, given by</p>
<div class="math notranslate nohighlight">
\[\displaystyle a_k=  \frac{\int\psi_k^{0*}V\psi_n^0d\tau}{E_n^0-E_k^0} = \frac{\langle \psi_k^0V\psi_n^0\rangle}{E_n^0-E_k^0}\]</div>
<p>where the right-hand expression is in bra-ket notation. Notice that the conjugate is not indicated, it is assumed by virtue of being on the left of the expression. The integration limits are not included either because they depend on the problem but for a harmonic oscillator they would be <span class="math notranslate nohighlight">\(\pm \infty\)</span>. The size of the coefficient belonging to a level <span class="math notranslate nohighlight">\(n\)</span> is inversely proportional to how far away in energy every other level (index <span class="math notranslate nohighlight">\(k\)</span>) is. Clearly the closer in energy level <span class="math notranslate nohighlight">\(k\)</span> is to level <span class="math notranslate nohighlight">\(n\)</span> the bigger the effect it has primarily due to the reciprocal energy difference; if this is small the coefficient will be large and vice versa. Equation (43) shows how the new potential effectively mixes the original wavefunctions <span class="math notranslate nohighlight">\(\psi\)</span> to produce the new ones. Notice that this equation produces the correction to the wavefunction and <span class="math notranslate nohighlight">\(\psi_n^0\)</span> has to be added to obtain the perturbed wavefunction. The next figure sketches how energy levels are changed by the interaction potential energy <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p><img alt="Drawing" src="../_images/series-fig11.png" /></p>
<p>Figure 11. The perturbation <span class="math notranslate nohighlight">\(V\)</span> alters the energy levels. The exact amount depends on how <span class="math notranslate nohighlight">\(V\)</span> changes.</p>
<hr class="docutils" />
<p>Because the wavefunctions <span class="math notranslate nohighlight">\(\psi^0\)</span> form an orthonornmal set, consecutive wavefunctions  have opposite (odd/even) parity and this means that <span class="math notranslate nohighlight">\(\displaystyle \int\psi_k^{0*}V\psi_n^0d\tau\)</span> may be identically zero for different combinations of quantum numbers depending on the symmetry of <span class="math notranslate nohighlight">\(V\)</span>. For example, if <span class="math notranslate nohighlight">\(V\)</span> is odd ( meaning that <span class="math notranslate nohighlight">\(V(-x)=-V(x)\)</span> ) then <span class="math notranslate nohighlight">\(\displaystyle \int\psi_k^{0*}V\psi_n^0d\tau\)</span> will be zero when <span class="math notranslate nohighlight">\(\psi_k\)</span> and <span class="math notranslate nohighlight">\(\psi_n\)</span> have the same symmetry, i.e. when <span class="math notranslate nohighlight">\(k=n\pm 1\)</span>. It will be the opposite way round if <span class="math notranslate nohighlight">\(V\)</span> is even which is when <span class="math notranslate nohighlight">\(V(-x)=V(x)\)</span>.</p>
<p>The calculation can be repeated for the second-order perturbation and so on; the general observation is that if the wavefunction to order <span class="math notranslate nohighlight">\(m\)</span> is known then the energy to order 2<span class="math notranslate nohighlight">\(m\)</span> +1 can be calculated. The zeroth-order states <span class="math notranslate nohighlight">\(\psi_0\)</span> therefore allow us to find the first order energy correction and so forth. Extending the calculation to second order produces the energy correction, (see Atkins &amp; Friedmann 1997 for details),</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_n^{(2)}=\sum\limits_{n\ne k}\frac{|\langle \psi_k^0|V|\psi_n^0  \rangle |^2}{E_n^0 - E_k^0}   \tag{44}\]</div>
<p>This term is usually negative for the lowest energy because the energy for quantum numbers larger than <span class="math notranslate nohighlight">\(n\)</span> is usually greater than that for <span class="math notranslate nohighlight">\(n\)</span> itself. The total energy to second order is therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_n = E_n^0 + E_n^{(1)} + E_n^{(2)} \tag{45}\]</div>
<p>When calculating the perturbed energy how do we know that our calculation is valid? The potential added <span class="math notranslate nohighlight">\(V\)</span> might be too big for this method to work. Fortunately, this has also been worked out; the result is that the expectation values divided by the energy gap must be much less that 1. This means checking terms with indices <span class="math notranslate nohighlight">\(k = n \pm 1\)</span> because the denominator is usually smallest in this case. The limiting condition for our victim state <span class="math notranslate nohighlight">\(n\)</span> is thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle \left | \frac{\langle \psi_k^0|V|\psi_n^0  \rangle }{E_n^0 - E_k^0} \right | \ll 1  \tag{46}\]</div>
<p>for each of the nearby states <span class="math notranslate nohighlight">\(k\)</span> where <span class="math notranslate nohighlight">\(k \ne n\)</span>.</p>
</section>
</section>
<section id="perturbation-calculation-of-energy-of-a-particle-in-a-sloping-box">
<h2>8.2 Perturbation calculation of energy of a particle in a sloping box.<a class="headerlink" href="#perturbation-calculation-of-energy-of-a-particle-in-a-sloping-box" title="Permalink to this headline">#</a></h2>
<p>Consider now a particle in a one-dimensional box that is subjected to a small linear potential ramp; the potential is <span class="math notranslate nohighlight">\(bx\)</span> where <span class="math notranslate nohighlight">\(b\)</span> is a constant. Such a model might represent an electron in a deep quantum well experiencing an applied electric field. Using the perturbation method, the first-order correction to the energies and wavefunctions will be calculated. The validity of the result will also be checked according to equation (46), and finally the second-order correction to the lowest energy level will be found.</p>
<p>If the box has length <span class="math notranslate nohighlight">\(L\)</span>, the normalized wavefunctions are <span class="math notranslate nohighlight">\(\displaystyle \psi_n(x)=\sqrt{\frac{2}{L}}\sin(n\pi \frac{x}{L})\)</span>
where <span class="math notranslate nohighlight">\(n\)</span> = 1, 2, 3, <span class="math notranslate nohighlight">\(\cdots\)</span> and the perturbation is <span class="math notranslate nohighlight">\(bx\)</span>, which is zero at the left edge of the box. To calculate actual values and wavefunctions we will assume that <span class="math notranslate nohighlight">\(b=3E_1^0/(4L)\)</span> where <span class="math notranslate nohighlight">\(E_1^0\)</span> lowest energy level of the unperturbed box because this gives reasonable results.</p>
<p>To start the calculation, the unperturbed energy levels of the particle in a box are found by using the Schroedinger equation with a zero potential <span class="math notranslate nohighlight">\(V_0\)</span> = 0, the equation is then</p>
<div class="math notranslate nohighlight">
\[\displaystyle -\frac{\hbar^2}{2m}\frac{d^2\psi_n(x)}{dx^2} = E_n\psi_n(x)\]</div>
<p>Multiplying both sides by the wavefunction, and integrating, produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle -\frac{\hbar^2}{2m}\int\limits_0^L \psi_n(x)\frac{d^2\psi_n(x)}{dx^2}dx =E_n\int\limits_0^L\psi_n(x)\psi_n(x)dx\]</div>
<p>The complex conjugate is not indicated because the wavefunctions are real. The wavefunctions are normalized so that <span class="math notranslate nohighlight">\(\displaystyle \int \psi_n(x)\psi_n(x)dx\)</span> = 1 and the unperturbed energies after substituting for the wavefunctions and performing the differentiation and integration are</p>
<div class="math notranslate nohighlight">
\[\displaystyle  E_n =\frac{\hbar^2}{mL}\frac{(n\pi)^2}{L^2}\int\limits_0^L \sin\left(n\pi\frac{ x}{L}\right)^2dx= \frac{\hbar^2}{2m}\left(\frac{n\pi}{L}\right)^2  \tag{47}\]</div>
<p>If the mass is that of the electron and the box has a length of <span class="math notranslate nohighlight">\(1\)</span> nm, the energies of the levels with quantum number <span class="math notranslate nohighlight">\(n\)</span> are <span class="math notranslate nohighlight">\(6.023 \cdot 10^{-20} n^2\)</span>  J or <span class="math notranslate nohighlight">\(3032 n^2\,\mathrm{ cm^{-1}}\)</span>.</p>
<p>The sloping potential increases linearly across the box and has the value <span class="math notranslate nohighlight">\(V = bx\)</span>. Using equation (41) the energy change to first order of the <span class="math notranslate nohighlight">\(n^{th}\)</span> level is</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_m^{(1)} = \frac{2}{L}\int\limits_0^L \sin\left(n\pi\frac{ x}{L}\right)V(x)\sin\left(n\pi\frac{ x}{L}\right)dx = \frac{bL}{2}\]</div>
<p>The result is that the energy shift to first order <span class="math notranslate nohighlight">\(E_1^{(1)} = bL/2\)</span>, is half the final value of the applied potential, which makes sense as this is the average value. Furthermore, it is independent of the quantum number <span class="math notranslate nohighlight">\(n\)</span>, which will not necessarily be true for other potentials; for example if the potential was <span class="math notranslate nohighlight">\(bx^2\)</span> the first-order shift would depend on the quantum number.</p>
<p>Using the values for the constant <span class="math notranslate nohighlight">\(b=3E_1^0/4L\)</span> the energy shift is <span class="math notranslate nohighlight">\(2.258 \cdot 10^{-20}\)</span> J or <span class="math notranslate nohighlight">\(\approx 1136\, \mathrm{cm^{-1}}\)</span>,  the first, unperturbed, level is at an energy of <span class="math notranslate nohighlight">\(3032 \,\mathrm{cm^{-1}}\)</span>, so the shift is substantial. The validity of the calculation is seen in the first graph, where <span class="math notranslate nohighlight">\(|a_k| \lt 1\)</span> as required by eqn. 46.</p>
<p><img alt="Drawing" src="../_images/series-fig12.png" /></p>
<p>Figure 12. Square well on a linear potential.</p>
<hr class="docutils" />
<p>The main correction <span class="math notranslate nohighlight">\(a_k\)</span> terms to the basic (unperturbed) wavefunction has the same parity as the unperturbed wavefunction. The correction to <span class="math notranslate nohighlight">\(n\)</span> = 1 is mainly the <span class="math notranslate nohighlight">\(n\)</span> = 2 wavefunction scaled by the constant <span class="math notranslate nohighlight">\(a_k\)</span>, and this is not so surprising, the adjacent wavefunctions (above or below in energy, if any) have the biggest correcting effect due to the inverse dependence of the energy gap; equation (43). In the case of <span class="math notranslate nohighlight">\(n\)</span> = 4 then it is the third and fifth terms. It is also apparent that because of symmetry the <span class="math notranslate nohighlight">\(k = n\pm 2\)</span> correction terms are zero.</p>
<p>The second-order energy correction to the lowest level is given by equation (44), which has the relatively small value of <span class="math notranslate nohighlight">\(-3.664 \cdot 10^{-22}\)</span> J or <span class="math notranslate nohighlight">\(-18.44\, \mathrm{cm^{-1}}\)</span>. The next and each term where <span class="math notranslate nohighlight">\(k\)</span> is odd is zero. The term with <span class="math notranslate nohighlight">\(k\)</span> = 4 is also negative and far smaller (<span class="math notranslate nohighlight">\(-0.02\,\mathrm{ cm^{-1}}\)</span>) than that with <span class="math notranslate nohighlight">\(k = 2\)</span>.</p>
<p>To check on the validity the calculation the condition of equation (46) can be checked using the values of the <span class="math notranslate nohighlight">\(a\)</span> coefficients. The first level <span class="math notranslate nohighlight">\(n\)</span> = 1 has 0.045 as its first and largest <span class="math notranslate nohighlight">\(a\)</span> value, the second level, has <span class="math notranslate nohighlight">\(a\)</span> = 0.029 and -0.045 as the largest two values so all of these satisfy the condition in equation (46) since the difference in energy levels <span class="math notranslate nohighlight">\(E_n-E_k\)</span> is far greater than 1.</p>
<p>In the particular case of a linear perturbation the integrals can be integrated algebraically, but as this is not the general case the code below performs the integrals numerically using numpy’s ‘quad’ function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># perturbation calculation &#39;Particle in a Box&#39;    (This code can be modified to use in question 45) </span>

<span class="n">fig1</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">hbar</span><span class="o">=</span> <span class="mf">6.62607e-34</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>    <span class="c1"># J s </span>
<span class="n">mu</span>  <span class="o">=</span> <span class="mf">9.10938e-31</span>  <span class="c1"># mass electron kg</span>
<span class="n">L</span>   <span class="o">=</span> <span class="mf">1e-9</span>         <span class="c1"># box length m</span>
<span class="n">sc</span>  <span class="o">=</span> <span class="mf">5.03e22</span>      <span class="c1"># convert J /molec to wavenumbers</span>
<span class="n">nm</span>  <span class="o">=</span> <span class="mf">1e-9</span>         <span class="c1"># nanometres</span>
<span class="n">numn</span><span class="o">=</span> <span class="mi">6</span>            <span class="c1"># maximum quantum number n</span>
<span class="n">numk</span><span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">numn</span>       <span class="c1"># maximum k</span>
<span class="n">x0</span>  <span class="o">=</span> <span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mf">2.0</span>       <span class="c1"># left side of box</span>
<span class="n">xm</span>  <span class="o">=</span>  <span class="n">L</span><span class="o">/</span><span class="mf">2.0</span>       <span class="c1"># right side of box</span>

<span class="n">E0</span> <span class="o">=</span>  <span class="p">[(</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">hbar</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numn</span><span class="o">+</span><span class="n">numk</span><span class="p">)]</span>    <span class="c1"># energy levels in Joule</span>
        
<span class="n">V</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">3.0</span><span class="o">*</span><span class="n">E0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span>                        <span class="c1"># perturbing potential</span>
<span class="c1">#V = lambda x : 0.25*x**2                                       # potential for question 45</span>

<span class="n">psi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">n</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">L</span> <span class="p">)</span>  <span class="c1"># wavefunction psi^0(n)</span>
<span class="n">func</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">:</span> <span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">V</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>                      <span class="c1"># function psi V psi to integrate from 0 to L</span>

<span class="c1"># calculate from below to above level n </span>

<span class="n">Vbar</span> <span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="o">+</span><span class="n">numn</span><span class="p">)]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numn</span><span class="p">)]</span>  <span class="c1"># average V, int(psi.V.psi) index is Vbar[n][k]  hold data n=0,1.. k -0,1...</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numn</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="n">numk</span><span class="p">):</span>
            <span class="n">Vbar</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xm</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>  <span class="c1"># err is integration error which we ignore, limits 0 to L</span>
            <span class="c1">#print(n,k,Vbar[n][k]*sc)                         # print individual values</span>
    <span class="k">pass</span>

<span class="n">E1</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Vbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numn</span><span class="p">)</span> <span class="p">]</span>                      <span class="c1"># first order correction</span>

<span class="n">numx</span> <span class="o">=</span> <span class="mi">200</span>     <span class="c1"># number of data points</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xm</span><span class="p">,</span><span class="n">numx</span><span class="p">)</span>                                   <span class="c1"># make numx, x values in range 0 to L </span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="p">)]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numn</span><span class="p">)]</span>         <span class="c1"># coefficient A_k;   call as phi[n][k]</span>
<span class="n">a2</span><span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="p">)]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numn</span><span class="p">)]</span>         <span class="c1"># coefficients for E_n^(2) , i.e. 2nd order correction</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numn</span><span class="p">):</span>                                       <span class="c1"># calculate new wavefunction</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Vbar</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span> <span class="n">E0</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">E0</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">)</span>
            <span class="n">a2</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="n">Vbar</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="n">E0</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">E0</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">)</span>       <span class="c1"># term for 2nd order correction</span>
        <span class="k">pass</span>
    <span class="k">pass</span>
<span class="n">E2</span><span class="o">=</span> <span class="p">[</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a2</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="p">)]</span> <span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numn</span><span class="p">)]</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;List of energy and corrections due to 1st and 2nd order perturbation terms&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;n       E0          E1          E2      En (/wavenumber)&#39;</span><span class="p">))</span>  <span class="c1"># print energy level</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numn</span><span class="p">)</span> <span class="p">:</span>                                            
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:10.2f}</span><span class="s1">  </span><span class="si">{:10.2f}</span><span class="s1"> </span><span class="si">{:10.2f}</span><span class="s1">  </span><span class="si">{:10.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">E0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">E1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">E2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sc</span><span class="p">,(</span><span class="n">E0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span> <span class="n">E1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">E2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">sc</span><span class="p">)</span> <span class="p">)</span>

<span class="n">phi</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">:</span> <span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="p">)]</span> <span class="p">)</span>     <span class="c1"># perturbed wavefunction</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>                                                <span class="c1"># plot first 4 energy levels &amp; phi  </span>
    <span class="n">mx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>        <span class="c1"># make positive, just being pretty</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="o">-</span><span class="n">mx</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">E0</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">sc</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>                             <span class="c1"># original energy</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">((</span><span class="n">E0</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+</span><span class="n">E1</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">*</span><span class="n">sc</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>   <span class="c1"># perturbed</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">nm</span><span class="p">,(</span><span class="n">E0</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+</span><span class="n">E1</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">*</span><span class="n">sc</span> <span class="o">+</span> <span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">mx</span><span class="o">*</span><span class="mi">4000</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># 4000 is only to scale for viewing</span>
    <span class="k">pass</span>

<span class="n">nn</span> <span class="o">=</span> <span class="mi">3</span>                                       <span class="c1"># &gt;0 plot this  quantum number in a[nn][:]</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="p">)],(</span><span class="n">a</span><span class="p">[</span><span class="n">nn</span><span class="p">][:]))</span> <span class="c1"># bar plot values for |a_k| for midway energy level</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numk</span><span class="o">//</span><span class="mi">2</span><span class="p">)])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$index\; k$&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$a_k$&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;coefficients &#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$a_k$&#39;</span><span class="o">+</span><span class="s1">&#39; for n = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;, $n\ne k$&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">numk</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mxa</span><span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="n">nn</span><span class="p">][:])</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">mxa</span><span class="o">*</span><span class="mf">1.05</span><span class="p">,</span><span class="n">mxa</span><span class="o">*</span><span class="mf">1.05</span><span class="p">])</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">nm</span><span class="p">,</span><span class="n">V</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sc</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">x0</span><span class="o">/</span><span class="n">nm</span><span class="p">,</span><span class="n">xm</span><span class="o">/</span><span class="n">nm</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.25</span><span class="o">*</span><span class="n">sc</span><span class="o">*</span><span class="n">E0</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; x /nm&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Energy /cm^{-1}$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original &amp; perturbed energy levels(dashed)</span><span class="se">\n</span><span class="s1"> &amp; their wavefunctions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>List of energy and corrections due to 1st and 2nd order perturbation terms
n       E0          E1          E2      En (/wavenumber)
1    3030.41     1136.40     -18.46     4148.35
2   12121.64     1136.40       5.50    13263.54
3   27273.68     1136.40       3.28    28413.36
4   48486.54     1136.40       2.01    49624.95
5   75760.22     1136.40       1.33    76897.96
</pre></div>
</div>
<img alt="../_images/chapter-5-perturbation-A_6_1.png" src="../_images/chapter-5-perturbation-A_6_1.png" />
</div>
</div>
<p>Figure 13. Left Coefficients for the <span class="math notranslate nohighlight">\(n = 3\)</span> level and right, original energy levels (solid black), perturbed energies (blue dashed) and  wavefunctions for <span class="math notranslate nohighlight">\(n =0, 1, 2\)</span>. The green sloping line shows the perturbation.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="chapter-5-G-Q35-44.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 35 - 44</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="chapter-5-perturbation-B-Q45-48.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 45 - 48</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>