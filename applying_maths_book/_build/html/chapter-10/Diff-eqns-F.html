
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Partial Differential Equations, PDE &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PDE examples continued" href="Diff-eqns-G.html" />
    <link rel="prev" title="Linear equations with variable coefficients" href="Diff-eqns-E.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Applying Maths in the Chemical and Biomolecular Sciences.
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1. Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-C.html">
     Euler’s theorem, roots of unity, x-ray diffraction structure factor.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     Differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4. Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     Integration by substitution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     Using parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     Calculating an Average Value.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     Multiple integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     Calculating the energy of a chemical bond using molecular orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     Rotation matrices: moving molecules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     Solving equations using matrices. Eigenvectors &amp; Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-K.html">
     Calculating a bond length using moments of inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61.html">
     Question 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     Principal axes for Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q62.html">
     Question 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-A.html">
     Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-B.html">
     First order eqns &amp; Integrating factors. Second order eqns, Newtons laws, equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-C.html">
     The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-D.html">
     Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-E.html">
     Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Partial Differential Equations, PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-G.html">
     PDE examples continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     Monte - Carlo Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     Solving rate equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     Modelling data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter-1/chapter1-E.html">
   SI units, Rounding, converting units &amp; Glossary.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/References.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/Python%20crib.html">
   Appendix:  Some basic Python instructions with a few examples.
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapter-10/Diff-eqns-F.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/subblue/applying-maths-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-10/Diff-eqns-F.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-10/Diff-eqns-F.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-10/Diff-eqns-F.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   9.1 Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#separation-of-variables">
   9.2 Separation of variables
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-particle-in-a-two-dimensional-box">
     <strong>
      (i) Particle in a two-dimensional box
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-particle-in-a-circular-well">
     <strong>
      (ii) Particle in a  circular well
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#angular-solution">
     <strong>
      Angular solution
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#radial-solution">
     <strong>
      Radial solution
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drums">
     <strong>
      Drums
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-steady-state-temperature-profile-in-two-dimensions">
     <strong>
      (iii) Steady State temperature profile in two dimensions
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-one-dimensional-diffusion">
     <strong>
      (iv) One-dimensional diffusion
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#v-diffusion-and-chemical-reactions">
     <strong>
      (v) Diffusion and chemical reactions
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vi-flow-and-chemical-reaction-lateral-flow-tests">
     <strong>
      (vi) Flow and chemical reaction. Lateral flow tests
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vii-diffusion-in-a-closed-tube-or-isolated-bar">
     <strong>
      (vii) Diffusion in a closed tube or isolated bar
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#viii-periodic-boundary-conditions">
     <strong>
      (viii) Periodic boundary conditions
     </strong>
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="partial-differential-equations-pde">
<h1>Partial Differential Equations, PDE<a class="headerlink" href="#partial-differential-equations-pde" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span><span class="p">,</span><span class="n">odeint</span>
<span class="n">init_printing</span><span class="p">()</span>                      <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="background">
<h2>9.1 Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>Many important phenomena in chemistry, physics, and biology involve partial differential equations; for example, the Schroedinger, wave, and diffusion equations. Although the general theory of partial differential equations is well beyond the scope of this book, the equations mentioned are among those whose solutions can be obtained by a powerful method known as the separation of variables.</p>
<p>The simplest type of partial differential equation has two independent variables, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, and its solution must represent a surface rather than a curve as does that of an ordinary differential equation. The ordinary differential equation has arbitrary constants as a result of integration, which are determined by the initial or boundary conditions; the partial differential equation has instead <em>arbitrary functions</em> of integration and these have to be eliminated to obtain a particular solution. The problem is not that there are too few arbitrary functions to solve the equation but that there are too many. An example given by Stephenson (1996) illustrates this point.</p>
<p>Consider the equation formed by differentiating <span class="math notranslate nohighlight">\(w = yf(x)\)</span> with respect to <span class="math notranslate nohighlight">\(y\)</span>, and where <span class="math notranslate nohighlight">\(f(x)\)</span> is a general, unspecified function of <span class="math notranslate nohighlight">\(x\)</span>. The differential is <span class="math notranslate nohighlight">\(\displaystyle \frac{\partial w}{\partial y} = f(x)\)</span> and by substitution to eliminate <span class="math notranslate nohighlight">\(f(x)\)</span> the partial differential equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle y\frac{\partial w}{\partial y}-w=0\]</div>
<p>which is a first-order equation. The solution to this is <span class="math notranslate nohighlight">\(f(x)\)</span> but as this function was not specified, it is therefore <em>any arbitrary function</em>. Exactly what this function might be has to be determined by using the initial or boundary conditions imposed on the problem.</p>
<p>As a second example, the one-dimensional wave equation will be ‘solved’. This equation has the form</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial^2u}{\partial t^2}=a^2\frac{\partial^2u}{\partial x^2}\]</div>
<p>Consider now the equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle u=f_1(x+at)+f_2(x-at)\]</div>
<p>where the functions <span class="math notranslate nohighlight">\(f\)</span> are arbitrary and are not defined in any real sense. To find a solution we differentiate twice by <span class="math notranslate nohighlight">\(x\)</span> then twice by <span class="math notranslate nohighlight">\(t\)</span> and add the results. Let <span class="math notranslate nohighlight">\(x + at \equiv r\)</span> and <span class="math notranslate nohighlight">\(x − at \equiv s\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial u}{\partial x}=\frac{\partial (f_1+f_2)}{\partial r}\frac{\partial r}{\partial x}+\frac{\partial (f_1+f_2)}{\partial s}\frac{\partial s}{\partial x} =f'(x+at)+f'_2(x-at)\]</div>
<p>and similarly</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial^2u}{\partial x^2}=f''_1(x+at)+f''(x-at) ; \qquad \frac{\partial^2u}{\partial t^2}=a^2f''_1(x+at)+a^2f''(x-at)\]</div>
<p>and adding these two equations and eliminating the functions produces the wave equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial^2u}{\partial t^2}=a^2\frac{\partial^2u}{\partial x^2}\]</div>
<p>To convince yourself of the arbitrary, and hence not very useful nature of the functions <span class="math notranslate nohighlight">\(f_1\)</span> and <span class="math notranslate nohighlight">\(f_2\)</span> that solve the wave equation, use Sympy to do the algebra on a few functions with arguments <span class="math notranslate nohighlight">\(x \pm at\)</span>. The functions (see box below) are differentiated twice in <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(x\)</span> and then the wave equation is formed and the result is zero, proving that the functions we choose are in fact solutions. This method is therefore a way of solving the equation, but in many cases, the method of separating variables is more satisfactory and is described next.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, a, t&#39;</span><span class="p">)</span>
<span class="n">f</span>  <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>       <span class="c1"># an arbitrary function in x+at, x-at</span>
<span class="n">ans</span><span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">ans</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Diff-eqns-F_3_0.png" src="../_images/Diff-eqns-F_3_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>  <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="c1"># another  arbitrary function in x+at, x-at</span>
<span class="n">ans</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">))</span> 
<span class="n">ans</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Diff-eqns-F_4_0.png" src="../_images/Diff-eqns-F_4_0.png" />
</div>
</div>
</div>
<div class="section" id="separation-of-variables">
<h2>9.2 Separation of variables<a class="headerlink" href="#separation-of-variables" title="Permalink to this headline">¶</a></h2>
<p>This method assumes that the solution to the partial differential equation is based on splitting the problem into two parts. In the diffusion equation the quantity required is usually the concentration of a species as a function of time and of position. The solution is therefore found using <span class="math notranslate nohighlight">\(c(x,t) = c(x)c(t)\)</span> and splitting the partial differential equation into two parts, one, which depends on time alone and the other on position alone. Both these equations are then made equal to a constant and each can be solved. To find the constants introduced by integration, and thus the exact form of the solution, the initial and boundary conditions are now used. Finding these constants often, but not always, involves expanding the solution as a Fourier series. Solving the differential equations is often the simpler part of the calculation; handing the boundary conditions can involve more work. Some examples are now given.</p>
<div class="section" id="i-particle-in-a-two-dimensional-box">
<h3><strong>(i) Particle in a two-dimensional box</strong><a class="headerlink" href="#i-particle-in-a-two-dimensional-box" title="Permalink to this headline">¶</a></h3>
<p>The energy and wavefunctions of a particle in a two-dimensional box with sides of length <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are calculated from the Schroedinger equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle -\frac{\hbar^2}{2m}\left(\frac{\partial^2 \varphi }{\partial x^2 }  +\frac{\partial ^2\varphi}{\partial y^2} \right) =E\varphi \tag{41} \]</div>
<p>which is a partial differential equation in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. The separation of variables assumes that the wavefunction <span class="math notranslate nohighlight">\(\varphi\)</span> which is a function of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, is also the product of two wavefunctions, one in <span class="math notranslate nohighlight">\(x\)</span> and the other in <span class="math notranslate nohighlight">\(y\)</span>, thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle \varphi(x,y) = \psi(x)\psi(y) \equiv \psi_x\psi_y\]</div>
<p>Substituting gives <span class="math notranslate nohighlight">\(\displaystyle -\frac{\hbar^2}{2m}\left(\psi_y\frac{\partial^2 \psi_x }{\partial x^2 }  +\psi_x\frac{\partial ^2\psi_y}{\partial y^2} \right) =E\psi_x\psi_y\)</span></p>
<p>and rearranging <span class="math notranslate nohighlight">\(\displaystyle -\frac{\hbar^2}{2m}\left(\frac{1}{\psi_x}\frac{\partial^2 \psi_x }{\partial x^2 }  +\frac{1}{\psi_y}\frac{\partial ^2\psi_y}{\partial y^2} \right) =E\)</span></p>
<p>The next step is essential to the method of separating variables and this is that each of the terms on the left of the equation must be equal to a constant. This is true because the two terms are variables of either <span class="math notranslate nohighlight">\(x\)</span> or <span class="math notranslate nohighlight">\(y\)</span>. If <span class="math notranslate nohighlight">\(x\)</span> is varied, only the first term of the equation changes, the other is a constant as is the energy <span class="math notranslate nohighlight">\(E\)</span>. However, for the whole equation to be satisfied, the derivative in <span class="math notranslate nohighlight">\(x\)</span> must be equal to a constant, and this is labelled as <span class="math notranslate nohighlight">\(E_x\)</span>, and is called a separation constant;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \displaystyle -\frac{\hbar^2}{2m}\frac{1}{\psi_x}\frac{\partial^2 \psi_x }{\partial x^2 }=E_x  \tag{42}\]</div>
<p>Similarly for changes in <span class="math notranslate nohighlight">\(y\)</span>, with <span class="math notranslate nohighlight">\(x\)</span> constant,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \displaystyle -\frac{\hbar^2}{2m}\frac{1}{\psi_y}\frac{\partial^2 \psi_y }{\partial y^2 }=E_y  \tag{43}\]</div>
<p>and then</p>
<div class="math notranslate nohighlight">
\[\displaystyle  E_x + E_y = E  \tag{44}\]</div>
<p>The two equations in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> can now be solved in the usual way. For example <span class="math notranslate nohighlight">\(\displaystyle \frac{\partial^2 \psi_x}{\partial x^2}+k^2\psi_x=0\)</span> with <span class="math notranslate nohighlight">\(\displaystyle k^2 = 2mE/\hbar^2\)</span> which produces the solutions to the problem of a particle in a one-dimensional box, see 3.8. Combining the equations gives for a box of dimensions <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \varphi =\sqrt{\frac{4}{ab}}\sin\left( \frac{n_x\pi x}{a}\right)\sin\left(\frac{n_y\pi x}{b} \right)\]</div>
<p>and the energies are <span class="math notranslate nohighlight">\(\displaystyle E=\frac{\pi^2\hbar^2}{2m}\left(\frac{n_x^2}{a^2}+\frac{n_y^2}{b^2}  \right) \)</span> where <span class="math notranslate nohighlight">\(n_x\)</span> and <span class="math notranslate nohighlight">\(n_y\)</span> are positive integer quantum numbers which must be greater than zero, viz, <span class="math notranslate nohighlight">\(n_{x,y} = 1, 2, 3 \cdots\)</span>. Notice that in a square box some levels will be degenerate depending upon how the quantum numbers add, for example, <span class="math notranslate nohighlight">\(n_x = 2\)</span> and <span class="math notranslate nohighlight">\(n_y = 1\)</span> and vice versa. The first few wavefunctions are shown as contour plots in Fig. 20.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig20.png" /></p>
<p>Fig. 20 Wavefunctions in the square well drawn as contour plots. The quantum numbers are labelled above each plot. Negative values are drawn as dashed lines.</p>
</div>
<hr class="docutils" />
<div class="section" id="ii-particle-in-a-circular-well">
<h3><strong>(ii) Particle in a  circular well</strong><a class="headerlink" href="#ii-particle-in-a-circular-well" title="Permalink to this headline">¶</a></h3>
<p>The pattern of nodes of the radial part of a wavefunction of a particle in a deep circular well is described by a Bessel function. The properties of these functions are well established and look like damped sine and cosine waves. The pattern of vibrations on a circular drum head is similar.</p>
<p>There are two boundary conditions. One ensures that the angular solutions repeat themselves around the circumference and the gradients match at the same point, just as for a particle on a ring. The other ensures that the radial part of the wavefunction is zero at the edge of the disc, just as is the case for a particle in a box at its edges.
The wave equation starts out as (41) but for a disc has to be written in plane polar coordinates to be solvable and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle -\frac{\hbar^2}{2m}\left( \frac{\partial^2}{\partial r^2}+ \frac{1}{r}\frac{\partial^2}{\partial r^2}+\frac{1}{r^2}\frac{\partial^2}{\partial \theta^2} \right)\psi+V(r)\psi=E\psi  \tag{45} \]</div>
<p>and the potential energy <span class="math notranslate nohighlight">\(V\)</span> is zero and <span class="math notranslate nohighlight">\(\psi \)</span> is a function of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span>. The disc has a radius of <span class="math notranslate nohighlight">\(a\)</span>. (See Section 5.9 for the conversion equations to polar coordinates.) With the abbreviation <span class="math notranslate nohighlight">\(k^2 = 2mE/\hbar^2\)</span> (units of <span class="math notranslate nohighlight">\(k\)</span> are m<span class="math notranslate nohighlight">\(^{-1}\)</span>) the equation can be rewritten as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \left( \frac{\partial^2}{\partial r^2}+ \frac{1}{r}\frac{\partial^2}{\partial r^2}+\frac{1}{r^2}\frac{\partial^2}{\partial \theta^2} \right)\psi+k^2\psi = 0  \tag{46}\]</div>
<p>Separating variables into <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> <em>assumes</em> that the solution has the form <span class="math notranslate nohighlight">\(\psi = R(r)\varphi(\theta)\)</span>. Substituting for <span class="math notranslate nohighlight">\(\psi\)</span>, then dividing by <span class="math notranslate nohighlight">\(R\varphi\)</span> and multiplying by <span class="math notranslate nohighlight">\(r^2\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \frac{r^2}{R}\frac{\partial^2}{\partial R^2}+ \frac{r}{R}\frac{\partial^2R}{\partial r^2}+\frac{1}{\varphi}\frac{\partial^2\varphi}{\partial \theta^2} +r^2\psi=0  \tag{46}\]</div>
<p>and each term must be equal to a constant and is therefore independent of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span>. The right-hand side of this equation is zero hence if we choose the separation constant to be <span class="math notranslate nohighlight">\(n^2\)</span> this is <span class="math notranslate nohighlight">\(-n^2\)</span> for one equation and <span class="math notranslate nohighlight">\(+n^2\)</span> for the other.</p>
</div>
<div class="section" id="angular-solution">
<h3><strong>Angular solution</strong><a class="headerlink" href="#angular-solution" title="Permalink to this headline">¶</a></h3>
<p>The <span class="math notranslate nohighlight">\(\theta\)</span> equation is <span class="math notranslate nohighlight">\(\displaystyle \frac{1}{\varphi}\frac{\partial^2\varphi}{\partial \theta^2}=const\)</span> and using the separation constant <span class="math notranslate nohighlight">\(-n^2\)</span> this can be written as</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \frac{\partial^2\varphi}{\partial \theta^2}+n^2\varphi = 0  \tag{47}\]</div>
<p>and its solution is given by equation (27) and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \varphi=\frac{1}{\sqrt{2\pi}}e^{\large{in\theta}}\]</div>
</div>
<div class="section" id="radial-solution">
<h3><strong>Radial solution</strong><a class="headerlink" href="#radial-solution" title="Permalink to this headline">¶</a></h3>
<p>The angular boundary conditions make the wavefunction <span class="math notranslate nohighlight">\(\varphi\)</span> repeat itself after each <span class="math notranslate nohighlight">\(2\pi \)</span>n radians where <span class="math notranslate nohighlight">\(n\)</span> has values <span class="math notranslate nohighlight">\(n = 0,  \pm 1, \pm 2, \cdots\)</span>.</p>
<p>The radial equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \frac{r^2}{R}\frac{\partial^2}{\partial R^2}+ \frac{r}{R}\frac{\partial^2R}{\partial r^2} +r^2k^2=n^2  \tag{48}\]</div>
<p>is more difficult to solve but, with the substitution <span class="math notranslate nohighlight">\(x = kr\)</span>, has the form of Bessel’s equation,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  x^2\frac{d^2R}{dx^2}+x\frac{dR}{dx}+(x^2-n^2)R=0\]</div>
<p>which has the solution <span class="math notranslate nohighlight">\(J_n(x)\)</span> where <span class="math notranslate nohighlight">\(J\)</span> is Bessel’s function of the first kind of order <span class="math notranslate nohighlight">\(n\)</span>. All Bessel’s functions are described by an infinite series in <span class="math notranslate nohighlight">\(x\)</span> just as sine and cosine are. See Margenau &amp; Murphy (1943), Abramowicz &amp; Stegun (1965), or Arkfen (1970), for the series.</p>
<p>The solution is</p>
<div class="math notranslate nohighlight">
\[\displaystyle R(r) = C_0\text{BesselJ}(n,r)+C_1\text{BesselY}(n,r) \]</div>
<p>and the constants will be determined by the boundary conditions.</p>
<p>The radial boundary condition is that the wavefunction is zero at the edge of the disc, which means that the Bessel function has to be zero here. Additionally the wavefunction has to be normalized. This latter requirement means that the second constant <span class="math notranslate nohighlight">\(C_1\)</span> has to be zero because the second Bessel function BesselY is <span class="math notranslate nohighlight">\(-\infty\)</span> at <span class="math notranslate nohighlight">\(r = 0\)</span> and a wavefunction based on this function could not be normalised. We can arbitrarily set <span class="math notranslate nohighlight">\(C_0\)</span> to <span class="math notranslate nohighlight">\(N\)</span>, which we will assume normalizes the wavefunction, and the radial solution is therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle R(r)=NJ_n(kr)\]</div>
<p>with the change <span class="math notranslate nohighlight">\(J\to BesselJ\)</span>. The radial boundary condition means that <span class="math notranslate nohighlight">\(J_n(ka) = 0\)</span> for a disc of radius <span class="math notranslate nohighlight">\(a\)</span>. The Bessel function is repeatedly zero, as are sine and cosine, which it resembles, and <span class="math notranslate nohighlight">\(\rho_{n,l} = k_{n,l}a\)</span> is the number where the <span class="math notranslate nohighlight">\(n^{th}\)</span> Bessel function <span class="math notranslate nohighlight">\(J_n(k_{nl}r)\)</span> crosses zero for the <span class="math notranslate nohighlight">\(l^{th}\)</span> time. The wavefunction is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  R(r)=NJ_n\left(\rho_{n,l}\frac{r}{a} \right) \]</div>
<p>The values of <span class="math notranslate nohighlight">\(\rho_{nl}\)</span> can be calculated using SciPy ‘special’ functions via. <span class="math notranslate nohighlight">\(\mathtt{import\; scipy.special \; as\;sp}\)</span> and then <span class="math notranslate nohighlight">\(\mathtt{sp.jn( n, x )}\)</span> and the zeros as <span class="math notranslate nohighlight">\(\text{sp.jn_zeros( n, num_0 )}\)</span>.</p>
<p>The shape of the wavefunction at a fixed angle <span class="math notranslate nohighlight">\(\theta\)</span> has the profile of the Bessel function with the radius set at each of the zero crossings, the lowest energy is found at the first crossing, <span class="math notranslate nohighlight">\(\rho_{0,1}\)</span> the next at crossing <span class="math notranslate nohighlight">\(\rho_{1,1}\)</span> and so on with increasing <span class="math notranslate nohighlight">\(r\)</span>, see Fig. 21. The wavefunction for the lowest state (<span class="math notranslate nohighlight">\(k = 0,\, l = 1\)</span>) does not have a node before reaching the perimeter, the second (<span class="math notranslate nohighlight">\(k = 1,\, l = 1\)</span>) has one node as so on, just as for the particle in a box.</p>
<p>Using the definition of <span class="math notranslate nohighlight">\(k^2\)</span> the energy is <span class="math notranslate nohighlight">\(\displaystyle E_{n,l}=\frac{\hbar^2}{2m}\left( \frac{\rho_{n,l}}{a} \right)^2\)</span> and the energy of the first few energy levels follows that of the value of <span class="math notranslate nohighlight">\(\rho_{n,l}\)</span>. Notice how this pattern of levels is similar, but not identical, to that of a particle in a box. The energy levels are ordered with the quantum numbers, <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(l\)</span>, but in this case act through the value <span class="math notranslate nohighlight">\(\rho\)</span>, and this is different to that of the square well or box where the quantum numbers are included directly in the energy.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig21.png" /></p>
<p>Fig 21. Left. Bessel’s <span class="math notranslate nohighlight">\(J\)</span> functions plotted with <span class="math notranslate nohighlight">\(x=kr\)</span>. Two of the zeros <span class="math notranslate nohighlight">\(\rho_{0,1}\)</span> and <span class="math notranslate nohighlight">\( \rho_{3,1}\)</span> are marked with black dots. Right. The first few energy levels of a particle on a disc are shown for a disc of <span class="math notranslate nohighlight">\(1\)</span> nm radius with mass that of the electron. The quantum numbers <span class="math notranslate nohighlight">\(n\)</span>, and <span class="math notranslate nohighlight">\(l\)</span> are shown also.</p>
<hr class="docutils" />
<p>Some of the zero values of <span class="math notranslate nohighlight">\(\rho\)</span> are given in the table. This list also shows the ordering of the energy levels.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{c|cc}
\hline
n &amp; 0 &amp; 1 &amp; 2 &amp; 0 &amp; 3&amp; 1\\
l &amp; 1 &amp; 1 &amp; 1 &amp; 2 &amp; 1 &amp; 2\\
\rho_{n,l} &amp; 2.40 &amp; 3.83 &amp; 5.13 &amp; 5.52 &amp; 6.38 &amp; 7.01\\
\hline\end{array}\end{split}\]</div>
<p>The total wavefunction is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi_{n,l}=\frac{N}{\sqrt{2\pi}} J_n\left( \frac{\rho_{n,l} r}{a} \right) e^{ni\theta}\]</div>
<p>and as <span class="math notranslate nohighlight">\(n\)</span> can take values <span class="math notranslate nohighlight">\(0, \pm 1, \pm\)</span> 2, etc. and all levels except the first are doubly degenerate. We can think of this, if you wish, as the particle moving in a clockwise or anti-clockwise manner although such everyday notions are always problematic when quantum effects are concerned and so should not be taken too literally. The quantum number <span class="math notranslate nohighlight">\(l\)</span> has positive integer values <span class="math notranslate nohighlight">\(\gt\)</span> 0.</p>
</div>
<div class="section" id="drums">
<h3><strong>Drums</strong><a class="headerlink" href="#drums" title="Permalink to this headline">¶</a></h3>
<p>Equation (46), if slightly modified, describes the shape of the normal modes of a circular drum, and the corresponding equations for a square box those of a square drum. The change to make is <span class="math notranslate nohighlight">\(\displaystyle k^2 = \omega^2/c^2\)</span> where <span class="math notranslate nohighlight">\(c^2 = \sqrt{T/\sigma}\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> is the normal mode’s vibrational frequency in rad <span class="math notranslate nohighlight">\(s^{-1}\)</span>. If the drum skin were cut, a tension of <span class="math notranslate nohighlight">\(T\)</span> newton per metre would be needed to keep it closed. The density of the drum skin <span class="math notranslate nohighlight">\(\rho\)</span> (units of kg m<span class="math notranslate nohighlight">\(^{-2}\)</span>) gives <span class="math notranslate nohighlight">\(c\)</span> units of velocity. The normal mode frequencies are <span class="math notranslate nohighlight">\(\displaystyle \omega_{n,l} = \frac{\rho_{n,l}c}{a}\)</span> and because the overtones are never an integer multiple of the fundamental, because of the values <span class="math notranslate nohighlight">\(\rho\)</span> takes (see table), a drum makes a noise rather than a pure sound.</p>
</div>
<div class="section" id="iii-steady-state-temperature-profile-in-two-dimensions">
<h3><strong>(iii) Steady State temperature profile in two dimensions</strong><a class="headerlink" href="#iii-steady-state-temperature-profile-in-two-dimensions" title="Permalink to this headline">¶</a></h3>
<p>The Laplace equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial^2 V}{\partial x^2}+\frac{\partial^2 V}{\partial y^2}+\frac{\partial^2 V}{\partial z^2} = 0\]</div>
<p>finds application in areas as diverse as steady state heat flow and electrostatics. This equation is so important that it is often abbreviated to</p>
<div class="math notranslate nohighlight">
\[\displaystyle \nabla^2 V = 0\]</div>
<p>with the symbol <span class="math notranslate nohighlight">\(\nabla \)</span>, which is nabla, is often called ‘del’ squared.</p>
<p>In two dimensions,<span class="math notranslate nohighlight">\(\displaystyle \frac{\partial^2 V}{\partial x^2}+\frac{\partial^2 V}{\partial y^2}=0\)</span> and the solution can be obtained in a similar manner to the last example. Separating variables produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{1}{V_x}\frac{\partial^2 V_x}{\partial x^2}+\frac{1}{V_y}\frac{\partial^2 V_y}{\partial y^2}=0\]</div>
<p>but each derivative must now be equal to the same constant as their sum is zero. Thus, <span class="math notranslate nohighlight">\(\displaystyle \frac{1}{V_x}\frac{\partial^2 V_x}{\partial x^2}=-\frac{1}{V_y}\frac{\partial^2 V_y}{\partial y^2}=k^2 \)</span> and where <span class="math notranslate nohighlight">\(k^2\)</span> is chosen to make the solutions simpler and <span class="math notranslate nohighlight">\(k^2 \ge 0\)</span>.  The general solutions to these
equations are</p>
<div class="math notranslate nohighlight">
\[\displaystyle V_x=Ae^{+kx}+Be^{-kx} \qquad \text{and} \qquad V_y=C\sin(ky)+D\cos(ky)\]</div>
<p>and the final result is the product <span class="math notranslate nohighlight">\(V_xV_y\)</span> with linear combinations of these solutions because the differential equation is linear and as such any linear combinations of solutions is also a solution. The next step is to find solutions that satisfy the initial or boundary conditions and these are defined by the problem being solved.</p>
<p>As an example the temperature profile of a bar heated only at one end will be calculated. The bar has a width <span class="math notranslate nohighlight">\(L\)</span> but a length that is so long as to be effectively infinite. The sides of the bar are kept at zero degrees and the end constantly heated to <span class="math notranslate nohighlight">\(T\)</span> degrees; for generality, this temperature profile is called <span class="math notranslate nohighlight">\(f(y)\)</span>. The sketch, Fig. 10.22 shows the situation.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig22.png" /></p>
<p>Fig. 22 A bar with one end held at temperature <span class="math notranslate nohighlight">\(T\)</span>. The sides are held at 0<sup>o</sup>. The width of the bar is <span class="math notranslate nohighlight">\(L\)</span>.</p>
<hr class="docutils" />
<p>The boundary conditions impose the constraints</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{lccc}
y=0,\; V=0,&amp; y=L,\; V=0\\
x=0,\; V=f(y),&amp; x=\infty,\; V=0 \end{array}\end{split}\]</div>
<p>The value <span class="math notranslate nohighlight">\(f(y)\)</span> is any normal function that specifies how <span class="math notranslate nohighlight">\(V\)</span> varies with position <span class="math notranslate nohighlight">\(y\)</span>. The four solutions are written without the integration constants because these are realized when the boundary conditions are applied and are</p>
<div class="math notranslate nohighlight">
\[\displaystyle V=e^{+kx}\sin(ky)=e^{-kx}\sin(ky)=e^{+kx}\cos(ky)=e^{-kx}\cos(ky)  \tag{49}\]</div>
<p>When <span class="math notranslate nohighlight">\(x = \infty\)</span>, the solution cannot contain <span class="math notranslate nohighlight">\(\displaystyle e^{+kx}\)</span> because the temperature is zero not infinity, so <span class="math notranslate nohighlight">\(\displaystyle e^{+kx} \sin(ky)\)</span> and <span class="math notranslate nohighlight">\(\displaystyle e^{+kx} \cos(ky)\)</span> are not solutions. At <span class="math notranslate nohighlight">\(y = 0\)</span>, the temperature is zero and so the solution cannot be <span class="math notranslate nohighlight">\(\displaystyle e^{-kx}\cos(ky)\)</span> because <span class="math notranslate nohighlight">\(\cos(0)\)</span> is not zero. This leaves the solution as</p>
<div class="math notranslate nohighlight">
\[\displaystyle V = e^{-kx}\sin(ky)\]</div>
<p>which leaves <span class="math notranslate nohighlight">\(k\)</span> to be determined. When <span class="math notranslate nohighlight">\(y = L\)</span> the temperature is zero and <span class="math notranslate nohighlight">\(\sin(kL) = 0\)</span>, which it will
be for all <span class="math notranslate nohighlight">\(k = n\pi/L\)</span> if <span class="math notranslate nohighlight">\(n\)</span> is an integer. Thus, the general solution is</p>
<div class="math notranslate nohighlight">
\[\displaystyle V=e^{-n\pi x/L}\sin(n\pi y/L)\]</div>
<p>However, this does not satisfy the condition that at <span class="math notranslate nohighlight">\(x\)</span> = 0 the temperature is some arbitrary but normal function <span class="math notranslate nohighlight">\(f(y)\)</span> which could be some constant value, say <span class="math notranslate nohighlight">\(T\)</span>. To obtain a solution, a sum of all possible solutions is tried and this produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle V=\sum_{n=1}^{\infty} b_ne^{-n\pi x/L}\sin(n\pi y/L)  \tag{50}\]</div>
<p>as a <em>formal solution</em> where <span class="math notranslate nohighlight">\(b_n\)</span> are the amounts of each term to be included in the sum. When <span class="math notranslate nohighlight">\(x\)</span> = 0 the temperature is <span class="math notranslate nohighlight">\(f(y)\)</span>, thus,</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(y)=\sum_{n=1}^{\infty} b_n\sin(n\pi y/L)\]</div>
<p>This relationship is a Fourier series of sines, therefore, we can find the coefficients <span class="math notranslate nohighlight">\(b_n\)</span> as if they are Fourier coefficients (see Chapter 9.1.7) using</p>
<div class="math notranslate nohighlight">
\[\displaystyle b_n=\frac{2}{L}\int_0^L f(y)\sin\left(\frac{n\pi y}{L} \right)dy  \tag{51}\]</div>
<p>If, for example, the temperature function <span class="math notranslate nohighlight">\(f(y) = T\)</span> and <span class="math notranslate nohighlight">\(L = \pi\)</span>, then the coefficients are <span class="math notranslate nohighlight">\(\displaystyle b_n=\frac{}{}\int_0^\pi \sin(n y)dy\)</span> , which evaluate to <span class="math notranslate nohighlight">\(\displaystyle \frac{4T}{\pi},\; \frac{4T}{3\pi},\;\frac{4T}{5\pi},\cdots\)</span> and the temperature profile is</p>
<div class="math notranslate nohighlight">
\[\displaystyle V=\frac{4T}{\pi}\left(e^{-x}\sin(y)+ e^{-3x}\frac{\sin(3y)}{3}+e^{-5x}\frac{\sin(5y)}{5}+\cdots  \right) \]</div>
<p>The figure (fig 23) shows the temperature profile plotted as contours and python algorithm is listed also. The left-hand figure shows the calculation for a constant temperature <span class="math notranslate nohighlight">\(T = 10\)</span> along the y-axis. In the right hand figure, the temperature varies as <span class="math notranslate nohighlight">\(10\sin^2(2\pi y/L)\)</span> so it is initially maximal in two places  along the <span class="math notranslate nohighlight">\(y\)</span> axis. The way the heat spreads out is intuitively consistent with this.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig23.png" /></p>
<p>Fig. 23 Steady state temperature contours with a temperature of zero along the top and bottom of a plate and <span class="math notranslate nohighlight">\(T\)</span> = 10 (left) and <span class="math notranslate nohighlight">\(T=10\sin^2(2\pi y/L)\)</span> held along the y-axis. The plate has a height of  <span class="math notranslate nohighlight">\(L\)</span> = 3 and the temperatures decrease to the right as the temperature is held at zero infinite <span class="math notranslate nohighlight">\(x\)</span>.</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the basic code to reproduce fig 23. Use quad() to numberically integrate</span>
<span class="n">s</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span> <span class="p">,</span><span class="n">n</span> <span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">quad</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># use [0] to answer return only</span>
<span class="n">V</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">nmax</span> <span class="p">:</span> <span class="nb">sum</span><span class="p">(</span> <span class="p">[</span><span class="n">b</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nmax</span><span class="p">)]</span> <span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span>  <span class="mf">10.0</span>
<span class="n">x</span> <span class="o">=</span>   <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span>   <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="n">L</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>             <span class="c1"># set up grid for contour plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">V</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="mi">40</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Diff-eqns-F_7_0.png" src="../_images/Diff-eqns-F_7_0.png" />
</div>
</div>
</div>
<div class="section" id="iv-one-dimensional-diffusion">
<h3><strong>(iv) One-dimensional diffusion</strong><a class="headerlink" href="#iv-one-dimensional-diffusion" title="Permalink to this headline">¶</a></h3>
<p>To find the time profile of the non-equilibrium concentration of a solute in solution, the diffusion equation, or Fick’s second law, is required. Imagine that a partition separates a solution from pure solvent. When the partition is removed, without otherwise disturbing the solution, diffusion of solute into the solvent occurs and <em>vice versa</em>. At any given place the concentration is changing as time progresses. At any given time, there is a concentration profile along the whole sample. Fick’s First Law states that the flux is proportional to the negative gradient of concentration with distance, multiplied by the diffusion constant, or,</p>
<div class="math notranslate nohighlight">
\[\displaystyle J=-D\frac{\partial c}{\partial x} \]</div>
<p>The minus sign ensures that the flux of molecules is from a high concentration to a lower one. However, the flux is also the gradient of the concentration with time, and combining this with Fick’s First Law produces the second law, which relates the time profile of the concentration to the distance diffused, and is</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}=D\frac{\partial ^2c}{\partial x^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is time, <span class="math notranslate nohighlight">\(x\)</span> distance, and <span class="math notranslate nohighlight">\(c\)</span> concentration. <span class="math notranslate nohighlight">\(D\)</span> is the diffusion coefficient in units of <span class="math notranslate nohighlight">\(\mathrm{m^2\, s^{-1}}\)</span>. Typical values are <span class="math notranslate nohighlight">\(\approx 10^{-9}\)</span> for a small molecule in water, to <span class="math notranslate nohighlight">\(\approx 10^{-11}\,\mathrm{ m^2\, s^{-1}}\)</span> or less in a lipid membrane.</p>
<p>The equation is solved by separating variables, assuming <span class="math notranslate nohighlight">\(c = c_xc_t\)</span> and then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{1}{Dc_t}\frac{\partial c_t}{\partial t}=\frac{1}{c_x}\frac{\partial ^2c_x}{\partial x^2} \]</div>
<p>As each term must be constant, for example <span class="math notranslate nohighlight">\(-k^2\)</span>, two equations are produced</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial c_t}{\partial t}=-Dk^2c_t, \qquad \text{and} \qquad \frac{\partial^2 c_x}{\partial x^2}=-k^2c_x \tag{52}\]</div>
<p>The time dependence has the solution <span class="math notranslate nohighlight">\(\displaystyle c = e^{-Dk^2t}\)</span> and the spatial dependence is <span class="math notranslate nohighlight">\(\displaystyle c_x = \sin(kx)\)</span> and <span class="math notranslate nohighlight">\(c_x = \cos(kx)\)</span>; by hypothesis the solutions are either</p>
<div class="math notranslate nohighlight">
\[\displaystyle c=e^{-Dk^2t}\sin(kx), \qquad \text{or} \qquad c=e^{-Dk^2t}\cos(kx) \tag{53}\]</div>
<p>or the sum of both terms</p>
<div class="math notranslate nohighlight">
\[\displaystyle c=e^{-Dk^2t}[A\sin(kx)+B\cos(kx)] \tag{54}\]</div>
<p>with <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> as arbitrary constants that are found from the initial and boundary conditions. The constant is chosen to be <span class="math notranslate nohighlight">\(-k^2\)</span>, and is negative because the concentration might fall, but could not increase to infinity, which it would do if <span class="math notranslate nohighlight">\(+k^2\)</span> were used. The constant is squared only to simplify the resulting equations.</p>
<p>The actual solution is determined by the initial and boundary conditions for the problem at hand. Consider, for example, the diffusion from a thin layer at the top of a slab and then into it. The slab has a  thickness <span class="math notranslate nohighlight">\(L\)</span> with the external faces being kept at a concentration of zero for <span class="math notranslate nohighlight">\(t \gt 0\)</span>. Initially the concentration in the layer at the top of the slab is some normal function of <span class="math notranslate nohighlight">\(x\)</span> such as <span class="math notranslate nohighlight">\(f(x)\)</span> but which would normally be constant. The boundary conditions are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{lccc}
t=0,\; c=f(x)  &amp; \text{and} &amp; 0 \lt x \lt L \\
t \gt 0, c=0\; \text{at}\; x=0 &amp; \text{and} &amp; c=0 \; \text{at} \; x=L \end{array}\end{split}\]</div>
<p>Considering the boundary conditions, as for the previous example, the solution is based on <span class="math notranslate nohighlight">\(\displaystyle c = e^{−Dk^2t}\sin(kx)\)</span> with <span class="math notranslate nohighlight">\(k = n\pi /L\)</span>, and the general form of the solution is based on equation (50) and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle c=\sum_{n=1}^\infty b_ne^{\large{-Dn^2\pi^2t/L^2}}\sin\left( \frac{n\pi x}{L} \right), \qquad b_n=\frac{2}{L}\int_0^L f(x)\sin\left( \frac{n\pi x}{L} \right)dx \tag{55}\]</div>
<p>If the initial concentration in the slab is a constant, then <span class="math notranslate nohighlight">\(f(x) = c_0\)</span> and the integral in <span class="math notranslate nohighlight">\(b\)</span> becomes <span class="math notranslate nohighlight">\(\displaystyle b_n=\frac{2c_0}{L}\int_0^L \sin\left( \frac{n\pi x}{L} \right)dx=\frac{2c_0}{n\pi}(1-(-1)^n)\)</span>
which means that when <span class="math notranslate nohighlight">\(n\)</span> is even, <span class="math notranslate nohighlight">\(b_n\)</span> = 0. The concentration profile is</p>
<div class="math notranslate nohighlight">
\[\displaystyle c=\frac{2c_0}{\pi}\sum_{n=1}^\infty \frac{(1-(-1)^n)}{n}e^{\large{-Dn^2\pi^2 t/L^2}}\sin\left(\frac{n\pi x}{L}  \right) \tag{56}\]</div>
<p>A calculation is shown in fig 24 where molecules are all initially at the top of the slab and subsequently diffuse out. The concentration at the edges of the slab is kept at zero which might be done by washing the molecules away. The initial concentration is arbitrarily set at <span class="math notranslate nohighlight">\(10\)</span>.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig24.png" /></p>
<p>Fig. 24 Concentration profiles vs. position at different times inside the slab. Molecules are diffusing out from the top and the edges of the slab are kept at zero concentration, for example, by washing material away. The diffusion coefficient used is similar to that of lysozyme <span class="math notranslate nohighlight">\(11\cdot 10^{-11}\,\mathrm{m^2\, s^{-1}}\)</span>, the initial concentration <span class="math notranslate nohighlight">\(10\)</span> mM. The width of the slab is <span class="math notranslate nohighlight">\(10\)</span> nm. The times are given next to the lines and are in nanoseconds. The oscillating grey line at the top of the figure is set at <span class="math notranslate nohighlight">\(0.01\)</span> ns and shows that close to zero time the sine functions almost but not exactly cancel out one another even with <span class="math notranslate nohighlight">\(100\)</span> terms in the summation.  The plot also shows how slow diffusion is as it takes <span class="math notranslate nohighlight">\(\approx 600\)</span> ns for the molecules to be removed and the concentration to approach zero.</p>
</div>
<hr class="docutils" />
<div class="section" id="v-diffusion-and-chemical-reactions">
<h3><strong>(v) Diffusion and chemical reactions</strong><a class="headerlink" href="#v-diffusion-and-chemical-reactions" title="Permalink to this headline">¶</a></h3>
<p>When diffusion and reaction compete it is possible that explosive growth of a product occurs. Starting with Fick’s First Law a term is added to allow for first order reaction to form product and is</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}=D\frac{\partial ^2c}{\partial x^2} +kc \tag{56a}\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is the first order rate constant for production of species <span class="math notranslate nohighlight">\(c\)</span> which is a function of position <span class="math notranslate nohighlight">\(x\)</span> and time <span class="math notranslate nohighlight">\(t\)</span>, i.e. <span class="math notranslate nohighlight">\(c(x,t)\)</span>. We will assume that the calculation takes place along a length <span class="math notranslate nohighlight">\( 0\le x \le L\)</span> and that the length is so long that the concentration of product <span class="math notranslate nohighlight">\(c\)</span> is zero at either end at all times, <span class="math notranslate nohighlight">\(c(0,t)=c{L,t}=0\)</span>.</p>
<p>This differential equation look awkward to solve but if a new variable is defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle y(x,t)=c(x,t)e^{-kt}\tag{57b}\]</div>
<p>and this differentiated and substituted into the starting equation a familiar equation is produced.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial y}{\partial t}=\frac{\partial c}{\partial t}e^{-kt}-cke^{-kt}, \qquad  \frac{\partial^2 y}{\partial t^2}=\frac{\partial^2 c}{\partial t^2}e^{-kt}\]</div>
<p>substituting and simplifying gives,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial y}{\partial t}=D\frac{\partial^2 y}{\partial t^2}\]</div>
<p>which is just the diffusion equation but in variable <span class="math notranslate nohighlight">\(y\)</span> instead of <span class="math notranslate nohighlight">\(c\)</span>. The answer can be written down as it is the same as eqn 55 and after substituting for <span class="math notranslate nohighlight">\(c\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle c=\sum_{n=1}^\infty b_ne^{kt}e^{\large{-Dn^2\pi^2t/L^2}}\sin\left( \frac{n\pi x}{L} \right), \qquad b_n=\frac{2}{L}\int_0^L f(x)\sin\left( \frac{n\pi x}{L} \right)dx \tag{55'}\]</div>
<p>where <span class="math notranslate nohighlight">\(f(x)\)</span> is the concentration profile in the tube at <span class="math notranslate nohighlight">\(t=0\)</span>. Notice that this is exactly the same as equation 55, i.e when no reaction occurs, but now multiplied by <span class="math notranslate nohighlight">\(\displaystyle e^{kt}\)</span> to allow for reaction.</p>
<p>As an example suppose that an initial amount is placed as a very small drop in the centre of the long tube, i.e mathematically we will allow this to be a Kronecker delta function, i.e. <span class="math notranslate nohighlight">\(f(x)=\delta(x-L/2)\)</span> and follow what happens in time. The integrals <span class="math notranslate nohighlight">\(b\)</span> are</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{2}{L}\int_0^L \delta(x-L/2)\sin\left( \frac{n\pi x}{L} \right)dx=\sin(n\pi/2)\]</div>
<p>where we use the fact that the delta function is zero except when <span class="math notranslate nohighlight">\(x=L/2\)</span>. These <span class="math notranslate nohighlight">\(b_n\)</span> integrals are <span class="math notranslate nohighlight">\(0,\pm 1\)</span> depending on <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Because the extra reaction term <span class="math notranslate nohighlight">\(+kc\)</span> is positive the species <span class="math notranslate nohighlight">\(c\)</span> may grow in time, if it were negative the population of <span class="math notranslate nohighlight">\(c\)</span> would always decay exponentially in time. The critical term is <span class="math notranslate nohighlight">\(\displaystyle kt-(n\pi/L)^2Dt\)</span> in the exponential. The series of terms to be summed starts with <span class="math notranslate nohighlight">\(n=1\)</span> and when <span class="math notranslate nohighlight">\(k \gt (\pi/L)^2D\)</span> the exponential is greater than <span class="math notranslate nohighlight">\(1\)</span> and even though other terms in the summation with <span class="math notranslate nohighlight">\((n\pi/L)^2D\)</span>  make each the exponential term smaller, perhaps less than <span class="math notranslate nohighlight">\(1\)</span> overall, the population increases, i.e. is dominated by the first few terms with small <span class="math notranslate nohighlight">\(n\)</span>. The critical factor for growth is that <span class="math notranslate nohighlight">\(k \gt D\pi^2/L^2\)</span>. The effect of this behaviour is that suddenly the amount of <span class="math notranslate nohighlight">\(c\)</span> becomes very large indeed.  If the species were bacteria in a nutrient medium or algae in a pond this behaviour describes an ‘algal bloom’.</p>
<p>At small times figure 24a shows diffusion spreading the concentration with very little change in total concentration as there is slow growth initially, but this is soon overtaken and diffusion now has a small effect in spreading compared to the explosive growth. Eventually the growth must be limited by the amount of material available but this limit is not included in this model, thus <span class="math notranslate nohighlight">\(c\)</span> could increase to unrealistic values. In effect, when explosive growth occurs that area into which diffusion has occurred is fixed and suddenly filled with product. Eventually the whole extent of the available volume will slowly be filled with product: growth, explosive or otherwise, cannot occur where there is no material to react, and this is limited by diffusion.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig24a.png" /></p>
<p>fig 24a. Diffusion and reaction population at different times in microseconds. <span class="math notranslate nohighlight">\(L=10^{-4}\)</span> m, <span class="math notranslate nohighlight">\(k=10^3\)</span> /s, <span class="math notranslate nohighlight">\(D/L^2=0.1\)</span> The totals listed in the plot are proportional to the area under each curve, i.e to the amount of <span class="math notranslate nohighlight">\(c\)</span> produced. It is clear that the amount produced increases slowly to begin with then exponentially. The vertical line at <span class="math notranslate nohighlight">\(x/L=0.5\)</span> represents the delta function population at zero time.</p>
</div>
<hr class="docutils" />
<div class="section" id="vi-flow-and-chemical-reaction-lateral-flow-tests">
<h3><strong>(vi) Flow and chemical reaction. Lateral flow tests</strong><a class="headerlink" href="#vi-flow-and-chemical-reaction-lateral-flow-tests" title="Permalink to this headline">¶</a></h3>
<p>In a lateral flow test used to detect, for example, Covid 19 viruses, the analyte containing the virus is solubilsed in a buffer along with other reagents and a few drops added to a sample pad in the test device, see figure 24b. By capillary action, similar to that which occurs in thin layer chromatography, the fluid containing the analyte passes through to a second region containing antibodies (immunoglobulins) attached to silver or gold nanoparticles. The fluid then passes into a ribbon of nitrocellulose impregnated with reporter antibodies in two specific places, the first to trap any analyte containing species and the second as a test region to confirm that flow has occurred. Finally this ribbon is attached to a wick that ensures that flow continues until no more fluid is left.</p>
<p>The purpose of the nanoparticles is only to allow visual identification of the result because they are highly coloured by virtue of <em>surface plasmon resonance</em>. These antibody - nanoparticle conjugates are coated in sucrose or other sugars to protect them during storage but which dissolves in the buffer fluid. This now enables the analyte (e.g. virus), A, to bind the antibody-nanoparticle Ab in the equilibrium,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \mathrm{Ab+A \rightleftharpoons Ab\cdot A}\]</div>
<p>where Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A is the complex to be measured. This is the first reaction, the second is when the Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A complex reacts in the test region and similarly the equilibrium is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \mathrm{Ab\cdot A + X }\overset{ k}\rightleftharpoons \mathrm{Ab\cdot A\cdot X}\]</div>
<p>where <span class="math notranslate nohighlight">\(X\)</span> represents the reporting antibody. Both Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A and Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A<span class="math notranslate nohighlight">\(\cdot\)</span>X are coloured as both contain the nanoparticle it is the concentration of Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A<span class="math notranslate nohighlight">\(\cdot\)</span>X bound to the test region that makes detection by eye possible after the flow has removed all unbound species.</p>
<p>The thin ribbon of nitrocellulose is typically <span class="math notranslate nohighlight">\(2\)</span> cm long by <span class="math notranslate nohighlight">\(3\)</span> mm wide and <span class="math notranslate nohighlight">\(0.1\)</span> mm thick into which are placed an active zone, which is a <span class="math notranslate nohighlight">\(\sim 1\)</span> mm long zone of antibodies that will bind only to those complexes containing the analyte, and a second test zone further on, also containing antibodies that will react with any complexes remaining.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig24b.png" /></p>
<p>Figure 24b. Schematic of a lateral flow device. The whole assembly is <span class="math notranslate nohighlight">\(\approx 6\)</span> cm long. The coloured complex Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A<span class="math notranslate nohighlight">\(\cdot\)</span>X is bound in the test region where it becomes concentrated and can be differentiated from the background colour due to the Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A conjugate complex.</p>
<hr class="docutils" />
<p>The flow velocity in the nitrocellulose is typically <span class="math notranslate nohighlight">\(0.25\)</span> mm/s and a test area is <span class="math notranslate nohighlight">\(\sim 1\)</span> mm. The analyte - nanoparticle - antibody complex Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A has to rapidly become attached to an antibody in the detecting strip as the liquid flows through it. Only some will bind because rate constant <span class="math notranslate nohighlight">\(k\)</span> is small, far less than diffusion controlled (in water <span class="math notranslate nohighlight">\(\approx 10^{10}\,\mathrm{dm^3\,mol^{-1}\,sec^{-1}}\)</span>) which means that it is <em>reaction controlled</em> and numerous encounters of the species occur before reaction.</p>
<p>When in the test volume the nanoparticle complex must diffuse to the edge of a pore in the nitrocellulose. These   typically have a radius of <span class="math notranslate nohighlight">\(\sim 5\)</span> microns and the reporter antibody X is bound to the surface of the pores. In three dimensions the mean distance diffused is <span class="math notranslate nohighlight">\(\sqrt{6Dt}\)</span> where the diffusion constant<span class="math notranslate nohighlight">\(^1\)</span> which for a nanoparticle is typically <span class="math notranslate nohighlight">\(10^{-11}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s thus to diffuse <span class="math notranslate nohighlight">\(5\cdot 10^{-6}\)</span> m will take <span class="math notranslate nohighlight">\(\approx 0.4\)</span> seconds. This gives a time scale for reaction.</p>
<p><span class="math notranslate nohighlight">\(^1\)</span> The nanoparticles used typically have radii of <span class="math notranslate nohighlight">\(10\)</span> to <span class="math notranslate nohighlight">\(100\)</span> nm. The Stokes - Einstein equation gives the diffusion coefficient as <span class="math notranslate nohighlight">\(D=k_BT/6\pi\eta R\)</span> for a radius <span class="math notranslate nohighlight">\(R\)</span> and viscosity <span class="math notranslate nohighlight">\(\eta= 10^{-3}\)</span> Pa s or <span class="math notranslate nohighlight">\(1\)</span> cP (for an aqueous solution). The diffusion constant is therefore <span class="math notranslate nohighlight">\(D = 10^{-11}\to 10^{-12}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s.</p>
<p>Binding of the analyte will be almost total if there is a large equilibrium constant, which there is in these reactions, and is typically many tens of thousands. However, even with an excess of X it takes time to establish equilibrium. The forward (binding) rate constant <span class="math notranslate nohighlight">\(k\)</span> is important because the species are flowing through the reactive region. (The reverse rate constant can be ignored when the equilibrium constant is large). The (bimolecular) limit to the half-life forming the complex Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A<span class="math notranslate nohighlight">\(\cdot\)</span>X is <span class="math notranslate nohighlight">\(\ln(2)/kX\)</span>, assuming that X is in excess and so pseudo-first order, where typically <span class="math notranslate nohighlight">\(k = 10^5\,\mathrm{dm^3\,mol^{-1}\, s^{-1}}\)</span> and <span class="math notranslate nohighlight">\(X= 10^{-6}\;\mathrm{dm^3\,mol^{-1}}\)</span>. With these values <span class="math notranslate nohighlight">\(t_{1/2}\approx 10\)</span> s. This is short enough that much of the analyte will be detected because it takes <span class="math notranslate nohighlight">\(4\)</span> seconds or so to flow across the reactive region. Of course this assumes that the amount of X is in sufficient excess compared to Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A. As the half-life is a product of terms an increase either in concentration of X or rate constant <span class="math notranslate nohighlight">\(k\)</span> will greatly reduce the half-life and increase detection, and <em>vice versa</em>. In other words the success of such a device depends crucially on timing, rate constants and concentrations. The similar argument can be made for the first reaction forming Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A, although in that case there is extra time because the conjugate mixing region although it has a larger volume the material used has faster flow rates than in the nitrocellulose, thus forming a bottleneck at the junction of the two, which gives more time for reaction.</p>
<p>To analyse the behaviour the equation governing the flow and reaction is needed. This is derived by calculating the amount of material that flows into and out of a small volume, of area <span class="math notranslate nohighlight">\(A\)</span> and depth <span class="math notranslate nohighlight">\(\delta x\)</span>. In words this is</p>
<p><span class="math notranslate nohighlight">\(\qquad\qquad\)</span> rate of change  = rate of entering at <span class="math notranslate nohighlight">\(x\)</span> - rate of leaving at <span class="math notranslate nohighlight">\(x+\delta x\)</span>.</p>
<p>where the flux at <span class="math notranslate nohighlight">\(x\)</span> and time <span class="math notranslate nohighlight">\(t\)</span> is <span class="math notranslate nohighlight">\(J(x,t)\)</span> mass moved /volume/time which makes the rate of entering the volume <span class="math notranslate nohighlight">\(AJ(x,t)\)</span> or</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial }{\partial t}cA\delta x= AJ(x,t) - AJ(x+\delta x,t)\]</div>
<p>and <span class="math notranslate nohighlight">\(c\)</span> which depends on position <span class="math notranslate nohighlight">\(x\)</span> and time <span class="math notranslate nohighlight">\(t\)</span> is the concentration of the transported nanoparticle complex and hence proportional to analyte concentration. Rearranging gives,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial c}{\partial t}= \frac{J(x,t) - J(x+\delta x,t)}{\delta x}\]</div>
<p>and in the limit <span class="math notranslate nohighlight">\(\delta x\to 0\)</span></p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}=-\frac{\partial J}{\partial x}\]</div>
<p>Rather than use the flux it is easier to split this into <span class="math notranslate nohighlight">\(J \equiv vc\)</span> and so</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}=-v\frac{\partial c}{\partial x}  \tag{ 56a}\]</div>
<p>where <span class="math notranslate nohighlight">\(v = flow/area \)</span> is the velocity of the flow. As chemical reaction can also occur this rate equation is modified to</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}=-v\frac{\partial c}{\partial x}-kc\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> a rate constant forming the product. Clearly, from the way the lateral flow is made the reaction only occurs at a specific place, effectively meaning that the rate constant is zero except in the reactive zones. This means that we can split the calculation into parts. Initially we let the reaction be zero, and if the amount initially is some function <span class="math notranslate nohighlight">\(C_0(x,0)\)</span> spread along the <span class="math notranslate nohighlight">\(x\)</span> axis (the direction of flow) then the solution to the partial differential equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle c(x,t)=c_0(x-vt)\]</div>
<p>showing that the concentration at any position has the same profile as it had initially but moves to increasing <span class="math notranslate nohighlight">\(x\)</span> as time increases. If the initial amount were a spike of concentration a wave of concentration moves along unchanged in shape. This must be the case as diffusion is ignored so there is no way that the profile could spread. This is the case in a linear flow device.</p>
<p>In our example the flow is too rapid for species to be able to diffuse from outside into the reaction zone. In some circumstances diffusion may be important relative to flow and then the dimensionless Peclet number, the flow rate divided by rate of diffusion, or <span class="math notranslate nohighlight">\(P=Lv/D\)</span>, where <span class="math notranslate nohighlight">\(L\)</span> is distance to be considered and if <span class="math notranslate nohighlight">\(\sim 1\)</span> or less diffusion has to be considered along with flow. In the lateral flow device the Peclet number is <span class="math notranslate nohighlight">\(\gg 1\)</span>.</p>
<p>To calculate the effect of chemical reaction in the reactive zone we can make the same substitution as in eqn. 57b. The result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle c(x,t)=e^{-kc(x,t)}c_0(x-vt)\]</div>
<p>and so on entering the zone at a certain <span class="math notranslate nohighlight">\(x=x_a\)</span> the concentration is reduced with rate constant <span class="math notranslate nohighlight">\(k\)</span> and on exiting the region at <span class="math notranslate nohighlight">\(x_b\)</span> the concentration is no longer changed. Naturally, the product of the reaction increases to <span class="math notranslate nohighlight">\(\int(c_0(x,0)-c(x,\infty))dx\)</span>. This how the lateral flow result is observed by eye, the product is concentrated in a small area and the colour becomes intensified due to this.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig24c.png" /></p>
<p>Figure 24c. Calculated profiles of Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A species in a lateral flow test as time vs distance. The reactive area <span class="math notranslate nohighlight">\(x_a\to x_b\)</span> is shown by the vertical lines and is where the species Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A binds to form Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A<span class="math notranslate nohighlight">\(\cdot\)</span>X. The population of this rises in the test region as Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A declines. Notice that outside this region the population of Ab<span class="math notranslate nohighlight">\(\cdot\)</span>A remains constant and its shape unchanged. The bottom line (red) shows the <em>time</em> profile of the product placed in the test region.</p>
</div>
<hr class="docutils" />
<div class="section" id="vii-diffusion-in-a-closed-tube-or-isolated-bar">
<h3><strong>(vii) Diffusion in a closed tube or isolated bar</strong><a class="headerlink" href="#vii-diffusion-in-a-closed-tube-or-isolated-bar" title="Permalink to this headline">¶</a></h3>
<p>If the ends of a long tube are filled with solvent, then closed and some solute injected, diffusion will ensure that equilibrium will eventually be reached no matter where the solute is injected. Similarly, if the end of an otherwise insulated bar is heated for a short while, as heat cannot escape, a uniform temperature will be reached. From these results, we know that, because the initial concentration or temperature profile levels out to a constant value, the solution must have both a time-dependent and a constant part. At long times the temperature or concentration will become uniform and, if <span class="math notranslate nohighlight">\(f(x)\)</span> describes the amount initially added and <span class="math notranslate nohighlight">\(0 \lt x \lt L\)</span>, the long time value is <span class="math notranslate nohighlight">\(\displaystyle \frac{1}{L}\int_0^L f(x)dx\)</span>. The initial condition is given by the shape of the concentration profile <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(c(x,t)\)</span> is the concentration at position <span class="math notranslate nohighlight">\(x\)</span> and time <span class="math notranslate nohighlight">\(t\)</span>, then, because no heat or material leaves, the concentration gradients at the ends of the tube are zero at all times, or</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dc(0,t)}{dx}=\frac{dc(L,t)}{dx} = 0, \qquad t \gt 0\]</div>
<p>Starting with the diffusion equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial c}{\partial t} =D \frac {\partial^2 c}{\partial x^2}\]</div>
<p>and separating variables as before gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial c_t}{\partial t} = -Dk^2c_t\quad\text{and}\quad\displaystyle \frac{\partial^2 c_x}{\partial x^2} = -k^2c_x\]</div>
<p>The solution is, as before, <span class="math notranslate nohighlight">\(c = c_tc_x\)</span>.</p>
<p>The time-dependent equation integrates to <span class="math notranslate nohighlight">\(\displaystyle c = e^{−Dk^2t}\)</span>, but the spatial part needs special attention to incorporate the boundary conditions. The separation parameter <span class="math notranslate nohighlight">\(k\)</span> can have values of zero, or it can be positive or positive and imaginary, i.e. <span class="math notranslate nohighlight">\(ik\)</span>. In this case if we use <span class="math notranslate nohighlight">\(−(ik)^2 \to k^2\)</span> and integrating produces the exponential solution <span class="math notranslate nohighlight">\(\displaystyle c_x = ae^{kx} + be^{−kx}\)</span>, however the boundary conditions are then only met when <span class="math notranslate nohighlight">\(a = b = 0\)</span> which is not a useful result.</p>
<p>When <span class="math notranslate nohighlight">\(k\)</span> = 0 the equation to integrate is <span class="math notranslate nohighlight">\(\displaystyle \frac{\partial ^2c_x}{\partial x^2}=0\)</span> and the solution is <span class="math notranslate nohighlight">\(c_x=ax+b\)</span> and the final solution <span class="math notranslate nohighlight">\(c_tc_x = ax + b\)</span>, because <span class="math notranslate nohighlight">\(k\)</span> = 0 and the exponential term is unity. The boundary conditions are only met when <span class="math notranslate nohighlight">\(a\)</span> = 0 but <span class="math notranslate nohighlight">\(b\)</span> is undefined so this solution cannot be complete.</p>
<p>Finally, when <span class="math notranslate nohighlight">\(k\)</span> is positive the solutions are <span class="math notranslate nohighlight">\(c_x = a\sin(kx) + b\cos(kx)\)</span>. The gradient boundary condition ensures that the solution contains only the cosine term because the derivative, <span class="math notranslate nohighlight">\(kb\sin(kx)\)</span>, is zero at <span class="math notranslate nohighlight">\(x\)</span> = 0 and at <span class="math notranslate nohighlight">\(L\)</span> provided that <span class="math notranslate nohighlight">\(k = n\pi/L\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is an integer. To make the next equations clearer <span class="math notranslate nohighlight">\(k\)</span> is used as if it were an integer and its value only substituted in at the end. The solution is thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle c_k=e^{-k^2Dt}\cos(kx), \qquad k=0,\;1,\;2\; \cdots\]</div>
<p>and the final solution is a linear combination of the <span class="math notranslate nohighlight">\(k\)</span> terms including <span class="math notranslate nohighlight">\(k\)</span> = 0 and this will give a term that is time independent. The initial condition ensures that</p>
<div class="math notranslate nohighlight">
\[\displaystyle f(x) = \sum_{n=0}^\infty b_k\cos(kx), \qquad \text{giving} \qquad b_k=\frac{2}{L}\int_0^Lf(x)\cos(kx)dx\]</div>
<p>where <span class="math notranslate nohighlight">\(k = n\pi/L\)</span>. The complete solution is</p>
<div class="math notranslate nohighlight">
\[\displaystyle c=\frac{b_0}{2}+\sum_{n=1}^\infty b_ne^{-(n\pi /L)^2Dt}\cos\left(\frac{n\pi x}{L}\right)\]</div>
<p>The first term <span class="math notranslate nohighlight">\(b_0/2\)</span> is divided by 2 to make it equal to the average concentration at long times viz, <span class="math notranslate nohighlight">\(\displaystyle  \frac{1}{L}\int_0^L f(x) dx\)</span>, because by its defining equation <span class="math notranslate nohighlight">\(b_0\)</span> is otherwise 2 times too large. The results show how the initial profile eventually reaches a constant, time-independent value, the total amount of material or heat being conserved.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig25a.png" /></p>
<p>Fig. 25a Left: One-dimensional diffusion in a closed tube of length 100 nm at the times (in ns) shown.  The initial concentration profile has the Gaussian shape <span class="math notranslate nohighlight">\(\displaystyle e^{-2(x-2.5)^2}\)</span>, and is essentially indistinguishable from the curve plotted at the first time of <span class="math notranslate nohighlight">\(0.01\)</span> ns. The diffusion coefficient used is similar to that of lysozyme <span class="math notranslate nohighlight">\(D = 11\cdot 10^{-2} \,\mathrm{nm^2\,ns^{-1} }\)</span>. The profile at different times is shown. The times are shown on the plot. An essentially uniform profile is not reached until <span class="math notranslate nohighlight">\(t \approx 5000\)</span> ns. The equilibrium concentration is shown as the black dashed line.</p>
<p>Right: The figure on the right shows the time profile measured at <span class="math notranslate nohighlight">\(x = 2.5, 10\)</span> and <span class="math notranslate nohighlight">\(25\)</span> nm along the tube. Both the x and y- axes are shown on a logarithmic scale which makes the plotted lines easier to distinguish from one another. Initially at <span class="math notranslate nohighlight">\(x = 2.5\)</span> the concentration falls rapidly, while that at 10 nm remains effectively zero for about <span class="math notranslate nohighlight">\(10\)</span> ns and that at <span class="math notranslate nohighlight">\(25\)</span> nm remains zero for a few hundred ns. Eventually some molecules reach <span class="math notranslate nohighlight">\(10\)</span> nm and then <span class="math notranslate nohighlight">\(25\)</span> nm and the population at both positions begins to rise as a wave of molecules passes. As the tube is of finite length  eventually a steady concentration along the tube is reached. This takes <span class="math notranslate nohighlight">\(\approx 50000\)</span> ns and demonstrates that molecular diffusion is an intrinsically slow process.</p>
</div>
<hr class="docutils" />
<div class="section" id="viii-periodic-boundary-conditions">
<h3><strong>(viii) Periodic boundary conditions</strong><a class="headerlink" href="#viii-periodic-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>When diffusion is on a circular loop, the boundary conditions are periodic. The effect is similar to the insulated bar in that an initial concentration profile becomes constant at long times. If the concentration is initially <span class="math notranslate nohighlight">\(f(\theta), -\pi &lt; \theta &lt; +\pi\)</span>, the amount initially present at long times is <span class="math notranslate nohighlight">\(\displaystyle \frac{1}{\pi}\int_{\pi}^{\pi}f(\theta)d\theta\)</span>. The boundary conditions ensure that the concentration and its gradient are the same after a period,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  c(0,t)=c(2\pi,t), \qquad c'(o,t)=c'(2\pi,t), \qquad t\gt 0\]</div>
<p>These conditions are most easily illustrated with a figure (Fig. 26). Only when both conditions are met is the solution continuous at the boundary.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig26.png" /></p>
<p>Fig. 26 Periodic boundary conditions. Only in the top curve are both conditions simultaneously satisfied.</p>
<hr class="docutils" />
<p>Following the derivation (52) or that for the insulated bar, the general solution is found when <span class="math notranslate nohighlight">\(k\)</span> is zero or positive. Rather than changing the notation <span class="math notranslate nohighlight">\(x\)</span> is used to represent the angle that varies from <span class="math notranslate nohighlight">\(−\pi\)</span> to <span class="math notranslate nohighlight">\(\pi\)</span>. The general solution is</p>
<div class="math notranslate nohighlight">
\[\displaystyle c_x=a\sin(kx)+b\cos(kx)\]</div>
<p>and the boundary conditions are now applied. To make the concentration the same when <span class="math notranslate nohighlight">\(x = −\pi\)</span> and <span class="math notranslate nohighlight">\(+\pi\)</span>, and with <span class="math notranslate nohighlight">\(k\)</span> = 0, 1, 2, <span class="math notranslate nohighlight">\(\cdots\)</span>, the following equations must apply, <span class="math notranslate nohighlight">\(\displaystyle a\sin(-\pi k)+b\cos(-\pi k)=  a\sin(\pi k)+b\cos(\pi k)\)</span> and for the derivatives <span class="math notranslate nohighlight">\(\displaystyle -a\cos(-\pi k)+b\sin(-\pi k)=  a\cos(\pi k)-b\sin(\pi k)\)</span>.</p>
<p>Because the sine terms are zero at integer values of <span class="math notranslate nohighlight">\(\pi\)</span> radians, it follows that neither <span class="math notranslate nohighlight">\(a\)</span> nor <span class="math notranslate nohighlight">\(b\)</span> is zero. Therefore, the solution is found by expanding the complete solution;</p>
<div class="math notranslate nohighlight">
\[\displaystyle  c(x)=\sum_{k=0}^\infty [a_k\sin(kx)+b_k\cos(kx)]\]</div>
<p>with the initial condition <span class="math notranslate nohighlight">\(f(x)\)</span> providing the coefficients as</p>
<div class="math notranslate nohighlight">
\[\displaystyle a_k=\frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin(kx)  \qquad b_k=\frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos(kx)dx\]</div>
<p>The complete solution is</p>
<div class="math notranslate nohighlight">
\[\displaystyle c= \frac{b_0}{2}+ \sum_{n=1}^\infty e^{-n^2Dt}[a_k\sin(kx)+b_k\cos(kx)]\]</div>
<p>and an example of diffusion is shown in Fig. 26a (right) with a Gaussian initial concentration profile. Notice how the concentration matches both in value and slope at <span class="math notranslate nohighlight">\(\pm \pi\)</span> as required by the boundary conditions. To compare with previous equations <span class="math notranslate nohighlight">\(k=n\pi x/L=n x\)</span> since <span class="math notranslate nohighlight">\(x\)</span> is an angle and has a maximum <span class="math notranslate nohighlight">\(L=\pi\)</span>, i.e. a half circle only is needed.</p>
<p>The X-ray structure of the chlorophylls in the photosynthetic antenna protein LHCII shows that they are arranged in the form of a ring. These chlorophylls are all (electronically) coupled to one another and when excited by a femtosecond laser pulse a localized wavepacket is produced, which, because of interactions with the surrounding solvent molecules and protein residues, will then spread its energy among the pigments’ excitonic energy levels. In this case, the time-dependent Schroedinger equation, rather than the diffusion equation, is used. However, if we assume that the energy levels are close enough to be considered continuous, the wavepacket’s motion as it relaxes around the ring of molecules would have behaviour reminiscent of diffusion as shown in Fig. 10.26a.</p>
<p><img alt="Drawing" src="../_images/diffeqn-fig26a.png" /></p>
<p>Fig 26a. Diffusion on a ring. The initial concentration profile is <span class="math notranslate nohighlight">\(\displaystyle f(x)=e^{-20(x-\pi /4)^2}\)</span> and the diffusion coefficient <span class="math notranslate nohighlight">\(D\)</span> = 1. The left-hand figure shows how the concentration profile changes at the times given, on the right the figure shows the time profile at the given angles.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-10"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Diff-eqns-E.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Linear equations with variable coefficients</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Diff-eqns-G.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PDE examples continued</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Godfrey Beddard<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>