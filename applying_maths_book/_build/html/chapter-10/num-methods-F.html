
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>9 Boundary value problems: shooting method &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1. Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     Numbers to Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     Trigonometric functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting: permutations, combinations and probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     Real, imaginary,conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-C.html">
     4 Euler’s theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-27.html">
     Questions 14 - 27
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     Differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     Limits, maxima/minima and calculus of variations.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     13 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4. Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     Integration by substitution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     Using parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     Calculating an Average Value.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     10 Multiple integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     12 Calculating the energy of a chemical bond using molecular orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q 1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q 15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q 73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     Maclaurin and Taylor series expansions. Paramagnetic spins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     1 Motivation and concept
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     Not all axes are right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-61.html">
     Questions 53 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q38 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     Rotation matrices: moving molecules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     Solving equations using matrices. Eigenvectors &amp; Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     Calculating bond length using moments of inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-62.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     Chapter 8 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     Computed Tomography
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Diff-eqns-intro.html">
   8. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-A.html">
     Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-B.html">
     Integrating factors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-C.html">
     The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-D.html">
     Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-E.html">
     Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-F.html">
     Partial Differential Equations, PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-G.html">
     PDE examples continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/References.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapter-10/num-methods-F.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/chapter-10/num-methods-F.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerical-integration-of-the-schroedinger-equation">
   10 Numerical integration of the Schroedinger equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-shooting-method-example-with-a-quadratic-potential">
   10.1 The shooting method example with a quadratic potential
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-eigenvalues-and-wavefunctions">
     Calculating eigenvalues and wavefunctions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvalues">
     Eigenvalues
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wavefunctions">
     Wavefunctions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#energy-levels-for-the-ammonia-inversion-normal-mode-calculated-using-atomic-units">
   10.2 Energy levels for the ammonia inversion normal mode calculated using atomic units
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">init_printing</span><span class="p">()</span>                      <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="c1">#import matplotlib as mpl</span>
<span class="c1">#mpl.use(&#39;TkAgg&#39;)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="boundary-value-problems-shooting-method">
<h1>9 Boundary value problems: shooting method<a class="headerlink" href="#boundary-value-problems-shooting-method" title="Permalink to this headline">¶</a></h1>
<p>The previous examples have been treated as initial value problems, but, in many cases, the equation being examined requires that the solution has predetermined value at two places, and a number of engineering and quantum mechanical problems have this restriction. Figure 25 illustrates, in a schematic way, the difference in the initial value and boundary conditions for a second-order equation; <span class="math notranslate nohighlight">\(d^2y/dx^2 = f (x,y)\)</span>. The top sketch shows the two initial conditions chosen at <span class="math notranslate nohighlight">\(x = 0\)</span> to be <span class="math notranslate nohighlight">\(y = 1\)</span> and <span class="math notranslate nohighlight">\(dy/dx|_0 = 2\)</span>; the gradient is shown as an arrow. The lower figure illustrates the situation if the boundary condition on <span class="math notranslate nohighlight">\(y\)</span> is one when <span class="math notranslate nohighlight">\(x = 0\)</span>, and zero when <span class="math notranslate nohighlight">\(x = 2\)</span>, which is the limit of the calculation; <span class="math notranslate nohighlight">\(x\)</span> can only range from <span class="math notranslate nohighlight">\(0 \to 2\)</span>.</p>
<p>The only way to solve differential equations is to know what the initial conditions are. In the boundary value problem, the true initial gradient <span class="math notranslate nohighlight">\(dy/dx|0 = \alpha\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> is unknown, but whose value will produce the required result that at <span class="math notranslate nohighlight">\(x = 2,\; y = 0\)</span>. Initially <span class="math notranslate nohighlight">\(\alpha\)</span> has to be guessed, the calculation performed and then repeated with new guesses until the boundary condition is satisfied. Fortunately, this guessing can be made into an iterative process gradually homing in on the true value.</p>
<img src='num-methods-fig25.png' alt='Drawing' style='width:400px'/>
<p>Figure 25. Initial value conditions (top panel), and boundary value conditions (lower panel). This shows three curves following three different initial values <span class="math notranslate nohighlight">\(\alpha\)</span>, in addition to <span class="math notranslate nohighlight">\(y_0 = 1\)</span>, only one of which achieves the boundary condition <span class="math notranslate nohighlight">\(y = 0\)</span> when <span class="math notranslate nohighlight">\(x = 2\)</span>. The shooting method guesses/iterates to the correct initial value <span class="math notranslate nohighlight">\(\alpha\)</span> to satisfy the boundary condition</p>
<hr class="docutils" />
<p>Suppose the equation we want to solve is the one examined before in Section 5.2,</p>
<div class="math notranslate nohighlight">
\[ \frac{d^y}{dx^2}+3\frac{dy}{dx}+5y=0   \tag{51}\]</div>
<p>but now with boundary conditions <span class="math notranslate nohighlight">\(y_0 = 1\)</span> and <span class="math notranslate nohighlight">\(y_2 = 0\)</span>. This last condition means that the value of <span class="math notranslate nohighlight">\(y\)</span> is fixed at zero when <span class="math notranslate nohighlight">\(x = 2\)</span>. Because this equation can only be solved with initial conditions, the condition <span class="math notranslate nohighlight">\(y_2 = 0\)</span> must be replaced with <span class="math notranslate nohighlight">\(dy/dx |_0 = \alpha\)</span>, and <span class="math notranslate nohighlight">\(\alpha\)</span> must be found so that when the equation is solved, <span class="math notranslate nohighlight">\(y_2 = 0\)</span>. The method to be used is a kind of trial and error techniques called shooting.</p>
<p>An outline shooting algorithm, using the particular initial conditions <span class="math notranslate nohighlight">\(y_0 = a\)</span> and <span class="math notranslate nohighlight">\(y_2 = b\)</span> is;</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{lll}\\
\text{(1) Set } y_0 = a. \text{ Guess  initial } \alpha\\ 
\qquad\text{Set precision Q to restrict }|y_{2\alpha} - b|\lt Q\\
\qquad\text{Set  loop  limit  in  case  no  result  is found.}\\
\qquad\text{Solve equation with guessed } \alpha \text{ to get initial } y_{2\alpha}.\\
\text{(2) Loop until }|y_{2\alpha} - b|\lt Q \text{ or loop limit exceeded}\\
\qquad\text{(i) Numerically solve the equation in the range } a \le x \le b.\\
\qquad\text{(ii) Save } y_{2\alpha} \text{ the value of } y \text{ at }x = 2 \text{ found with value } \alpha \\
\qquad\text{(iii) Update } \alpha\\
\quad\text{ Loop to (2)}\\
\text{(3) Print result and plot data}\\
\end{array}\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(y\)</span> value calculated at the last data point (<span class="math notranslate nohighlight">\(x = 2\)</span> in this case) is the boundary value <span class="math notranslate nohighlight">\(y_{2\alpha}\)</span> for each <span class="math notranslate nohighlight">\(\alpha\)</span>, and this has to be stored after each solution and compared with the boundary condition <span class="math notranslate nohighlight">\(y_2 = b\)</span>. A new value of <span class="math notranslate nohighlight">\(\alpha\)</span> is now chosen, and the new <span class="math notranslate nohighlight">\(y_{2\alpha}\)</span> compared with the boundary value; when the difference is small enough the calculation ends. Ideally, the difference between the estimated and true value is zero; therefore, this calculation is the same as numerically finding the root of an equation. The new value of <span class="math notranslate nohighlight">\(\alpha\)</span> is the root that can be found by linear interpolation (e.g. secant method), using the last two values calculated. Choosing the initial value of <span class="math notranslate nohighlight">\(\alpha\)</span> is quite an art. Some equations are ‘forgiving’ and a value close to <span class="math notranslate nohighlight">\(y_0\)</span> will produce a converging solution at the boundary; in other equations some experimenting with different <span class="math notranslate nohighlight">\(\alpha\)</span> values is needed before a solution is reached; the innocuous looking equation <span class="math notranslate nohighlight">\(d^2y/dx^2 = 1/(1 + y^2)\)</span> is difficult to solve unless <span class="math notranslate nohighlight">\(\alpha\)</span> starts close to zero and the next <span class="math notranslate nohighlight">\(\alpha\)</span> value chosen is also very small.</p>
<p>Before working out a specific example, it is worth noting that the boundary conditions and the equation can be written generally, and in numerical methods textbooks may appear as</p>
<div class="math notranslate nohighlight">
\[\frac{d^2y}{dx^2}=f(x,y,dy/dx), \quad a \le x \le b ;\quad y_a = r,\quad y_b=s\]</div>
<p>The function <span class="math notranslate nohighlight">\(f (x, y, dy/dx)\)</span> simply means that the differential equation has terms in one or more of <span class="math notranslate nohighlight">\(x,\; y\)</span>, and <span class="math notranslate nohighlight">\(dy/dx\)</span> such as <span class="math notranslate nohighlight">\(d^2y/dx^2 + dy/dx + x^2 + y = 0\)</span>. The initial condition needed to solve this equation has the form <span class="math notranslate nohighlight">\(dy/dx |_a = \alpha\)</span>; note that this is defined at <span class="math notranslate nohighlight">\(a\)</span>, the initial point, and uses the value <span class="math notranslate nohighlight">\(\alpha\)</span> that must be found. The boundary condition <span class="math notranslate nohighlight">\(y_b = s\)</span> can be thought of as the non-linear equation <span class="math notranslate nohighlight">\(y_b(\alpha) - s = 0\)</span> in the parameter <span class="math notranslate nohighlight">\(\alpha\)</span>, and this is the equation that has to be solved iteratively to find its root.</p>
<p>To implement the shooting algorithm, the differential equation has to be solved several times with different initial values. In this case, it makes sense to put this part of the calculation into a small procedure so that the same code does not have to be repeated in several places. A procedure is shown below and is based on Algorithm 14. This code is placed inside the procedure and the parameters needed are passed through the header.  The equation to be solved, <span class="math notranslate nohighlight">\(d^2y/dx^2 + 3dy/dx + 5y = 0\)</span>, is split into two coupled equations, in the usual way,  as lambda functions.</p>
<p>The modified Euler method is made into a procedure as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Algorithm 17  modified Euler procedure</span>

<span class="k">def</span> <span class="nf">mod_euler</span><span class="p">(</span><span class="n">dydx</span><span class="p">,</span><span class="n">dzdx</span><span class="p">,</span><span class="n">xvals</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">xn</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Modified Euler or RK2 method</span>
    
    <span class="n">Eulery</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>   <span class="c1"># define arrays for results</span>
    <span class="n">Eulerz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">xn</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>                   <span class="c1"># initial values</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">z0</span>

    <span class="n">Eulery</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="n">Eulerz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">z0</span>
    <span class="n">xvals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>      <span class="c1"># modifiued Euler </span>
        <span class="n">k1</span><span class="o">=</span> <span class="n">dydx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">L1</span><span class="o">=</span> <span class="n">dzdx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="n">k2</span><span class="o">=</span> <span class="n">dydx</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">L1</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
        <span class="n">L2</span><span class="o">=</span> <span class="n">dzdx</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">k1</span><span class="o">*</span><span class="n">h</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">L1</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">L1</span><span class="o">+</span><span class="n">L2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">h</span>
        <span class="n">Eulery</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
        <span class="n">Eulerz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
        <span class="n">xvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">x</span>
        <span class="k">pass</span>
    
    <span class="k">return</span> <span class="n">Eulery</span><span class="p">,</span><span class="n">Eulerz</span>
</pre></div>
</div>
</div>
</div>
<p>The procedure takes the functions <span class="math notranslate nohighlight">\(dydx,\;dzdx\)</span>, and the <span class="math notranslate nohighlight">\(x\)</span> values and initial values and number of points to calculate. In the shooting method shown below the secant method is used to find the boundary values (section 2)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 18 Shooting method </span>

<span class="n">dydx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="p">:</span> <span class="n">z</span>             <span class="c1"># define differential equations as functions </span>
<span class="n">dzdx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">y</span>

<span class="n">n</span>  <span class="o">=</span> <span class="mi">200</span>       <span class="c1"># number of points</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.0</span>       <span class="c1"># left hand boundary</span>
<span class="n">xn</span> <span class="o">=</span> <span class="mf">2.0</span>       <span class="c1"># calculate to this boundary</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mf">1.0</span>       <span class="c1"># left hand boundary, point a</span>
<span class="n">yxn</span> <span class="o">=</span> <span class="mf">0.0</span>      <span class="c1"># boundary at xn</span>

<span class="n">alpha0</span> <span class="o">=</span> <span class="mf">0.0</span>   <span class="c1"># initial alpha guess dy/dx=alpha</span>
<span class="n">alpha1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">alpha0</span>        <span class="c1"># guess initial value</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mf">1e-6</span>       <span class="c1"># choose limit on accuracy of bisection</span>

<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>    <span class="c1"># define array to hold x values</span>

<span class="n">yvals</span><span class="p">,</span><span class="n">zvals</span> <span class="o">=</span> <span class="n">mod_euler</span><span class="p">(</span> <span class="n">dydx</span><span class="p">,</span><span class="n">dzdx</span><span class="p">,</span> <span class="n">xvals</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">alpha0</span><span class="p">,</span><span class="n">xn</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="c1"># solve with initial alpha</span>
<span class="n">yn0</span> <span class="o">=</span> <span class="n">yvals</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                   <span class="c1"># initial value at right hand boundary xn</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yn0</span><span class="o">-</span><span class="n">yxn</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Q</span><span class="p">:</span>                        <span class="c1"># start iterative loop to find solution</span>
    <span class="n">yvals</span><span class="p">,</span><span class="n">zvals</span> <span class="o">=</span> <span class="n">mod_euler</span><span class="p">(</span> <span class="n">dydx</span><span class="p">,</span><span class="n">dzdx</span><span class="p">,</span><span class="n">xvals</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">alpha1</span><span class="p">,</span><span class="n">xn</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="n">yn1</span>   <span class="o">=</span> <span class="n">yvals</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">alpha1</span><span class="o">=</span> <span class="n">alpha1</span> <span class="o">-</span><span class="p">(</span><span class="n">yn1</span><span class="o">-</span><span class="n">yxn</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">alpha1</span><span class="o">-</span><span class="n">alpha0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">yn1</span><span class="o">-</span><span class="n">yn0</span><span class="p">)</span>     <span class="c1"># secant method </span>
    <span class="n">alpha0</span><span class="o">=</span> <span class="n">alpha1</span>
    <span class="n">yn0</span>   <span class="o">=</span> <span class="n">yn1</span>                                             <span class="c1"># end secant</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>                                               <span class="c1"># loop counter</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;index = &#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span><span class="s1">&#39; error =&#39;</span><span class="p">,</span><span class="n">yn0</span><span class="o">-</span><span class="n">yxn</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">pass</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;alpha_0&#39;</span><span class="p">,</span><span class="n">alpha0</span><span class="p">)</span> <span class="p">)</span>
<span class="c1">#plt.plot(xvals, yvals,color=&#39;blue&#39;)</span>
<span class="c1">#plt.show()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>index =  1  error = -0.0618948
index =  2  error = 6.5746e-16
alpha_0 -11.892761
</pre></div>
</div>
</div>
</div>
<p>The results are printed out at the end of the calculation; the number of iterations is limited to 5 to keep the calculation short; you can increase this. There is no check on the stability of the calculation; you will have check to see if <span class="math notranslate nohighlight">\(\alpha\)</span> is a sensible value by looking at the size of the error. If this is large, <span class="math notranslate nohighlight">\(\gg Q\)</span>, then it may be necessary to choose another value of <span class="math notranslate nohighlight">\(\alpha\)</span> to start with. A good initial value can only be chosen by trial and error. (Occasionally the secant method fails when <span class="math notranslate nohighlight">\(yN1 - yN0 = 0\)</span> and a very small value 10<sup>-10</sup> can be added to <span class="math notranslate nohighlight">\(\alpha_l\)</span> to prevent this.) The result of the calculation for equation 51 is shown in Figure 26 with the boundary conditions <span class="math notranslate nohighlight">\(y_0 = 1\)</span> and <span class="math notranslate nohighlight">\(y_2 = 0\)</span>. The initial conditions satisfying these boundary conditions are <span class="math notranslate nohighlight">\(y_0 = 1\)</span> and <span class="math notranslate nohighlight">\(\alpha = dy/dx |_0 = −11.89\)</span>.</p>
<img src='num-methods-fig26.png' alt='Drawing' style='width:400px'/>
<p>Figure 26. Solution to boundary problem equation 51. The initial values <span class="math notranslate nohighlight">\(y_0 = 1\)</span> and <span class="math notranslate nohighlight">\(dy/dx|0 = -11.9\)</span> were calculated and are consistent with boundary values <span class="math notranslate nohighlight">\(y_0 = 1\)</span> and <span class="math notranslate nohighlight">\(y_2 = 0\)</span>.</p>
<hr class="docutils" />
<div class="section" id="numerical-integration-of-the-schroedinger-equation">
<h2>10 Numerical integration of the Schroedinger equation<a class="headerlink" href="#numerical-integration-of-the-schroedinger-equation" title="Permalink to this headline">¶</a></h2>
<p>In one dimension, the Schroedinger equation for a particle of mass <span class="math notranslate nohighlight">\(m\)</span> with an energy <span class="math notranslate nohighlight">\(E\)</span> in a potential <span class="math notranslate nohighlight">\(V(x)\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle -\frac{\hbar^2}{2m}\frac{d^2\psi(x)}{dx^2}+V(x)\psi(x)=E\psi(x)\]</div>
<p>The first term represents the kinetic energy, the second the potential energy with potential, <span class="math notranslate nohighlight">\(V(x)\)</span>, and <span class="math notranslate nohighlight">\(E\)</span> is the total energy. At each of certain discrete energies, called the eigenvalues, this equation has a wavefunction that satisfies the condition <span class="math notranslate nohighlight">\(\psi(x) \to 0,\; (x \to R)\)</span> where <span class="math notranslate nohighlight">\(R\)</span> is a distance large compared to the extent of the potential at energy <span class="math notranslate nohighlight">\(E\)</span>. However, at almost any value of <span class="math notranslate nohighlight">\(E\)</span> the equation has a solution, which means that it can be integrated to find <span class="math notranslate nohighlight">\(\psi(x)\)</span>, but only when <span class="math notranslate nohighlight">\(\psi(x) \to 0,\; (x \to R)\)</span> does <span class="math notranslate nohighlight">\(\psi(x)\)</span> have a physical interpretation. The range <span class="math notranslate nohighlight">\(R\)</span> is taken to be the extent over which the particle can exist; while this is often <span class="math notranslate nohighlight">\(\pm \infty\)</span>, as in a harmonic oscillator, it is <span class="math notranslate nohighlight">\(\pm L/2\)</span> in an infinitely high square well potential of length <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(0 \to \infty\)</span> for atoms. Once the energy <span class="math notranslate nohighlight">\(E\)</span> is determined then the wavefunction can be found. The Numerov method is an efficient way to do this but Runge-Kutta or the Euler methods can also be used provided a method is chosen with sufficient precision.</p>
<p>Imposing the physics onto the mathematics leads to a huge reduction in the number of possible solutions, but presents us with the interesting task of finding just those solutions that are physically meaningful. Suppose that <span class="math notranslate nohighlight">\(\psi(x)\)</span> is the value of a wavefunction of a (quantum) particle at some position <span class="math notranslate nohighlight">\(x\)</span>. The word ‘particle’ is used generically; it might be, for example, an electron, a proton, a rotational, or a vibrational quantum of a molecule. One of the axioms of quantum mechanics is that the probability at time <span class="math notranslate nohighlight">\(t\)</span> of finding a particle between coordinate <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(x + dx\)</span> is <span class="math notranslate nohighlight">\(\psi(x)^*\psi(x)\)</span> and, since the particle must exist somewhere in the range <span class="math notranslate nohighlight">\(-\infty \le x \le \infty\)</span> , the total probability must be 1:<span class="math notranslate nohighlight">\(\displaystyle \int_{-\infty}^{\infty} \psi(x)^*\psi(x)dx=1\)</span>. Because the probability over all space is 1, this ensures that that every wavefunction is zero at <span class="math notranslate nohighlight">\(\pm \infty :\psi(x)\to 0,(x \to \pm \infty\)</span>).</p>
<p>The derivative of <span class="math notranslate nohighlight">\(\psi\)</span> at infinity is also zero <span class="math notranslate nohighlight">\(d\psi/dx|_\infty \to 0\)</span>. The wavefunctions only have this property at certain discrete values of <span class="math notranslate nohighlight">\(E\)</span>, and these are called the eigenvalues. The shape of the wavefunction changes depending on the energy; for example, 1s, 2s, and 3s atomic orbitals do have different shapes, as do the wavefunctions of the harmonic oscillator or of the ‘particle in a box’.</p>
<p>Mathematically, the restriction <span class="math notranslate nohighlight">\(\psi(x) \to 0, (x \to R)\)</span> makes the integration of the Schroedinger equation a boundary value problem. In solving for the energies and wavefunctions of the hydrogen or other atoms where the wavefunction’s range is <span class="math notranslate nohighlight">\(r = 0\cdots \infty\)</span>, and the wavefunction is not always zero at <span class="math notranslate nohighlight">\(r = 0\)</span>, the spherically symmetric nature of the problem means that <span class="math notranslate nohighlight">\(\psi(r)^*\psi(r)\)</span> has to be multiplied by <span class="math notranslate nohighlight">\(4πr^2\)</span> to take into account the volume element of spherical coordinates. The probability density is then always zero at <span class="math notranslate nohighlight">\(r = 0\)</span> and at infinity.</p>
<p>In the numerical calculation, the discrete energies (eigenvalues) <span class="math notranslate nohighlight">\(E\)</span> in an attractive potential, such as a harmonic oscillator, can be estimated by several different methods. One of the easiest to use is the shooting method. Once an <em>eigenvalue</em>, which is energy, <span class="math notranslate nohighlight">\(E\)</span> is found either the Euler, or a more sophisticated numerical method can be used to find its wavefunction that is also called its <em>eigenfunction</em>.</p>
<p>Two boundary conditions <span class="math notranslate nohighlight">\(\psi(x) \to 0, (x \to R)\)</span> have to be translated into two initial values because the Schroedinger equation is second order. Suppose that one is <span class="math notranslate nohighlight">\(\beta\)</span>, the value the wavefunction has at some starting point, for example at <span class="math notranslate nohighlight">\(x = 0,\; \psi_0 = \beta\)</span>. The other value is the slope of the wavefunction at the same point; <span class="math notranslate nohighlight">\(d\psi/dx |_0 = \gamma\)</span>. The quantities <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are derived shortly.</p>
<p>To integrate the equation, a shooting method can be used but in a slightly different manner to that described in Section 11.9. Because of the physics involved, the initial values of <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(d\psi/dx\)</span> can be fixed at the outset, and instead the calculation is performed by changing the values of <span class="math notranslate nohighlight">\(E\)</span> and the result checked to see if the boundary condition <span class="math notranslate nohighlight">\(\psi(x) \to 0, (x \to R)\)</span> is obtained at a given <span class="math notranslate nohighlight">\(E\)</span>. If it is not, which is generally the case, <span class="math notranslate nohighlight">\(E\)</span> is incremented by a small amount and the calculation repeated. When the wavefunction changes sign at the boundary point, it has passed through <span class="math notranslate nohighlight">\(\psi(x) = 0\)</span> and an approximate value for the eigenvalue is found as the average of the last two values of <span class="math notranslate nohighlight">\(E\)</span>, Figure 27. At this point the eigenvalue can be estimated more accurately if required, by bisecting the energy range between the last two calculations into smaller parts. When this first eigenvalue has been found, the energy <span class="math notranslate nohighlight">\(E\)</span> is then increased by a small amount and the next eigenvalue is sought, and so the eigenvalues are successively found with increasing energy. It is very important for an accurate determination of <span class="math notranslate nohighlight">\(E\)</span> that the precision with which the wavefunction approximates to zero at large <span class="math notranslate nohighlight">\(x\)</span> is very high. In the case of a double potential well, such as occurs in the ammonia inversion, if this is not the case energy levels that should be split by a small amount will, erroneously, have the same energy. Decreasing the value at which the bisection is terminated, therefore making the wavefunction closer to zero, will cure this. The stopping value <span class="math notranslate nohighlight">\(Q\)</span> may ultimately need to be as small as 10<sup>-8</sup>; see Algorithm 18.</p>
<p>The calculation does not have to be carried out to <span class="math notranslate nohighlight">\(x = \infty\)</span>. Clearly this would be impossible, and an effective infinity is used instead. This is estimated from the shape of the potential; as a rule of thumb, extending the <span class="math notranslate nohighlight">\(x\)</span> value in the calculation to twice the width of the potential at the maximum energy to be calculated is usually sufficient. The exception is the particle in the box, where this extends only to the edge of the box.</p>
</div>
<div class="section" id="the-shooting-method-example-with-a-quadratic-potential">
<h2>10.1 The shooting method example with a quadratic potential<a class="headerlink" href="#the-shooting-method-example-with-a-quadratic-potential" title="Permalink to this headline">¶</a></h2>
<div class="section" id="calculating-eigenvalues-and-wavefunctions">
<h3>Calculating eigenvalues and wavefunctions<a class="headerlink" href="#calculating-eigenvalues-and-wavefunctions" title="Permalink to this headline">¶</a></h3>
<p>In solving the Schroedinger equation is is necessary to re-write it into a more convenient form and also split it into to equations as done with previous examples of second order equations. Rearranging produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d^2\psi(x)}{dx} -  \frac{2m}{\hbar^2}\left(V(x)-E\right)\psi(x)=0\]</div>
<p>then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d\psi(x)}{dx}=v, \qquad  \frac{dv}{dx} = \frac{2m}{\hbar^2}\left(V(x)-E\right)\psi(x)\]</div>
<p>As an example, suppose that the potential <span class="math notranslate nohighlight">\(V\)</span> in the Schroedinger equation is quadratic <span class="math notranslate nohighlight">\(V(x) = kx^2/2\)</span>, which is symmetric and centred on zero. The value of the force constant <span class="math notranslate nohighlight">\(k\)</span> is known from spectroscopic experiments for many molecules, e.g. 516 N m<sup>-1</sup> for HCl and 172.1 N m<sup>-1</sup> for I<sub>2</sub>, so that the calculation can be checked with known values of the energy levels, which are spaced as <span class="math notranslate nohighlight">\(\hbar \omega(n + 1/2)\)</span> with <span class="math notranslate nohighlight">\(\omega = \sqrt{k/\mu}\)</span> if <span class="math notranslate nohighlight">\(\omega\)</span> is in radians s<sup>-1</sup> and <span class="math notranslate nohighlight">\(\mu\)</span> is the reduced mass in kg.</p>
<p>The calculation starts by solving the Schroedinger equation for <span class="math notranslate nohighlight">\(\psi\)</span> at zero energy and <span class="math notranslate nohighlight">\(x = 0\)</span>, which happens to be at the lowest point of the potential, and <span class="math notranslate nohighlight">\(E\)</span> is incremented by a small amount and at each new value the <em>sign</em> of the wavefunction at the boundary is checked. The energy is incremented until <span class="math notranslate nohighlight">\(\psi\)</span> changes sign. When this happens an eigenvalue has been passed and the energy <span class="math notranslate nohighlight">\(E\)</span> of the eigenvalue is between these last two values. The bisection method is now used to find an accurate value of the eigenvalue. This is a very stable method but takes several steps to reach the minimum for a given level of precision; the slowness of this method is more than compensated for by its stability because the Newton - Raphson or secant methods are rather subject to instability and can miss eigenvalues. A new energy is now chosen just above the last one found and a new eigenvalue sought and so forth, until the maximum energy required has been reached. The energy increments must be small enough not to miss an eigenvalue but not so small that the calculation takes an inordinate length of time, so some knowledge of the likely energy spacing, based on your knowledge of the chemical physics involved, is going to be useful.</p>
</div>
<div class="section" id="eigenvalues">
<h3>Eigenvalues<a class="headerlink" href="#eigenvalues" title="Permalink to this headline">¶</a></h3>
<p>The solutions of the Schroedinger equation in a symmetrical potential have either an ‘odd’ or ‘even’ parity, meaning that the wavefunction is either symmetrical and has a mirror image about the y-axis, or non-symmetrical and has instead a centre of inversion. If the wavefunction is of even parity then <span class="math notranslate nohighlight">\(\psi(x) = \psi(-x)\)</span> and is finite at the origin but has zero slope; the initial condition is therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \psi(0)=1, \qquad \frac{d\psi}{dx}\bigg|_0=0  \tag{52}\]</div>
<p>If the wavefunction is odd, then <span class="math notranslate nohighlight">\(\psi(x) = -\psi(-x)\)</span> and its value at the origin <span class="math notranslate nohighlight">\(x = 0\)</span> must be zero, but its gradient has constant value; therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \psi(0)=0, \qquad \frac{d\psi}{dx}\bigg|_0=1  \tag{53}\]</div>
<p>The number 1 is used in these initial values as it only defines the size of the wavefunction. As <span class="math notranslate nohighlight">\(\psi\)</span> can be normalized at the end of the calculation these values are not critical. The zeros reflect the odd - even parity and are essential.</p>
<p>For simplicity, Planck’s constant and the reduced mass are set equal to unity, see later how to use atomic unit. If the harmonic potential is <span class="math notranslate nohighlight">\(V(x) = 10x^2\)</span>, the force constant <span class="math notranslate nohighlight">\(k =20\)</span> and with quantum numbers <span class="math notranslate nohighlight">\(n = 0, 1, 2 \cdots\)</span> , the eigenvalues are <span class="math notranslate nohighlight">\(\sqrt{20}(n + 1/2)\)</span>, which allows an easy comparison with the calculated values. The accuracy of the integration depends not only on the number of steps taken, as with all other integrations, but also on having an accurate integration method. In this example the Numerov method was used, algorithm 16a. Because any method is going to be called several times in the calculation it is placed into its own procedure. The potential to be used is passed into the procedure so this can be used for other symmetric potentials.</p>
<p>The code used is shown below.  Using this code, even and odd eigenfunctions are calculated. To calculate odd numbered ones, the initial value <span class="math notranslate nohighlight">\(y_0\)</span> has to be changed 0 and <span class="math notranslate nohighlight">\(dy/dx = 1\)</span>, see equation 53. Note also that this code will only work properly if the potential is positive; if it is negative then a constant should be added to make its lowest value zero and then subtracted from the final eigenvalues.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 20 Shooting Method used to solve the Schroedinger equation.</span>

<span class="c1">#--------------</span>
<span class="k">def</span> <span class="nf">solve_SE</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">init0</span><span class="p">,</span><span class="n">init1</span><span class="p">,</span><span class="n">E0</span><span class="p">):</span>      <span class="c1"># dpsidx=v, dvdx = 2mu/(hbar^2)(V-E)*psi</span>
    
    <span class="k">def</span> <span class="nf">derivs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>                                            <span class="c1"># y =[init0,init1]</span>
        <span class="n">dvdx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">mu</span><span class="o">/</span><span class="n">hbar</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">V</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">E0</span> <span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="c1"># potential varies with x</span>
        <span class="n">dpsidx</span><span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dpsidx</span><span class="p">,</span> <span class="n">dvdx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 

    <span class="n">y</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span> <span class="n">derivs</span><span class="p">,</span> <span class="p">[</span><span class="n">init0</span><span class="p">,</span><span class="n">init1</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>             <span class="c1"># Numpy/Scipy method : derivatives, initial values , x.</span>
    <span class="k">return</span> <span class="n">y</span>                                          <span class="c1"># shape= [n,2], y= wavefunction at energy E0</span>
<span class="c1">#------------</span>

<span class="n">k</span> <span class="o">=</span> <span class="mf">20.0</span>                                              <span class="c1"># force constant</span>
<span class="n">V</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>                           <span class="c1"># harmonic potential</span>

<span class="n">mu</span> <span class="o">=</span>   <span class="mf">1.0</span>                                            <span class="c1"># mass</span>
<span class="n">hbar</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">n</span> <span class="o">=</span>    <span class="mi">1000</span>                                           <span class="c1"># num points</span>
<span class="n">x0</span> <span class="o">=</span>   <span class="mf">0.0</span>                                            <span class="c1"># initial x</span>
<span class="n">xN</span> <span class="o">=</span>   <span class="mf">5.0</span>                                            <span class="c1"># boundary or infinity x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>                              <span class="c1"># start, stop &amp; number of points</span>
<span class="n">yxN</span> <span class="o">=</span>    <span class="mf">0.0</span>                                          <span class="c1"># boundary value at maxN</span>
<span class="n">deltaE</span> <span class="o">=</span> <span class="mf">1.0</span>                                          <span class="c1"># energy increment, must be less than sep&#39;n of energy levels</span>
<span class="n">maxE</span> <span class="o">=</span> <span class="mf">100.0</span>                                          <span class="c1"># max energy</span>
<span class="n">Q</span> <span class="o">=</span>      <span class="mf">1e-13</span>                                        <span class="c1"># stopping value</span>
<span class="n">xf</span> <span class="o">=</span> <span class="n">xN</span>
<span class="k">for</span> <span class="n">indx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>                                    <span class="c1"># do odd-even values</span>
    <span class="n">En0</span> <span class="o">=</span>    <span class="mf">0.0</span>                                      <span class="c1"># starting energy</span>
    <span class="n">Qn</span>  <span class="o">=</span>   <span class="n">indx</span>                                      <span class="c1"># even/odd quantum number</span>
    <span class="n">dydx</span><span class="o">=</span>   <span class="n">indx</span><span class="o">*</span><span class="mf">1.0</span>                                  <span class="c1"># initial dy/dx guess</span>
    <span class="n">y0</span> <span class="o">=</span>    <span class="mf">1.0</span><span class="o">-</span><span class="n">indx</span>                                  <span class="c1"># y0 even quantum num, any value here is ok except 0 </span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">solve_SE</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">dydx</span><span class="p">,</span><span class="n">En0</span><span class="p">)</span>                      <span class="c1"># get all y values at energy En0</span>
    <span class="n">yN0</span><span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>                                     <span class="c1"># save point at boundary i.e. at xN</span>
    <span class="n">En1</span><span class="o">=</span> <span class="n">En0</span> <span class="o">+</span> <span class="n">deltaE</span>                                 <span class="c1"># second try with energy</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;quantum num, eigenvalue&#39;</span><span class="p">))</span>
    <span class="k">while</span> <span class="n">En1</span> <span class="o">&lt;</span> <span class="n">maxE</span> <span class="p">:</span>                                <span class="c1"># keep on to max energy</span>
        
        <span class="n">y</span>  <span class="o">=</span> <span class="n">solve_SE</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">dydx</span><span class="p">,</span>  <span class="n">En1</span><span class="p">)</span>              <span class="c1"># solve at energy En1</span>
        <span class="n">yN1</span><span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>                                <span class="c1"># save point at boundary</span>
        <span class="c1">#print(Qn,yN1,yN0)</span>
        <span class="k">if</span> <span class="n">yN1</span><span class="o">*</span><span class="n">yN0</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">:</span>                            <span class="c1"># check if zero crossed</span>
            <span class="c1"># ** start bisection method **</span>
            <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">En1</span> <span class="o">-</span> <span class="n">En0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Q</span> <span class="p">:</span>                <span class="c1"># difference in energy&gt;Q</span>
                <span class="n">Em</span> <span class="o">=</span><span class="p">(</span><span class="n">En1</span> <span class="o">+</span> <span class="n">En0</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>                   <span class="c1"># mid point</span>
                <span class="n">y</span>  <span class="o">=</span> <span class="n">solve_SE</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">dydx</span><span class="p">,</span>  <span class="n">Em</span><span class="p">)</span>       <span class="c1"># recalc at energy Em. y is wavefunction</span>
                <span class="n">ym</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>                         <span class="c1"># y at boundary</span>
                <span class="k">if</span> <span class="n">yN0</span><span class="o">*</span><span class="n">ym</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>                       <span class="c1"># check sign of y (wavefunction)</span>
                    <span class="n">En0</span> <span class="o">=</span> <span class="n">Em</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">En1</span> <span class="o">=</span> <span class="n">Em</span>
                    <span class="k">pass</span>
                <span class="k">pass</span>                                    <span class="c1"># end of while abs()</span>
            
            <span class="n">yN0</span> <span class="o">=</span> <span class="n">yN1</span>                                   <span class="c1"># replace for next calc</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:5d}</span><span class="s1">   </span><span class="si">{:12.6f}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">Qn</span><span class="p">,</span> <span class="n">En1</span><span class="p">))</span> <span class="c1"># results</span>
                                                        <span class="c1"># plot energy levels and wavefunctions here</span>
            <span class="n">Qn</span> <span class="o">=</span> <span class="n">Qn</span> <span class="o">+</span> <span class="mi">2</span>                                 <span class="c1"># increase quantum num  </span>
            <span class="k">pass</span>
            <span class="c1"># ** end bisection **</span>
        <span class="n">En0</span> <span class="o">=</span> <span class="n">En1</span> 
        <span class="n">yN0</span> <span class="o">=</span> <span class="n">yN1</span>                                        <span class="c1"># replace for next calc</span>
        <span class="n">En1</span> <span class="o">=</span> <span class="n">En1</span> <span class="o">+</span> <span class="n">deltaE</span>                               <span class="c1"># new energy</span>
        <span class="k">pass</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>quantum num, eigenvalue
    0       2.236068 
    2      11.180340 
    4      20.124612 
    6      29.068884 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    8      38.013156 
   10      46.957428 
   12      55.901700 
   14      64.845972 
   16      73.790244 
   18      82.734515 
   20      91.678788 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>quantum num, eigenvalue
    1       6.708204 
    3      15.652476 
    5      24.596748 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    7      33.541021 
    9      42.485292 
   11      51.429563 
   13      60.373834 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   15      69.318106 
   17      78.262378 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   19      87.206651 
   21      96.150921 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p>The eigenvalues for two different potentials are shown in Fig. 28. The harmonic <span class="math notranslate nohighlight">\(V(x) = (k/2)x^2,\; k=20\)</span>  and the double well, <span class="math notranslate nohighlight">\(V(x) = x^4 - 13x^2 + 169/4\)</span>, which has a minimum of zero and a barrier height of 42.25. A few eigenvalues for the harmonic potential are listed below, and the agreement between the numerical and exact eigenvalue energy is good to at least five decimal places.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c c c}\\
\text{n} &amp; \text{eigenvalue} &amp; \text{eigenvalue}\\
    0  &amp;    2.236068  &amp;  2.236068\\
    1  &amp;    6.708204  &amp;  6.708204\\
    2  &amp;   11.180340  &amp; 11.180340\\
    3  &amp;   15.652476  &amp; 15.652476\\
    4  &amp;   20.124612  &amp; 20.124612\\
    5  &amp;   24.596748  &amp; 24.596748\\
    6  &amp;   29.068884  &amp; 29.068884\\
   10  &amp;   46.957428  &amp; 46.957428\\
   15  &amp;   69.318106  &amp; 69.318107\\
   20  &amp;   91.678788  &amp; 91.678787\\
\end{array}\end{split}\]</div>
<p>The code used the shooting method with Python/Scipy method ‘odeint’ to integrate the Schroedinger equation. For simplicity the mass and <span class="math notranslate nohighlight">\(\hbar = 1\)</span>. The calculation using atomic units is described in section 10.2.</p>
<table>
    <tr>
    <td>
    <figure>
        <img src='num-methods-fig28a.png'  alt='Drawing' style='width: 400px;'/> 
        </figure> 
        </td>
    <td>
    <figure>
        <img src='num-methods-fig28b.png'  alt='Drawing' style='width: 400px;'/>
        </figure>
        </td>
     </tr>
</table>
<p>Figure 28 Potential energy and eigenvalues. Left the harmonic potential <span class="math notranslate nohighlight">\(V(x) = 10x^2\)</span>. Right The double well potential <span class="math notranslate nohighlight">\(V(x) = x^4 - 13x^2 + 169/4\)</span>.</p>
<p>The eigenvalues for the double well show a splitting below the barrier, as expected, because the two wells interact. However, the difference in energy is very small lower down in the well, and the levels are, in this particular potential, effectively accidentally degenerate. Only near the top of the barrier are two closely spaced levels visible in the plot, with quantum numbers <span class="math notranslate nohighlight">\(n = 12\)</span> and <span class="math notranslate nohighlight">\(13\)</span>. This is because the barrier is narrow here and there is more interaction between the two halves of the potential. Above the barrier, the potential is suddenly wider and the energy levels now become closer together. Crudely, this can be thought of in a similar way as an infinite square well or ‘particle in a box’. A wide well has energy levels closer together than a short one. As the potential energy increases, so does the separation between eigenvalues, just as happens in the square well.</p>
<p>The harmonic potential is unusual because as the energy increases so does the width of the well and it does so in such a way that the energy separation between adjacent levels is constant. In comparison in the infinite square well, adjacent levels separate by ever-increasing amounts as the energy increases. In a potential such as <span class="math notranslate nohighlight">\(|x^{3/2}|\)</span>, the level separation decreases with an increase in energy as they also do in the hydrogen atom, where the potential is proportional to <span class="math notranslate nohighlight">\(1/x\)</span>, or in the anharmonic oscillator with the Morse potential. The difference in the spacing between energy levels the harmonic and double well potentials is shown in Fig. 11.28. In the double well potential below an energy of <span class="math notranslate nohighlight">\(30\)</span> units, the well is narrow, which means it effectively has a large force constant causing the energy levels to be widely spaced, compared to the harmonic potential which is wider, at the same energy, and therefore has a smaller force constant. Well above the barrier, the widths of the double and harmonic potential gradually become similar and the energy spacings are now also more similar to one another.</p>
</div>
<div class="section" id="wavefunctions">
<h3>Wavefunctions<a class="headerlink" href="#wavefunctions" title="Permalink to this headline">¶</a></h3>
<p>Once the eigenvalues are known the wavefunctions have also effectively been calculated, see Algorithm 11.18. Depending on the method used one half of the wavefunction can be calculated then its image used to form the other half or the whole may be calculated in one go. This is possible because in a symmetrical well the left half is either the mirror image or the inverse mirror image of the right half. Figure 11.29 shows some of the wavefunctions, eigenvalues, and the double well potential of Fig. 11.28.</p>
<p>At low energy, far below the barrier top, the eigenvalues <span class="math notranslate nohighlight">\((E_0, E_1),\; (E_2, E_3)\)</span>, etc. are grouped in pairs with a nearly identical energy because the barrier almost, but not quite, separates the two wells. The lowest two eigenvalues have energy <span class="math notranslate nohighlight">\(3.5661\)</span> and the next two have energy <span class="math notranslate nohighlight">\(10.5327\)</span>, both pairs being similar to within eight decimal places. Levels <span class="math notranslate nohighlight">\(10\)</span> and <span class="math notranslate nohighlight">\(11\)</span> are separated by slightly more energy: <span class="math notranslate nohighlight">\(35.1961\)</span> and <span class="math notranslate nohighlight">\(35.2167\)</span> respectively, which is still small. Levels <span class="math notranslate nohighlight">\(12\)</span> and <span class="math notranslate nohighlight">\(13\)</span>, which are shown in the figure, have just enough of an energy difference (<span class="math notranslate nohighlight">\(39.9156\)</span> and <span class="math notranslate nohighlight">\(40.22768\)</span>) to be seen as separate levels. The wavefunctions with small quantum numbers, <span class="math notranslate nohighlight">\(0 \le n \le 9\)</span>, are rather like those of two separated wells but still have odd and even parity overall, as does each half. The <span class="math notranslate nohighlight">\(n = 13\)</span> wavefunction, Figure 29, has odd parity with a centre of inversion at <span class="math notranslate nohighlight">\(x = 0\)</span>, and it is clear that there is little chance of finding the molecule at zero displacement. It has to tunnel from one well to the other; an effect famously observed in the ‘umbrella’ mode of ammonia inversion. The <span class="math notranslate nohighlight">\(n = 8\)</span> wavefunction similarly exhibits tunnelling, as do all levels below the barrier. As the barrier gradually lessens, the eigenvalues separate as shown for <span class="math notranslate nohighlight">\(n = 12\)</span> and <span class="math notranslate nohighlight">\(13\)</span>. Some memory of the barrier can still be seen in the <span class="math notranslate nohighlight">\(n = 15\)</span> level, which above the barrier has an increased amplitude of the wavefunction at a displacement <span class="math notranslate nohighlight">\(x \approx \pm 3/4\)</span>.</p>
<img src='num-methods-fig29.png' alt='Drawing' style='width:450px'/>
<p>Figure 29. Eigenvalues and wavefunctions vs displacement <span class="math notranslate nohighlight">\(x\)</span> for quantum number 8 to 15 superimposed on the double well potential of Figure 28. The eigenvalues with <span class="math notranslate nohighlight">\(n = 8\)</span> and <span class="math notranslate nohighlight">\(9\)</span> are too close to separate on this figure, as are <span class="math notranslate nohighlight">\(10\)</span> and <span class="math notranslate nohighlight">\(11\)</span>.</p>
</div>
</div>
<div class="section" id="energy-levels-for-the-ammonia-inversion-normal-mode-calculated-using-atomic-units">
<h2>10.2 Energy levels for the ammonia inversion normal mode calculated using atomic units<a class="headerlink" href="#energy-levels-for-the-ammonia-inversion-normal-mode-calculated-using-atomic-units" title="Permalink to this headline">¶</a></h2>
<p>A more realistic example is to calculate the energy levels for ammonia; this also illustrates how to use atomic units to control the huge or tiny numbers present in quantum calculations.</p>
<p>The potential energy (Swalen &amp; Ibers 1962), <span class="math notranslate nohighlight">\(V\)</span>, of the umbrella or tunnelling normal mode vibration, measured as the displacement <span class="math notranslate nohighlight">\(x\)</span> of the N atom from the plane of the H atoms, assuming a <span class="math notranslate nohighlight">\(C_{3V}\)</span> point group, is approximated by <span class="math notranslate nohighlight">\(\displaystyle V(x) = 30471x^2 + 12478e^{−5.005x^2} - 10458\)</span> cm<sup>-1</sup>. The displacement <span class="math notranslate nohighlight">\(x\)</span> is in <span class="math notranslate nohighlight">\(\overset{\text{o}} A\)</span>. The eigenvalues and their spacing will be calculated up to an energy of 4000 cm<sup>-1</sup>, which is above the barrier.</p>
<p>The normal SI units for Planck’s constant and the reduced mass are difficult to use because they generate very large or very small numbers. Converting to atomic units greatly simplifies the calculation. This is done by using an energy scale in hartree, where 1 hartree is <span class="math notranslate nohighlight">\(2.1947465225 \cdot 10^5\)</span> cm<sup>-1</sup> or 27.211396 eV, and the corresponding distance scale, is in units of the Bohr radius <span class="math notranslate nohighlight">\(a_0\)</span>, which is <span class="math notranslate nohighlight">\(0.529177 \cdot10^{-10}\)</span> m. The hartree is the natural unit of energy and is <span class="math notranslate nohighlight">\(e^2/(4\pi\epsilon_0a_0)\)</span>, where <span class="math notranslate nohighlight">\(\epsilon_0\)</span> the permittivity of free space and <span class="math notranslate nohighlight">\(e\)</span> the charge on the electron. The constants in the Schroedinger equation now become <span class="math notranslate nohighlight">\(\hbar^2/m_e = 1\)</span>, where <span class="math notranslate nohighlight">\(m_e\)</span> is the mass in kg of the <em>electron</em> and therefore for the reduced mass <span class="math notranslate nohighlight">\(\mu\)</span> (kg) of the molecular vibration, the ratio <span class="math notranslate nohighlight">\(\displaystyle \frac{\hbar^2}{m_e}\frac{m_e}{\mu}\equiv \frac{m_e}{\mu}\)</span> is used. The schroedinger equation is now</p>
<div class="math notranslate nohighlight">
\[\frac{d^2\psi}{dx^2}-\frac{2\mu}{m_e}\left(V(x)-E\right)\psi=0\]</div>
<p>where displacement <span class="math notranslate nohighlight">\(x\)</span> is now in units of <span class="math notranslate nohighlight">\(a_0\)</span>, and energy in hartree, which means that <span class="math notranslate nohighlight">\(E\)</span> is in hartree. The potential has to be changed to achieve this and becomes</p>
<div class="math notranslate nohighlight">
\[V(x) = (30471a_0^2 x^2 + 12478e^{−5.005a_0^2x^2} - 10457)/2.194746 \cdot 10^5\]</div>
<p>Plotting this potential shows that the calculation needs an <span class="math notranslate nohighlight">\(x\)</span> range of 0 to <span class="math notranslate nohighlight">\(2a_0\)</span> and an energy scale up to 0.02 hartree, Figure 30. The potential is essentially parabolic, except for the low and Gaussian shaped barrier of <span class="math notranslate nohighlight">\(\approx\)</span> 0.0094 hartree (2063 cm<sup>-1</sup>), centred at zero, which produces two energy minima at <span class="math notranslate nohighlight">\(\pm 0.723 a_0\)</span>.</p>
<p>In the numerical calculation, energy increments of no more than 0.001 are needed to determine all the levels accurately. The reduced mass is assumed to be that of three hydrogen atoms acting as one mass, and the nitrogen atom. The masses in kg are <span class="math notranslate nohighlight">\(m_H = 1.673534 \cdot 10^{-27},\;  m_N = 2.325267 \cdot 10^{-26}, \; m_e = 9.1093819 \cdot 10^{-31}\)</span>, making <span class="math notranslate nohighlight">\(\mu/m_e = 4532.769\)</span>.</p>
<img src='num-methods-fig30.png' alt='Drawing' style='width:450px'/>
<p>Figure 30. Calculated energy levels and potential energy function for the inversion or ‘umbrella mode’ vibration in ammonia. The <span class="math notranslate nohighlight">\(n\)</span> = 0 and 1 levels are split but are too close to be drawn separately. The <span class="math notranslate nohighlight">\(n=2\)</span> and 3 levels are just separated by enough energy to be seen individually. The <span class="math notranslate nohighlight">\(n=4\)</span> level is just above the barrier’s top.</p>
<hr class="docutils" />
<p>The first few energy levels (cm<span class="math notranslate nohighlight">\(^{-1}\)</span>)  are
$<span class="math notranslate nohighlight">\(\displaystyle\begin{array}{ccc}
n &amp; \text{energy} &amp; n &amp; \text{energy}\\
0   &amp;  522.67 &amp;  1   &amp;  523.92\\
2   &amp;  1467.54 &amp;  3   &amp;  1513.15\\
4   &amp;  2150.39  &amp; 5   &amp;  2460.93\\
6   &amp;  2981.51  &amp; 7   &amp;  3509.60\\
\end{array}\)</span>$</p>
<p>Four levels, as two closely spaced pairs, appear in the double well part of the potential. Here the inversion mode tunnels through the barrier. Above the barrier there are single levels, see Figure 30. The results show only a moderately good agreement between theory and experiment, see table below. However, the fitting is very sensitive to the parameters of the potential; a change in the potential far too small to see by eye will cause large changes in the calculated energy levels. A more sophisticated calculation would vary the parameters in the potential optimally to fit the data. A further sophistication would add terms in <span class="math notranslate nohighlight">\(x^4\)</span> to the potential, but doing this eventually becomes an exercise in fitting the data to an arbitrary potential that may not have any physical reality. Preferably, the potential should be derived from an <em>ab initio</em> analysis of the motion of the atoms, rather than assuming the potential shape has a certain form; this is, however, a very difficult calculation.</p>
<p>The energy gaps, in cm<span class="math notranslate nohighlight">\(^{-1}\)</span>, compared with the spectroscopically determined values are shown below.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{ccc}
 &amp;\text{Table 3}\\
\text{transition} &amp; \text{calculated} &amp; \text{experiment}\\
\Delta_{1,0}   &amp; 1.2     &amp; 0.7935\\
\Delta_{3,2}   &amp; 46     &amp; 35.81 \\
\Delta_{2,1}   &amp; 944     &amp; 932.5 \\
\Delta_{3,0}   &amp; 991     &amp; 968.3\\
\end{array}\end{split}\]</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-10"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Godfrey Beddard<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>