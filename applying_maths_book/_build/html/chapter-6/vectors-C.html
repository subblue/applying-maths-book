
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8 Axes need not be right-angled or of equal length &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 33 - 38" href="vectors-Q33-38.html" />
    <link rel="prev" title="Questions 25 - 32" href="vectors-Q25-32.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1 Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     1 Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     5 Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     1 Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     1 - 3.8 Differentiation, gradients &amp; basic functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     3.9 Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     4 Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     6 Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     9 Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     10 Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     11 Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     12 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4 Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     1 Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     6 Integration and parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     8 Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     9 The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     10 Multiple integrals, Change of variables: Jacobians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     12 Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     1 Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     6 Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     8 Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     9 Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="vectors-intro.html">
   6. Vectors.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-A.html">
     1 Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-B.html">
     6 Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     8 Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-D.html">
     12 Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-E.html">
     15 Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-F.html">
     18 Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-G.html">
     21 Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     1 Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     4 Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     6 Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     7 Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     9 Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     11 Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     12 Solving equations using matrices. Eigenvectors and Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     13 Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     14 Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     15 Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     16 Principal axes and Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     1 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     4 Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     5 Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     1 Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     5 Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     7 Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     11 The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     12 The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     14 Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     1 Basics, Initial and Boundary Value problems, Steady state, Phase portrait, Chemical kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     9 First order equations &amp; Integrating factors. Second order equations, Newton’s laws and equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     12 The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     13 Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     14 Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     15 Partial Differential Equations, PDE. 1D &amp; 2D diffusion, Particle in a box, Lateral flow tests, Diffusion and Reaction, Cable equation, Algal Blooms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     16 PDE continued. Diffusion, Wave and Schroedinger eqns. Solution by the Fourier method. Transient grating.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     1 Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     4 Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     5 Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     6 The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     8 Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     9 Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     1 Monte - Carlo integration &amp; importance sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     2 Solving rate equations. The Gillespie method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     3 Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     4 Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     6 The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     1 Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     6 Modelling data. Least squares, chi squared, residuals, ANNOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     7 Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     10 Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-14/chapter14-intro.html">
   14 SI Units, Scientific Constants, unit conversion, Glossary, Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/chapter14-E.html">
     1 SI Units, Unit conversions, Scientific Constants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/Python%20crib.html">
     5 Appendix:  Some basic Python instructions with a few examples.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../references/references-intro.html">
   15 References and index
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/References.html">
     1 References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/index.html">
     2 Index
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-6/vectors-C.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-6/vectors-C.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-6/vectors-C.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-6/vectors-C.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basis-set">
   8.1 Basis set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-orthogonal-vectors">
   8.2 non-orthogonal vectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-bond-lengths">
   8.3 Calculating bond lengths
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conversion-from-one-basis-set-to-another">
   9 Conversion from one basis set to another
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#converting-axes">
   9.1 Converting axes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-the-new-coefficients">
   9.2 Calculating the new coefficients
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformation-of-basis-vectors">
   10 Transformation of basis vectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-bond-lengths-and-angles-in-non-right-angled-crystals">
   10.1 Calculating bond lengths and angles in non right-angled crystals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unit-cell-volume">
   11 Unit cell volume
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>8 Axes need not be right-angled or of equal length</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basis-set">
   8.1 Basis set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-orthogonal-vectors">
   8.2 non-orthogonal vectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-bond-lengths">
   8.3 Calculating bond lengths
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conversion-from-one-basis-set-to-another">
   9 Conversion from one basis set to another
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#converting-axes">
   9.1 Converting axes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-the-new-coefficients">
   9.2 Calculating the new coefficients
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformation-of-basis-vectors">
   10 Transformation of basis vectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-bond-lengths-and-angles-in-non-right-angled-crystals">
   10.1 Calculating bond lengths and angles in non right-angled crystals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unit-cell-volume">
   11 Unit cell volume
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="axes-need-not-be-right-angled-or-of-equal-length">
<h1>8 Axes need not be right-angled or of equal length<a class="headerlink" href="#axes-need-not-be-right-angled-or-of-equal-length" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span><span class="p">,</span><span class="n">odeint</span><span class="p">,</span><span class="n">solve_ivp</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="n">init_printing</span><span class="p">()</span>                      <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<section id="basis-set">
<h2>8.1 Basis set<a class="headerlink" href="#basis-set" title="Permalink to this headline">#</a></h2>
<p>In crystallography the coordinates of the unit cell are often reported in terms of the crystal type, monoclinic, triclinic, and so forth, whose axes are not mutually at right angles or always of the same length. The base vectors are no longer the orthonormal <span class="math notranslate nohighlight">\(\boldsymbol i, j, k\)</span> set we have been using and are now labelled as <span class="math notranslate nohighlight">\(\vec a, \vec b, \vec c\)</span> to indicate that they are non-orthogonal. By convention, the angle <span class="math notranslate nohighlight">\(\alpha\)</span> lies between <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(c\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. This is shown in figure 20. Many authors use <span class="math notranslate nohighlight">\(\boldsymbol {a,b,c}\)</span> instead of <span class="math notranslate nohighlight">\(\vec a, \vec b, \vec c\)</span> but using arrows is here clearer.</p>
<p>As the base vectors are not at <span class="math notranslate nohighlight">\(90^\text{o}\)</span> to one another, when a dot product is calculated, the terms <span class="math notranslate nohighlight">\(\vec a\cdot \vec b, \vec a\cdot\vec c\)</span>, and <span class="math notranslate nohighlight">\(\vec c\cdot \vec b\)</span> are not zero but the corresponding cross terms <span class="math notranslate nohighlight">\(\boldsymbol i\cdot k, \boldsymbol i\cdot j\)</span>, and <span class="math notranslate nohighlight">\(\boldsymbol j\cdot k\)</span> in the right-angled basis set are. Additionally, the base vectors are often not of unit length, but have the length, and relative angles, of the unit cell, which means that they are not normalized and not orthogonal - just about as bad as it can get! However, the method to calculate a dot product is, in principle, no different to that already described. Although a, b, and c represent the length of the unit cell, these are not unit vectors; the ‘unit’ here refers to the minimum repeat distance in the crystal.</p>
</section>
<section id="non-orthogonal-vectors">
<h2>8.2 non-orthogonal vectors<a class="headerlink" href="#non-orthogonal-vectors" title="Permalink to this headline">#</a></h2>
<p>Suppose two vectors are <span class="math notranslate nohighlight">\(\vec V\)</span> and <span class="math notranslate nohighlight">\(\vec W\)</span> in the non-normalized, non-orthogonal <span class="math notranslate nohighlight">\((\vec a, \vec b, \vec c)\)</span> basis
then we can write</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec V = v_1\vec a + v_2\vec b + v_3\vec c, \quad \vec W = w_1\vec a + w_2\vec b + w_3\vec c\]</div>
<p>and <span class="math notranslate nohighlight">\(v_1\)</span> is the amount (component) of the vector along axes <span class="math notranslate nohighlight">\(a\)</span>, and <span class="math notranslate nohighlight">\(v_2\)</span> along <span class="math notranslate nohighlight">\(b\)</span>, and so forth, and similarly for <span class="math notranslate nohighlight">\(\vec W\)</span>. Expanding out the dot product produces nine terms, which do have some symmetry;</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad\begin{align} \vec V\cdot \vec W &amp;= (v_1\vec a + v_2\vec b + v_3\vec c)\cdot (w_1\vec a + w_2\vec b + w_3\vec c) \\&amp;= v_1w_1\vec a\cdot \vec a + v_2w_2 \vec b\cdot\vec b + v_3w_3\vec c\cdot\vec c
\\&amp;+ (v_1w_2 + v_2w_1)\vec a\cdot\vec b \\&amp;+ (v_1w_3 + v_3w_1)\vec a\cdot\vec c \\&amp;+ (v_2w_3 + v_3w_2)\vec b\cdot \vec c \qquad\qquad\qquad\qquad \qquad\qquad\qquad \text{(18)}\end{align}\end{split}\]</div>
<p>Keeping our nerve, we can simplify, since <span class="math notranslate nohighlight">\(\vec a\cdot \vec a = a^2\)</span>, if <span class="math notranslate nohighlight">\(a\)</span> is the length of vector <span class="math notranslate nohighlight">\(a\)</span> and similarly for <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(c\)</span>. The dot product gives the cosine of the angle between any two vectors, just as it does for orthogonal vectors, equation 2. From Fig. 20 it can be seen that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad \begin{align}\vec a\cdot \vec b &amp;= ab \cos(\gamma ),\\
\vec a\cdot \vec c &amp;= ac\cos(\beta),\\
\vec b\cdot \vec c  &amp;= bc\cos(\alpha) \qquad\qquad\qquad\qquad \qquad\qquad\qquad \text{(19)}\end{align}\end{split}\]</div>
<p>The cosines remain because the axes are not at <span class="math notranslate nohighlight">\(90^\text{o}\)</span> so that the contribution a component along each axis makes to the others is not zero. Substituting into equation 18 gives,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle  \qquad\qquad\begin{align}\vec V\cdot \vec W =&amp;\; v_1w_1a^2 + v_2w_2b^2 + v_3w_3c^2 \\&amp; +(v_1w_2 +v_2w_1)ab\cos(\gamma) \\&amp;+ (v_1w_3 + v_3w_1)ac\cos(\beta)\\&amp;+ (v_2w_3 + v_3w_2)bc\cos(\alpha)\end{align}  \qquad\qquad\qquad\qquad \text{(20)}\end{split}\]</div>
<p>The magnitude of <span class="math notranslate nohighlight">\(\vec V\)</span> is calculated in a similar way</p>
<div class="math notranslate nohighlight">
\[ \displaystyle |\vec V|^2 =\vec V\cdot\vec V =v_1^2a^2 +v_2^2b^2 +v_3^2c^2 + 2v_1v_2ab\cos(\gamma ) + 2v_1v_3ac\cos(\beta) + 2v_2v_3bc\cos(\alpha) \qquad\tag{21}\]</div>
<p>as is <span class="math notranslate nohighlight">\(|\vec W|\)</span> by substituting <span class="math notranslate nohighlight">\(w\)</span>’s for <span class="math notranslate nohighlight">\(v\)</span>’s.</p>
<p><img alt="Drawing" src="../_images/vectors-fig20.png" /></p>
<p>Figure 20. Non-orthogonal axes and non-normalized base vectors <span class="math notranslate nohighlight">\(\vec a, \vec b\)</span> and <span class="math notranslate nohighlight">\(\vec c\)</span>.</p>
</section>
<hr class="docutils" />
<section id="calculating-bond-lengths">
<h2>8.3 Calculating bond lengths<a class="headerlink" href="#calculating-bond-lengths" title="Permalink to this headline">#</a></h2>
<p>In X-ray crystallography, an atom’s coordinates are often given in terms of the unit cell
dimensions and these are not always at right angles to one another. Suppose that the
vector of atom C<span class="math notranslate nohighlight">\(_A\)</span>’s coordinates, given in unit cell dimensions, is A and that for atom C<span class="math notranslate nohighlight">\(_B\)</span> is AB. The bond length is calculated from the difference of two vectors <span class="math notranslate nohighlight">\(\vec V = \vec A - \vec B\)</span> and then by calculating the dot product of this vector with itself, equation 21.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec V\cdot\vec V=|\vec V|^2. \qquad\tag{22}\]</div>
<p>To illustrate the method described in Section 8.2, (i) the C-N<span class="math notranslate nohighlight">\(_1\)</span> bond length and (ii) the angle between the N<span class="math notranslate nohighlight">\(_1\)</span>CN<span class="math notranslate nohighlight">\(_2\)</span> atoms in s-tetrazine, <span class="math notranslate nohighlight">\(\mathrm{C_2N_4H_2}\)</span>, will be calculated; its geometry is shown in figure 22. The crystal structure was determined using Cu radiation with a wavelength of <span class="math notranslate nohighlight">\(0.1542 \)</span> nm. The unit cell has dimensions of <span class="math notranslate nohighlight">\(a = 0.523\)</span> nm, <span class="math notranslate nohighlight">\(b = 0.579\)</span> nm, and <span class="math notranslate nohighlight">\(c = 0.663\)</span> nm (Bertinotti &amp; Giacomello 1956). The angle between the long and either short axis is <span class="math notranslate nohighlight">\(90^\text{o}\)</span>, and the angle between the two short axes is <span class="math notranslate nohighlight">\(115^\text{o}30'\)</span>. The crystal is therefore monoclinic and this crystal type is characterized by one twofold symmetry axis and one mirror plane. The fractional coordinates of some of the atoms in the crystal are shown in the table. These are in units of the length of each base vector or unit cell dimension.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{rrrr}
\hline
&amp; v_1/a&amp; v_2/b &amp; v_3/c\\
\hline
\mathrm{C} &amp; 0.2546 &amp; 0.0153 &amp; 0.1380\\
\mathrm{N_1} &amp; 0.1834 &amp; -0.1669 &amp; -0.0015\\
\mathrm{N_2} &amp; 0.0849 &amp; 0.1795 &amp; 0.1486\\
\mathrm{N_3} &amp; -0.0849 &amp; -0.1795 &amp; -0.1486\\
\hline \end{array} \end{split}\]</div>
<p><img alt="Drawing" src="../_images/vectors-fig21.png" /></p>
<p>Figure 21. Figure to show how to calculate a bond length given vectors <span class="math notranslate nohighlight">\(\vec A\)</span> and <span class="math notranslate nohighlight">\(\vec B\)</span> of the two atom’s coordinates.</p>
<hr class="docutils" />
<p>The vectors <span class="math notranslate nohighlight">\(\vec a, \vec b\)</span>, and <span class="math notranslate nohighlight">\(\vec c\)</span> form the basis-set axes with lengths <span class="math notranslate nohighlight">\(a, b, c\)</span>, respectively, which are the same as the unit cell. The origin of coordinates is assumed to be <span class="math notranslate nohighlight">\(O = [0 0 0] \)</span> and no H atoms are resolved.
Using the data, the magnitude of the base vectors are (in nm)</p>
<div class="math notranslate nohighlight">
\[\displaystyle |\vec a| = a = 0.523,\quad\vec b| = b = 0.579,\quad|\vec c| = c = 0.663\]</div>
<p>The angle <span class="math notranslate nohighlight">\(\beta\)</span> between <span class="math notranslate nohighlight">\(\vec a\)</span> and <span class="math notranslate nohighlight">\(c = 115^\text{o}30' \equiv 115.5^\text{o}\)</span> and the other angles are each <span class="math notranslate nohighlight">\(90^\text{o}\)</span>.</p>
<p><strong>(i)</strong> To find the C-N1 bond length, let the vector for the position of the N<span class="math notranslate nohighlight">\(_1\)</span> atom be <span class="math notranslate nohighlight">\(\vec W_{N_1} = w_1\vec a + w_2\vec b + w_3\vec c\)</span>. Using data in the table, this vector is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec W_{N_1} = 0.1834a\vec a - 0.1669b\vec b - 0.0015c\vec c, \quad\text{where}\quad w_1 = 0.1834a, w_2 = -0.1669b, w_3 = -0.0015c\]</div>
<p>and the constants <span class="math notranslate nohighlight">\(a, b, c\)</span> are present because the lengths are given as fractions of the unit cell length. These could be multiplied out at the outset to give the vector</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec W_{N_1} = 0.095918\vec a - 0.096635\vec b - 0.0009945\vec c\]</div>
<p>but can be left and done at the end of the calculation. The vector for the C atom is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec V_C = 0.2456a\vec a + 0.0153b\vec b + 0.1380c\vec c\]</div>
<p>Define a new vector <span class="math notranslate nohighlight">\(\vec\Delta\)</span>  to be the bond vector <span class="math notranslate nohighlight">\(\vec V_C - \vec W_{N_1}\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec\Delta =\Delta_1\vec a+\Delta_2\vec b+\Delta_3\vec c\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta_1 =(v_1 -w_1),\Delta_2 =(v_2 -w_3),\Delta_3 =(v_3 -w_3)\)</span> and as<span class="math notranslate nohighlight">\(|\Delta |= d\)</span> is the bond length, using the definition of the dot product <span class="math notranslate nohighlight">\(\vec \Delta \cdot \vec\Delta\)</span>, given in equation 21 and substituting for <span class="math notranslate nohighlight">\(d\)</span> will give</p>
<div class="math notranslate nohighlight">
\[\displaystyle d^2 = \Delta_1^2 a^2 + \Delta_2^2 b^2 + \Delta_3^2 c^2
+ 2\Delta_1\Delta_2ab\cos(\gamma ) + 2\Delta_1\Delta_3ac \cos(\beta) + 2\Delta_2\Delta_3bc\cos(\alpha) \qquad\tag{23}\]</div>
<p>where <span class="math notranslate nohighlight">\(a, b, c\)</span> are the magnitudes of their corresponding vectors <span class="math notranslate nohighlight">\(\vec a, \vec b,\vec c\)</span> . In this particular example, <span class="math notranslate nohighlight">\(\beta = 115.5^\text{o}\)</span> and the angles <span class="math notranslate nohighlight">\(\gamma=\alpha = 90^\text{o} \)</span> and their cosines zero; therefore,</p>
<div class="math notranslate nohighlight">
\[\displaystyle d^2 = \Delta_1^2 a^2 + \Delta_2^2 b^2 + \Delta_3^2 c^2 + 2\Delta_1\Delta_3ac \cos(\beta) \qquad\tag{24}\]</div>
<p>Substituting for numerical values gives \Delta_1 = 0.1834 - 0.2546 = -0.07128, \Delta_2 = -0.1822,
etc. Therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle d^2 = (-0.07128a)^2 + (-0.1822b)2 + (-0.1395c)^2 + 2(-0.07128a)(-0.1395b)\cos(115.5\pi /180)\]</div>
<p>and using the values for <span class="math notranslate nohighlight">\(a, b, c\)</span> produces a C-N<span class="math notranslate nohighlight">\(_1\)</span> bond length of <span class="math notranslate nohighlight">\(d = 0.1346\)</span> nm.</p>
<p><strong>(ii)</strong> The angle <span class="math notranslate nohighlight">\(\mathrm{N_1-C-N_2}\)</span> (or any other) is found by defining difference vectors <span class="math notranslate nohighlight">\(\vec \Delta_{CN_2}\)</span> and
<span class="math notranslate nohighlight">\(\vec \Delta_{CN_1}\)</span>  for the two bonds as just described, then calculating their dot product</p>
<div class="math notranslate nohighlight">
\[\displaystyle \cos(\theta)=\frac{\vec \Delta_{CN_2}\cdot \vec \Delta_{CN_1}}{d_{CN_1}d_{CN_2}} \qquad\tag{25}\]</div>
<p>The values <span class="math notranslate nohighlight">\(d_{CN_1}\)</span> and <span class="math notranslate nohighlight">\(d_{CN_2}\)</span> are the bond lengths and using the calculated bond lengths the <span class="math notranslate nohighlight">\(\mathrm{N_1-C-N_2}\)</span> angle is <span class="math notranslate nohighlight">\(114.5^\text{o}\)</span>. To make sure you understand the calculation, calculate the <span class="math notranslate nohighlight">\(\mathrm{C-N_2}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{N_1-N_2}\)</span> bond lengths. You should find them to be <span class="math notranslate nohighlight">\(0.1323\)</span> and <span class="math notranslate nohighlight">\(0.1321\)</span> nm respectively.</p>
<p><img alt="Drawing" src="../_images/vectors-fig22.png" /></p>
<p>Figure 22. A monoclinic crystal, the axes, and a sketch (right) of the projection of the tetrazine structure looking down the b axis. The plane of the s - tetrazine molecule lies in the <span class="math notranslate nohighlight">\(a - c\)</span> plane. (Not all atoms are explicitly shown.)</p>
</section>
<hr class="docutils" />
<section id="conversion-from-one-basis-set-to-another">
<h2>9 Conversion from one basis set to another<a class="headerlink" href="#conversion-from-one-basis-set-to-another" title="Permalink to this headline">#</a></h2>
<p>It is sometimes essential to be able to convert from one basis set to another, and if you were involved in computer graphics this would be something that you would have to do all the time as the viewing point and perspective of the scene changes. In this case, the basis set would probably be called a reference frame. In geography or astronomy, converting from earth-based coordinates to celestial ones is commonplace, in chemistry and physics converting rectangular to polar coordinates is often necessary when dealing with atomic or molecular orbitals. An X-ray crystallographic analysis of a molecule usually results in coordinates that are quoted in terms of the unit cell parameters the axes of which may be neither at right angles to one another nor of equal length. Although a molecule’s bond lengths and angles can be calculated in these non-orthogonal coordinates, as illustrated in Section 8.3, it is often practical to convert to normal right-angled coordinates, particularly for drawing structures.</p>
<p>The method of converting from triclinic to orthonormal coordinates is now described and is used to illustrate the general method of converting one basis set into another. We use triclinic coordinate axes because these axes are set at different angles to one another and are each of different length. This conversion will lead to a related but more useful method of calculating geometries from X-ray data than that of Section 8. The two sets of axes shown in figure 23 are the general triclinic <span class="math notranslate nohighlight">\(a, b, c\)</span> and the orthogonal or conventional Cartesian <span class="math notranslate nohighlight">\(x, y, z\)</span>.</p>
<p>Any vector is unchanged by changing its basis set and therefore its coefficients must change between bases. If <span class="math notranslate nohighlight">\(\vec V\)</span> is any vector and <span class="math notranslate nohighlight">\(g_{x,y,z}\)</span> is the set of its coefficients in an <span class="math notranslate nohighlight">\(xyz\)</span> basis and <span class="math notranslate nohighlight">\(g_{A,B,C}\)</span> in another basis <span class="math notranslate nohighlight">\(ABC\)</span>, this equality is written as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec V= g_x\vec x+g_y\vec y+g_z\vec z=g_A\vec A+g_B\vec B+g_C\vec C \qquad\tag{26}\]</div>
<p>To transform from the ABC basis with known coefficients <span class="math notranslate nohighlight">\(g_A, g_B, g_c\)</span> to another <span class="math notranslate nohighlight">\(xyz\)</span> basis a new set of coefficients <span class="math notranslate nohighlight">\(g_x, g_y, g_z\)</span> need to be calculated.</p>
<p>To effect the conversion of a vector, the axes must be converted first, and then the vector’s new coefficients calculated. These coefficients will be calculated by expanding each of the <span class="math notranslate nohighlight">\(A, B, C\)</span> vectors, equations 26, in turn with equations like those of eqn. 27.</p>
<p><img alt="Drawing" src="../_images/vectors-fig23.png" /></p>
<p>Figure 23. Two sets of unit vectors; The set <span class="math notranslate nohighlight">\(\vec x\vec y \vec z\)</span> are orthogonal but <span class="math notranslate nohighlight">\(\vec A\vec B\vec C\)</span> are not. Vector <span class="math notranslate nohighlight">\(A\)</span> lies along <span class="math notranslate nohighlight">\(\vec x\)</span> and <span class="math notranslate nohighlight">\(\vec B\)</span> is in the <span class="math notranslate nohighlight">\(x\)</span>y plane.</p>
</section>
<hr class="docutils" />
<section id="converting-axes">
<h2>9.1 Converting axes<a class="headerlink" href="#converting-axes" title="Permalink to this headline">#</a></h2>
<p>We will assume that the <span class="math notranslate nohighlight">\(xyz\)</span> basis set is orthogonal (just as are <span class="math notranslate nohighlight">\(\boldsymbol i, \boldsymbol j,\boldsymbol k\)</span>), as is the convention, therefore the basis vectors <span class="math notranslate nohighlight">\(\vec x, \vec y\)</span>, and <span class="math notranslate nohighlight">\(\vec z\)</span> are orthogonal to one another, for instance,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec x\cdot\vec y = \vec x\cdot\vec z = \vec z\cdot\vec y = 0\]</div>
<p>and as the vectors are normalized</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec x\cdot \vec x = \vec y\cdot\vec y = \vec z\cdot\vec z = 1\]</div>
<p>The non-orthogonal axes have unit vectors <span class="math notranslate nohighlight">\(\vec A,\vec B, \vec C\)</span> lying along them and which are projected in turn onto the right-angled <span class="math notranslate nohighlight">\(xyz\)</span> unit vectors, in which case they are not a basis set, and must therefore be represented as linear combinations of <span class="math notranslate nohighlight">\(x, y, z\)</span> unit vectors</p>
<div class="math notranslate nohighlight">
\[\displaystyle A=k_1\vec x+k_2\vec y+k_3\vec z,
\quad B=m_1\vec x+m_2\vec y+m_3\vec z,  
\quad C=n_1\vec x+n_2\vec y+n_3\vec z \qquad\tag{27}\]</div>
<p>The base vectors <span class="math notranslate nohighlight">\(A, B, C\)</span> have unit lengths, therefore, <span class="math notranslate nohighlight">\(k_1^2 + k_2^2 + k_3^2 = 1\)</span> and similarly for the <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(n\)</span>. Changing a basis does not change the vector at all, it merely moves the components around so that they have different values in a different basis set. The equations 27 represent the axes conversion from the <span class="math notranslate nohighlight">\(ABC\)</span> basis set to the <span class="math notranslate nohighlight">\(xyz\)</span>. These three equations can be put into a matrix form that shows the pattern of indices nicely. You should consult Chapter 7 if you are not familiar with matrices and their multiplication.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad\begin{bmatrix} A\\B\\C\end{bmatrix}=\begin{bmatrix}k_1 &amp; k_2 &amp; k_3\\m_1 &amp; m_2 &amp; m_3\\ n_1 &amp; n_2 &amp; n_3 \end{bmatrix} \begin{bmatrix}x\\y\\z\end{bmatrix}\qquad\qquad \qquad\qquad\text{(28)}\end{split}\]</div>
<p>The two sets of axes could be placed at any orientation with respect to one another but to make things easier, let vectors <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(x\)</span> coincide and let vector <span class="math notranslate nohighlight">\(B\)</span> be in the <span class="math notranslate nohighlight">\(x-y\)</span> plane, see figure 23. If this orientation is calculated in some other way then the basis set <span class="math notranslate nohighlight">\((x\; y\; z)\)</span> may need to be reordered to get everything correct. The way to check that everything is all right is to make all the angles <span class="math notranslate nohighlight">\(90^\text{o}\)</span> then a diagonal matrix should result.</p>
</section>
<section id="calculating-the-new-coefficients">
<h2>9.2 Calculating the new coefficients<a class="headerlink" href="#calculating-the-new-coefficients" title="Permalink to this headline">#</a></h2>
<p>Vector <span class="math notranslate nohighlight">\(A\)</span> lies along the <span class="math notranslate nohighlight">\(x\)</span>-axis, therefore its <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> components <span class="math notranslate nohighlight">\(k_2\)</span> and <span class="math notranslate nohighlight">\(k_3\)</span> are zero. The remaining component <span class="math notranslate nohighlight">\(k_1\)</span> has a length <span class="math notranslate nohighlight">\(1\)</span>, which is the length of <span class="math notranslate nohighlight">\(\vec A\)</span>, therefore the first of equations 27 representing the vector <span class="math notranslate nohighlight">\(A\)</span> in the <span class="math notranslate nohighlight">\(xyz\)</span> basis set is simply;</p>
<div class="math notranslate nohighlight">
\[ \displaystyle \vec A=\vec x\]</div>
<p>Similarly, <span class="math notranslate nohighlight">\(\vec B\)</span> which is in the <span class="math notranslate nohighlight">\(x-y\)</span> plane, has a component on the <span class="math notranslate nohighlight">\(x\)</span>-axis of <span class="math notranslate nohighlight">\(m_1 = \cos(\gamma )\)</span>, its <span class="math notranslate nohighlight">\(y\)</span> component is <span class="math notranslate nohighlight">\(m_2 = \cos(\pi/2 -\gamma) = \sin(\gamma )\)</span>. The component on the z-axis is zero, <span class="math notranslate nohighlight">\(m_3 = 0\)</span>, because the vector <span class="math notranslate nohighlight">\(\vec B\)</span> is in the <span class="math notranslate nohighlight">\(x-y\)</span> plane. The second vector is therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec B = \cos(\gamma )\vec x + \sin(\gamma )\vec y\]</div>
<p>Calculating <span class="math notranslate nohighlight">\(\vec C\)</span> is a little more complex. The component (projection) onto the x-axis is <span class="math notranslate nohighlight">\(n_1 = \cos(\beta)\)</span>. Calculating the other components is harder because the angle <span class="math notranslate nohighlight">\(\alpha\)</span> only connects  <span class="math notranslate nohighlight">\(\vec C\)</span> to <span class="math notranslate nohighlight">\(\vec B\)</span> and not to a <span class="math notranslate nohighlight">\(y\)</span>- or <span class="math notranslate nohighlight">\(x\)</span>-axis. However, with a little cunning, starting with the dot product the coefficients can be found. The dot product is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec B\cdot\vec C = \cos(\alpha)\]</div>
<p>because <span class="math notranslate nohighlight">\(\vec B\)</span> and <span class="math notranslate nohighlight">\(\vec C\)</span> are unit vectors.</p>
<p>Expanding this equation in the new basis set given by equation 27, and substituting for values already determined, gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \cos(\alpha) = \vec B\cdot\vec C = \left(\cos(\gamma)\vec x + \sin(\gamma )\vec y\right)\left(\cos(\beta)\vec x + n_2 \vec y + n_3\vec z\right)\]</div>
<p>Using the orthogonality rules <span class="math notranslate nohighlight">\(\vec x\cdot\vec x = \vec y\cdot\vec y = 1\)</span> together with the rule that all ‘cross terms’ such as <span class="math notranslate nohighlight">\(\vec x\cdot\vec y = 0\)</span> produces
therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle \cos(\alpha) = \vec B\cdot\vec C = \cos(\gamma )\cos(\beta) + n_2 \sin(\gamma )\]</div>
<p>therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle n_2=\frac{\cos(\alpha)-\cos(\beta)\cos(\gamma)}{\sin(\gamma)} \qquad\tag{29}\]</div>
<p>The coefficient <span class="math notranslate nohighlight">\(n_3\)</span> remains to be determined. This can be found from the normalization condition <span class="math notranslate nohighlight">\(n^2_1 + n_2^2 + n^2_3 = 1\)</span> and, again, using values already determined, is</p>
<div class="math notranslate nohighlight">
\[\displaystyle n_3^2=1-\cos^2(\beta)-\frac{\big(\cos(\alpha)-\cos(\beta)\cos(\gamma)\big)^2}{\sin^2(\gamma)} \]</div>
<p>The final equation for <span class="math notranslate nohighlight">\(\vec C\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec C=\cos(\beta)\vec x+n_2 \vec y+\left(\sin^2(\beta)-n_2^2\right)^{1/2}\vec z\]</div>
<p>The derivation so far has involved unit vectors, but a real crystal has vectors along the crystallographic axes that are not necessarily all of the same length or even of unit length. The notation usually used is to define the axes as <span class="math notranslate nohighlight">\(\vec a, \vec b, \vec c\)</span> of length <span class="math notranslate nohighlight">\(a, b, c\)</span> respectively and the unit vectors then can be written as <span class="math notranslate nohighlight">\(\vec A = \vec a/a\)</span>, and so forth. The bold lower case letter represents the actual crystal vector a. Making this change means that each of the vector equations can be rewritten by multiplying by the size of each vector, for instance as,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec b=b(\;\cos(\gamma)\vec x+\sin(\gamma)\vec y\;)\]</div>
<p>Written in matrix form they are clearer,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad\begin{bmatrix} \vec a\\ \vec b\\ \vec c\end{bmatrix}=\begin{bmatrix}a&amp;0&amp;0\\b\cos(\gamma)&amp; b\sin(\gamma) &amp; 0\\c\cos(\gamma) &amp; cn_2 &amp; c\sqrt{\sin^2(\beta)-n_2^2} \end{bmatrix}\begin{bmatrix}\vec x\\\vec y\\\vec z \end{bmatrix}\qquad\qquad\qquad\qquad \text{(30)}\end{split}\]</div>
<p>This equation can be written in shorthand as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec D = \boldsymbol{M}\vec X\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec D\)</span> is the vector <span class="math notranslate nohighlight">\(abc\)</span> and <span class="math notranslate nohighlight">\(\vec X\)</span> that of unit vectors <span class="math notranslate nohighlight">\(xyz\)</span> and the matrix is <span class="math notranslate nohighlight">\(\boldsymbol M\)</span>. This matrix represents the conversion from one set of axes into another; as written converting from the <span class="math notranslate nohighlight">\(xyz\)</span> axes to the <span class="math notranslate nohighlight">\(abc\)</span>. To effect the opposite conversion, the equation to use is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec X=\boldsymbol{M}^{-1}\vec D\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{M}^{-1}\)</span> is the inverse of <span class="math notranslate nohighlight">\(\boldsymbol{M}\)</span>, see Chapter 7. Finally, and as a check when all the angles are <span class="math notranslate nohighlight">\(90^\text{o}\)</span>, matrix <span class="math notranslate nohighlight">\(\boldsymbol{M}\)</span> reduces to a diagonal matrix and this tells us that ordering the axes as <span class="math notranslate nohighlight">\(ABC\)</span> gives the resulting order <span class="math notranslate nohighlight">\(xyz\)</span>.</p>
</section>
<section id="transformation-of-basis-vectors">
<h2>10 Transformation of basis vectors<a class="headerlink" href="#transformation-of-basis-vectors" title="Permalink to this headline">#</a></h2>
</section>
<section id="calculating-bond-lengths-and-angles-in-non-right-angled-crystals">
<h2>10.1 Calculating bond lengths and angles in non right-angled crystals<a class="headerlink" href="#calculating-bond-lengths-and-angles-in-non-right-angled-crystals" title="Permalink to this headline">#</a></h2>
<p>Normally, we are not so interested in converting axes but wish to find an atom’s coordinates in Cartesian (<span class="math notranslate nohighlight">\(xyz\)</span>) axes, but which are given in crystallographic tables in terms of the unit cell <span class="math notranslate nohighlight">\(abc\)</span> axes. The convention in crystallographic tables is to quote the coordinates as fractions of the unit cell lengths in columns labelled as <span class="math notranslate nohighlight">\(x/a, y/b, z/c\)</span>, or even as <span class="math notranslate nohighlight">\(x, y, z\)</span>. This is initially confusing because <span class="math notranslate nohighlight">\(xyz\)</span> axes are not involved.</p>
<p>The method now described is not limited to the specific example considered, but will apply to any two basis sets. The coordinates of an atom describe a vector from the origin and equation 26 is used to describe the vector. The same vector has coefficients <span class="math notranslate nohighlight">\(g_x, g_y, g_z\)</span> in the <span class="math notranslate nohighlight">\(xyz\)</span> basis set (axes) and <span class="math notranslate nohighlight">\(g_A, g_B, g_C\)</span> in the <span class="math notranslate nohighlight">\(abc\)</span> basis set. The right-hand side of equation 26 can be expanded by replacing the base vectors <span class="math notranslate nohighlight">\(\vec A, \vec B, \vec C\)</span> by equation 27, which gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle g_x\vec x+g_y\vec y+g_z\vec z=g_A(k_1\vec x+k_2\vec y+k_3\vec z) +g_B(m_1\vec x+m_2\vec y+m_3\vec z) +g_C(n_1\vec x+n_2\vec y+n_3\vec z)\]</div>
<p>This is really three equations and, although difficult to understand in this form, becomes
clearer when written as matrices:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{bmatrix}g_x &amp; g_y &amp; g_z \end{bmatrix}\begin{bmatrix}\vec x\\ \vec y\\ \vec z \end{bmatrix}=\begin{bmatrix}g_A&amp;g_B &amp; g_C \end{bmatrix}\begin{bmatrix}k_1 &amp; k_2 &amp; k_3\\m_1 &amp; m_2 &amp; m_3\\n_1 &amp; n_2 &amp; n_3  \end{bmatrix}\begin{bmatrix}\vec x\\ \vec y\\ \vec z \end{bmatrix}\end{split}\]</div>
<p>which is simplified to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{bmatrix}g_x &amp; g_y &amp; g_z \end{bmatrix}=\begin{bmatrix}g_A&amp;g_B &amp; g_C \end{bmatrix}\begin{bmatrix}k_1 &amp; k_2 &amp; k_3\\m_1 &amp; m_2 &amp; m_3\\n_1 &amp; n_2 &amp; n_3  \end{bmatrix}\end{split}\]</div>
<p>and the square matrix is the matrix, <span class="math notranslate nohighlight">\(\boldsymbol M\)</span> of equation 30. This last equation can be summarized as the matrix equation</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec g_{xyz}=g_{ABC}\boldsymbol M \qquad\tag{31}\]</div>
<p>where the <span class="math notranslate nohighlight">\(g\)</span>’s are vectors of the <em>coefficients</em> . With X-ray data, the <span class="math notranslate nohighlight">\(g_{ABC}\)</span> are the <span class="math notranslate nohighlight">\(x/a, y/b, z/c\)</span> data given in crystallographic tables. This equation shows us how to calculate the coordinates in <span class="math notranslate nohighlight">\(xyz\)</span> axes given those in <span class="math notranslate nohighlight">\(abc\)</span>. To calculate <span class="math notranslate nohighlight">\(abc\)</span> coordinates given <span class="math notranslate nohighlight">\(xyz\)</span>, the equation to use is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \vec g_{ABC}=\vec g_{xyz}\boldsymbol{M}^{-1}\]</div>
<p>which is obtained by right multiplying both sides of eqn 31 by the inverse of <span class="math notranslate nohighlight">\(\boldsymbol M\)</span>.</p>
<p>If a vector <span class="math notranslate nohighlight">\(\vec W\)</span> between two atoms represents the bond vector, then its coordinates are conventionally given in terms of <span class="math notranslate nohighlight">\(abc\)</span> and its length can be calculated from equation 21. More conveniently, the dot product can be used</p>
<div class="math notranslate nohighlight">
\[\displaystyle d^2 = | \vec  W\cdot \vec W | = | \vec g_{xyz}\cdot \vec g_{xyz} | \qquad\tag{31a}\]</div>
<p>and with equation 31 and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle d^2=(g_{abs}\boldsymbol M)\cdot(g_{abs}^T\boldsymbol M^T)\qquad\tag{32}\]</div>
<p>which is the same as equation 21 when it is expanded out. The superscript <span class="math notranslate nohighlight">\(T\)</span> means that the transpose is taken, see Chapter 7. This equation looks a little different from those dot products calculated previously because the transpose is in a different place. This is because <span class="math notranslate nohighlight">\(\vec g\)</span> is a row vector and the left vector has to be a row, the right-hand side as a column, hence the transpose.</p>
<p>The bond angle can be calculated using the dot product of two bond vectors after converting into <span class="math notranslate nohighlight">\(xyz\)</span> coordinates. The angle is therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle \theta_{12}=\cos^{-1}\left(\frac{\vec g_{1,xyz}\cdot \vec g_{2,xyz}}{|\vec g_{1,xyz}||\vec g_{2,xyz}|} \right)=\cos^{-1}\left(\frac{\vec g_{1,xyz}\cdot \vec g_{2,xyz}}{d_1d_2} \right) \qquad\tag{33}\]</div>
<p>In a monoclinic crystal, which is perhaps the most common crystal type, the equations are considerably simplified because <span class="math notranslate nohighlight">\(\alpha = \gamma = 90^\text{o}\)</span> then the matrix <span class="math notranslate nohighlight">\(\boldsymbol M\)</span>, equation 30 is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \boldsymbol M = \begin{bmatrix}a&amp;0&amp;0\\0 &amp; b &amp; 0\\c\cos(\beta) &amp; 0 &amp; c\sin(\beta) \end{bmatrix}\end{split}\]</div>
<p>and the new coordinates are</p>
<div class="math notranslate nohighlight">
\[\displaystyle ( g_x, \;g_y,\; g_z) = (ag_A + c\cos(\beta)g_C,\; bg_B, \;c\sin(\beta)g_C)\]</div>
<p>In Section 8.3 some data from s-tetrazine was used to calculate bond lengths and angles. The unit cell parameters are <span class="math notranslate nohighlight">\(a = 0.523\)</span> nm, <span class="math notranslate nohighlight">\(b = 0.579\)</span> nm, and <span class="math notranslate nohighlight">\(c = 0.663\)</span> nm and angle <span class="math notranslate nohighlight">\(\beta = 115.5^\text{o}\)</span> making <span class="math notranslate nohighlight">\(\cos(\beta) = -0.4305, \sin(\beta) = 0.9026\)</span>. Using equation 31 the <span class="math notranslate nohighlight">\(g_{x,y,z}\)</span> coefficients for the carbon atom (in nm) are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\begin{bmatrix}g_x&amp; g_y &amp; g_z \end{bmatrix}&amp;=\begin{bmatrix}0.2546&amp; 0.0153&amp; 0.1380 \end{bmatrix}\begin{bmatrix}q &amp; 0 &amp; 0\\0 &amp; b &amp; 0\\ -0.4305c &amp; 0 &amp; 0.9026c \end{bmatrix}\\&amp;=\begin{bmatrix}0.09606 &amp;0.008859&amp; 0.08258\end{bmatrix}\end{align}\end{split}\]</div>
<p>The C-N<span class="math notranslate nohighlight">\(_1\)</span> bond length can be calculated either by converting the C or N<span class="math notranslate nohighlight">\(_1\)</span> atom’s coordinates separately, or by forming the <span class="math notranslate nohighlight">\(g_{ABC}\)</span> values of a bond vector as the difference in C and N<span class="math notranslate nohighlight">\(_1\)</span> values, and then transforming with the M matrix. The result is <span class="math notranslate nohighlight">\(0.1346\)</span> nm, which is the same found in Section 8.3 but arrived at far more simply.</p>
<p>A more complex example of using these formulae is to calculate the volume of the unit cell, (see Section 10.2) bond distances <span class="math notranslate nohighlight">\(\mathrm{C_1-C_2}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{C_2-C_3}\)</span> and the <span class="math notranslate nohighlight">\(\mathrm{C1-C2} \to \mathrm{C_2-C_3}\)</span> bond angle in the benzene ring of o-nitrobenzoic acid. Python will be used to do the arithmetic. The crystal structure is triclinic with the following cell parameters (G. Portalone Acta Cryst. E, 2009, v65, p0954), lengths in <span class="math notranslate nohighlight">\(\overset{\text{ o}}{A}\)</span> and angles in degrees.</p>
<div class="math notranslate nohighlight">
\[\displaystyle a  =   5.0147, b  =   7.527, c  =   10.620, \alpha = 69.41, \beta  = 86.07, \gamma  = 71.01
\]</div>
<p>The first step is to define the matrix <span class="math notranslate nohighlight">\(\boldsymbol M\)</span>, and then equation 31 where the row vector is the vector of bond coordinates. When M was defined, it was done so in terms of fractional coordinates, as shown in the table, so that these can be used directly in the calculation. The angles are quoted in degrees and minutes and must be converted into fractions of degrees and then radians.</p>
<p><img alt="Drawing" src="../_images/vectors-nitro.png" /></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Determine matrix M</span>
<span class="c1"># data from G. Portalone. Acta. Cryst. E, 2009 v 65 p 0954.  Values in angstrom</span>

<span class="n">a</span>  <span class="o">=</span>   <span class="mf">5.0147</span>       
<span class="n">b</span>  <span class="o">=</span>   <span class="mf">7.527</span>
<span class="n">c</span>  <span class="o">=</span>   <span class="mf">10.620</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">69.41</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>                     <span class="c1"># make angles radians </span>
<span class="n">beta</span>  <span class="o">=</span> <span class="mf">86.07</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
<span class="n">gama</span>  <span class="o">=</span> <span class="mf">71.01</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>

<span class="n">C1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0287</span><span class="p">,</span>  <span class="mf">0.0235</span><span class="p">,</span> <span class="mf">0.6923</span><span class="p">])</span>    <span class="c1"># x/a, y/b, z/c defined as array </span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8416</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0231</span><span class="p">,</span> <span class="mf">0.7933</span><span class="p">])</span>
<span class="n">C3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8224</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2123</span><span class="p">,</span> <span class="mf">0.8508</span><span class="p">])</span>
<span class="n">N1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6642</span><span class="p">,</span>  <span class="mf">0.1288</span><span class="p">,</span> <span class="mf">0.8481</span><span class="p">])</span>
    
<span class="n">n2</span> <span class="o">=</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gama</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gama</span><span class="p">)</span>
<span class="n">M</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
               <span class="p">[</span><span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gama</span><span class="p">),</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gama</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
               <span class="p">[</span><span class="n">c</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span> <span class="n">c</span><span class="o">*</span><span class="n">n2</span><span class="p">,</span><span class="n">c</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">n2</span><span class="o">**</span><span class="mi">2</span><span class="p">)]])</span>
<span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5.0147    , 0.        , 0.        ],
       [2.44930932, 7.11734591, 0.        ],
       [0.72787003, 3.69930532, 9.92822972]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:8.4f}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Volume =&#39;</span><span class="p">,</span><span class="n">Volume</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="s1">&#39; nm^3&#39;</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Volume =  0.3544 nm^3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bond_length</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>  <span class="c1"># A and B are vectors of x/a, y/b, z/c  eqn. 31a </span>
    
    <span class="n">dAB</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="p">)</span> <span class="o">@</span> <span class="n">M</span>                 <span class="c1"># @ is matric multiply</span>
    <span class="k">return</span>  <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dAB</span><span class="p">,</span><span class="n">dAB</span><span class="p">))</span>
<span class="c1">#---------------------------------</span>

<span class="k">def</span> <span class="nf">bond_angle</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">):</span>  <span class="c1"># central atom first then left &amp; right, eqn. 33</span>
    
    <span class="n">dAB</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">B</span><span class="p">)</span> <span class="o">@</span> <span class="n">M</span> 
    <span class="n">dAC</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">C</span><span class="p">)</span> <span class="o">@</span> <span class="n">M</span>
    
    <span class="n">LAB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dAB</span><span class="p">,</span><span class="n">dAB</span><span class="p">))</span>
    <span class="n">LAC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dAC</span><span class="p">,</span><span class="n">dAC</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dAB</span><span class="p">,</span><span class="n">dAC</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">LAB</span><span class="o">*</span><span class="n">LAC</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    
<span class="c1">#----------------------------------   </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:6.3f}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;bond C1 C2=&#39;</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">C1</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="p">,</span><span class="s1">&#39; nm&#39;</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:6.3f}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;bond C2 C3=&#39;</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">C3</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="p">,</span><span class="s1">&#39; nm&#39;</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:6.3f}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;bond N1 C2=&#39;</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">N1</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="p">,</span><span class="s1">&#39; nm&#39;</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:6.1f}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;bond angle C123 =&#39;</span><span class="p">,</span> <span class="n">bond_angle</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">C1</span><span class="p">,</span><span class="n">C3</span><span class="p">),</span><span class="s1">&#39; degrees&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:6.1f}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;bond angle C12N =&#39;</span><span class="p">,</span> <span class="n">bond_angle</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">C1</span><span class="p">,</span><span class="n">N1</span><span class="p">),</span><span class="s1">&#39; degrees&#39;</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bond C1 C2= 0.140 nm
bond C2 C3= 0.137 nm
bond N1 C2= 0.147 nm
bond angle C123 = 122.5 degrees
bond angle C12N = 121.1 degrees
</pre></div>
</div>
</div>
</div>
</section>
<section id="unit-cell-volume">
<h2>11 Unit cell volume<a class="headerlink" href="#unit-cell-volume" title="Permalink to this headline">#</a></h2>
<p>The absolute value of the determinant of <span class="math notranslate nohighlight">\(\boldsymbol M\)</span> is numerically equal to the volume of the unit cell, (Giacovazzo et al. 1992, p. 68). When all the angles are <span class="math notranslate nohighlight">\(90^\text{o}\)</span> then this matrix reduces to a diagonal form, and the determinant is <span class="math notranslate nohighlight">\(abc\)</span>, which is equal to the volume. Consider a monoclinic crystal, such as benzoic acid, where only one crystal angle is not <span class="math notranslate nohighlight">\(90^\text{o}\)</span>, and where <span class="math notranslate nohighlight">\(a = 0.552, b = 0.514, c = 2.190\)</span> nm and the angle <span class="math notranslate nohighlight">\(\beta= 97^\text{o}\)</span>. The volume of the crystal will only be a little smaller than that of a solid rectangle of sides <span class="math notranslate nohighlight">\(abc = 0.621\;\mathrm{ nm^3}\)</span> because the angle <span class="math notranslate nohighlight">\(\beta\)</span> is close to <span class="math notranslate nohighlight">\(90^\text{o}\)</span>. The <span class="math notranslate nohighlight">\(\boldsymbol M\)</span> matrix for a monoclinic crystal where <span class="math notranslate nohighlight">\(\alpha = \gamma =90^\text{o}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \qquad\qquad\begin{bmatrix}\vec a\\ \vec b\\ \vec c\end{bmatrix}=\begin{bmatrix}a&amp;0&amp;0\\0&amp;b&amp;0\\c\cos(\beta) &amp; 0 &amp; c\sin(\beta)\end{bmatrix}\begin{bmatrix}\vec x\\ \vec y\\ \vec z\end{bmatrix}\qquad\qquad\qquad\qquad \text{(34)}\end{split}\]</div>
<p>The determinant is simple to do by hand in this particular example because the terms that are zero mean that the determinant is the product of the diagonal terms or <span class="math notranslate nohighlight">\(V=abc\sin(\beta)\)</span>. This result makes sense viewing the geometry of a monoclinic crystal, figure 22, which is that of a rectangular box pushed along one side. The term <span class="math notranslate nohighlight">\(\sin(\beta)\)</span> is the amount the height is reduced compared to a rectangular box. Using the cell parameters, the volume of the benzoic acid unit cell is <span class="math notranslate nohighlight">\(0.617\;\mathrm{ nm^3}\)</span>, which is slightly smaller than the rectangular <span class="math notranslate nohighlight">\(0.621\;\mathrm{nm^3}\)</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="vectors-Q25-32.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 25 - 32</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="vectors-Q33-38.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 33 - 38</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>