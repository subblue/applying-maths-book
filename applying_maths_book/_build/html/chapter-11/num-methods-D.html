
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6 The phase plane, nullclines, stable points and separatrix. The pendulum, Euler-Cromer eqns, SIR model of disease, bacterial growth. &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 17 - 20" href="num-methods-Q17-20.html" />
    <link rel="prev" title="Questions 13 - 16" href="num-methods-Q13-16.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1 Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     1 Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     5 Trig, hyperbolic and inverse functions, waves, polar coordinates,  factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     1 Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     1 - 3.8 Differentiation, gradients &amp; basic functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     3.9 Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     4 Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     6 Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     9 Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     10 Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     11 Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     12 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4 Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     1 Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     6 Integration and parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     8 Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     9 The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     10 Multiple integrals, Change of variables: Jacobians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     12 Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     1 Series, averages, waves, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     6 Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     8 Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     9 Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     1 Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     6 Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     8 Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     12 Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     15 Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     18 Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     21 Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     1 Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     4 Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     6 Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     7 Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     9 Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     11 Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     12 Solving equations using matrices. Eigenvectors and Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     13 Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     14 Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     15 Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     16 Principal axes and Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     1 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     4 Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     5 Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     1 Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     5 Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     7 Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     11 The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     12 The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     14 Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     1 Basics, Initial and Boundary Value problems, Steady state, Phase portrait, Chemical kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     9 First order equations &amp; Integrating factors. Second order equations, Newton’s laws and equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     12 The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     13 Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     14 Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     15 Partial Differential Equations, PDE. 1D &amp; 2D diffusion, Particle in a box, Lateral flow tests, Diffusion and Reaction, Cable equation, Algal Blooms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     16 PDE continued. Diffusion, Wave and Schroedinger eqns. Solution by the Fourier method. Transient grating.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-A.html">
     1 Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-B.html">
     4 Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-C.html">
     5 Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6 The phase plane, nullclines, stable points and separatrix. The pendulum,  Euler-Cromer eqns,  SIR model of disease,  bacterial growth.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-E.html">
     8 Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-F.html">
     9 Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     1 Monte - Carlo integration &amp; importance sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     2 Solving rate equations. The Gillespie method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     3 Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     4 Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     6 The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     1 Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     6 Modelling data. Least squares, chi squared, residuals, ANNOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     7 Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     10 Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-14/chapter14-intro.html">
   14 SI Units, Scientific Constants, unit conversion, Glossary, Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/chapter14-E.html">
     1 SI Units, Unit conversions, Scientific Constants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/Python%20crib.html">
     5 Appendix:  Some basic Python instructions with a few examples.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../references/references-intro.html">
   15 References and index
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/References.html">
     1 References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/index.html">
     2 Index
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-11/num-methods-D.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-11/num-methods-D.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-11/num-methods-D.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-11/num-methods-D.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   6 The phase plane, nullclines, stable points and separatrix. The pendulum,  Euler-Cromer eqns,  SIR model of disease,  bacterial growth.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction">
     6.1 Introduction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-phase-plane-2">
     6.2 The phase plane
     <span class="math notranslate nohighlight">
      \(^2\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#isoclines-and-nullclines">
     6.3 Isoclines and nullclines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-linear-equations-the-pendulum">
     6.4 Non-linear equations: the pendulum
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#i-the-separatrix">
       <strong>
        (i) The Separatrix
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eulercromer-equations">
     6.5 Euler–Cromer equations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-sir-model-describes-the-spread-of-diseases">
   7 The SIR model describes the spread of diseases
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rate-equations">
     7.1 Rate equations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-sir-phase-plane">
     7.2 The SIR phase plane
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#steady-states-isoclines-and-nullclines">
     7.3 Steady states, isoclines, and nullclines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#threshold-for-an-epidemic-and-maximum-and-total-number-infected">
     7.4 Threshold for an epidemic and maximum and total number infected
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sensitivity-to-rate-constant-k-2">
     7.5 Sensitivity to rate constant
     <span class="math notranslate nohighlight">
      \(k_2\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-the-time-profile-of-an-epidemic">
     7.6 Calculating the time profile of an epidemic
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bacterial-populations-calculated-via-chemical-kinetics">
     7.7 Bacterial populations calculated via Chemical Kinetics
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>6 The phase plane, nullclines, stable points and separatrix. The pendulum,  Euler-Cromer eqns,  SIR model of disease,  bacterial growth.</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   6 The phase plane, nullclines, stable points and separatrix. The pendulum,  Euler-Cromer eqns,  SIR model of disease,  bacterial growth.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction">
     6.1 Introduction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-phase-plane-2">
     6.2 The phase plane
     <span class="math notranslate nohighlight">
      \(^2\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#isoclines-and-nullclines">
     6.3 Isoclines and nullclines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-linear-equations-the-pendulum">
     6.4 Non-linear equations: the pendulum
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#i-the-separatrix">
       <strong>
        (i) The Separatrix
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eulercromer-equations">
     6.5 Euler–Cromer equations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-sir-model-describes-the-spread-of-diseases">
   7 The SIR model describes the spread of diseases
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rate-equations">
     7.1 Rate equations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-sir-phase-plane">
     7.2 The SIR phase plane
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#steady-states-isoclines-and-nullclines">
     7.3 Steady states, isoclines, and nullclines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#threshold-for-an-epidemic-and-maximum-and-total-number-infected">
     7.4 Threshold for an epidemic and maximum and total number infected
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sensitivity-to-rate-constant-k-2">
     7.5 Sensitivity to rate constant
     <span class="math notranslate nohighlight">
      \(k_2\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-the-time-profile-of-an-epidemic">
     7.6 Calculating the time profile of an epidemic
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bacterial-populations-calculated-via-chemical-kinetics">
     7.7 Bacterial populations calculated via Chemical Kinetics
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="the-phase-plane-nullclines-stable-points-and-separatrix-the-pendulum-euler-cromer-eqns-sir-model-of-disease-bacterial-growth">
<h1>6 The phase plane, nullclines, stable points and separatrix. The pendulum,  Euler-Cromer eqns,  SIR model of disease,  bacterial growth.<a class="headerlink" href="#the-phase-plane-nullclines-stable-points-and-separatrix-the-pendulum-euler-cromer-eqns-sir-model-of-disease-bacterial-growth" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">init_printing</span><span class="p">()</span>                    <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<section id="introduction">
<h2>6.1 Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>In the study of two-dimensional linear and non-linear differential equations, the phase plane, nullclines, and fixed points are very useful tools for analysing the equations before any numerical or algebraic calculation. The phase plane allows fixed points to be found, these are also called <em>steady state</em>, or <em>equilibrium</em> points and occur when <span class="math notranslate nohighlight">\(dy/dt = dx/dt = 0\)</span>. Some examples are also given in Chapter 10. <em>Closed orbits</em> and <em>limit-cycles</em> can also be observed in the phase plane and are described shortly.</p>
<p>Written generally, pairs of differential equations are</p>
<div class="math notranslate nohighlight">
\[\frac{dy}{dt} = f(x, y, t) \quad\text{   and   }\quad  \frac{dx}{dt} = g(x, y, t)\]</div>
<p>where the functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> may contain terms in <span class="math notranslate nohighlight">\(x,\; y\)</span> and perhaps <span class="math notranslate nohighlight">\(t\)</span>. For example,</p>
<div class="math notranslate nohighlight">
\[ \frac{dy}{dt} = xy+x^2 -y^2, \qquad \frac{dy}{dt}=-\sin(x)+(y-1)^2\]</div>
</section>
<section id="the-phase-plane-2">
<h2>6.2 The phase plane <span class="math notranslate nohighlight">\(^2\)</span><a class="headerlink" href="#the-phase-plane-2" title="Permalink to this headline">#</a></h2>
<p>The phase plane is the plot of <span class="math notranslate nohighlight">\(y\)</span> vs <span class="math notranslate nohighlight">\(x\)</span> and is found by calculating <span class="math notranslate nohighlight">\(dy/dx\)</span> by using the chain rule. In practice, this means dividing the equation for <span class="math notranslate nohighlight">\(y\)</span> by that for <span class="math notranslate nohighlight">\(x\)</span>; therefore the phase plane does not explicitly contain time. If the resulting equation can be integrated, the family of curves produced can be plotted for different values of the integration constant, which means for different initial values of <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span>. If the integration cannot be done analytically, then a numerical solution of the two initial equations has to be found and, again, <span class="math notranslate nohighlight">\(y\)</span> plotted vs <span class="math notranslate nohighlight">\(x\)</span> at various times until the entire phase plane is produced.</p>
<p>For example, if the equations governing the motion of a particle in a particular double-well potential, Fig. 13, are</p>
<div class="math notranslate nohighlight">
\[ \frac{dy}{dt} =x-x^3, \qquad  \frac{dx}{dt}=y\]</div>
<p>calculating the phase plane means integrating</p>
<div class="math notranslate nohighlight">
\[\displaystyle dy/dx = (x - x^3)/y\]</div>
<p>Separating <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int ydy=\int(x-x^3)dx\]</div>
<p>which integrates to</p>
<div class="math notranslate nohighlight">
\[y=\sqrt{x^2-x^4/2 +c} \]</div>
<p>and this is the equation describing this phase plane. The values of integration constant <span class="math notranslate nohighlight">\(c\)</span> depend on the initial energy of the particle. If it has sufficient energy, then the barrier will be surmounted and oscillation will occur between both wells. If not, the motion is restricted to one well only. The phase portrait is the collection of curves drawn on the phase plane with different initial conditions, in this case, different values of <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>The <em>stable</em>, <em>steady-state</em>, or <em>equilibrium</em> points are found when the rate of change is zero, and are therefore found at</p>
<div class="math notranslate nohighlight">
\[\displaystyle dy/dt=x - x^3 =0\quad\text{and}\quad dx/dt=y=0\]</div>
<p>making fixed points at <span class="math notranslate nohighlight">\(x=0,\;y=0\)</span> and <span class="math notranslate nohighlight">\(x = \pm 1,\; y = 0\)</span>. A more detailed analysis of fixed points in general shows that they may be stable, unstable or saddle points, see Jeffrey (1990) and/or Strogatz (1994).</p>
<p>A stable steady state has the property of returning to that state after a small perturbation to it is made, and clearly, the points (<span class="math notranslate nohighlight">\(\pm 1,\; 0\)</span>) are of this nature, Fig. 13 as they are at the bottom of the wells. The origin is a saddle point, and is not fully stable because moving in any direction from the origin the gradient is negative, except moving up or down the y-axis.</p>
<hr class="docutils" />
<p><span class="math notranslate nohighlight">\(^2\)</span> The name is historical and apparently was originally used in dynamics as the plane containing position <span class="math notranslate nohighlight">\(x\)</span> and momentum <span class="math notranslate nohighlight">\(mdx/dt\)</span> of a object as it moved under the influence of a force.</p>
</section>
<hr class="docutils" />
<section id="isoclines-and-nullclines">
<h2>6.3 Isoclines and nullclines<a class="headerlink" href="#isoclines-and-nullclines" title="Permalink to this headline">#</a></h2>
<p>The equation produced when the rate of change is zero is sometimes called an isocline or nullcline. Just as on an incline we move up, or on a decline down, an isocline means that the gradient is always the same and must therefore be a constant number, and a contour path is followed in the phase plane. A <em>nullcline</em> occurs when this constant is zero The nullclines are</p>
<div class="math notranslate nohighlight">
\[\displaystyle x - x^3 = 0\quad\text{ and }\quad y = 0\]</div>
<p>which in this case are both straight lines. <em>Isoclines</em> are the lines when</p>
<div class="math notranslate nohighlight">
\[x - x^3 = a\quad\text{ and }\quad y = a\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is some constant. Assuming that <span class="math notranslate nohighlight">\(y\)</span> is plotted vertically and <span class="math notranslate nohighlight">\(x\)</span> horizontally, the ‘flow’ or vector showing the direction of change, is always horizontal at each point along the nullcline, <span class="math notranslate nohighlight">\(dy/dt = 0\)</span>, no matter what its curve is, and vertical on the nullcline <span class="math notranslate nohighlight">\(dx/dt = 0\)</span>. The nullclines also partition the phase plane into areas where the derivatives have different sign; exactly what these are depends upon the particular equations. Figure  shows the phase portrait with isoclines at different <span class="math notranslate nohighlight">\(c\)</span> values and the nullclines, which are dotted. The figure-of-eight curve is the <em>separatrix</em> and, in this example, is the point when the particle has just enough initial energy to cross the barrier separating the region of oscillation in one well from motion over the barrier, and hence, motion between both wells. When the particle is placed in the bottom of either well, it has zero potential and zero kinetic energy. If it is not pushed, it will remain in this stable state at (<span class="math notranslate nohighlight">\(\pm 1, 0\)</span>) which are the points on the axis marked with a red dot.</p>
<p>Finally, in this short introduction to the phase plane, it must be remembered that although the phase plane equation 37 does not explicitly contain time, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are still functions of time and that time passing on the phase plane is not measured by equal <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> motion, but in a very non-linear manner. This can only really be observed by plotting pairs of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates on the phase plane at various times after solving the coupled equations.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig13.png" /></p>
<p>Figure 13. Example of a phase - plane with a few contours (isoclines) making up the phase portrait. The potential energy profile  has barrier with a maximum energy of zero. The motion of a particle starting at different points is shown on the right. The <span class="math notranslate nohighlight">\(dy/dt = 0\)</span> nullclines are shown dotted, the other nullcline, <span class="math notranslate nohighlight">\(dx/dt = y = 0\)</span> is the x-axis. The arrows show the direction of motion around the phase plane. The separatrix is the light blue ‘figure of eight’ and passes through the origin.</p>
</section>
<hr class="docutils" />
<section id="non-linear-equations-the-pendulum">
<h2>6.4 Non-linear equations: the pendulum<a class="headerlink" href="#non-linear-equations-the-pendulum" title="Permalink to this headline">#</a></h2>
<p>A rigid pendulum with a heavy bob at its end can move in two ways. When the energy is small, it will oscillate about the vertical in a good approximation to simple harmonic motion, and when the energy is large enough it will rotate continuously in the vertical plane. If the displacement from the vertical is not small, the motion is non-linear and the equation of motion has no exact analytical solution. If it is assumed that the pivot holding the pendulum is frictionless and that no air or other resistance hinders the motion, then the equation of motion is</p>
<div class="math notranslate nohighlight">
\[ \frac{d^2\varphi}{dt^2}+\omega^2\sin(\varphi)=0 \qquad\tag{38}\]</div>
<p>This equation  is described as non-linear because the angle <span class="math notranslate nohighlight">\(\varphi\)</span> does not change linearly but as <span class="math notranslate nohighlight">\(\sin(\varphi)\)</span>. A derivation of is given in Chapter 10.</p>
<p>The variable <span class="math notranslate nohighlight">\(\varphi\)</span> is the angle in radians away from the vertical, and <span class="math notranslate nohighlight">\(\omega\)</span> is an angular frequency defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \omega = \sqrt{g/L}\;\mathrm{s^{-1}}\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is the acceleration due to gravity and <span class="math notranslate nohighlight">\(L\)</span> the length of the pendulum. The frequency <span class="math notranslate nohighlight">\(\omega\)</span> is the frequency that the pendulum has when it undergoes infinitesimally small oscillations. The mass of the pendulum is <span class="math notranslate nohighlight">\(m\)</span>; it is used to calculate forces but cancels out in the result.</p>
<p>When the angular displacement is small expanding the sine as a series and retaining the first terms as the next terms is <span class="math notranslate nohighlight">\(\varphi^3/3!\)</span> and will be insignificant, gives, <span class="math notranslate nohighlight">\(\sin(\varphi) \to \varphi\)</span>, the the pendulum’s motion is sinusoidal and that of the simple harmonic oscillator of frequency <span class="math notranslate nohighlight">\(\omega\)</span>. The equation of motion becomes</p>
<div class="math notranslate nohighlight">
\[ \frac{d^2\varphi}{dt^2}+\omega^2=0 \]</div>
<p>which has the general solution,</p>
<div class="math notranslate nohighlight">
\[ \varphi (t)=c_1\sin(\omega t+c_2)\]</div>
<p>where <span class="math notranslate nohighlight">\(c_1,c_2\)</span> are integration constants and depend on initial conditions. These are chosen to be <span class="math notranslate nohighlight">\(\varphi (t)=\varphi_0\)</span> and <span class="math notranslate nohighlight">\(d\varphi/dt=v_0\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span>. The  equations become</p>
<div class="math notranslate nohighlight">
\[\displaystyle \varphi_0=c_1\sin(c_2)\quad\text{ and }\quad d\varphi/dt = v_0=c_1\omega\cos(c_2)\]</div>
<p>which after finding the constants produces</p>
<div class="math notranslate nohighlight">
\[\varphi(t)=\varphi_0\cos(\omega t)+\frac{v_0}{\omega}\sin(\omega t) \]</div>
<p>Naturally, different initial conditions would lead to different <span class="math notranslate nohighlight">\(c_{1,2}\)</span>.</p>
<p>Much of the dynamics of the real pendulum can be understood from the phase plane (<span class="math notranslate nohighlight">\(\varphi,\; d\varphi/dt)\)</span> which can be calculated easily if the equation of motion is split into two; the first gives the angular velocity <span class="math notranslate nohighlight">\(v\)</span>, the second the angular acceleration or rate of change of
velocity,</p>
<div class="math notranslate nohighlight">
\[\frac{d\varphi}{dt} = v, \quad \frac{dv}{dt} + \omega^2 \sin(\varphi) = 0 \qquad\tag{39}\]</div>
<p>The equilibrium or steady state point when the derivatives are zero is clearly <span class="math notranslate nohighlight">\(v = 0\)</span> and <span class="math notranslate nohighlight">\(\omega^2 \sin(\varphi) = 0\)</span>, which will occur when <span class="math notranslate nohighlight">\(\varphi = 0, \pm n\pi\)</span> with <span class="math notranslate nohighlight">\(n = 1,\, 2 \cdots\)</span>. The nullclines are zero because only <span class="math notranslate nohighlight">\(v\)</span> or <span class="math notranslate nohighlight">\(\varphi\)</span> occur in each equation; the isoclines are found when the derivative is a constant <span class="math notranslate nohighlight">\(k\)</span>, whose values you can choose. In this case,</p>
<div class="math notranslate nohighlight">
\[\displaystyle v = k\quad\text{ and }\quad\varphi = \sin^{-1}(k/\omega^2)\]</div>
<p>are the isoclines. The phase plane is obtained by first using the chain rule to give</p>
<div class="math notranslate nohighlight">
\[ \frac{dv}{d\varphi} = -\frac{\omega^2}{v} \sin(\varphi)\]</div>
<p>and then variables <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(\varphi\)</span> can be separated and the equation integrated to give</p>
<div class="math notranslate nohighlight">
\[\displaystyle v=\sqrt{2\omega^2\cos(\varphi)+2c}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is a constant of integration. This constant will be determined by the starting conditions; these are the angle that the pendulum is released from and its angular velocity at the point of release. If the initial velocity is <span class="math notranslate nohighlight">\(v_0\)</span> and the release angle <span class="math notranslate nohighlight">\(\varphi_0\)</span> then the integration is</p>
<div class="math notranslate nohighlight">
\[\int_{v_0}^v vdv = -\omega^2\int_{\varphi_0}^\varphi \sin(\varphi)d\varphi\]</div>
<p>which produces</p>
<div class="math notranslate nohighlight">
\[v=\sqrt{v_0^2+2\omega^2[\cos(\varphi)-\cos(\varphi_0)]} \]</div>
<p>and this is shown in fig 14.</p>
<section id="i-the-separatrix">
<h3><strong>(i) The Separatrix</strong><a class="headerlink" href="#i-the-separatrix" title="Permalink to this headline">#</a></h3>
<p>The line crossing through <span class="math notranslate nohighlight">\(\varphi/\pi=\pm 1\)</span> on the abscissa, is called the <em>separatrix</em>; this is produced in this example when the integration constant <span class="math notranslate nohighlight">\(c = 1\)</span> if <span class="math notranslate nohighlight">\(\omega = 1\)</span>. At all points between the separatrixes, the pendulum does not complete more than one revolution, i.e. oscillates back and forth, and the motion appears as closed curves in the figure. If the pendulum starts from a stationary position at any angle except zero, up to a fraction short of <span class="math notranslate nohighlight">\(\pi\)</span> radians, a position almost upside down, it will then swing, ad infinitum, to a similar position on the other side and then back again; recall that there is no friction term in the equations. If the pendulum starts exactly upside down and also isn’t given a push, i.e. initial angular velocity is zero, then it should remain upside down for ever in this metastable state. However, no matter what angle the pendulum is in initially, if it is given a sufficient push and acquires energy in excess of <span class="math notranslate nohighlight">\(2mgL\)</span>, then it can repeatedly rotate though 360<span class="math notranslate nohighlight">\(^\mathrm{o}\)</span>. This is shown on the phase plane by the lines above the separatrix that do not cross the horizontal <span class="math notranslate nohighlight">\(\varphi/\pi\)</span> axis.</p>
<p>The direction of the motion can also be determined from the plot, starting at <span class="math notranslate nohighlight">\(\varphi/\pi = 1/2\)</span> or 90<span class="math notranslate nohighlight">\(^\mathrm{o}\)</span>, and at zero initial velocity, the pendulum loses potential energy and gains kinetic energy. The angle decreases as the pendulum moves towards its lowest point; this means that the velocity is negative and becomes increasingly so, reaching its largest negative value when the pendulum is pointing vertically down. The motion is therefore clockwise around the closed curves as shown by the arrows on the plot. The motion continues forever, because energy is conserved in this model of the pendulum.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig14.png" /></p>
<p>Figure 14 Phase plane, angle vs velocity for the pendulum with <span class="math notranslate nohighlight">\(\omega = 1\)</span> and various initial conditions. The separatrix are the lines crossing at <span class="math notranslate nohighlight">\(\varphi/\pi  = \pm 1\)</span>, they separate regions of oscillation, inside the closed curve, from complete rotation of the pendulum.</p>
<hr class="docutils" />
<p>The change in angle and velocity with time can be found by numerically solving equations 39 as shown in Fig. 15 using the method outlined in Algorithm 14 with change in notation from <span class="math notranslate nohighlight">\(x,\,y\)</span> to <span class="math notranslate nohighlight">\(v,\,\varphi\)</span>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dphidt</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span> <span class="p">:</span> <span class="n">v</span>
<span class="n">dvdt</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">phi</span> <span class="p">:</span> <span class="o">-</span><span class="n">omega0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>and changing the steps in the loop of the Euler algorithm to (commented out to show)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#v = v + h*dvdt(phi)  </span>
<span class="c1">#phi = phi + h*dphidt(v)</span>
<span class="c1">#t  = t + h </span>
</pre></div>
</div>
</div>
</div>
<p>An exact algebraic solution is only possible when the angle is small and <span class="math notranslate nohighlight">\(\sin(\varphi) \to \varphi\)</span>, which is the harmonic oscillator and has a frequency <span class="math notranslate nohighlight">\(\omega\)</span> and a period of 1/<span class="math notranslate nohighlight">\(\omega\)</span> seconds. When the starting angle is not small, the angular motion is not purely sinusoidal, as may be seen in the figure, but spends longer near to the turning points at the top of the swing.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig15.png" /></p>
<p>Figure 15. Angle (radians) and velocity (radians/sec) vs time of the non-linear pendulum, with <span class="math notranslate nohighlight">\(\omega = 1,\;v_0=0\)</span> and an initial angle of <span class="math notranslate nohighlight">\(8\pi/9\)</span>. Notice that the velocity is zero when the potential energy is a maximum. This is when its angle is greatest or smallest and vice versa.</p>
</section>
</section>
<hr class="docutils" />
<section id="eulercromer-equations">
<h2>6.5 Euler–Cromer equations<a class="headerlink" href="#eulercromer-equations" title="Permalink to this headline">#</a></h2>
<p>Although the Euler method will work well in all our examples, it is not necessarily the best method to use for oscillating systems, such as the pendulum, because energy is not conserved that well. By changing the algorithm as below then the error in the energy becomes proportional to <span class="math notranslate nohighlight">\(\Delta t^3\)</span> which is a significant improvement over <span class="math notranslate nohighlight">\(\Delta t\)</span> when the step size is small. The angle is calculated as <span class="math notranslate nohighlight">\(\mathtt{phi= phi + h*v}\)</span> instead of <span class="math notranslate nohighlight">\(\mathtt{phi= phi + h*dphidt}\)</span> as in the Euler method, Algorithm 14. See Gould et al. (2007) for more details of this and related methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm: Euler Cromer modifications</span>

<span class="k">def</span> <span class="nf">EulerCromer</span><span class="p">(</span><span class="n">dphidt</span><span class="p">,</span> <span class="n">dvdt</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">maxt</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>  
    
    <span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">Eulerv</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Eulerphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dtime</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">h</span>   <span class="o">=</span> <span class="p">(</span><span class="n">maxt</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>                   <span class="c1"># time step</span>
    <span class="n">v</span>   <span class="o">=</span> <span class="n">v0</span>                            <span class="c1"># initial values</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">phi0</span>
    <span class="n">t</span>   <span class="o">=</span> <span class="n">t0</span>
    <span class="n">Eulerv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="o">=</span> <span class="n">v0</span>
    <span class="n">Eulerphi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi0</span>
    <span class="n">dtime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="o">=</span> <span class="n">t0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">v</span>   <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">dvdt</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">v</span>
        <span class="n">t</span>   <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">h</span>
        <span class="n">Eulerv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="n">v</span>                  <span class="c1"># save values</span>
        <span class="n">Eulerphi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span>
        <span class="n">dtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>    <span class="o">=</span> <span class="n">t</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">Eulerv</span><span class="p">,</span><span class="n">Eulerphi</span><span class="p">,</span><span class="n">dtime</span>
<span class="c1">#---------</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-sir-model-describes-the-spread-of-diseases">
<h1>7 The SIR model describes the spread of diseases<a class="headerlink" href="#the-sir-model-describes-the-spread-of-diseases" title="Permalink to this headline">#</a></h1>
<p>A very interesting, and relatively straightforward example of coupled equations is the spread of an infectious disease, because, besides being intrinsically interesting, especially during the Covid19 epidemic, it allows a clear illustration of a number of features such as the phase plane and nullclines.</p>
<p>An epidemic is defined as the number of infected persons, increasing with time to a number above those initially infected. Kermack &amp; McKendrick (1927), were the first to describe a realistic disease model, which they used to study the spread of a plague on the island of Bombay in 1905/6. In the SIR model, one or more infected persons are introduced into a community where all are equally susceptible to the disease. The model assumes, first, that the disease spreads by contact one to another; each person runs the course of the disease and then cannot be re-infected; and, secondly, that the duration of the infection is short compared to an individual’s lifetime, so that the total number of people is constant. Finally, the number of individuals is fixed once the infection has begun; therefore this model only describes infection in a closed community and is called a compartmentalised model. This is called the S-I-R model, because individuals are either susceptible (S), infected (I), or removed (R). The scheme is</p>
<div class="math notranslate nohighlight">
\[ S+I \overset{k_2}\longrightarrow 2I ; \qquad   I \overset{k_1} \longrightarrow  R  \qquad\tag{40}\]</div>
<p>and the aim is to calculate how R, S, and I change with time. In doing so we shall set up a set of rate equations and suppose that the numbers of individuals involved is sufficiently large that the integration is valid. In the case of Covid-19 the numbers are so large that this should not present a problem.</p>
<p>The first step describes the transmission of the infection, and the second, the recovery from infection, hence, the number infected I must reach zero at long times as the infection ends. The susceptible persons become infected by reacting with someone who is already infected with a rate constant <span class="math notranslate nohighlight">\(k_2\)</span>. In chemical terms, the rate of such a second-order reaction is <span class="math notranslate nohighlight">\(k_2[S][I]\)</span>, supposing that <span class="math notranslate nohighlight">\([S]\)</span> and <span class="math notranslate nohighlight">\([I]\)</span> are concentrations. The second step, infected to removed, has a rate constant <span class="math notranslate nohighlight">\(k_1\)</span>, the reciprocal of which is the average time that an individual once infected takes to move into the removed class; the rate for this is <span class="math notranslate nohighlight">\(k_1[I]\)</span>. Out of the constant total number of individuals, <span class="math notranslate nohighlight">\(N = S + I + R\)</span>; the number <span class="math notranslate nohighlight">\(R_0\)</span> before the infection starts are those that are immune and clearly at least one infected person has initially to be present. The second equation shows that given time, all individuals will end up in the removed class R, and play no further part in the infection, being immune, isolated, or dead. In this model, the epidemic is assumed to run its course without the intervention of medication, which, given at random times to different individuals, would prematurely cause its end.</p>
<p>If S, I, and R were chemical species, the scheme above would represent a quadratic autocatalytic reaction where R is the product that takes no further part in the reaction. To start the reaction, some initial amount of species I has to be present.</p>
<section id="rate-equations">
<h2>7.1 Rate equations<a class="headerlink" href="#rate-equations" title="Permalink to this headline">#</a></h2>
<p>The rate equations for scheme 40 are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}\qquad\qquad
\displaystyle \frac{dS}{dt} &amp;= -k_2SI \\
\displaystyle \frac{dI}{dt} &amp;= +k_2SI - k_1I\\
\displaystyle \frac{dR}{dt} &amp;= +k_1I \\
N &amp;= I + S + R
\end{align}\qquad\qquad\qquad\qquad\qquad\text{41}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(I\)</span> represent the number of individuals (or the concentration of chemical species in an autocatalytic reaction). The initial number infected is <span class="math notranslate nohighlight">\(I_0\)</span>, those susceptible <span class="math notranslate nohighlight">\(S_0\)</span>, and removed <span class="math notranslate nohighlight">\(R_0\)</span>. The total number of individuals is a constant <span class="math notranslate nohighlight">\(N\)</span>, and, because of this, the last differential equation is not needed because <span class="math notranslate nohighlight">\(R\)</span> can be calculated by subtracting from <span class="math notranslate nohighlight">\(N\)</span> the amount of <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(I\)</span> at any time. The rate constants are <span class="math notranslate nohighlight">\(k_2\)</span>, the spreading rate constant and <span class="math notranslate nohighlight">\(k_1\)</span> the removal rate constant, and have units of number<span class="math notranslate nohighlight">\(^{-1}\)</span> time<span class="math notranslate nohighlight">\(^{-1}\)</span> and number time<span class="math notranslate nohighlight">\(^{-1}\)</span> respectively. By writing down rate equations, it is implicitly assumed that the number of individuals present is large and can be a continuous variable, not an integer, as is really the case. The model described so far assumes that all infected persons recover but instead many may die as we have seen with Covid19. To model this an extra rate constant can be added to <span class="math notranslate nohighlight">\(k_1\to k_1+k_D\)</span> and then the term <span class="math notranslate nohighlight">\(dD/dt=k_DI\)</span> included. The fraction that die is <span class="math notranslate nohighlight">\(k_1/(k_1+k_D)\)</span>, a number which will normally be known. Monte Carlo methods to integrate and simulate these equations without using calculus are shown in Chapter 12 in Q9 and Q16 and their answers.</p>
<p>Before the equations are numerically integrated, a complete analytical solution not being possible, some analysis of the problem can still be carried out. The actual values of the constants are important if a real disease is to be modelled, and before trying to fit the data, it is necessary to know what range of parameters will produce an epidemic and what the expected populations will look like.</p>
<p>Intuitively, scheme 40 suggests that the number infected I, which is initially small (for instance, one person), increases rapidly, passes through a maximum, then slowly decays away. However, this will occur only if <span class="math notranslate nohighlight">\(k_2S_0 \gt k_1\)</span> because when S is large, I is initially formed more rapidly than it is consumed. If the opposite is true, then I is consumed more rapidly and its population cannot become large and no epidemic occurs. To be quantitative, let <span class="math notranslate nohighlight">\(R_R = k_2S_0/k_1\)</span> be defined as the reproductive ratio,<span class="math notranslate nohighlight">\(^\dagger\)</span> which is the number of secondary infections caused by one infected person if all the population is equally susceptible. An epidemic must ensue if the reproductive ratio is greater than one, because more individuals will become infected with time. This can also be appreciated by examining the rate of change of I in the second of equations 41 at</p>
<div class="math notranslate nohighlight">
\[\displaystyle t = 0;\; dI/dt\big|_{t = 0} = I_0(k_2S_0 − k_1)\quad\text{ if }\quad k_2S_0 \gt k_1\]</div>
<p>then <span class="math notranslate nohighlight">\(dS/dt \gt 0\)</span> and an epidemic will occur.</p>
<p>Typical values for the reproductive ratio are smallpox = 4; mumps = 5; German measles (rubella) = 6; measles = 12; malaria <span class="math notranslate nohighlight">\(\approx\)</span>100, (see Britton 2003), Covid-19 <span class="math notranslate nohighlight">\(gt 3, \lt 9\)</span> (Wikipedia).</p>
<p>( <span class="math notranslate nohighlight">\(^\dagger\)</span> Many texts call the reproductive ratio <span class="math notranslate nohighlight">\(R_0\)</span>, which is unfortunately confusing with <span class="math notranslate nohighlight">\(R_0\)</span>, the initial number in the removed class.)</p>
</section>
<section id="the-sir-phase-plane">
<h2>7.2 The SIR phase plane<a class="headerlink" href="#the-sir-phase-plane" title="Permalink to this headline">#</a></h2>
<p>A graph of <span class="math notranslate nohighlight">\(I\)</span> vs <span class="math notranslate nohighlight">\(S\)</span> is the phase plane. The phase plane shows how the number of infectives <span class="math notranslate nohighlight">\(I\)</span>
and susceptibles <span class="math notranslate nohighlight">\(S\)</span> change with time, even though time is only implicit on the graph. The relationship between I and S is found by using the chain rule</p>
<div class="math notranslate nohighlight">
\[\displaystyle\frac{dI}{dt}=\frac{dI}{dS}\frac{dS}{dt}\]</div>
<p>and then  integrating:</p>
<div class="math notranslate nohighlight">
\[\frac{dI}{dS}=\frac{k_2S-k_1}{-k_2S}=\frac{k_1}{k_2S}-1\]</div>
<p>Integrating with limits <span class="math notranslate nohighlight">\(I_0,\;S_0\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{I_0}^IdI=\int_{S_0}^S \left(\frac{k_1}{k_2S}-1\right)dS\]</div>
<p>which produces</p>
<div class="math notranslate nohighlight">
\[I=\frac{k_1}{k_2}\ln\left(\frac{S}{S_0}  \right)-S+N\]</div>
<p>where the initial values have been substituted with <span class="math notranslate nohighlight">\(I_0 + S_0 = N\)</span>; at <span class="math notranslate nohighlight">\(t = 0,\; R = 0\)</span>. Next, dividing by <span class="math notranslate nohighlight">\(N\)</span> to make the calculation independent of the number of individuals produces</p>
<div class="math notranslate nohighlight">
\[I_N=\frac{k_1}{k_2N}\ln\left(\frac{S_NN}{S_0}  \right)-S_N+1  \qquad\tag{42}\]</div>
<p>where the notation is <span class="math notranslate nohighlight">\(I_N = I/N\)</span> and similarly for <span class="math notranslate nohighlight">\(S_N\)</span>. The graph of <span class="math notranslate nohighlight">\(I_N\)</span> vs <span class="math notranslate nohighlight">\(S_N\)</span> is shown in Fig. 16 at different values of <span class="math notranslate nohighlight">\(S_0/N\)</span>, which is the fraction initially susceptible. Time does not explicitly appear in this equation, but this does not mean that the curves are time independent; far from it, because S and I both depend on time. The curves, equation 42, must start at the line <span class="math notranslate nohighlight">\(S_N +I_N =1\)</span> , or <span class="math notranslate nohighlight">\(S+I=N\)</span>, which is the diagonal line in Fig.16, because no <span class="math notranslate nohighlight">\(R\)</span> (removed class) individuals are present initially, and must move to the left as time progresses. At very long times the fraction infected must become zero.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig16.png" /></p>
<p>Figure 16 Phase plot of equation 42. Different fractions of initially susceptible individuals <span class="math notranslate nohighlight">\(I_N\)</span> are shown calculated with <span class="math notranslate nohighlight">\(S_N^{max} = 1/3\)</span>. An epidemic occurs when a curve starts to the right of <span class="math notranslate nohighlight">\(S_N^{max}\)</span>. The arrow shows the direction of change with time and are horizontal on the (vertical) nullcline, <span class="math notranslate nohighlight">\(S = k_1/k_2\)</span>, and vertical on the <span class="math notranslate nohighlight">\(I = 0\)</span> nullcline or horizontal axis.</p>
<hr class="docutils" />
<p>The definition of an epidemic is that the number of individuals infected increases above those infected initially. In Fig. 16, the initial number infected is found where a curve touches the diagonal line, this is 0.25 with <span class="math notranslate nohighlight">\(S_0/N = 0.75\)</span>, and <span class="math notranslate nohighlight">\(I_N\)</span> increases to <span class="math notranslate nohighlight">\(\approx 0.4\)</span> at its maximum and therefore, an epidemic may occur. Starting at <span class="math notranslate nohighlight">\(S_0/N = 0.25\)</span>, the number infected decreases continuously and therefore an epidemic cannot occur. This simple approach indicates the importance of immunization and vaccination.</p>
<p>Immunizing or vaccinating a population reduces those susceptible, reducing <span class="math notranslate nohighlight">\(S_0\)</span> and the reproductive ratio <span class="math notranslate nohighlight">\(R_R\)</span>, and so making an epidemic less possible. To the right of <span class="math notranslate nohighlight">\(S_N^{max}\)</span>, Fig.16, an epidemic occurs, although it may not be severe if the initial value of <span class="math notranslate nohighlight">\(S_0/N\)</span> is close to the maximum; to its left the infection dies out. The turnover from epidemic to no epidemic is the point where <span class="math notranslate nohighlight">\(S_N^{max}\)</span> touches the diagonal. In the figure this occurs at <span class="math notranslate nohighlight">\(I_N^{max} = 1 - 1/3 = 0.66\)</span>, meaning that <span class="math notranslate nohighlight">\(66\)</span>% immunization is needed to prevent an epidemic, which is a low value. With an infectious disease such as mumps or German measles, this value has to be <span class="math notranslate nohighlight">\(\approx\)</span> 0.85, meaning that 85% of the population has to be immunized to prevent an epidemic. Notice that not everyone needs to be immunized to prevent an epidemic; this is called <em>herd immunity</em>. A few individuals will by chance, never meet an infected person. An immunization/vaccination level of <span class="math notranslate nohighlight">\(85\)</span>% may be difficult to achieve in a population by voluntary mass vaccination. Should the level of immunization fall by only a small amount, the threshold at <span class="math notranslate nohighlight">\(S_N^{max}\)</span> may be crossed and an epidemic could occur. The number of individuals being immunized can suddenly fall, as happened in the UK in the late 1990’s and early in this century, due to poorly researched and inflammatory news media stories about the MMR vaccine for children. Some parents were reluctant to have their children vaccinated even though the risk of damage to health and even death were far greater than receiving the vaccine itself. Similar concerns have prevented many people from becoming vaccinated for Covid19 even though world-wide multiple millions of doses have been administered.</p>
</section>
<section id="steady-states-isoclines-and-nullclines">
<h2>7.3 Steady states, isoclines, and nullclines<a class="headerlink" href="#steady-states-isoclines-and-nullclines" title="Permalink to this headline">#</a></h2>
<p>In a rate equation, a steady state is produced when the rate of change is zero. In the SIR model this means</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dS}{dt} = 0,\qquad \frac{dI}{dt} = 0\]</div>
<p>When molecules, or species in general, interact more than one steady state can be present, and not all of these are necessarily stable. The nullclines on the phase plane of the SIR model are particularly simple and are <span class="math notranslate nohighlight">\(I = 0\)</span>, or along the S-axis, and <span class="math notranslate nohighlight">\(S = k_1/k_2\)</span>, which is the vertical line at <span class="math notranslate nohighlight">\(S_N^{max}\)</span> and divides the region where the infected population increases from that where it decreases. The nullclines divide the phase plane into four areas, two areas are below the S-axis in this case, and, as negative number of individuals do not make any sense, only two of the four regions have any meaning. Assuming that I is plotted vertically and R horizontally, the ‘flow’ or vector, arrow Fig.16, showing the direction of change is always vertical at any point of the <span class="math notranslate nohighlight">\(I\)</span> nullcline, (horizontal axis), no matter what its curve is, and horizontal on the <span class="math notranslate nohighlight">\(S\)</span> nullcline when <span class="math notranslate nohighlight">\(dS/dt = 0\)</span>. A steady state point is found where the nullclines meet, in the SIR model this is in the <span class="math notranslate nohighlight">\(S\)</span>-axis at the point <span class="math notranslate nohighlight">\([k_1/k_2, 0]\)</span> which is the foot of the vertical line <span class="math notranslate nohighlight">\(S_N^{max}\)</span>.</p>
</section>
<section id="threshold-for-an-epidemic-and-maximum-and-total-number-infected">
<h2>7.4 Threshold for an epidemic and maximum and total number infected<a class="headerlink" href="#threshold-for-an-epidemic-and-maximum-and-total-number-infected" title="Permalink to this headline">#</a></h2>
<p>The maximum fraction of infected individuals is found when <span class="math notranslate nohighlight">\(dI_N/dS_N = 0\)</span>, and this occurs
at the constant value <span class="math notranslate nohighlight">\(\displaystyle S_N=\frac{k_1}{k_2N}\)</span> for any fixed <span class="math notranslate nohighlight">\(N\)</span>. When <span class="math notranslate nohighlight">\(dI_N/dS_N=0\)</span> is reached, the infection has peaked and must start to decrease. The <em>maximum fraction</em> infected at any one time, is from 42</p>
<div class="math notranslate nohighlight">
\[I_N^{max} = 1+\frac{k_1}{k_2(S_0+I_0)}\left(\ln\left( \frac{k_1}{k_2S_0} \right) -1  \right) \qquad\tag{43}\]</div>
<p>and, when multiplied by the total number <span class="math notranslate nohighlight">\(I_0 + S_0\)</span>, gives the maximum number of hospital beds necessary to treat the infection. The maximum <span class="math notranslate nohighlight">\(I_N^{max}\)</span> may occur mathematically to the right of the diagonal line, Fig. 16, but clearly this is not physically possible, because the maximum value <span class="math notranslate nohighlight">\(I_N\)</span> can ever take is subject to the condition <span class="math notranslate nohighlight">\(S_N^{max} + I_N^{max} \le 1\)</span> and this occurs when <span class="math notranslate nohighlight">\(R_R \ge 1\)</span>.</p>
<p>When the number (or fraction) of infected individuals is zero, there are still some who remain susceptible, see Fig. 16, who did not catch the disease even in an epidemic. This fraction is in the range <span class="math notranslate nohighlight">\(0.02 \to 0.08\)</span> in the figure, and is the extent of herd immunity. To be more quantitative, equation 42 describes <span class="math notranslate nohighlight">\(I\)</span> vs <span class="math notranslate nohighlight">\(R\)</span>, and when <span class="math notranslate nohighlight">\(t \to \infty\)</span> then <span class="math notranslate nohighlight">\(I\)</span> is zero, giving</p>
<div class="math notranslate nohighlight">
\[0 = \frac{k_1}{k_2N}\ln\left( \frac{S_N^\infty N}{S_0} \right)-S_N^{\infty} +1 \qquad\tag{44}\]</div>
<p>which is transcendental, and has to be solved numerically for <span class="math notranslate nohighlight">\(S_N^\infty\)</span>, the fractional amount of <span class="math notranslate nohighlight">\(S\)</span> remaining at <span class="math notranslate nohighlight">\(t \to \infty\)</span>. The Newton-Raphson method (Chapter 3.10) could be used to solve the equation. However, for a strong epidemic the fractional amount of <span class="math notranslate nohighlight">\(S\)</span> left at the end is very small; <span class="math notranslate nohighlight">\(S_N^\infty \ll 1\)</span> hence</p>
<div class="math notranslate nohighlight">
\[\frac{k_1}{k_2N}\ln\left( \frac{S_N^\infty N}{S_0} \right) +1=0 \qquad\tag{45}\]</div>
<p>When re-arranged,</p>
<div class="math notranslate nohighlight">
\[S_N^\infty =\frac{S_0}{N}e^{-k_2N/k_1},\qquad \text{or}\qquad S_N^\infty =\frac{S_0}{I_0/S_0+1}e^{-k_2S_0/k_1(1+I_0/S_0)} \qquad\tag{46}\]</div>
<p>When <span class="math notranslate nohighlight">\(I_0/S_0 \ll 1\)</span>, for example, if only one person is infected initially, then <span class="math notranslate nohighlight">\(\displaystyle S_N^\infty \approx e^{-k_2S_0/k_1}\)</span>. As a check, using the lowest curve in Fig. 16, which has been calculated with the ratio <span class="math notranslate nohighlight">\(k_2N/k_1 = 3, S_0 = N - I_0\)</span> and <span class="math notranslate nohighlight">\(I_0/S_0 = 1/1000\)</span>, the fractional amount of <span class="math notranslate nohighlight">\(S\)</span> remaining at the end of the epidemic, calculated using the approximate formula, is <span class="math notranslate nohighlight">\(S_N^\infty  \approx 0.0498\)</span> or 4.98% of the population were never infected. This is close to the exact value of 5.94%.</p>
<p>Finally, starting with equation 45 the total number infected is approximately</p>
<div class="math notranslate nohighlight">
\[I_{tot} \approx N-S_0e^{-k_2N/k_1} \qquad\tag{45}\]</div>
<p>or <span class="math notranslate nohighlight">\(N(1 - 0.0498)\)</span> and this is the size of the infection, and in effect defines the total number of hospital beds needed over the course of the epidemic.</p>
</section>
<section id="sensitivity-to-rate-constant-k-2">
<h2>7.5 Sensitivity to rate constant <span class="math notranslate nohighlight">\(k_2\)</span><a class="headerlink" href="#sensitivity-to-rate-constant-k-2" title="Permalink to this headline">#</a></h2>
<p>To understand some of the equations above, such as the maximum fraction infected, <span class="math notranslate nohighlight">\(I_N^{max}\)</span> it is easier to draw some graphs. Suppose that there are ten thousand susceptible persons, and that the disease starts to spread after one person is infected. What is the effect of the different rate constants? The rate of infection <span class="math notranslate nohighlight">\(k_2\)</span> here is key, i.e. the term <span class="math notranslate nohighlight">\(k_2SI\)</span> (eqn. 41) has a dramatic effect. If <span class="math notranslate nohighlight">\(k_2\)</span> is small, <span class="math notranslate nohighlight">\(10^{-5}\)</span>, top left, (see the graphs below), the overall the epidemic does not progress even up to <span class="math notranslate nohighlight">\(1000\)</span> days. However, with <span class="math notranslate nohighlight">\(k_2=2\cdot 10^{-5}\)</span> (top right) the epidemic starts and <span class="math notranslate nohighlight">\(\approx 1500\)</span> persons are infected at the peak. Increasing <span class="math notranslate nohighlight">\(k_2\)</span> again to <span class="math notranslate nohighlight">\(5\cdot 10^{-5}\)</span>  <span class="math notranslate nohighlight">\(\approx 4800\)</span> are infected. This rapid increase is rather dramatic and shows the effect of feedback, i.e. <span class="math notranslate nohighlight">\( S+I \overset{k_2}\longrightarrow 2I \)</span>;  Increasing <span class="math notranslate nohighlight">\(k_2\)</span> above <span class="math notranslate nohighlight">\(10^{-4}\)</span> has a smaller effect than when <span class="math notranslate nohighlight">\(k_2=10^{-5}\)</span> simply because so many are already infected. This behaviour shows how important the reproductive ratio is because this is proportional to <span class="math notranslate nohighlight">\(k_2\)</span>.</p>
<p>Even with this simple model we can understand why wearing face masks is important because this effectively reduces <span class="math notranslate nohighlight">\(k_2\)</span>. Isolating individuals, or being vaccinated, reduces the spread of disease also because the number of those susceptible is reduced and therefore so is the product <span class="math notranslate nohighlight">\(k_2SI\)</span> in eqn. 40.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig16a.png" /></p>
<p>Figure 16a. Populations of susceptibles S, (red line), infected I, (blue line) and recovered R, (green line) vs. time with different <span class="math notranslate nohighlight">\(k_2\)</span> values using <span class="math notranslate nohighlight">\(k_1 =0.1\)</span>. The peaks of the infected curves are found using eqn. 43, <span class="math notranslate nohighlight">\(I_N^{max}N\)</span>.</p>
</section>
<hr class="docutils" />
<section id="calculating-the-time-profile-of-an-epidemic">
<h2>7.6 Calculating the time profile of an epidemic<a class="headerlink" href="#calculating-the-time-profile-of-an-epidemic" title="Permalink to this headline">#</a></h2>
<p>As an illustration of using the SIR model, suppose that you are presented with this specific problem: The following data for the incidence of influenza was recorded at a boys’ boarding school. Starting on day zero, the number of boys infected each day was</p>
<div class="math notranslate nohighlight">
\[\displaystyle \qquad\qquad 1, 3, 7, 25, 72, 222, 282, 256, 233, 189, 123, 70, 25, 11, 4\]</div>
<p>One infected boy started the flu epidemic, and <span class="math notranslate nohighlight">\(763\)</span> boys were resident. This example is given by Murray (2002, chapter 10, p. 326). The SIR model can be used to estimate the rate constants describing the data, the maximum number infected at any time, and the total number of boys that have been infected at the end of the epidemic.
The strategy is to work out what is already known from the data.</p>
<p>First, the timescale is in days; the number of boys susceptible is <span class="math notranslate nohighlight">\(763\)</span>, making <span class="math notranslate nohighlight">\(S_0 = 763 - 1\)</span>, assuming that only one boy was initially infected. If the infectious period is about 2.5 days, this means that, by definition, <span class="math notranslate nohighlight">\(k_1 = 1/2.5\)</span>, which can be used as a starting value leaving only <span class="math notranslate nohighlight">\(k_2\)</span> to be estimated. We know that <span class="math notranslate nohighlight">\(R_R = k_2S_0/k_1\)</span> has to be greater than 1 and if all the boys are susceptible except one,then <span class="math notranslate nohighlight">\(k_2 \times 762 \times 2.5 \gt 1\)</span> which makes <span class="math notranslate nohighlight">\(k_2 \gt 5 \cdot 10^{-4}\)</span>; the maximum value of <span class="math notranslate nohighlight">\(R_R\)</span>,is approximately 20 for common infections, making <span class="math notranslate nohighlight">\(k_2 \lt 0.01\)</span> and this should give a range of rate constants to start the calculation.</p>
<p>Only two quantities need to be calculated; the third, <span class="math notranslate nohighlight">\(R\)</span>, is evaluated via <span class="math notranslate nohighlight">\(I + S + R = N\)</span>. The Euler method code to integrate the differential equations is outlined in Algorithm 14 or 15. Note, that in the calculation, instead of using I we use In. The calculation is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm: SIR model of disease</span>

<span class="k">def</span> <span class="nf">EulerSIRint</span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="n">In0</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxt</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="n">num</span>
    <span class="n">EulerS</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Np</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">EulerIn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Np</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dtime</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Np</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="n">EulerS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="n">S0</span>
    <span class="n">EulerIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">In0</span>
    <span class="n">dtime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="o">=</span> <span class="n">t0</span>
    <span class="n">S</span>  <span class="o">=</span> <span class="n">S0</span>
    <span class="n">In</span> <span class="o">=</span> <span class="n">In0</span>
    <span class="n">t</span>  <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Np</span><span class="p">):</span>
        
        <span class="n">S</span> <span class="o">=</span> <span class="n">S</span>  <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">dSdt</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">In</span><span class="p">)</span>
        <span class="n">In</span><span class="o">=</span> <span class="n">In</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">dIndt</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">In</span><span class="p">)</span>
        
        <span class="n">EulerS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">S</span>
        <span class="n">EulerIn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">In</span>
        <span class="n">dtime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="n">t</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">h</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">dtime</span><span class="p">,</span> <span class="n">EulerS</span><span class="p">,</span> <span class="n">EulerIn</span>

<span class="n">k2</span>  <span class="o">=</span> <span class="mf">0.00218</span>        <span class="c1"># initial k&#39;s</span>
<span class="n">k1</span>  <span class="o">=</span> <span class="mf">0.452</span>
<span class="n">num</span> <span class="o">=</span> <span class="mi">763</span>            <span class="c1"># number of individuals </span>

<span class="n">dSdt</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">S</span><span class="p">,</span> <span class="n">In</span> <span class="p">:</span> <span class="o">-</span><span class="n">k2</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">In</span>          <span class="c1"># eqns 41</span>
<span class="n">dIndt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">S</span><span class="p">,</span> <span class="n">In</span> <span class="p">:</span>  <span class="n">k2</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">In</span><span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="n">In</span>
<span class="n">t0</span>    <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">maxt</span>  <span class="o">=</span> <span class="mi">25</span>

<span class="n">S0</span>  <span class="o">=</span> <span class="n">num</span><span class="o">-</span><span class="mi">1</span>
<span class="n">In0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">R0</span>  <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Np</span>  <span class="o">=</span> <span class="mi">1000</span>      <span class="c1"># number of points for integration</span>


<span class="n">dtime</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">In</span> <span class="o">=</span> <span class="n">EulerSIRint</span><span class="p">(</span><span class="n">S0</span><span class="p">,</span><span class="n">In0</span><span class="p">,</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span>
<span class="c1">#plt.plot(dtime, S)                          # remove first # to plot</span>
<span class="c1">#plt.plot(dtime, In)</span>
<span class="c1">#plt.show()</span>
</pre></div>
</div>
</div>
</div>
<p>The result of numerical integration is shown in Fig. 17, with <span class="math notranslate nohighlight">\(k_2 = 0.0022\)</span>, day<span class="math notranslate nohighlight">\(^{-1}\)</span>, and <span class="math notranslate nohighlight">\(k_1 = 0.451\)</span> day<span class="math notranslate nohighlight">\(^{-1}\)</span>; the data were fitted as outlined in 18. The number of susceptible individuals initially changes slowly because the product SI in the first rate equation 41 is small, <span class="math notranslate nohighlight">\(I\)</span> being small. As <span class="math notranslate nohighlight">\(I\)</span> increases, <span class="math notranslate nohighlight">\(S\)</span> also decreases, but, their product is larger (<span class="math notranslate nohighlight">\(1 \times 763\)</span> is smaller than <span class="math notranslate nohighlight">\(2 \times 762\)</span> and so forth) and therefore the population of <span class="math notranslate nohighlight">\(S\)</span> starts to decrease rapidly as that of <span class="math notranslate nohighlight">\(I\)</span> increases; see the first of equations 41. The population of <span class="math notranslate nohighlight">\(I\)</span> goes through a maximum because in the second equation, the term <span class="math notranslate nohighlight">\(k_2I\)</span> eventually starts to dominate and removes <span class="math notranslate nohighlight">\(I\)</span>.</p>
<p>The maximum number infected at any time is calculated with equation 43; substituting in the numbers gives 286 boys infected, which is seen on the graph where it peaks between days <span class="math notranslate nohighlight">\(6\)</span> and <span class="math notranslate nohighlight">\(7\)</span>. The number remaining susceptible is not zero at the end of the calculation indicating that not all the boys became infected even though they were all susceptible. The total number of boys who were not infected, using the approximation in equation 45 is 19, making <span class="math notranslate nohighlight">\(744\)</span> who contracted the disease. The numerical calculation indicates that <span class="math notranslate nohighlight">\(24\)</span> boys were not infected, showing that the approximation, equation 45, is quite good.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig17.png" /></p>
<p>Figure 17. SIR data calculated for boys infected with influenza with <span class="math notranslate nohighlight">\(k_2 = 0.0022\)</span>, day<span class="math notranslate nohighlight">\(^{-1}\)</span> and <span class="math notranslate nohighlight">\(k_1 = 0.451\)</span> day<span class="math notranslate nohighlight">\(^{-1}\)</span> with <span class="math notranslate nohighlight">\(763\)</span> boys one of whom was initially infected. The scheme is <span class="math notranslate nohighlight">\(\displaystyle  S+I \overset{k_2}\longrightarrow 2I ; \;   I \overset{k_1} \longrightarrow  R  \)</span>.</p>
<hr class="docutils" />
<p>After 2019 there is no shortage of data from covid-19 to illustrate the SIR type of epidemic, however, the real data only partly follows this scheme because of medical intervention, i.e. learning how best to deal with very ill patients means that the rate constants vary with time which complicates the calculation, as do the use of face masks and of course the availability, or otherwise, of vaccinations.</p>
</section>
<section id="bacterial-populations-calculated-via-chemical-kinetics">
<h2>7.7 Bacterial populations calculated via Chemical Kinetics<a class="headerlink" href="#bacterial-populations-calculated-via-chemical-kinetics" title="Permalink to this headline">#</a></h2>
<p>Foods provide an environment for microbes to survive and multiply because they are rich in nutrients. While some microbes are harmless others such as yeasts and molds spoil foods. Bacteria, such as the pathogens <em>staphylococcus aureus</em> and <em>E. coli</em>, also produce enterotoxins (protein toxins) which target the gastrointestinal tract and cause diarrhea and food poisoning.</p>
<p>The life cycle of bacteria has four stages,</p>
<p>(1) the lag (induction) phase when populations are small,</p>
<p>(2) exponential growth,</p>
<p>(3) a maximum population during the stationary phase, and</p>
<p>(4) death when the population declines.</p>
<p>and the population therefore rises rapidly then decreases slowly not unlike the infected population in fig 17 above. The bacterial population is often inferred from the optical density of a sample calibrated against known standards.</p>
<p>Bacteria multiply by dividing so that a naive model of their increase in number follows the series <span class="math notranslate nohighlight">\(1, 2, 4, 8, \cdots 2^n\)</span> which would naturally lead to an infinite population. The Malthusian idea is that growth occurs exponentially,</p>
<div class="math notranslate nohighlight">
\[M=M_0e^{kt},\qquad \text{Malthusian}\]</div>
<p>with rate constant, <span class="math notranslate nohighlight">\(k\)</span> which is the difference between birth and death rate constants. This model is a good description when the population is relatively small but still predicts an infinite population eventually. The Gompertz model (a variation on the Logistic equation) has been used as a way of predicting a bacterial population, this equation has the basic form</p>
<div class="math notranslate nohighlight">
\[\displaystyle \ln\left(\frac{M}{M_0}\right) = -e^{-kt},\qquad\text{Gompertz}\]</div>
<p>and a plot of <span class="math notranslate nohighlight">\(M\)</span> vs. <span class="math notranslate nohighlight">\(t\)</span> looks like a sigmoidal curve becoming constant at long times. This equation, while an improvement, only approximately fits the data because microbial populations can and will eventually die out.</p>
<p>Using a chemical kinetics based model of growth and death provides a rationale for describing bacterial populations. The bacterial are treated as if they were molecules that can be described by rate equations. The model used by Taub et al. (J. Food. Sci. p2350, v68, 2003) allows bacteria to grow by division and die away naturally as well as by reaction with an antagonistic molecule produced by the bacteria itself.  This latter species is an essential feature of the model.  We let bacteria, labelled M, divide into two others which are labelled A to distinguish them and additionally an antagonist X is produced. The fact that <span class="math notranslate nohighlight">\(A\to 2A\)</span> provides positive feedback, or autocatalysis, so that the amount of A increases very rapidly. The species X interacts with bacteria A and cause them to die, forming species D. The bacteria also die naturally. The scheme is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align} &amp; M \overset{k_1}\longrightarrow A\\ &amp;
A \overset{k_2}\longrightarrow 2A+X\\&amp;
A+X \overset{k_3}\longrightarrow D\\&amp;
A \overset{k_4}\longrightarrow D\\&amp;
M \overset{k_5}\longrightarrow D
 \end{align}\end{split}\]</div>
<p>The first reaction is the lag phase, the second exponential growth and the and the third causes a limit to the populations and starts the death phase. The rate equations are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align} \frac{dM}{dt} &amp;= -(k_1+k_5)M \\
\frac{dA}{dt} &amp;= +k_1M +k_2A -(k_3X +k_4)A\\  
\frac{dX}{dt} &amp;= k_2A -k_3XA\end{align}\end{split}\]</div>
<p>and the initial conditions are at time zero M is present as <span class="math notranslate nohighlight">\(M_0\)</span> bacteria, and <span class="math notranslate nohighlight">\(A = X = 0\)</span>. Before calculating the populations quite a lot can be understood by examining these equations and to do this we shall insist that the bacteria are growing normally, i.e. the maximum population is orders of magnitude greater than the initial population. From the equations we can infer that,</p>
<p>(i) Species M decays exponentially with rate constant <span class="math notranslate nohighlight">\(k_1+k_5\)</span>.</p>
<p>(ii) Maximum X happens when <span class="math notranslate nohighlight">\(X\)</span> reaches steady-state, <span class="math notranslate nohighlight">\(dX/dt = 0\)</span> and when integrated produces a constant. The maximum possible value is <span class="math notranslate nohighlight">\(X_{max}=k_2/k_3\)</span> and this ratio has to be much greater than <span class="math notranslate nohighlight">\(1\)</span> as the bacterial population is growing.</p>
<p>(iii) When species X is small and <span class="math notranslate nohighlight">\(k_1M\)</span> is also small, species A increases exponentially with a rate constant <span class="math notranslate nohighlight">\(k_2-k_4\)</span> assuming that <span class="math notranslate nohighlight">\(k_2 \gt k_4\)</span>.</p>
<p>(iv) At long times after the maximum bacterial population is passed the bacteria decay exponentially with rate constant <span class="math notranslate nohighlight">\(k_4\)</span>. At these times <span class="math notranslate nohighlight">\(k_1M\)</span> is very small vs. population of A, <span class="math notranslate nohighlight">\(k_2-k_3X \sim 0\)</span> (see (iii) above), thus <span class="math notranslate nohighlight">\(dA/dt \sim -k_4 A\)</span> which integrates to an exponential decay.</p>
<p>(v) The rate constant <span class="math notranslate nohighlight">\(k_3\)</span> has to be small compared to the others. Since <span class="math notranslate nohighlight">\(k_3XA\)</span> is the product of two potentially large numbers A and X then <span class="math notranslate nohighlight">\(k_3\)</span> has to be very small to be comparable to other rate constants. If <span class="math notranslate nohighlight">\(10^8\)</span> bacteria are to be produced then <span class="math notranslate nohighlight">\(1/k_3 \sim 10^8\)</span></p>
<p>The Euler method can be used to integrate the rate equations and using <span class="math notranslate nohighlight">\(1000\)</span> time steps is plenty. The code for the SIR model above can be changed to do this calculation. The time-scale needed from experience of food going bad is only a few days, thus we guess rate constants in terms of time units in days to illustrate the behaviour of the population. Some initial numbers are tried just to get going, even if fitting to a data set using a non-linear least squares method. The graph below shows the populations of M, A and X on a linear and log scale vs. time. The initial population <span class="math notranslate nohighlight">\(M_0 = 10000\)</span>, the rate constants are <span class="math notranslate nohighlight">\(k_1 = 1,  k_2 = 4, k_3 = 1\cdot 10^{-8}, k_4 = 0.5,  k_5 = 0.01\)</span>. You can see that with this set of rate constants that the lag phase is <span class="math notranslate nohighlight">\(\approx 3\)</span> days, (fig 17a left), the exponential rise is very rapid about a day, and large <span class="math notranslate nohighlight">\(\sim 10^4\)</span> times increase, the stationary phase short, <span class="math notranslate nohighlight">\(\approx 1\)</span> day and the death phase long, several days. This model therefore shows all the features of the growth and death of a bacterial population.</p>
<p>The fall in the population after reaching a maximum is due to <span class="math notranslate nohighlight">\(k_4A\)</span> becoming greater than <span class="math notranslate nohighlight">\(k_2-k_3X\)</span>. As species A decreases the reaction <span class="math notranslate nohighlight">\(A+X\to D\)</span> is slowed but X is still being formed from <span class="math notranslate nohighlight">\(A\to 2A+X\)</span>, so this is slowed also as A decreases under the influence of <span class="math notranslate nohighlight">\(k_4\)</span>. The result is that X becomes constant at long times since the amount formed during the exponential growth phase remains because it is no longer being formed or removed at any appreciable rate as can be seen in fig 17a.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig17a.png" /></p>
<p>Figure 17a. Calculated profile of a bacterial population. The rate constants used were <span class="math notranslate nohighlight">\(k_1 = 1,  k_2 = 4, k_3 = 15\cdot10^{-8}, k_4 = 0.5,  k_5 = 0.01\)</span>. The equations show the limiting equations as described in the text applicable when <span class="math notranslate nohighlight">\(k_2\gt k_4\)</span>. In the left hand figure M is multiplied by <span class="math notranslate nohighlight">\(10^4\)</span> so that it can be seen on the same plot as A and X.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="num-methods-Q13-16.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 13 - 16</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="num-methods-Q17-20.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 17 - 20</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2024.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>