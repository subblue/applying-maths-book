
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1 Numerical Methods &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 1 - 7" href="num-methods-Q1-7.html" />
    <link rel="prev" title="11. Numerical Methods" href="num-methods-intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1 Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     1 Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     5 Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     1 Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivreâ€™s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     1 - 3.8 Differentiation, gradients &amp; basic functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     3.9 Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     4 Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     6 Limits, lâ€™Hopitalâ€™s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     9 Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     10 Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     11 Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     12 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4 Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     1 Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     3 Integration by substitution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     6 Integration and parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     8 Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     9 The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     10 Multiple integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     12 Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     1 Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     6 Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     8 Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     9 Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     1 Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     6 Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     8 Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     12 Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     15 Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     18 Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     21 Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     1 Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     4 Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     6 Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     7 Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     9 Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     11 Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     12 Solving equations using matrices. Eigenvectors and Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     13 Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     14 Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     15 Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     16 Principal axes and Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     1 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     4 Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     5 Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     1 Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     5 Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     7 Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     11 The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     12 The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     14 Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     1 Basics, Initial and Boundary Value problems, Steady state, Phase portrait, Chemical kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     9 First order eqnâ€™s &amp; Integrating factors. Second order eqnâ€™s, Newtonâ€™s laws, equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     12 The â€˜Dâ€™ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     13 Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     14 Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     15 Partial Differential Equations, PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     16 PDE continued. Diffusion, wave eqn., Schroedinger eqn., Fourier method, Transient grating.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     1 Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-B.html">
     4 Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-C.html">
     5 Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-D.html">
     6 The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-E.html">
     8 Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-F.html">
     9 Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     1 Monte - Carlo integration &amp; importance sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     2 Solving rate equations. The Gillespie method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     3 Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     4 Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     6 The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     1 Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     6 Modelling data. Least squares, chi squared, residuals, ANNOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     7 Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     10 Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-14/chapter14-intro.html">
   14 SI Units, Scientific Constants, unit conversion, Glossary, Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/chapter14-E.html">
     1 SI Units, Unit conversions, Scientific Constants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/Python%20crib.html">
     5 Appendix:  Some basic Python instructions with a few examples.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../references/references-intro.html">
   15 References and index
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/References.html">
     1 References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/index.html">
     2 Index
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-11/num-methods-A.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-11/num-methods-A.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-11/num-methods-A.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-11/num-methods-A.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rounding-errors">
   1.1 Rounding errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#truncation-errors">
   1.2 Truncation errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unstable-recursion-magnification-of-errors">
   1.3 Unstable recursion: magnification of errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#organized-chaos">
   1.4 Organized Chaos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerical-methods-used-to-find-the-roots-of-an-equation">
   2 Numerical methods used to find the roots of an equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#secant-method">
   2.1 Secant method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerical-integration">
   3 Numerical integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#always-try-some-algebra-first">
   3.1 Always try some algebra first
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mid-point-rule-integration">
   3.2 Mid-point rule integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trapezoidal-rule-integration">
   3.3 Trapezoidal rule integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simpson-s-rule-integration">
   3.4 Simpsonâ€™s rule integration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-concentration-of-ion-pairs">
     <strong>
      Example. Concentration of ion pairs
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integrating-data-from-an-experiment">
   3.5 Integrating data from an experiment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-and-molecular-beam-scattering">
   3.6 Atomic and molecular beam scattering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background-and-derivation-of-formulae">
   3.7 Background and derivation of formulae
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scattering">
   3.8 Scattering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-coulomb-potential">
   3.9 The  Coulomb potential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-lennard-jones-potential">
   3.10 The Lennard-Jones potential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis-of-results">
   3.11 Analysis of results
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>1 Numerical Methods</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rounding-errors">
   1.1 Rounding errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#truncation-errors">
   1.2 Truncation errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unstable-recursion-magnification-of-errors">
   1.3 Unstable recursion: magnification of errors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#organized-chaos">
   1.4 Organized Chaos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerical-methods-used-to-find-the-roots-of-an-equation">
   2 Numerical methods used to find the roots of an equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#secant-method">
   2.1 Secant method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numerical-integration">
   3 Numerical integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#always-try-some-algebra-first">
   3.1 Always try some algebra first
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mid-point-rule-integration">
   3.2 Mid-point rule integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trapezoidal-rule-integration">
   3.3 Trapezoidal rule integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simpson-s-rule-integration">
   3.4 Simpsonâ€™s rule integration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-concentration-of-ion-pairs">
     <strong>
      Example. Concentration of ion pairs
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integrating-data-from-an-experiment">
   3.5 Integrating data from an experiment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atomic-and-molecular-beam-scattering">
   3.6 Atomic and molecular beam scattering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background-and-derivation-of-formulae">
   3.7 Background and derivation of formulae
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scattering">
   3.8 Scattering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-coulomb-potential">
   3.9 The  Coulomb potential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-lennard-jones-potential">
   3.10 The Lennard-Jones potential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis-of-results">
   3.11 Analysis of results
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="numerical-methods">
<h1>1 Numerical Methods<a class="headerlink" href="#numerical-methods" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span><span class="p">,</span><span class="n">odeint</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="n">init_printing</span><span class="p">()</span>                      <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<p>To start this chapter, some details on numerical accuracy are reviewed; next simple integration methods are described with a few examples and problems. More difficult, and interesting, is the numerical integration of differential equations, some of which only have numerical solutions. The various methods used are explained. A different numerical approach is taken in the next chapter on Monte Carlo methods. Simple integration is rather slow by this method but integrating differential equations is very robust. Monte Carlo methods are very versatile at simulating physical processes, such as diffusion or fluorescence, and occasionally this is the only way to do the calculation. Simulation also provides a good way to understand the processes involved, some of which can be very complex and not always easily translated into differential equations.</p>
<section id="rounding-errors">
<h2>1.1 Rounding errors<a class="headerlink" href="#rounding-errors" title="Permalink to this headline">#</a></h2>
<p>In many calculations, the errors introduced by the computer due to the way its integers and real numbers are manipulated do not matter. Sometimes, the answer the computer returns may be precise and will be printed to many decimal places; however, it may not be accurate. To understand this, the expression <span class="math notranslate nohighlight">\((1 - x)^6\)</span> is expanded as the series <span class="math notranslate nohighlight">\(1-6x+15x^2 -20x^3 +15x4 -6x^5 +x^6\)</span> and this is plotted close to its minimum at <span class="math notranslate nohighlight">\(x\approx 1\)</span> in Fig.1. While the scale is small, <span class="math notranslate nohighlight">\(\approx 10^{-13}\)</span>, determining the exact root of the equation numerically is difficult. Of course, we know it is at <span class="math notranslate nohighlight">\(1\)</span>, but the computer will not give this answer even using a Newton-Raphson iterative scheme. The reason for the noisy plot is because the alternating positive and negative terms in the summation add up to almost zero, and the rounding error in the precision with which the numbers are calculated becomes important, and this limits the accuracy of the calculation.</p>
<p>A real number is converted in the computer into a floating-point number represented as <span class="math notranslate nohighlight">\(x = \pm 0.d_1d_2d_3d_4 \cdot 10^y\)</span> which only approximately represents the number; i.e. it is only accurate to a certain number of decimal places. The mantissa, is the fraction <span class="math notranslate nohighlight">\(0.d_1d_2d_3d_4\)</span>, where <span class="math notranslate nohighlight">\(d_1\)</span> etc. are the digits <span class="math notranslate nohighlight">\(0\cdots 9\)</span>. A floating-point number is usually described as a single or double precision and the number of decimal places is typically <span class="math notranslate nohighlight">\(7\)</span> and <span class="math notranslate nohighlight">\(14\)</span> respectively; this depends on the type of computer being used. Normally nowadays double precision is standard for example <span class="math notranslate nohighlight">\(17\)</span> digits.</p>
<p>However, as seen in Fig. 1, 17 digits are not good enough to find the root; <span class="math notranslate nohighlight">\(25\)</span> decimal places give a far more accurate result. The instruction Digits:= 25, sets <span class="math notranslate nohighlight">\(25\)</span> decimal place precision for floating point numbers.
Using the Newton-Raphson method (see Chapter 3.10), the root cannot be found accurately: the method is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">6.0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">20.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">15.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mf">6.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">6</span>
<span class="n">df</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.0</span> <span class="o">+</span> <span class="mf">30.0</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">60.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">60.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">30.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">6.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span>      <span class="c1"># derivative</span>
<span class="n">s</span>  <span class="o">=</span> <span class="mf">0.8</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">snew</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">snew</span><span class="o">-</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">snew</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0030182818841857
</pre></div>
</div>
</div>
</div>
<p>With typical double precision (<span class="math notranslate nohighlight">\(16\)</span> decimal places), the root found is <span class="math notranslate nohighlight">\(1.0030182818841857\)</span>, which is not even on the graph shown below, but furthermore it depends greatly on the starting value. If the function <span class="math notranslate nohighlight">\((1 - x)^6\)</span> is plotted directly without expanding, and hence without accumulating rounding errors, then the curve looks like that obtained with <span class="math notranslate nohighlight">\(25\)</span> digits precision. This illustrates the important point that in many cases a small amount of algebra can significantly improve numerical calculations; errors rapidly accumulate with the repeated adding and subtracting of similarly sized numbers, and once an error is present it contaminates all subsequent results.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig1.png" /></p>
<p>Figure 1. Plots of the series expansion of <span class="math notranslate nohighlight">\((1 - x)^6\)</span> with two different values of floating point precision. (Notice the axes range.)</p>
</section>
<hr class="docutils" />
<section id="truncation-errors">
<h2>1.2 Truncation errors<a class="headerlink" href="#truncation-errors" title="Permalink to this headline">#</a></h2>
<p>In summing a series, the number of terms to be added has to be decided in advance. This automatically leads to an error that is nothing to do with arithmetical precision. The calculation should be repeated with more terms until the number of decimal places you require is continuously obtained. Rounding errors must additionally be considered, especially if the series contains alternating positive and negative terms; the errors can accumulate as the summation continues but will not be the same for all values of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Consider the series <span class="math notranslate nohighlight">\( \displaystyle \sin(x)=1-\frac{x^3}{3!}+\frac{x^5}{5!}-\cdots\)</span> which is valid for all <span class="math notranslate nohighlight">\(x\)</span>. If the series is summed up to the term <span class="math notranslate nohighlight">\(x^n/n!\)</span> with <span class="math notranslate nohighlight">\(x \gt 0\)</span>, the error is less than <span class="math notranslate nohighlight">\(\displaystyle \left| \frac{x^{n+2}}{(n+2)!}\right|\)</span>. The values of <span class="math notranslate nohighlight">\(\sin(0.5)\)</span> is <span class="math notranslate nohighlight">\(0.47942553\)</span> whether calculated directly using Python or as the summation up to the <span class="math notranslate nohighlight">\(x^7\)</span> term. If, however, <span class="math notranslate nohighlight">\(x\)</span> is large, for instance <span class="math notranslate nohighlight">\(x = 5.5\pi\)</span>, then we know by drawing a graph that  <span class="math notranslate nohighlight">\(\sin(x) = -1\)</span>, but by summation up to <span class="math notranslate nohighlight">\(x^7\)</span> the result is <span class="math notranslate nohighlight">\(-79258.34\)</span>: clearly this is ridiculous because <span class="math notranslate nohighlight">\(\sin(x) \le 1 \)</span> for all <span class="math notranslate nohighlight">\(x\)</span>. Only if the number of terms in the summation is increased to at least terms <span class="math notranslate nohighlight">\(\gt x^{59}\)</span>, and the numerical precision increased to <span class="math notranslate nohighlight">\(20\)</span> decimal places can an accurate result be obtained from the series approach. In this instance, we know that the answer from the small summation is incorrect because the properties of <span class="math notranslate nohighlight">\(\sin(x)\)</span> are well known, but if you are summing a series whose result is unknown, then great care is necessary.</p>
</section>
<section id="unstable-recursion-magnification-of-errors">
<h2>1.3 Unstable recursion: magnification of errors<a class="headerlink" href="#unstable-recursion-magnification-of-errors" title="Permalink to this headline">#</a></h2>
<p>In solving integrals, a recursion formula can often be found, particularly when the integration is done by parts. An example met before (Q4.22) is</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_n=\int_0^1 x^ne^{x-1}dx = x^ne^{x-1} \bigg|_0^1 -n\int_0^1 x^{n-1}e^{x-1} dx =1 - nI_{n-1}\]</div>
<p>To evaluate the integral with the code below different <span class="math notranslate nohighlight">\(n\)</span>, the starting value with <span class="math notranslate nohighlight">\(n = 0\)</span> is required, which is <span class="math notranslate nohighlight">\(I_0 = 1 - 1/e\)</span>. In the recursion calculation, <span class="math notranslate nohighlight">\(s\)</span> has, arbitrarily, been chosen as the name for the integral because <span class="math notranslate nohighlight">\(I\)</span> and <span class="math notranslate nohighlight">\(int\)</span> are reserved names in Sympy. Recall that <span class="math notranslate nohighlight">\(\mathtt{s= 1 - n* s}\)</span>; is an assignment, meaning that the new value of <span class="math notranslate nohighlight">\(s\)</span> is <span class="math notranslate nohighlight">\(1 - n \times (current\; value)\)</span>. Some of the results are tabulated below the code, <span class="math notranslate nohighlight">\(n\)</span> is the power to which <span class="math notranslate nohighlight">\(x\)</span> is raised, <span class="math notranslate nohighlight">\(s\)</span> is the recursion answer and <span class="math notranslate nohighlight">\(f\)</span> the result of algebraic integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, n&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>          <span class="c1"># use SymPy</span>

<span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>                    <span class="c1"># initial value</span>
<span class="n">ans_s</span> <span class="o">=</span> <span class="p">[]</span>                                   <span class="c1"># arrays to hold results</span>
<span class="n">ans_f</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">23</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">n</span><span class="o">*</span><span class="n">s</span>                            <span class="c1"># recursion</span>
    <span class="n">ans_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>                          <span class="c1"># save values</span>
    <span class="n">eqn</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">eqn</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">)</span>          <span class="c1"># normal algebraic integration</span>
    <span class="n">ans_f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">evalf</span><span class="p">())</span>                  <span class="c1"># save result</span>
    <span class="k">pass</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;n      s      f(n)&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ans_s</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">ans_s</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">ans_f</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">])</span>  <span class="p">)</span>    <span class="c1"># format output</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n      s      f(n)
1 0.3678794 0.3678794
2 0.2642411 0.2642411
3 0.2072766 0.2072766
4 0.1708934 0.1708934
5 0.1455329 0.1455329
6 0.1268023 0.1268023
7 0.1123835 0.1123835
8 0.1009319 0.1009319
9 0.0916122 0.0916122
10 0.0838770 0.0838770
11 0.0773522 0.0773522
12 0.0717732 0.0717732
13 0.0669477 0.0669479
14 0.0627310 0.0627326
15 0.0590337 0.0590209
16 0.0554593 0.0556640
17 0.0571918 0.0625000
18 -0.029453 0
19 1.5596197 -16.00000
20 -30.19239 0
21 635.04029 16384.000
22 -13969.88 0
</pre></div>
</div>
</div>
</div>
<p>The failure of both the Sympy integration and the recursion formula indicates how careful one needs to be with some apparently innocent numerical calculations. After about <span class="math notranslate nohighlight">\(n = 12\)</span> it is difficult to judge which calculation gives the most accurate result, and by <span class="math notranslate nohighlight">\(n = 18\)</span>, both are clearly wrong. If integer constants  are used then accurate results are obtained for the direct integration, but using integers will not always be an option.</p>
<p>While this calculation is a little unusual, it is not uncommon. When calculating wavefunctions using Hermite or other polynomials, large powers of <span class="math notranslate nohighlight">\(x\)</span>, exponentials and recursion formulae are commonly used. Recursion and difference formulae are often used in the numerical integration of differential equations, see Section 11.3, consequently, their numerical integration is akin to an art rather than a science. However, you should not be too despondent or sceptical about numerical methods because with care, and sometimes cunning, accurate results can be obtained.</p>
</section>
<section id="organized-chaos">
<h2>1.4 Organized Chaos<a class="headerlink" href="#organized-chaos" title="Permalink to this headline">#</a></h2>
<p>You need to be aware that recursion can sometimes lead to chaotic behaviour as a normal outcome of a calculation. This is a different sort of chaos to that just calculated; it is very much like â€˜organized chaosâ€™ and is not due to rounding or precision errors. Often this chaos is termed â€˜deterministicâ€™.</p>
<p>There is an important distinction therefore to be made between different types of â€˜Chaosâ€™. In classical and quantum mechanics, in studying molecules for example, it is also observed that regular motion can suddenly become chaotic even though the underlying equations of motion do not indicate that this will necessarily happen. By â€˜chaoticâ€™ is meant that two starting conditions placed arbitrary close to one another in value, will lead to entirely different but <em>repeatable outcomes</em> at some later time. If the cause of the chaos is due to rounding errors, the outcome is not repeatable but unpredictable.</p>
<p>We take a short diversion into this interesting topic via a well-known example of deterministic chaos, first described in detail by May (1974, 1987) and May &amp; Oster (1976), and called the <em>logistic map</em>. This arises from the recursive equation</p>
<div class="math notranslate nohighlight">
\[x_{n+1} = r\,x_n(1 - x_n)\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is a constant and this equation is the discrete version of the logistic equation (Verhulst 1838) used to describe population growth,</p>
<div class="math notranslate nohighlight">
\[\displaystyle dN/dt=r\,N(1-k/N)\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the population <span class="math notranslate nohighlight">\(r\)</span> the growth rate and <span class="math notranslate nohighlight">\(k\)</span> a constant the carrying capacity. This equation works well only for some species such as bacteria but not for other more complex ones. The reaction <span class="math notranslate nohighlight">\(A+X\leftrightharpoons 2X,\quad X+B\to C\)</span> has the related rate equation</p>
<div class="math notranslate nohighlight">
\[dX/dt=-(k_1A+k_2B)X+4k_2X^2\]</div>
<p>if <span class="math notranslate nohighlight">\([A],[B]\)</span> are held constant.</p>
<p>Returning to the logistic map, if <span class="math notranslate nohighlight">\(x_{n+1}\)</span> is plotted vs <span class="math notranslate nohighlight">\(x_n\)</span>  then it has an inverted parabola like shape, fig 1a, with a maximum at <span class="math notranslate nohighlight">\(r/4\)</span>.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig1a.png" /></p>
<p>Figure 1a. plot of the equation <span class="math notranslate nohighlight">\(x_{n+1} = r\,x_n(1 - x_n)\)</span>.</p>
<hr class="docutils" />
<p>We shall call <span class="math notranslate nohighlight">\(x\)</span> the population, <span class="math notranslate nohighlight">\(r\)</span> the growth rate and <span class="math notranslate nohighlight">\(n\)</span> number of iterations which could also be interpreted at discrete units of time. When the growth rate <span class="math notranslate nohighlight">\(r\lt 1\)</span> the population decreases from its initial value <span class="math notranslate nohighlight">\(x_0\)</span> to zero. Only above <span class="math notranslate nohighlight">\(r\ge 1\)</span> does the population increase. As it does it rises rapidly, then oscillates before reaching a steady value.  However, at a value of <span class="math notranslate nohighlight">\(r\ge 3\)</span> bifurcation occurs, i.e. the oscillations persist indefinitely, and two values are alternately produced. As <span class="math notranslate nohighlight">\(r\)</span> increases a little more, two periods are seen and four values exist, and these double again as <span class="math notranslate nohighlight">\(r\)</span> continues to increase until eventually chaos ensues at about <span class="math notranslate nohighlight">\(r = 3.9\)</span>. Above <span class="math notranslate nohighlight">\( r = 4 \)</span>, <span class="math notranslate nohighlight">\(x_n\)</span> becomes negative, thus the valid range is <span class="math notranslate nohighlight">\( 0\lt r \le 4\)</span>. Figure 1b shows this behaviour with an initial value of <span class="math notranslate nohighlight">\(x_0 = 0.1\)</span>.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig1b.png" /></p>
<p>Figure 1b. The population <span class="math notranslate nohighlight">\(x_n\)</span> shown vs. iteration number <span class="math notranslate nohighlight">\(n\)</span> for different growth rates <span class="math notranslate nohighlight">\(r\)</span>. Notice that bifurcation occurs above <span class="math notranslate nohighlight">\(r=3\)</span> and that chaotic behaviour at <span class="math notranslate nohighlight">\(r=3.9\)</span>. The data points are in red, the line simply aids the eye to help follow the pattern of the points.</p>
<hr class="docutils" />
<p>To be able to view the bifurcations more easily a plot of population <span class="math notranslate nohighlight">\(x_n\)</span> vs <span class="math notranslate nohighlight">\(r\)</span> is made and apparently random behaviour from otherwise regular behaviour is observed, Fig. 2. Some authors call this an orbit plot. The iteration is continued at each <span class="math notranslate nohighlight">\(r\)</span> for at least a hundred steps to allow and initial oscillations to die out and become constant or to allow any constant oscillation to become steady or random depending on <span class="math notranslate nohighlight">\(r\)</span>. As <span class="math notranslate nohighlight">\(r\)</span> increases the doubling multiplies to <span class="math notranslate nohighlight">\(4, 8, 16\cdots \)</span> and more numerous sets of numbers produce a random looking but regular pattern.   Figure 2 shows part of the plot.   The values up to <span class="math notranslate nohighlight">\(r=1\)</span> are zero then they rise uniformly in a single curved line to join the plot shown. The initial pitchfork bifurcation at <span class="math notranslate nohighlight">\(r=3\)</span> is clear as are the next few bifurcations (at each of which the number of points double) at <span class="math notranslate nohighlight">\(r\approx 3.449, 3.5409, 3.5644\cdots \)</span> but then become too numerous to see on this plot. Pain (1993, chapter 12) and Strogatz 1994 chapter 10) both describe these non-linear and chaotic effects that have been observed experimentally as well as a detailed mathematical description of this topic.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig2.png" /></p>
<p>Figure 2. Bifurcations and ordered chaos generated by iterating <span class="math notranslate nohighlight">\(x_{n+1} = r\,x_n(1 - x_n)\)</span>.</p>
<hr class="docutils" />
<p>The Feigenbaum constant <span class="math notranslate nohighlight">\(\delta=4.669301\cdots\)</span> is the ratio of three successive birfurcation points and is a property of all maps of this type, not just the logistic map. The constant is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \delta =\lim_{n\to \infty}\frac{\mu_{n+1}-\mu_n}{\mu_{n+2}-\mu_{n+1}}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the index of the birfucation and <span class="math notranslate nohighlight">\(\mu\)</span> the value of <span class="math notranslate nohighlight">\(r\)</span> at that point. Interestingly, any equation that shows an inverted curve, such as <span class="math notranslate nohighlight">\(x_{n+1}=r\,\sin(x_n)\)</span>, shows very similar behavior in all respects to that of the logistic map.</p>
<p>The code to do this calculation, which produces a plot such as figure 2, is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 1;  Logistic eqn. &amp; Bifurcation. This is quite  slow calculation</span>

<span class="c1">#fig1= plt.figure( figsize=(6,6) )    # remove # to plot</span>
<span class="c1">#plt.rcParams.update({&#39;font.size&#39;: 16})</span>

<span class="n">Leqn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="p">:</span> <span class="n">r</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>        <span class="c1"># logistic map eqn</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>                               <span class="c1"># increase this for more detail, e.g 200</span>
<span class="n">dn</span><span class="o">=</span> <span class="mi">100</span>                               <span class="c1"># ditto</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">dn</span>
<span class="n">popl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>    <span class="c1"># define 2D array</span>
<span class="n">popl</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="mi">2</span>                         <span class="c1"># set value outside plot range</span>
<span class="n">r0</span>  <span class="o">=</span> <span class="mf">2.5</span>                             <span class="c1"># r start</span>
<span class="n">rmax</span><span class="o">=</span> <span class="mf">4.0</span>                             <span class="c1"># r end   </span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span><span class="n">rmax</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>            <span class="c1"># growth rate array</span>

<span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>                               <span class="c1"># initial x </span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">Leqn</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>             <span class="c1"># x = r*x*(1.0 - x)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">popl</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="n">dn</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>          <span class="c1"># save last n do this to get all branches as these oscillate</span>
        <span class="k">pass</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">n</span>                     <span class="c1"># increment x</span>
    <span class="k">pass</span>

<span class="c1">#for i in range(n):                   # remove # to pot results</span>
<span class="c1">#    plt.scatter(r[:],popl[:,i],marker=&#39;.&#39;,s = 0.01,color=&#39;blue&#39;)  # plot </span>
<span class="c1">#    </span>
<span class="c1">#plt.xlim([r0,4])</span>
<span class="c1">#plt.ylim([0,1])</span>
<span class="c1">#plt.xlabel(r&#39;$r$&#39;,fontsize=20)</span>
<span class="c1">#plt.ylabel(r&#39;$p$&#39;,fontsize=20)</span>
<span class="c1">#plt.show()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="numerical-methods-used-to-find-the-roots-of-an-equation">
<h2>2 Numerical methods used to find the roots of an equation<a class="headerlink" href="#numerical-methods-used-to-find-the-roots-of-an-equation" title="Permalink to this headline">#</a></h2>
</section>
<section id="secant-method">
<h2>2.1 Secant method<a class="headerlink" href="#secant-method" title="Permalink to this headline">#</a></h2>
<p>We now set aside the questions of numerical accuracy and chaos and look at some practical methods of numerically solving all sorts of equations. Sometimes in integration or in solving differential equations, the root of some function is required; three related numerical methods, the Secant, Regula Falsi, and bisection, are now described. The Newton - Raphson method has already been met in Chapter 3.10 and is used when the equation can be differentiated.</p>
<p>The secant method is similar in idea to the Newton - Raphson method except that the derivative is expressed as a difference equation. If <span class="math notranslate nohighlight">\(f (x) = 0\)</span> is the equation whose roots or <span class="math notranslate nohighlight">\(x\)</span> values we want to find, then, in a recursive scheme, the next <span class="math notranslate nohighlight">\(x\)</span> value is given by Newton - Raphson as <span class="math notranslate nohighlight">\(x_{n+1} = x_n  f(x_n)/f'(x_n)\)</span> with <span class="math notranslate nohighlight">\(n = 0, 1, 2 \cdots\)</span> and <span class="math notranslate nohighlight">\(f'\)</span> is the derivative with respect to <span class="math notranslate nohighlight">\(x\)</span>. Notice how similar this equation is to the general form of the logistic map in the previous section, i.e <span class="math notranslate nohighlight">\(x_{n+1}=f(x_n)\)</span>.  The <span class="math notranslate nohighlight">\(x_0\)</span> value to start the calculation must be somewhere near to the root, and can be estimated by plotting the function. At the end of each step, the new value <span class="math notranslate nohighlight">\(x_{n+1}\)</span> is substituted into the right-hand side of the equation, and the process is repeated until the absolute value of the function becomes less than some preset tolerance or the number of iterations is exceeded.
In the secant method, the derivative is approximated as</p>
<div class="math notranslate nohighlight">
\[\displaystyle f'(x_n)\approx \frac{\Delta f}{\Delta x}=\frac{f(x_n)-f(x_{n-1})}{x_n-x_{n-1}}\]</div>
<p>then substituting into the Newton - Raphson equation gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle  x_{n+1} = x_n -f(x_n)\frac{x_n-x_{n-1}}{f(x_n)-f(x_{n-1})}  \qquad\tag{1}\]</div>
<p>which is the working equation for the secant method. Two initial guesses of the root are required, because the equation has to have points at <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> to begin the iterative process and these are usually to one side of the root. Once the method is close to a root, the number of digits of accuracy doubles for every two iterations. However, the method can sometimes fail because the particular curvature of the function may produce <span class="math notranslate nohighlight">\(f(x_n) = f(x_{n1})\)</span>.</p>
<p>In each of the following three algorithms the new value <span class="math notranslate nohighlight">\(x_{n+1}\)</span> is called <span class="math notranslate nohighlight">\(x_m\)</span> and is given a dummy value greater than the tolerance to start with. The root and the value of the function at the root, which should be zero or very close to it, are printed. The equation is <span class="math notranslate nohighlight">\(x^5 + x = 1\)</span>. The three methods give essentially the same result if the tolerance on ending the calculation is similar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 2; Secant method</span>

<span class="c1">#--------------------</span>
<span class="k">def</span> <span class="nf">Secant</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>
    <span class="n">xm</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-8</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">))</span>  <span class="o">&gt;</span> <span class="n">xtol</span><span class="p">:</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">xm</span>
<span class="c1">#--------------------</span>

<span class="n">f</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>      <span class="c1"># function to solve</span>
<span class="n">x1</span> <span class="o">=</span> <span class="mf">0.0</span>  
<span class="n">x2</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ans</span><span class="o">=</span> <span class="n">Secant</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:12.8f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;root = &#39;</span><span class="p">,</span> <span class="n">ans</span><span class="p">)</span>   <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>root =    0.75487767
</pre></div>
</div>
</div>
</div>
<p>If the starting points span the root, then the false position or Regula Falsi method is used. This method uses the same equation as the secant method but a slightly different algorithm is used to generate the next point. This ensures that the root is always straddled. The algorithm is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 3; Regula Falsi</span>
<span class="c1">#--------------------------------</span>
<span class="k">def</span> <span class="nf">Regula_Falsi</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>
    <span class="n">xm</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">xtol</span> <span class="o">=</span> <span class="mf">1e-8</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">))</span>  <span class="o">&gt;</span> <span class="n">xtol</span><span class="p">:</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">xm</span>
<span class="c1">#-------------------------------</span>

<span class="n">f</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">x1</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x2</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">ans</span><span class="o">=</span> <span class="n">Regula_Falsi</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:12.8f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;root = &#39;</span><span class="p">,</span> <span class="n">ans</span><span class="p">)</span>   <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>root =    0.75487766
</pre></div>
</div>
</div>
</div>
<p>The bisection method is the simplest and most robust method. The initial estimates must span the root; therefore, the function is calculated from some point until its sign is changed, if the whereabouts of the root is unknown. At this point, the bisection method is repeatedly used to divide the region into finer parts.  The while loop is also limited by the number of iterations to prevent this becoming infinite. One â€˜trickâ€™ that can sometimes be used in the secant and Regula Falsi method, should they fail, is to add a small number, <span class="math notranslate nohighlight">\(\lt 10^{-6}\)</span>, to the denominator, to prevent it accidentally becoming zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 4; Bisection Method</span>

<span class="c1">#-------------------------------</span>
<span class="k">def</span> <span class="nf">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>   
    <span class="n">xm</span>   <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">xtol</span> <span class="o">=</span> <span class="mf">1e-8</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">))</span>  <span class="o">&gt;</span> <span class="n">xtol</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">:</span>    <span class="c1"># limit loop to 40 times</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">pass</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">xm</span>
<span class="c1">#---------------------------------</span>

<span class="n">f</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">x1</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">x2</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">ans</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>    <span class="c1"># call bisect with initial values 0 and 1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">  </span><span class="si">{:12.8f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;root = &#39;</span><span class="p">,</span> <span class="n">ans</span><span class="p">)</span>   <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>root =     0.75487766
</pre></div>
</div>
</div>
</div>
</section>
<section id="numerical-integration">
<h2>3 Numerical integration<a class="headerlink" href="#numerical-integration" title="Permalink to this headline">#</a></h2>
<p>Two methods of numerical integration have been briefly described in other chapters, one is the series expansion of a function and then a numerical evaluation of the terms; the other is the Euler - Maclaurin formula Chapter 5.7 and care needs to be exercised with both these methods. Three general and simpler methods are now outlined; these are the mid-point, the trapezoid, and Simpsonâ€™s rule. More sophisticated numerical methods than these are described in Numerical Recipes (Prest et al. 1986) and similar specialized texts.</p>
<p>Each of these methods divides the function to be integrated into small strips at predetermined abscissas, which are then multiplied by a certain constant number depending on the method, and added together. The integration becomes a summation, Fig. 3, and the general name for such a numerical integration method is <em>quadrature</em>. These methods are similar to the basic way we think about integration as the limiting area of a summation of rectangular strips as the width of each strip tends to zero. If the strips are fine enough, the result is a good approximation to the true value. In general, however, we do not initially know how many strips will be needed and some experimentation with this number is always necessary.</p>
<p>It should be remembered that whatever numerical method is used, a polynomial is being integrated and not the original equation, and thus the ability of this to describe the curve will affect the results. The more sophisticated the method becomes, the higher the order of the polynomial used.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig3.png" /></p>
<p>Figure 3. The trapezoidal rule approximates an integral with straight lines between points <span class="math notranslate nohighlight">\(x_1,\, x_2,\, \cdots\)</span>, although not very well in this example, where the strips are too far apart to represent the function accurately. The mid-point method, on the other hand, evaluates the function half way between each point, three of which are shown by the vertical dotted lines.</p>
</section>
<hr class="docutils" />
<section id="always-try-some-algebra-first">
<h2>3.1 Always try some algebra first<a class="headerlink" href="#always-try-some-algebra-first" title="Permalink to this headline">#</a></h2>
<p>There is always a tendency when using numerical methods to submit the equation directly to the computer. In many cases, however, performing some algebra first will help. This might mean simplifying the equation, removing constants to outside the integration, and, in particular, substitution of variables, which is done in standard integration. Consider the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty (1+x^2)^{-1}dx\]</div>
<p>This converges very slowly and makes the upper limit very large, which results in a slow calculation and potentially inaccurate numerical result. In fact, due to rounding errors, the result will get worse as the numerical integration proceeds. Some values of <span class="math notranslate nohighlight">\(1/(1 + x^2)\)</span> are given in Table 2 and show that the maximum <span class="math notranslate nohighlight">\(x\)</span> in the integration has to be at least <span class="math notranslate nohighlight">\(100\)</span> for four-figure accuracy. This means that at least <span class="math notranslate nohighlight">\(1000\)</span> points have to be used in the integration and even possibly <span class="math notranslate nohighlight">\(10,000\)</span>.</p>
<p>What is needed is to transform the function into something less extended. The substitution <span class="math notranslate nohighlight">\(x = e^{uz} - 1\)</span> where <span class="math notranslate nohighlight">\(u\)</span> is a small constant will do this. This substitution is not immediately obvious by any means. Typically, <span class="math notranslate nohighlight">\(u = 5\)</span>, although this value is not critical. Differentiating <span class="math notranslate nohighlight">\(x = e^{uz} - 1\)</span> gives <span class="math notranslate nohighlight">\(dx = ue^{uz}dz\)</span>, but the limits are still the same; <span class="math notranslate nohighlight">\(z = 0\)</span> when <span class="math notranslate nohighlight">\(x = 0\)</span> and <span class="math notranslate nohighlight">\(z = \infty\)</span> when <span class="math notranslate nohighlight">\(x = \infty\)</span>. Making substitutions and simplifying a little makes the integral,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty \frac{u}{2e^{-uz}+e^{uz}-2}dx\]</div>
<p>The upper limit is still <span class="math notranslate nohighlight">\(\infty\)</span>, but now this is not really important. If <span class="math notranslate nohighlight">\(z = 3\)</span>, the function in the integral has the value <span class="math notranslate nohighlight">\(\approx 1.5\cdot 10^{-6}\)</span> making the whole expression virtually zero beyond this value, and so <span class="math notranslate nohighlight">\(3\)</span> is the effective upper limit; quite an improvement on infinity. Additionally, fewer points in the integration are needed for the same precision.</p>
<p>Table 2. The slow convergence over a wide range of <span class="math notranslate nohighlight">\(x\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{ccc}
x &amp; 0.01 &amp; 0.1 &amp; 1 &amp; 10 &amp; 100 \\[0.25cm]
\hline
1/(1+x^2) &amp;0.9999000&amp; 0.9900990&amp;0.5 &amp; 0.0099009&amp; 0.000099\\
\end{array}\end{split}\]</div>
</section>
<section id="mid-point-rule-integration">
<h2>3.2 Mid-point rule integration<a class="headerlink" href="#mid-point-rule-integration" title="Permalink to this headline">#</a></h2>
<p>Mid-point integration assumes that the function is split equally into <span class="math notranslate nohighlight">\(N\)</span> points, and any point is connected by a straight line to the next, thus ignoring any curvature between these points. Clearly, for a rapidly oscillating or varying function, many determinations of N will be needed to obtain an accurate answer. The mid-point method, not surprisingly, sums the values of the <em>function</em> at the mid-point of each strip, <span class="math notranslate nohighlight">\(x_1^m \; x_2^m \cdots x_N^m \)</span> as</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_m=\int_a^b f(x)dx \approx \frac{b-a}{N}\left(f(x_1^m)+f(x_2^m)+\cdots + f(x_N^m)\right)\]</div>
<p>and as</p>
<div class="math notranslate nohighlight">
\[\displaystyle x_1^m = a+h/2,\quad x_2^m = a+3h/2 \cdots x_N^m =a+(N+1)h/2\]</div>
<p>in summation notation the equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_m=\int_a^b f(x)dx\approx \sum_{j=0}^{N-1} f(a+(j+1/2)h) \qquad\tag{2}\]</div>
<p>One advantage of this rule is that it enables functions with singularities in the integration range to be calculated. For instance, <span class="math notranslate nohighlight">\(1/(1 - x)\)</span> is infinite at <span class="math notranslate nohighlight">\(x = 1\)</span>, but an integration spanning this point need not fail with the midpoint method but will do so with all other methods that calculate the function at integer increments of <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>The error in the integral calculated with the mid-point method is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \epsilon = \pm\frac{(b-a)^3f''(c)}{24N^2}\]</div>
<p>and this will be greatly reduced by increasing the number of points <span class="math notranslate nohighlight">\(N\)</span>. The size of this error is found by calculating two points <span class="math notranslate nohighlight">\(c\)</span> where the second derivative has its maximum and minimum in the range <span class="math notranslate nohighlight">\(a \le c \le b\)</span>, and choosing the largest absolute value. This can be the most difficult part of the calculation and is usually not worth the effort. It is easier to calculate the integral by doubling the number of points each time until a sufficient number of decimal places are unchanging in the result. The mid-point method is the simplest to calculate and gives accurate answers, yet it is hardly mentioned in textbooks compared to the two methods described next. Notice that, because the mid-points are used, there is one less point in the summation using the mid-point method than in the trapezoid or Simpsonâ€™s method described next.</p>
<p>The mid point method is illustrated in the next algorithm where <span class="math notranslate nohighlight">\(e^{-x^2}\)</span> is integrated from <span class="math notranslate nohighlight">\(0 \to 1\)</span>. The exact value is <span class="math notranslate nohighlight">\(0.74682\)</span> and the numerical value is <span class="math notranslate nohighlight">\(0.74690\)</span> which is close and only used <span class="math notranslate nohighlight">\(20\)</span> points in the integration, however, to obtain <span class="math notranslate nohighlight">\(5\)</span> decimal place accuracy more than <span class="math notranslate nohighlight">\(100\)</span> terms are needed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 5; mid point integration method writtten as a subroutine or def</span>
<span class="c1">#--------------------------</span>
<span class="k">def</span> <span class="nf">mid_point</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>              <span class="c1"># define routine</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>               <span class="c1"># last value is N-1, first 0</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span> <span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">h</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>
<span class="c1">#---------------------------</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>          <span class="c1"># define function</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:6.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;sum = &#39;</span><span class="p">,</span> <span class="n">mid_point</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">))</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sum =  0.74690
</pre></div>
</div>
</div>
</div>
</section>
<section id="trapezoidal-rule-integration">
<h2>3.3 Trapezoidal rule integration<a class="headerlink" href="#trapezoidal-rule-integration" title="Permalink to this headline">#</a></h2>
<p>Trapezoidal integration is also straightforward. The equation to approximate the
integral is</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_T=\int_a^b f(x)dx \approx \frac{b-a}{2N}\bigg(f(x_1)+2f(x_2)+2f(x_3)+\cdots + f(x_N)\bigg) \qquad\tag{3}\]</div>
<p>whereby the integration is again split into <span class="math notranslate nohighlight">\(N\)</span> strips, Fig. 3, and <span class="math notranslate nohighlight">\(N\)</span> must be an even number. Calculating points <span class="math notranslate nohighlight">\(x_1,\, x_2,\cdots\)</span>  is easily done because they are related to the gap between the points; <span class="math notranslate nohighlight">\(x_2 =x_1 +h,\,x_3 =x_1 +2h\)</span> ,and so forth; see Fig.3, and <span class="math notranslate nohighlight">\(h=(b-a)/N\)</span> is the width of one strip.</p>
<p>The integral can be calculated either, as in equation (3), by adding up the first and last value of <span class="math notranslate nohighlight">\(f\)</span> and twice all the rest and then multiplying by <span class="math notranslate nohighlight">\(h/2\)</span>, or by adding up all the values of <span class="math notranslate nohighlight">\(f\)</span> then subtracting half the value of the first and last points and finally multiplying the result by <span class="math notranslate nohighlight">\(h\)</span>. Usually, as with all numerical methods, the result is calculated with several increasing values of <span class="math notranslate nohighlight">\(N\)</span> to see if convergence is achieved. The error <span class="math notranslate nohighlight">\(\epsilon\)</span> indicates how many decimal places the result is accurate to and is reduced as <span class="math notranslate nohighlight">\(1/N^2\)</span>, the same as for the mid-point rule.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 6; Trapezoid rule</span>
<span class="c1">#------------------------------</span>
<span class="k">def</span> <span class="nf">Tzoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>              <span class="c1"># last value is N, first 0</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">(</span> <span class="n">a</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="n">h</span> <span class="p">)</span>
        
    <span class="n">ss</span><span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>  <span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">return</span> <span class="n">ss</span>
<span class="c1">#--------------------------------</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>     <span class="c1"># define function</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ans</span><span class="o">=</span> <span class="n">Tzoid</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:6.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;sum = &#39;</span><span class="p">,</span> <span class="n">ans</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sum =  0.74667
</pre></div>
</div>
</div>
</div>
</section>
<section id="simpson-s-rule-integration">
<h2>3.4 Simpsonâ€™s rule integration<a class="headerlink" href="#simpson-s-rule-integration" title="Permalink to this headline">#</a></h2>
<p>Simpsonâ€™s rule is slightly more sophisticated than the trapezoidal method, as it fits a
quadratic function to data points rather than straight lines; the formula is</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_S=\int_a^b f(x)dx \approx \frac{b-a}{3N}\left(f(x_1)+4\sum_{j\,=\,odd}f(x_i)+2\sum_{j\,=\,even}f(x_i) \cdots + f(x_N)\right) \qquad\tag{4}\]</div>
<p>The sum is made by adding the first and last point to four times the sum of the odd indexed points, and to twice the sum of the even numbered points. The number of data points must be an even number. The error is reduced as <span class="math notranslate nohighlight">\(1/N^4\)</span> so decreases rapidly as the number of data points increase. The method is incorporated into a procedure called a def in Python. Values are passed to this to do the calculation. A similar process could be used to make procedures of the other integration methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 7; Simpson&#39;s rule</span>

<span class="c1">#----------------------------</span>
<span class="k">def</span> <span class="nf">simp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>                      <span class="c1"># simpson&#39;s rule subroutine</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>                <span class="c1"># last value is N, first 0</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>                    
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">f</span><span class="p">(</span> <span class="n">a</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="n">h</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">f</span><span class="p">(</span> <span class="n">a</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="n">h</span> <span class="p">)</span>    <span class="c1"># odd  </span>
        <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>                          <span class="c1"># switch odd-even</span>
        <span class="k">pass</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">s</span><span class="o">/</span><span class="mf">3.0</span>
    <span class="k">return</span> <span class="n">ss</span>
<span class="c1">#----------------------------</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>             <span class="c1"># define function</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>                                 <span class="c1"># limits</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">simp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:6.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;sum = &#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sum =  0.74682
</pre></div>
</div>
</div>
</div>
<p>and as can be seen this result is much closer to the algebraic one that the other methods for the same number of points in the integration.</p>
<section id="example-concentration-of-ion-pairs">
<h3><strong>Example. Concentration of ion pairs</strong><a class="headerlink" href="#example-concentration-of-ion-pairs" title="Permalink to this headline">#</a></h3>
<p>Bjerrumâ€™s theory of ionic association in solution, the concentration of ion pairs is</p>
<div class="math notranslate nohighlight">
\[\displaystyle n_{1,2}=3n_1\left( \frac{e^2}{4\pi\epsilon_0k_BT} \right)^3\left( \frac{1}{\epsilon a_0} \right)^3\int_2^be^xx^{-4}dx\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\displaystyle a_0 = \frac{| z_1z_2 |}{2\epsilon}\frac{e^2}{4\pi\epsilon_0k_BT }\]</div>
<p>and <span class="math notranslate nohighlight">\(b = 2a_0/\sigma\)</span> is a number greater than 2. The ionic charges are <span class="math notranslate nohighlight">\(z_1,\, z_2\)</span>, the solvent dielectric constant <span class="math notranslate nohighlight">\(\epsilon\)</span>, the minimum possible separation of the ions, when pressed together, is <span class="math notranslate nohighlight">\(\sigma\)</span>. The limit <span class="math notranslate nohighlight">\(b\)</span> has, in practice, a maximum value of <span class="math notranslate nohighlight">\(\approx 50\)</span>. The integral does not have an analytical solution, other than as another integral <span class="math notranslate nohighlight">\(( Ei(x))\)</span>, and is normally tabulated. To evaluate this integral at any value of <span class="math notranslate nohighlight">\(b\)</span> we will use the Simpsonâ€™s method.</p>
<p>Before doing the calculation, the function <span class="math notranslate nohighlight">\(e^x x^{-4}\)</span> should be examined. It changes slowly with <span class="math notranslate nohighlight">\(x\)</span>, as may be seen by plotting, and has a minimum at <span class="math notranslate nohighlight">\(x = 4\)</span>, where the ions are at separation <span class="math notranslate nohighlight">\(a_0\)</span>. At larger values of <span class="math notranslate nohighlight">\(x\)</span>, the function rises rapidly as the exponential term dominates the <span class="math notranslate nohighlight">\(x^{-4}\)</span> term. The value of <span class="math notranslate nohighlight">\(a_0\)</span> for a 1-1 electrolyte is <span class="math notranslate nohighlight">\(0.350\)</span> nm in water at <span class="math notranslate nohighlight">\(25\,^\text{o}\)</span>C taking the dielectric constant to be <span class="math notranslate nohighlight">\(80\)</span>. The calculation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \mathrm{a_0 = \frac{(1.602 \cdot 10^{-19} C)^2}{8\pi \cdot 8.854 \cdot 10^{-12} Fm^{-1} \cdot 1.381 \cdot 10^{-23} JK^{-1}\cdot298 K \cdot 80}}\]</div>
<p>The unit is <span class="math notranslate nohighlight">\(\mathrm{C^2/(Fm^{-1}JK^{-1}K)}\)</span> and it is not immediately obviously that this is metres. A farad (F) is a coulomb/volt and a volt is joule/coulomb, therefore a farad is <span class="math notranslate nohighlight">\(\mathrm{F = C^2J^{-1}}\)</span> giving <span class="math notranslate nohighlight">\(a_0\)</span> units of distance. Returning now to the numerical calculation, the integral at <span class="math notranslate nohighlight">\(b = 2\)</span> is clearly zero, starting at <span class="math notranslate nohighlight">\(b = 3\)</span> and incrementing by <span class="math notranslate nohighlight">\(9\)</span> to <span class="math notranslate nohighlight">\(30\)</span> in a loop, gives range of values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># integral in Byerrum equation using Simpson&#39;s method</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>                      <span class="c1"># function to ingtegrate</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;limit b    integral&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>                              <span class="c1"># start 3 , end 30, step 5</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">k</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">simp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>                                <span class="c1"># use Simpson&#39;s rule</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4d}</span><span class="s1">      </span><span class="si">{:10.6g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>limit b    integral
   3        0.325655
   8         1.99552
  13          24.625
  18         826.557
  23         42707.6
  28      2.76659e+06
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="integrating-data-from-an-experiment">
<h2>3.5 Integrating data from an experiment<a class="headerlink" href="#integrating-data-from-an-experiment" title="Permalink to this headline">#</a></h2>
<p>Integrating a curve formed from data points obtained from an experiment has to be done numerically. The safest method is to draw straight lines between the data points and calculate the area as rectangles and triangles, which is what the trapezoidal method does, and this works even if the data is not evenly spaced. You might in addition want to fit the data by a least squares method, which has the effect of smoothing the data, integrating the resulting equation and comparing the results. Alternatively, fitting a polynomial to the data and then integrating may give the required solution.</p>
</section>
<section id="atomic-and-molecular-beam-scattering">
<h2>3.6 Atomic and molecular beam scattering<a class="headerlink" href="#atomic-and-molecular-beam-scattering" title="Permalink to this headline">#</a></h2>
<p>In this next extended example, more of a â€˜real worldâ€™ rather than a purely mathematical calculation is described; it is the classical model of the elastic scattering of one particle, an atom or molecule, off another. The formulae are developed first, and then integrated using the Coulomb and Lennard-Jones 6-12 potentials, the latter being done numerically. In this example, the scattering angle is calculated. In a later example, the actual trajectory followed by a particle during elastic scattering is calculated and drawn.</p>
</section>
<section id="background-and-derivation-of-formulae">
<h2>3.7 Background and derivation of formulae<a class="headerlink" href="#background-and-derivation-of-formulae" title="Permalink to this headline">#</a></h2>
<p>Geiger and Marsden performed one of the most famous scattering experiments during the first decade of the twentieth century. Alpha particles were passed through a very thin Au foil and the positions of these particles detected by scintillation counting after scattering off the Au atoms. In 1910, while at Manchester University, Rutherford deduced that the mass of the atom was not distributed like that in a raisin pudding throughout its volume, but concentrated at its centre in a very small dense nucleus, thus confirming a â€˜planetaryâ€™ model of the atom. This laid the foundation for the old quantum (Bohr) model of the atom.</p>
<p>In the modern version of this experiment, the nature of the force between two particles, such as atoms, molecules, or ions, is sought. A cold beam of atoms or molecules (particles) can be made by passing its gas through a small conical shaped aperture (a skimmer) into a region of high vacuum, typically <span class="math notranslate nohighlight">\(\lt 10^{-6}\)</span> torr. If the particles in one beam strike those in a second beam made in the same way, but at right angles, the particles can scatter off one another elastically. This scattering is not exactly like that of one snooker or billiard ball bouncing off another, but depends on the intermolecular potential energy between the particles. This may be mainly Coulombic if the particles are charged, but if neutral, then a Lennard-Jones potential better describes the interaction; see Fig. 30 (in solutions) for a graph of the potential. The angular position of the scattered particles can be used to calculate the form of the interaction potential. Nowadays detection of the particlesâ€™ position is measured by a CCD camera with a scintillation plate in front of it. This converts a particleâ€™s kinetic energy into a photon. Alternatively, if this is not sensitive enough a specially designed particle detector has to be made and this moved from place to place to record the complete scattering pattern.</p>
<p>The geometry of the experiment is sketched in Fig. 4. The incident beam of particles, which has the shape of a cylindrical rod, is aimed towards the target atom. The potential energy between particles depends only on the separation of the particles; this is called a central force and the motion of the two particles about their centre of mass, can always be reduced to an equivalent one-particle problem, which means that the target can be considered to have infinite mass and therefore cannot move. If the incoming particles are initially off-axis they are deflected by the target and generally continue to travel away from their source but if they are more or less on axis they can be backscattered, orbit or sling-shot around the target.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig4.png" /></p>
<p>Figure 4. Geometry and definition of angle in particle - particle scattering. <span class="math notranslate nohighlight">\(\theta\)</span> is the angle at any position <span class="math notranslate nohighlight">\(r\)</span>, <span class="math notranslate nohighlight">\(\theta_0\)</span> the angle when the particles are closest at <span class="math notranslate nohighlight">\(r_0\)</span> and <span class="math notranslate nohighlight">\(\chi\)</span> is the scattering angle. The incoming beam has cylindrical symmetry.</p>
<hr class="docutils" />
<p>The incident particle starts at <span class="math notranslate nohighlight">\(-\infty\)</span> and a distance b off the axis, and has a total energy of <span class="math notranslate nohighlight">\(E_0\)</span>. The distance <span class="math notranslate nohighlight">\(b\)</span> is called the <em>impact parameter</em>, Fig. 4, and is the distance by which the particles would miss one another if there were no interaction between them. The distance between the particles is the vector r, and the closest that they approach to one another is <span class="math notranslate nohighlight">\(r_0\)</span>. This minimum distance occurs in a repulsive potential at a distance greater than b, because the initial energy causes the incoming particle to rise up the potential â€˜hillâ€™ to an extent depending on its total energy. A more realistic potential, such as a Lennard-Jones 6-12, has both attractive and repulsive parts. The attractive part is usually more extended than the repulsive, so that the particles are attracted to one another at long range and repel at short range, consequently, the distance of closest approach can now be smaller than <span class="math notranslate nohighlight">\(b\)</span>. The particle has a final asymptotic angle <span class="math notranslate nohighlight">\(\chi\)</span> and the geometry shown in the figure gives this angle as</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \chi=\pi-2\theta_0 \qquad\tag{5}\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta_0\)</span> is the angle between the particles when they are closest. The aim of the calculation is to find <span class="math notranslate nohighlight">\(\theta_0\)</span> as a function of <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(E_0\)</span>, and hence <span class="math notranslate nohighlight">\(\chi\)</span>, which can be measured experimentally. During a collision, the total energy and angular momentum are both conserved and are therefore constant, because no external forces act on the particles. The initial energy is <span class="math notranslate nohighlight">\(E_0 = \mu v_0^2/2\)</span>, where <span class="math notranslate nohighlight">\(v_0\)</span> is the asymptotic relative radial velocity and the reduced mass of the two particles is <span class="math notranslate nohighlight">\(\mu\)</span>. The initial energy is equal to the total energy, which is the sum of the kinetic and potential energy <span class="math notranslate nohighlight">\(U(r)\)</span> giving</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_0=\frac{\mu v^2}{2}{+\frac{L^2}{2\mu r^2}+U(r)} \qquad\tag{6}\]</div>
<p>The kinetic energy is <span class="math notranslate nohighlight">\(\mu v^2/2\)</span>, where <span class="math notranslate nohighlight">\(v = dr/dt\)</span> is the radial velocity at time <span class="math notranslate nohighlight">\(t\)</span> during the collision, and <span class="math notranslate nohighlight">\(L\)</span> the angular momentum. The centrifugal energy due to rotational motion, is <span class="math notranslate nohighlight">\(L^2/2\mu r^2\)</span>, which is positive, and when this reaches its maximum, the radial velocity <span class="math notranslate nohighlight">\(v\)</span> is zero, and the particles are at their closest point, <span class="math notranslate nohighlight">\(r_0\)</span>. Since the initial velocity <span class="math notranslate nohighlight">\(v_0\)</span> is perpendicular to <span class="math notranslate nohighlight">\(b\)</span>, the angular momentum is</p>
<div class="math notranslate nohighlight">
\[\displaystyle L=\mu b v_0 =b\sqrt{2E_0\mu}\]</div>
<p>making</p>
<div class="math notranslate nohighlight">
\[\displaystyle  E_0=\frac{\mu v^2}{2} + E_0\left(\frac{b}{r} \right)^2+U(r) \qquad\tag{7}\]</div>
<p>In this form the centrifugal energy is a function of <span class="math notranslate nohighlight">\(r\)</span> and the total potential energy can be considered to be the effective potential</p>
<div class="math notranslate nohighlight">
\[\displaystyle U_{eff}(r) = E_0\left(\frac{b}{r}\right)^2 + U(r)\]</div>
<p>instead of simply <span class="math notranslate nohighlight">\(U(r)\)</span>. By definition, angular momentum is <span class="math notranslate nohighlight">\(\displaystyle L = \mu r^2\frac{dÎ¸}{dt}\)</span> and also as <span class="math notranslate nohighlight">\(L = \mu bv_0\)</span>, therefore <span class="math notranslate nohighlight">\(\displaystyle d\theta = b v_0r^{-2}dt\)</span>.</p>
<p>Our aim is to find <span class="math notranslate nohighlight">\(\theta\)</span> the scattering angle and, because the last equation involves <span class="math notranslate nohighlight">\(d\theta\)</span> and <span class="math notranslate nohighlight">\(dt\)</span>, an integration will be needed, and a change of variable to <span class="math notranslate nohighlight">\(r\)</span> from <span class="math notranslate nohighlight">\(t\)</span>. This change is found using the energy which, by definition, is <span class="math notranslate nohighlight">\(E = \mu(dr/dt)^2/2\)</span> giving <span class="math notranslate nohighlight">\(\displaystyle dt = \sqrt{\frac{\mu}{2E}}dr\)</span>. Combining this with <span class="math notranslate nohighlight">\(d\theta = bv_0r^{âˆ’2}dt\)</span>, substituting <span class="math notranslate nohighlight">\(E = \mu v^2/2\)</span>, using equation 7, and simplifying a little gives the differential equation;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d\theta}{dr}=-\frac{b}{r^2}\left(1-\frac{U(r)}{E_0}-\frac{b^2}{r^2}  \right)^{-1/2} \qquad\tag{8}\]</div>
<p>The leading negative sign is introduced because <span class="math notranslate nohighlight">\(d\theta /dr\)</span> describes the incoming particle. The angle <span class="math notranslate nohighlight">\(\theta\)</span>, which depends on energy <span class="math notranslate nohighlight">\(E_0\)</span> and impact parameter <span class="math notranslate nohighlight">\(b\)</span>,  can be calculated by integrating from its minimum value at <span class="math notranslate nohighlight">\(r = r_0\)</span> to infinity, and takes the form,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \theta_0(E_0,b) = -\int_{\infty}^{r_0} \frac{d\theta}{dr} dr =+b\int_{r_0}^{\infty}\frac{1}{r^2\sqrt{1-\frac{U(r)}{E_0} -\frac{b^2}{r^2}  }}dr \qquad\tag{9}\]</div>
<p>Note that the angle <span class="math notranslate nohighlight">\(\theta_0\)</span> depends on the impact parameter <span class="math notranslate nohighlight">\(b\)</span>, the initial energy of the particle <span class="math notranslate nohighlight">\(E_0\)</span>, and the potential <span class="math notranslate nohighlight">\(U\)</span>, each of which must be known, as must <span class="math notranslate nohighlight">\(r_0\)</span>, before the calculation can be completed.</p>
<p>This equation is also conveniently rewritten as <span class="math notranslate nohighlight">\(\theta_0=\int g(r)dr\)</span> where</p>
<div class="math notranslate nohighlight">
\[\displaystyle g(r)=\frac{b}{r^2}\frac{1}{\sqrt{1-U(r)/E_0-(b/r)^2}}  \qquad\tag{10}\]</div>
</section>
<section id="scattering">
<h2>3.8 Scattering<a class="headerlink" href="#scattering" title="Permalink to this headline">#</a></h2>
<p>The scattering by two different potentials, the Coulomb and the Lennard-Jones 6-12 will be illustrated. The first step in the calculation is to find the equation for the separation <span class="math notranslate nohighlight">\(r_0\)</span>. This is done by using conservation of energy and then knowing that the radial velocity <span class="math notranslate nohighlight">\(v\)</span> is zero at the turning point <span class="math notranslate nohighlight">\(r_0\)</span>. From eqn 6 with <span class="math notranslate nohighlight">\(v = 0\)</span> and <span class="math notranslate nohighlight">\(r = r_0\)</span>, the energy is</p>
<div class="math notranslate nohighlight">
\[\displaystyle E_0 = \frac{L^2}{2\mu r_0^2} + U(r_0)\]</div>
<p>Substituting for <span class="math notranslate nohighlight">\(L=b\sqrt{2E_0\mu}\)</span> and rearranging gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle 1-\frac{b^2}{r_0^2}-\frac{U(r_0)}{E_0}=0 \qquad\tag{11}\]</div>
<p>This is solved for <span class="math notranslate nohighlight">\(r_0\)</span> and the largest root used, if there is more than one. Depending on the potential <span class="math notranslate nohighlight">\(r_0\)</span> may have to be found numerically, for example, by using the bisection method, see section 2.</p>
<p>The next step depends on the potential and as an example, the results of a hard sphere collision between two spheres is shown in figure 5. In this potential if the sum of the two colliding spheres is  <span class="math notranslate nohighlight">\(d\)</span> the potential is infinite when <span class="math notranslate nohighlight">\(b \le d\)</span> and zero otherwise. This means that</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \theta_0= +b\int_{d}^{\infty}\frac{1}{r^2\sqrt{1 -\frac{b^2}{r^2}  }}dr \]</div>
<p>changing the variable to <span class="math notranslate nohighlight">\(u=1/r\)</span> produces <span class="math notranslate nohighlight">\(dr=-dr/r^2\)</span> and then <span class="math notranslate nohighlight">\(\displaystyle \theta_0= \int_d^\infty (1-b^2u^2)^{-1/2}du\)</span> and this has a standard form;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \theta_0= \sin^{-1}\left(\frac{b}{d} \right)\]</div>
<p>and so the scattering angle is <span class="math notranslate nohighlight">\(\displaystyle \chi=\pi- \sin^{-1}\left(\frac{b}{d} \right)\)</span> which is independent of the collision energy. This is shown in fig 5, where <span class="math notranslate nohighlight">\(x = b/d\)</span>.</p>
</section>
<section id="the-coulomb-potential">
<h2>3.9 The  Coulomb potential<a class="headerlink" href="#the-coulomb-potential" title="Permalink to this headline">#</a></h2>
<p>The Coulomb potential energy between charges <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span> at separation <span class="math notranslate nohighlight">\(r\)</span> is <span class="math notranslate nohighlight">\(U(r) = \alpha/r\)</span> where <span class="math notranslate nohighlight">\(\alpha = q_1q_2/4\pi \epsilon_0\)</span> in SI units. Depending on the charges, the Coulomb potential can be repulsive or attractive. This <span class="math notranslate nohighlight">\(1/r\)</span> form of potential also describes that due to gravity, where <span class="math notranslate nohighlight">\(\alpha = -Gm_1m_2\)</span>. For example, it will describe a comet being attracted to and flung around the sun or a planet, <span class="math notranslate nohighlight">\(G\)</span> being the gravitational constant and <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span> the masses.</p>
<p>Considering now the Coulomb potential, the smallest separation of the particles is found from equation 11, which is a quadratic in <span class="math notranslate nohighlight">\(r_0\)</span>. The result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle r_0=\frac{\alpha \pm\sqrt{\alpha^2+4b^2E_0^2}}{2E_0} \]</div>
<p>and the larger root should be taken. The smallest value <span class="math notranslate nohighlight">\(r_0\)</span> can take occurs when <span class="math notranslate nohighlight">\(b\)</span> = 0, and is <span class="math notranslate nohighlight">\(\alpha/E_0\)</span>, which is the minimum separation because it is limited by the initial energy. The angle <span class="math notranslate nohighlight">\(\theta_0\)</span> is given by equation 10, with <span class="math notranslate nohighlight">\(g(r)\)</span> given by <span class="math notranslate nohighlight">\(\displaystyle \frac{b}{r^2}\left( 1-\frac{\alpha}{rE_0} -\frac{b^2}{r^2}  \right)^{-1/2}\)</span>.</p>
<p>The integral (10) can be solved by substituting <span class="math notranslate nohighlight">\(r=1/u\)</span> to make</p>
<div class="math notranslate nohighlight">
\[\displaystyle \theta_0=b\int_0^{u_0}\frac{1}{\sqrt{ 1-a u -b^2u^2  } } du\]</div>
<p>where for clarity <span class="math notranslate nohighlight">\(a=\alpha/E_0\)</span> and <span class="math notranslate nohighlight">\(\displaystyle u_0=1/r_0= \frac{-a\pm \sqrt{a^2+4b^2}  }{2b^2}\)</span>.</p>
<p>This has the form of a standard integral;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \frac{dx}{\sqrt{f+gx+hx^2}}=-\frac{1}{\sqrt{-h}}\sin^{-1}\left(  \frac{2hx+g}{g^2-4fh}\right) + const\]</div>
<p>if <span class="math notranslate nohighlight">\(h\)</span> is negative and <span class="math notranslate nohighlight">\(const\)</span> is the integration constant. The relationship  <span class="math notranslate nohighlight">\(\displaystyle \sin^{-1}(x)=i\ln\left( ix+\sqrt{1-x^2} \right)\)</span></p>
<p>is also needed to simplify the answer after the limits have been included.</p>
<p>The result for the scattering angle is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \chi=2\sin^{-1}\left(\frac{\alpha }{\sqrt{\alpha^2+4E_0b^2}}  \right) \]</div>
<p>which by using a right angled triangle can be recast as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \chi=2\tan^{-1}\left( \frac{\alpha}{2E_ob} \right) \qquad\tag{12}\]</div>
<p>which lies between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span> radians because the Coulomb potential is wholly repulsive between to atoms. At <span class="math notranslate nohighlight">\(b = 0,\, \chi = \pi\)</span> and a head-on collision occurs; at larger impact parameters the scattering angle gradually decays to zero. The particle never really misses the target, on an atomic scale, because the Coulomb interaction spreads out into space to infinity and this can be seen as the scattering angle decreases slowly.</p>
<p>Fig. 5 shows the scattering angles for the Coulomb collision, plotted as <span class="math notranslate nohighlight">\(\chi/\pi\)</span> vs <span class="math notranslate nohighlight">\(x = 2E_0b/\alpha\)</span>, which is dimensionless, and for a hard sphere collision vs <span class="math notranslate nohighlight">\(x = b/d\)</span> (see Q.7). When <span class="math notranslate nohighlight">\(x \gt 1\)</span> this measures the number of times that the impact parameter, the separation of the centres of the atoms, exceeds the sum of their radii. With hard spheres, because there is no long range interaction between them, the scattering angle <span class="math notranslate nohighlight">\(\chi\)</span> is zero when their separation is greater than the sum of their radii <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>In coulomb scattering the quantity <span class="math notranslate nohighlight">\(\alpha/2E_0\)</span> has dimensions of distance because <span class="math notranslate nohighlight">\(\alpha = q_1q_2/4\pi\epsilon_0\)</span> and has units <span class="math notranslate nohighlight">\(\mathrm{C^2/(C^2J^{-1}m^{-1})}\)</span> where C is the Coulomb, and <span class="math notranslate nohighlight">\(\alpha/2E_0\)</span> is therefore the effective diameter of the target. In the Coulomb case, the potential spreads out as <span class="math notranslate nohighlight">\(1/r\)</span> and one particle influences the other and is the cause of the small angular deflection at large <span class="math notranslate nohighlight">\(x\)</span> values. At small <span class="math notranslate nohighlight">\(x\)</span>, which is close to a â€˜head onâ€™ collision, Coulomb scattering is similar to that of a hard sphere.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig5.png" /></p>
<p>Figure 5. Scattering angle as fraction of <span class="math notranslate nohighlight">\(\pi\)</span> radians or <span class="math notranslate nohighlight">\(\chi/\pi\)</span> vs dimensionless parameter <span class="math notranslate nohighlight">\(x = b/d\)</span> for hard sphere and <span class="math notranslate nohighlight">\(x = 2E_0b/\alpha\)</span> for repulsive Coulomb potentials (see text). The inset diagrams show, schematically, Coulomb deflections with potential as diffuse filled circles). When the impact parameter <span class="math notranslate nohighlight">\(b\)</span> is greater than the sum of the radii <span class="math notranslate nohighlight">\(d\)</span> there is no scattering in the hard sphere collision, but this does occur with the coulomb potential as this has a finite, although decreasing value at large separationâ€™s.</p>
</section>
<hr class="docutils" />
<section id="the-lennard-jones-potential">
<h2>3.10 The Lennard-Jones potential<a class="headerlink" href="#the-lennard-jones-potential" title="Permalink to this headline">#</a></h2>
<p>The LJ potential</p>
<div class="math notranslate nohighlight">
\[\displaystyle U(r) = 4\epsilon\left[(\sigma/r)^{12} - (\sigma/r)^6\right]\]</div>
<p>has both attractive and repulsive parts to it; see Fig. 5.30 (in the solutions). The well depth is <span class="math notranslate nohighlight">\(-\epsilon\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> is a measure of the extent of the potential. The minimum energy occurs at <span class="math notranslate nohighlight">\(2^{1/6}\sigma\)</span>. Both the integration to find <span class="math notranslate nohighlight">\(\theta_0\)</span> and the initial value <span class="math notranslate nohighlight">\(r_0\)</span>, have to be calculated numerically. The interaction between two heavy noble gas atoms is described well with this type of potential, but molecules more approximately so. Substituting for the potential into (9) gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \theta_0=b\int_{r_0}^\infty \frac{1}{r^2}\left( 1-\frac{U(r)}{E_0}-\frac{b^2}{r^2} \right)^{-1/2}dr\]</div>
<p>This integral has to be solved numerically; it also has a difficult limit and the function  tends to infinity when <span class="math notranslate nohighlight">\(r = r_0\)</span> and decays slowly to zero as <span class="math notranslate nohighlight">\(r\)</span> increases, a value of at least <span class="math notranslate nohighlight">\(r = 1000\)</span> is typically needed to get an accurate integration when <span class="math notranslate nohighlight">\(\sigma,\, b,\, \epsilon,\, E_0 \approx 1\)</span>. Using the substitution <span class="math notranslate nohighlight">\(r = r_0/(1 - w^2) \)</span> simplifies the limits and also makes the calculation more accurate.</p>
<p>When <span class="math notranslate nohighlight">\(r=r_0\)</span> then <span class="math notranslate nohighlight">\(w\)</span> = 0 and when <span class="math notranslate nohighlight">\(r=\infty,\,w = 1\)</span> thus the new limits are <span class="math notranslate nohighlight">\(w=0,\,1\)</span>. Differentiating gives <span class="math notranslate nohighlight">\(dr = 2r_0w/(1 - w^2)^{2}dw\)</span> and this also has to be substituted into the integral producing</p>
<div class="math notranslate nohighlight">
\[\displaystyle \theta_0=\frac{2b}{r_0}\int_0^1 w \left( 1-\frac{1}{E_0}U\left(\frac{r_0}{1-w^2}\right)-\frac{b^2(1-w^2)^2}{r_0^2}\right)^{-1/2}dw \qquad\tag{14}\]</div>
<p>The distance <span class="math notranslate nohighlight">\(r_0\)</span> still has to be found and using eqn. 11 it is the largest root of</p>
<div class="math notranslate nohighlight">
\[\displaystyle  r=b\left(1-4\frac{\epsilon}{E_0}\left[\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6 \right]    \right)^{-1/2} \qquad\tag{15}\]</div>
<p>for each value of <span class="math notranslate nohighlight">\(b\)</span> required. The bisection method is easy to use for this calculation, however, as it is important to take the largest positive root, this can be found by starting at a large value of <span class="math notranslate nohighlight">\(r\)</span> and decreasing this in steps until a change of sign in eqn. 15 occurs.</p>
<p>The schematic of an algorithm for the whole calculation over a range of <span class="math notranslate nohighlight">\(b\)</span>  is shown below. The calculation only requires the ratio <span class="math notranslate nohighlight">\(E_0/\epsilon\)</span> as input and to plot universal curves <span class="math notranslate nohighlight">\(b\)</span> is reduced to <span class="math notranslate nohighlight">\(b/\sigma\)</span> so that <span class="math notranslate nohighlight">\(\sigma\)</span> = 1 and <span class="math notranslate nohighlight">\(\epsilon\)</span> = 1 is chosen. For simplicity, a python integration routine quad will be used in step 2(iii).</p>
<p><strong>(1)</strong><span class="math notranslate nohighlight">\(\quad\)</span>Define the constants, <span class="math notranslate nohighlight">\(E_0,\,\epsilon\)</span> ,etc.,range,increment in <span class="math notranslate nohighlight">\(b\)</span>, and number of points.</p>
<p><strong>(2)</strong><span class="math notranslate nohighlight">\(\quad\)</span> Start loop over several <span class="math notranslate nohighlight">\(b\)</span> values in the range <span class="math notranslate nohighlight">\(0 \to 3\)</span></p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(i)</strong> Search for the root, equation 15, starting at maximum <span class="math notranslate nohighlight">\(r\)</span> which is <span class="math notranslate nohighlight">\(bm\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(ii)</strong><span class="math notranslate nohighlight">\(\quad\)</span> Find an accurate root <span class="math notranslate nohighlight">\(r_0\)</span> using the bisection method.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(iii)</strong><span class="math notranslate nohighlight">\(\quad\)</span> Calculate the integral equation 9  or 10.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(iv)</strong><span class="math notranslate nohighlight">\(\quad\)</span> Calculate angle <span class="math notranslate nohighlight">\(\chi\)</span></p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(v)</strong><span class="math notranslate nohighlight">\(\quad\)</span> Store results</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(vi)</strong><span class="math notranslate nohighlight">\(\quad\)</span> Increment <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p><strong>(3)</strong><span class="math notranslate nohighlight">\(\quad\)</span>End Loop</p>
<p><strong>(4)</strong><span class="math notranslate nohighlight">\(\quad\)</span> Plot graph.</p>
<p>The plotting is commented out but an annotated plot is shown in fig 6.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Algorithm 8; Elastic scattering with LJ potential</span>
<span class="c1">#-----------------------------</span>
<span class="k">def</span> <span class="nf">scattering</span><span class="p">(</span><span class="n">E0</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>           <span class="c1"># solve equations</span>
    
    <span class="n">U</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="p">((</span><span class="n">sigma</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>         <span class="c1"># L-J 6-12 potential</span>
    <span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">U</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">E0</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>    <span class="c1"># eqn 10</span>
    
    <span class="n">angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>       <span class="c1"># initial values</span>
    <span class="n">bval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    
    <span class="n">f</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">r0</span><span class="p">:</span> <span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">U</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span><span class="o">/</span><span class="n">E0</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span>                    <span class="c1"># eqn 11 solve for r0</span>
    <span class="n">ff</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">g</span><span class="p">(</span><span class="n">r0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">r0</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>     <span class="c1"># eqn to solve subs included</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="n">bm</span>                    <span class="c1"># start at max value</span>
        <span class="k">while</span> <span class="n">f</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">r0</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">-</span> <span class="n">delta_b</span>      <span class="c1"># step 1 look for rargest roor</span>
            <span class="k">pass</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">-</span> <span class="mf">0.1</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">+</span> <span class="mf">0.1</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>       <span class="c1"># look for root</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="n">xm</span> <span class="o">+</span> <span class="mf">1e-6</span>             <span class="c1"># add for numberical stability</span>
    
        <span class="n">theta</span><span class="p">,</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># integrate equation using standard library method</span>
        <span class="n">chi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">theta</span>
        <span class="n">angle</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">chi</span>
        <span class="n">bval</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">b</span><span class="o">/</span><span class="n">sigma</span>         <span class="c1"># save result</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">delta_b</span>            <span class="c1"># increment</span>
    <span class="k">pass</span>
    
    <span class="k">return</span> <span class="n">bval</span><span class="o">/</span><span class="n">sigma</span> <span class="p">,</span><span class="n">angle</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="c1">#-------------------------------</span>
<span class="k">def</span> <span class="nf">bisect</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>               <span class="c1"># bisection method</span>
    <span class="n">xm</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">xtol</span> <span class="o">=</span> <span class="mf">1e-6</span>                    <span class="c1"># tolerance on root</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">))</span>  <span class="o">&gt;</span> <span class="n">xtol</span><span class="p">:</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">xm</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">xm</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">xm</span>
<span class="c1">#-------------------------------</span>

<span class="c1">#fig1 = plt.figure(figsize=(6,6))         # define figure size</span>
<span class="c1">#plt.axhline(0,linewidth=1,color=&#39;grey&#39;)</span>
<span class="n">clr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">]</span>               <span class="c1"># colour of plot lines.</span>

<span class="n">E0</span>    <span class="o">=</span> <span class="mf">0.2</span>         <span class="c1"># set initial values</span>
<span class="n">eps</span>   <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">n</span>     <span class="o">=</span> <span class="mi">200</span>         <span class="c1"># integer number of data points</span>
<span class="n">bm</span>    <span class="o">=</span> <span class="mf">3.0</span>         <span class="c1"># initial impact parameter</span>
<span class="n">delta_b</span> <span class="o">=</span> <span class="n">bm</span><span class="o">/</span><span class="n">n</span>      <span class="c1"># increment </span>
<span class="n">b</span> <span class="o">=</span> <span class="n">delta_b</span>

<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">bval</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">eps</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">E0</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">E0</span><span class="o">/</span><span class="mi">5</span><span class="p">]):</span>     <span class="c1"># calculate for 3 values </span>
    <span class="n">bval</span><span class="p">,</span><span class="n">angle</span> <span class="o">=</span> <span class="n">scattering</span><span class="p">(</span><span class="n">E0</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="c1">#plt.plot(bval, angle,color = clr[i])    # plot results</span>
    <span class="k">pass</span>
<span class="c1">#plt.show()</span>
</pre></div>
</div>
</div>
</div>
<p>A few points should be made about the calculation before considering the results. The integration is very tricky when the deflection angle is large and negative, because this angle can become <span class="math notranslate nohighlight">\(-\infty\)</span> and occasionally the integration will fail because here the square root becomes zero or imaginary. This can usually be avoided by adding a small amount to <span class="math notranslate nohighlight">\(r_0\)</span> and <span class="math notranslate nohighlight">\(10^{-6}\)</span> was found to be sufficient to prevent this and not significantly affect the results. The largest positive root is sought by calculating from the largest <span class="math notranslate nohighlight">\(r\)</span>, which can be taken to be the same as the largest <span class="math notranslate nohighlight">\(b\)</span>, to the smallest <span class="math notranslate nohighlight">\(r\)</span>, finding a change in sign and then starting the bisection method. This is necessary because the <span class="math notranslate nohighlight">\(r_0\)</span> equation can have three roots when <span class="math notranslate nohighlight">\(b\)</span> is large. The function <span class="math notranslate nohighlight">\(g\)</span>, equation 10 is a function of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, and when the substitution is made, <span class="math notranslate nohighlight">\(r\)</span> is replaced. The differential <span class="math notranslate nohighlight">\(dw\)</span> also has to be substituted for <span class="math notranslate nohighlight">\(dr\)</span>, and this can be seen in the function ff.</p>
<p>The angle <span class="math notranslate nohighlight">\(\chi\)</span> vs <span class="math notranslate nohighlight">\(b/\sigma\)</span> is plotted below for three values of the ratio <span class="math notranslate nohighlight">\(E/\epsilon\)</span>.</p>
<p><img alt="Drawing" src="../_images/num-methods-fig6.png" /></p>
<p>Figure 6. Scattering angles with the Lennard-Jones potential.</p>
</section>
<hr class="docutils" />
<section id="analysis-of-results">
<h2>3.11 Analysis of results<a class="headerlink" href="#analysis-of-results" title="Permalink to this headline">#</a></h2>
<p>When the impact parameter <span class="math notranslate nohighlight">\(b\)</span> is small (<span class="math notranslate nohighlight">\(b/\sigma \lt 1\)</span>), the recoil angle <span class="math notranslate nohighlight">\(\chi\)</span> is large and positive and the repulsive part of the potential is dominant. When <span class="math notranslate nohighlight">\(b\)</span> increases, the overall deflection can become zero. This is called a â€˜gloryâ€™ and the initial energy and values of <span class="math notranslate nohighlight">\(b\)</span> mean that the particles are initially attracted to one another, but the impact angle is glancing and, as the repulsive part of the potential is reached, just enough repulsion is present to return the particle on to its original path; the attractive and repulsive interactions exactly cancel. Rainbow scattering occurs when <span class="math notranslate nohighlight">\(d\chi/db = 0\)</span> at the minimum of the curve shown in Fig. 6. At some <span class="math notranslate nohighlight">\(b\)</span> values, the approaching particle can become captured, the angle increases past <span class="math notranslate nohighlight">\(-\pi\)</span> to <span class="math notranslate nohighlight">\(-\infty\)</span> and the particles orbit one another. This is seen with <span class="math notranslate nohighlight">\(E/\epsilon = 1/5\)</span> at <span class="math notranslate nohighlight">\(b/\sigma \approx 2.29\)</span>. The trajectories are shown in Fig. 10,  the algorithm with which to calculate them is also given.</p>
<p>In actual experiments and in quantum calculations, interferences between the different paths the same particle can take are observed. These must be absent in any classical calculation. Scattering is observed experimentally by performing molecular beam experiments and the scattering is, fortunately, not always elastic and chemical reactions can occur and this is called <em>reactive scattering</em>. These experiments have provided lots of fundamental information about chemical reactions and there are a number of clear descriptions of this, see, for example, Rigby et al. (1986), Steinfeld et al. (1999), Bernstein (1982), Eyring et al. (1980), and Hirst (1990).</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="num-methods-intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">11. Numerical Methods</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="num-methods-Q1-7.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 1 - 7</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>