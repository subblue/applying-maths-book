
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5 Appendix: Some basic Python instructions with a few examples. &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15 References and index" href="../references/references-intro.html" />
    <link rel="prev" title="1 SI Units, Unit conversions, Scientific Constants" href="chapter14-E.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1 Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     1 Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     5 Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     1 Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     1 - 3.8 Differentiation, gradients &amp; basic functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     3.9 Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     4 Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     6 Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     9 Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     10 Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     11 Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     12 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4 Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     1 Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     6 Integration and parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     8 Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     9 The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     10 Multiple integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     12 Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     1 Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     6 Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     8 Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     9 Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     1 Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     6 Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     8 Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     12 Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     15 Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     18 Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     21 Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     1 Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     4 Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     6 Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     7 Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     9 Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     11 Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     12 Solving equations using matrices. Eigenvectors and Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     13 Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     14 Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     15 Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     16 Principal axes and Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     1 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     4 Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     5 Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     1 Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     5 Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     7 Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     11 The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     12 The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     14 Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     1 Basics, Initial and Boundary Value problems, Steady state, Phase portrait, Chemical kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     9 First order eqn’s &amp; Integrating factors. Second order eqn’s, Newton’s laws, equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     12 The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     13 Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     14 Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     15 Partial Differential Equations, PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     16 PDE continued. Diffusion, wave eqn., Schroedinger eqn., Fourier method, Transient grating.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     1 Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     4 Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     5 Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     6 The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     8 Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     9 Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     1 Monte - Carlo integration &amp; importance sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     2 Solving rate equations. The Gillespie method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     3 Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     4 Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     6 The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     1 Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     6 Modelling data. Least squares, chi squared, residuals, ANNOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     7 Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     10 Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter14-intro.html">
   14 SI Units, Scientific Constants, unit conversion, Glossary, Python
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="chapter14-E.html">
     1 SI Units, Unit conversions, Scientific Constants
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5 Appendix:  Some basic Python instructions with a few examples.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../references/references-intro.html">
   15 References and index
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/References.html">
     1 References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/index.html">
     2 Index
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-14/Python crib.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-14/Python crib.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-14/Python crib.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-14/Python crib.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   5 Appendix:  Some basic Python instructions with a few examples.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-syntax-python-3-is-assumed">
     5.1 Basic syntax. Python 3 is assumed.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions">
     5.2 Functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-packages">
     5.3 Importing packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-statements-printing-formats">
     5.4 Simple statements,  printing formats
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lists-and-list-comprehension">
     6 Lists and List  comprehension
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-list-comprehension-to-make-a-double-list">
     6.1 Use list comprehension to make a double list
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerics-are-much-faster-with-numpy">
     7 Numerics are much faster with numpy.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#append-to-a-list">
     8 Append to a list
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-loops-and-if-else-to-calculate-stuff-how-to-make-sum-of-terms">
     8.1 Using
     <em>
      loops
     </em>
     and
     <em>
      if else
     </em>
     to calculate stuff.  How to make sum of terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     9 Functions.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lambda-functions">
     9.1 Lambda functions.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#def-functions">
     9.2 def functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursive-functions">
     9.3 Recursive functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-map-f-x-alist-or-f-x-for-x-in-list">
     10 Using map( f(x),  alist )   or    [ f(x) for x in list ]
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algebraic-and-numerical-integration-of-a-function">
     11 Algebraic and numerical integration of a function
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algebraic-integration-example-to-find-average-distance">
     12.1 Algebraic integration; example to find average distance
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integration">
     12.2 Numerical integration
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-other-algebraic-calculations-differentiation-and-series">
     13 Some other algebraic calculations, differentiation  and series
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-two-or-more-plots">
     14 Drawing two or more plots
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integration-of-differential-equations">
     15 Numerical integration of differential equations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algebraic-solution-using-sympy">
     15.1 Algebraic solution using Sympy
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-data-from-files-and-make-a-3d-plot-from-sdf-data">
     16 Reading data from files and make a 3D plot from .sdf data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-pdb-data">
     16.1 Reading pdb data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitting-data-using-non-linear-least-squares">
     17 Fitting data using non-linear least squares
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-needed-for-examples-above">
     18 Data needed for examples above
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-to-fit-txt">
     ‘data-to-fit.txt’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cyclohexane-sdf">
     ‘cyclohexane.sdf’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chapter-11-q20">
     Chapter 11 Q20
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uk-covid-deaths-txt">
     ‘UK-covid-deaths.txt’
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-13">
   Chapter 13
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-data-txt">
     ‘test data.txt’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca-data-txt">
     ‘PCA data.txt’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exponential-data-txt">
     ‘exponential-data.txt’
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>5 Appendix:  Some basic Python instructions with a few examples.</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   5 Appendix:  Some basic Python instructions with a few examples.
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-syntax-python-3-is-assumed">
     5.1 Basic syntax. Python 3 is assumed.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions">
     5.2 Functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-packages">
     5.3 Importing packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-statements-printing-formats">
     5.4 Simple statements,  printing formats
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lists-and-list-comprehension">
     6 Lists and List  comprehension
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-list-comprehension-to-make-a-double-list">
     6.1 Use list comprehension to make a double list
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerics-are-much-faster-with-numpy">
     7 Numerics are much faster with numpy.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#append-to-a-list">
     8 Append to a list
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-loops-and-if-else-to-calculate-stuff-how-to-make-sum-of-terms">
     8.1 Using
     <em>
      loops
     </em>
     and
     <em>
      if else
     </em>
     to calculate stuff.  How to make sum of terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     9 Functions.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lambda-functions">
     9.1 Lambda functions.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#def-functions">
     9.2 def functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursive-functions">
     9.3 Recursive functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-map-f-x-alist-or-f-x-for-x-in-list">
     10 Using map( f(x),  alist )   or    [ f(x) for x in list ]
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algebraic-and-numerical-integration-of-a-function">
     11 Algebraic and numerical integration of a function
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algebraic-integration-example-to-find-average-distance">
     12.1 Algebraic integration; example to find average distance
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integration">
     12.2 Numerical integration
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-other-algebraic-calculations-differentiation-and-series">
     13 Some other algebraic calculations, differentiation  and series
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drawing-two-or-more-plots">
     14 Drawing two or more plots
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integration-of-differential-equations">
     15 Numerical integration of differential equations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algebraic-solution-using-sympy">
     15.1 Algebraic solution using Sympy
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-data-from-files-and-make-a-3d-plot-from-sdf-data">
     16 Reading data from files and make a 3D plot from .sdf data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-pdb-data">
     16.1 Reading pdb data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitting-data-using-non-linear-least-squares">
     17 Fitting data using non-linear least squares
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-needed-for-examples-above">
     18 Data needed for examples above
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-to-fit-txt">
     ‘data-to-fit.txt’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cyclohexane-sdf">
     ‘cyclohexane.sdf’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chapter-11-q20">
     Chapter 11 Q20
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uk-covid-deaths-txt">
     ‘UK-covid-deaths.txt’
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-13">
   Chapter 13
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-data-txt">
     ‘test data.txt’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pca-data-txt">
     ‘PCA data.txt’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exponential-data-txt">
     ‘exponential-data.txt’
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="appendix-some-basic-python-instructions-with-a-few-examples">
<h1>5 Appendix:  Some basic Python instructions with a few examples.<a class="headerlink" href="#appendix-some-basic-python-instructions-with-a-few-examples" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First import all python add-ons etc that will be needed later on</span>
<span class="c1"># the next line is specific &#39;magic&#39; instruction to jupyter notebook ; do not add anything to that line</span>
<span class="o">%</span><span class="k">matplotlib</span> inline                       

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>               <span class="c1"># general python    fast numerical calculation</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># general python    plotting  always used</span>

<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span> <span class="c1"># specific use: e.g. import general numerical integration routine;</span>

<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>              <span class="c1"># algebraic solution of equations, only add if doing algebraic things </span>
<span class="n">init_printing</span><span class="p">()</span>                  <span class="c1"># allows printing of SymPy results in typeset maths format</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>  <span class="c1"># set font size for plots, alter at will.</span>
</pre></div>
</div>
</div>
</div>
<section id="basic-syntax-python-3-is-assumed">
<h2>5.1 Basic syntax. Python 3 is assumed.<a class="headerlink" href="#basic-syntax-python-3-is-assumed" title="Permalink to this headline">#</a></h2>
<p>(1) The position an instruction starts on a line is important. Normally position zero starts a line but in loops or after conditional statements indented by 4 spaces or a tab. In general it seems that the spaces and tabs cannot be mixed.</p>
<p>(2) Python is case sensitive, i.e. a name <span class="math notranslate nohighlight">\(\mathtt{Func}\)</span> is different to <span class="math notranslate nohighlight">\(\mathtt{func}\)</span>. Names should not start with a number.</p>
<p>(3) <span class="math notranslate nohighlight">\(\sqrt{-1}\)</span> is given the symbol <span class="math notranslate nohighlight">\(\mathtt{1j}\)</span> or <span class="math notranslate nohighlight">\(\mathtt{1J}\)</span></p>
<p>(4) Division takes two forms, a/b for normal floating point, i.e. 3/2=1.5 and a//b for integer division, i.e 3//2=1</p>
<p>(5) Functions sin cos or your own use round brackets i.e. <span class="math notranslate nohighlight">\(\mathtt{np.tan(x)}\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> can be floating point or integer and the function is evaluated at hat value.</p>
<p>(6) Arrays/lists use square brackets, e.g. <span class="math notranslate nohighlight">\(\mathtt{myary[i]}\)</span> and integer index, <span class="math notranslate nohighlight">\(i\)</span>, and returns the value at that index.</p>
<p>(7) Normal functions sin, cos etc. are unknown and have to be accessed <em>via</em> numpy as <span class="math notranslate nohighlight">\(\mathtt{np.sin(x), \;np.exp(x),\; np.pi }\)</span> etc. Use numpy for any numerical calculation other than trivial ones as it is fast.</p>
<p>(8) Powers are made as <span class="math notranslate nohighlight">\(\mathtt{x**(1J+3)}\)</span> etc.</p>
<p>(9) Indexing lists, sets, and arrays all start at zero, i.e. the first element of mylist is, <span class="math notranslate nohighlight">\(\mathtt{mylist[ 0 ]}\)</span>. If the list is of length <span class="math notranslate nohighlight">\(n\)</span> the last element is <span class="math notranslate nohighlight">\(\mathtt{mylist[n-1]}\)</span></p>
<p>(10) When using <em>for loops,  while loops, subroutines, if</em> statements, etc. the first line ends in a colon: for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f01</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>   <span class="c1"># define list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>             <span class="c1"># this has values ten values, i from  0 to 9  end in :</span>
    <span class="n">f01</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mf">10.5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f01</span><span class="p">[:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 10.5, 21.0, 31.5, 42.0, 52.5, 63.0, 73.5, 84.0, 94.5]
</pre></div>
</div>
</div>
</div>
<p>and all lines in the loop are inset by 4 spaces or a tab.</p>
<p>(11) Loops, subroutines, if etc. have no end statements; the tabbing is enough to delimit the range, however, it is acceptable to add the word <em>pass</em> as the last statement as it often makes reading easier.</p>
<p>(12) There are objects called <em>list comprehensions</em> that are an alternative to loops in many cases. (They are more consise but for speed or complex cases use loops).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>    <span class="c1"># makes list of 6 values, i=0 to 5 see below for details</span>
<span class="n">mylist</span><span class="p">[:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_5_0.png" src="../_images/Python crib_5_0.png" />
</div>
</div>
<p>Arrays are usually called <em>lists</em> and enclosed by square brackets [] and indexed by square brackets,
eg <span class="math notranslate nohighlight">\(\mathtt{mylist=[ 2,3,4 ]}\)</span> and so to print use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">mylist</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>to print the first element or to print the whole thing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>   <span class="c1"># or</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mylist</span><span class="p">[</span> <span class="p">:</span> <span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2, 3, 4, 5, 6, 7]
[2, 3, 4, 5, 6, 7]
</pre></div>
</div>
</div>
</div>
<p>2d lists are called as <span class="math notranslate nohighlight">\(\mathtt{A[ i ][ j ]}\)</span> , i.e. two separate brackets.</p>
<p>Numpy arrays are called in a similar manner however, two D arrays can be called differently as <span class="math notranslate nohighlight">\(\mathtt{A[ i, j ]}\)</span> with one square bracket.</p>
</section>
<section id="functions">
<h2>5.2 Functions<a class="headerlink" href="#functions" title="Permalink to this headline">#</a></h2>
<p>There are two types of user defined functions, as in a multiline subroutine or procedure e.g.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>           <span class="c1"># use this for complicated function with if else etc</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myfunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9068996821171088
</pre></div>
</div>
</div>
</div>
<p>and in a <em>lambda</em> or single line statement, e.g.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>     <span class="c1"># use for one line functions</span>

<span class="nb">print</span><span class="p">(</span><span class="n">myfunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9068996821171088
</pre></div>
</div>
</div>
</div>
</section>
<section id="importing-packages">
<h2>5.3 Importing packages<a class="headerlink" href="#importing-packages" title="Permalink to this headline">#</a></h2>
<p>It is necessary to import other packages for specific calculations, <em>numpy</em> for fast numerical calculations, <em>scipy</em> for special functions (such as error func), integrations, non-linear least squares etc. and <em>matplotlib</em> for plotting.</p>
<p>SymPy is used for algebraic calculations.</p>
<p>Print statements are always enclosed in brackets, eg. print(x**2)      [  This is different to python 2.7  ]</p>
<p>The other main different to python 2.7 is that 3/2 is treated as real division,i.e. 1.5. To get integer division use 3//2 = 1. This is important if the division is then to be used as an index as these can only be integers.</p>
</section>
<section id="simple-statements-printing-formats">
<h2>5.4 Simple statements,  printing formats<a class="headerlink" href="#simple-statements-printing-formats" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">2.1</span><span class="o">**</span><span class="mf">3.1</span>               <span class="c1"># raise to power</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>      <span class="c1"># use numpy to define sine and pi</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">123</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>               <span class="c1">#  quick print</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:6.3f}{:s}{:6.5g}{:s}{:4d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;The value of a is &#39;</span><span class="p">,</span> <span class="n">a</span> <span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The value of b is &#39;</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="s1">&#39;, c is &#39;</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>  

<span class="c1"># print uses s for string, f for reals, d for integer, g for general real, e  for scientific if needed</span>
<span class="c1"># \n causes a newline</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.97423999265871 -0.1611491390171008 123
The value of a is  9.974
The value of b is -0.16115, c is  123
</pre></div>
</div>
</div>
</div>
</section>
<section id="lists-and-list-comprehension">
<h2>6 Lists and List  comprehension<a class="headerlink" href="#lists-and-list-comprehension" title="Permalink to this headline">#</a></h2>
<p>Often a list (array in other languages) has <em>n</em> values that can be addressed later on. In python these can be number or strings of letters etc. or a mixture of these. Strings are enclosed in parenthesis as  ‘a’.</p>
<p>Usually a name is chosen and then values added in a loop of some kind. In many cases in python this can be done in one go. This is called <strong>list comprehension</strong>, see how <em>a</em> is generated below. Also shown is how different values can be extracted. The <em>range(5)</em> has values 0 to 4 because the first value in the list has zero index so is given by a[0].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># printing and intro to list comprehension</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>  <span class="c1"># list comprehension, range makes list of 5 values where i varies from 0 to 4</span>
                                   <span class="c1"># this is alternative to a &#39;for&#39; loop</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list is &#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;4th value is a[3] = &#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>                  <span class="c1"># print 4th value as index starts at zero</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1st to 3rd value is a[0:3] = &#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;last value a[-1] =&#39;</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;reverse order a[::-1] =&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>            <span class="c1"># note double ::</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list is  [0.0, 0.7071067811865475, 1.0, 0.7071067811865476, 1.2246467991473532e-16]
4th value is a[3] =  0.7071067811865476
1st to 3rd value is a[0:3] =  [0.0, 0.7071067811865475, 1.0]
last value a[-1] = 1.2246467991473532e-16
reverse order a[::-1] = [1.2246467991473532e-16, 0.7071067811865476, 1.0, 0.7071067811865475, 0.0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The values in my list are as follows&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>                                  <span class="c1"># note colon and we call whole list </span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>               <span class="c1"># format a list, note indent</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Second method; use enumerate to get index and values&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4d}</span><span class="s1"> </span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Third method; print directly as in conventional programming loop to get index and values&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>                                   <span class="c1"># call individual values </span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4d}</span><span class="s1"> </span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>            <span class="c1"># format a list </span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fourth method part of list&#39;</span><span class="p">)</span>                  <span class="c1"># use list to define spcific values</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4d}</span><span class="s1"> </span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> 
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The values in my list are as follows
 0.000
 0.707
 1.000
 0.707
 0.000
Second method; use enumerate to get index and values
   0  0.000
   1  0.707
   2  1.000
   3  0.707
   4  0.000
Third method; print directly as in conventional programming loop to get index and values
   0  0.000
   1  0.707
   2  1.000
   3  0.707
   4  0.000
Fourth method part of list
   0  0.000
   3  0.707
   4  0.000
</pre></div>
</div>
</div>
</div>
</section>
<section id="use-list-comprehension-to-make-a-double-list">
<h2>6.1 Use list comprehension to make a double list<a class="headerlink" href="#use-list-comprehension-to-make-a-double-list" title="Permalink to this headline">#</a></h2>
<p>Rather than use a double loop to put values into a double list this can be done in one go as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span>  <span class="c1"># 2d list, b[j][i] ,i.e. 2nd index in first place</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">double list is&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">double list index in order b[j][i], second row, fourth column has value b[1][4]&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;printing b[4][1] will lead to an error e.g.&#39;</span><span class="p">)</span>
<span class="c1">#print(b[4][1])       the error produced here will stop the notebook code cell from continuing until it is fixed.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>double list is
[[1.0, 1.0, 1.0, 1.0, 1.0], [1.0, 0.36787944117144233, 0.1353352832366127, 0.049787068367863944, 0.01831563888873418], [1.0, 0.1353352832366127, 0.01831563888873418, 0.0024787521766663585, 0.00033546262790251185]]

double list index in order b[j][i], second row, fourth column has value b[1][4] 0.01831563888873418
printing b[4][1] will lead to an error e.g.
</pre></div>
</div>
</div>
</div>
</section>
<section id="numerics-are-much-faster-with-numpy">
<h2>7 Numerics are much faster with numpy.<a class="headerlink" href="#numerics-are-much-faster-with-numpy" title="Permalink to this headline">#</a></h2>
<p>Import numpy (see top of page) to use mathematical functions and make arrays. The operation is orders of times faster than basic python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># make x range from 0 to 10pi in 5 steps. </span>

<span class="n">myary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># 2D array of size 5 by 3 (row, col)  full of zeros</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">myary</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">j</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myary</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>        <span class="c1"># print all of column 2 which is 3rd as index starts at 0 </span>
<span class="n">myary</span><span class="p">[:,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.00000000e+00  8.18730753e-01  5.01327998e-16 -8.18730753e-01
 -1.00265600e-15]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [ 1.00000000e+00,  9.04837418e-01,  8.18730753e-01],
       [ 6.12323400e-16,  5.54053124e-16,  5.01327998e-16],
       [-1.00000000e+00, -9.04837418e-01, -8.18730753e-01],
       [-1.22464680e-15, -1.10810625e-15, -1.00265600e-15]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="append-to-a-list">
<h2>8 Append to a list<a class="headerlink" href="#append-to-a-list" title="Permalink to this headline">#</a></h2>
<p>Appending one value at a time to a list is a very useful way of lengthening a list when the final length is unknown. Can be useful when reading datafile whose length is unknown. Start with an empty list then use a loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="p">[]</span>                  <span class="c1"># empty list</span>
<span class="n">lim_value</span> <span class="o">=</span> <span class="mi">3</span>                <span class="c1"># e.g. some value determined by programme else where</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lim_value</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">mylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># add value to list </span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>                  <span class="c1"># you must increment index in a while loop</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.0, 0.26359713811572677, 0.049787068367863944]
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-loops-and-if-else-to-calculate-stuff-how-to-make-sum-of-terms">
<h2>8.1 Using <em>loops</em> and <em>if else</em>  to calculate stuff.  How to make sum of terms<a class="headerlink" href="#using-loops-and-if-else-to-calculate-stuff-how-to-make-sum-of-terms" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f01</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>         <span class="c1"># make list full of zeros</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>                     <span class="c1"># range i from 0 to 19</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>                         <span class="c1"># use if not equal to zero </span>
        <span class="n">f01</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f01</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">pass</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">f01</span><span class="p">)</span>                               <span class="c1"># print whole list</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">sum of whole list is &#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f01</span><span class="p">)</span> <span class="p">)</span>  <span class="c1"># use just for 1D list, use numpy sum for anything else</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.0, 5.99903913064743e-32, 1.4997597826618576e-32, 0.7500000000000003, 1.0, 0.9045084971874736, 0.7499999999999999, 0.6112604669781571, 0.4999999999999999, 0.41317591116653474, 0.3454915028125263, 0.2922924934990568, 0.24999999999999994, 0.21596762663442207, 0.18825509907063323, 0.16543469682057085, 0.14644660940672624, 0.13049554138967043, 0.11697777844051097, 0.10542974530180318]

sum of whole list is  7.885735968708085
</pre></div>
</div>
</div>
</div>
<p>Now do same calulation but instead of using <em>i</em> to determine values in the sine function we define <em>x</em> and give it values then we will plot the result. (If you want to alter the size of the plot then <em>figure</em> has to be used, see drawing two plots, somewhere below this cell).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numx</span> <span class="o">=</span> <span class="mi">300</span>                              <span class="c1"># number of points</span>
<span class="n">f01</span>  <span class="o">=</span> <span class="p">[</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numx</span><span class="p">)]</span>      <span class="c1"># make list full of zeros</span>
<span class="c1"># you could also use </span>
<span class="c1"># f01 = np.zeros(n,type=float)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">numx</span><span class="p">)</span>         <span class="c1"># make numx values evenly spaces between 0 and 2pi</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numx</span><span class="p">):</span>                   <span class="c1"># range sets values, in this case x and f01 must have same length</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>                      <span class="c1"># use if not equal to zero </span>
        <span class="n">f01</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>       <span class="c1"># fill list elements with values</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f01</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">pass</span>

<span class="c1">#print(f01)    # printing disabled as 300 points</span>
<span class="n">figx</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f01</span><span class="p">)</span>                       <span class="c1"># must have imported matplotlib, this is done at top of worksheet</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span> <span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39; x /metre&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span> <span class="s1">&#39;some function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span> <span class="s1">&#39; simple plotting&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                            <span class="c1"># this must be last plotting instruction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_28_0.png" src="../_images/Python crib_28_0.png" />
</div>
</div>
<p>If you want to plot two graphs together then it is a bit more complicated. First it is necessary to define a <em>figure</em> and then define <em>axes</em> on which to draw the data and add subplots as the two figures. This is shown below.</p>
</section>
<section id="id1">
<h2>9 Functions.<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>There are standard functions <em>sin, cos, exp</em> etc. that we use numpy to call as <em>np.sin(x)</em> etc. There are also two main types of user defined function that can take arguments.</p>
</section>
<section id="lambda-functions">
<h2>9.1 Lambda functions.<a class="headerlink" href="#lambda-functions" title="Permalink to this headline">#</a></h2>
<p>These are single line functions and can be used for straightforward functions. They have the form</p>
<p><em>aname =  lambda variable1, variable 2, etc.  :  expression in variables 1, 2 etc.</em></p>
<p>note the word lambda and the colon.</p>
<p>These function are called using normal <strong>curved brackets</strong>  <em>aname(3.0,2.0,…)</em>  Note that lists use square brackets.</p>
<p>It is also possible to use if statements inside a lambda and an example is given but it is usually better to use a def type function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">func1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>        <span class="c1"># define function in x and z</span>

<span class="nb">print</span><span class="p">(</span> <span class="n">func1</span><span class="p">(</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">4.2</span><span class="p">)</span> <span class="p">)</span>                               <span class="c1"># print value at given x and z</span>

<span class="n">func2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">else</span>  <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>  <span class="c1"># you can do this but its better to use def type functions</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;func2 with if statement, cannot plot this, value at -1 is &#39;</span><span class="p">,</span> <span class="n">func2</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>      <span class="c1"># define x values </span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span> <span class="p">)</span>    <span class="c1"># example of plotting lambda function, note how x is whole list of values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mf">3.0</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$cos(x)+exp(-x/z)$&#39;</span><span class="p">)</span>           <span class="c1"># plot using mathjax , put r before &#39; bla bla&#39; and enclose in $ signs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.5211115802791633
func2 with if statement, cannot plot this, value at -1 is  0.8414709848078965
</pre></div>
</div>
<img alt="../_images/Python crib_31_1.png" src="../_images/Python crib_31_1.png" />
</div>
</div>
</section>
<section id="def-functions">
<h2>9.2 def functions<a class="headerlink" href="#def-functions" title="Permalink to this headline">#</a></h2>
<p>These are the more general type of user defined functions and allow for any sort of complicated function. They are the equivalent of subroutines in other languages.</p>
<p>The answers you want are obtained by using a <em>return</em> statement.</p>
<p>The variables inside the function are local, i.e. if you use x inside its different to the x outside. <strong>However, there are rules on local and global variables that need checking</strong>.</p>
<p>The syntax for <em>def</em> functions is shown below. Note also that we can now plot negative values of aour function,not possible with the way the lambdat functio was defined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">afunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>                              <span class="c1"># define afunc to be function of x and z</span>
    
    <span class="k">if</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>                               <span class="c1"># can add if else and loops etc. inside def function.</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>               <span class="c1"># must use return (and as many values as you want )</span>

<span class="n">Q</span><span class="p">,</span> <span class="n">is_x</span><span class="p">,</span> <span class="n">is_z</span> <span class="o">=</span> <span class="n">afunc</span><span class="p">(</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">4.2</span><span class="p">)</span>               <span class="c1"># return sends three values back, call them Q, is_x, is_z</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;returned values are Q, 2*x and sin(z), i.e.&#39;</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span> <span class="n">is_x</span><span class="p">,</span> <span class="n">is_z</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>      <span class="c1"># define x values with numpy:  (start, end, num points)</span>

<span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">]</span>                   <span class="c1"># choose colours then index in loop</span>

<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">]):</span>         <span class="c1"># enumerate passes  index , value  into loop</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">),</span><span class="n">color</span> <span class="o">=</span> <span class="n">col</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;z=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="p">)</span>    <span class="c1"># example of plotting lambda function, note how x is whole list of values</span>
    <span class="k">pass</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$cos(x)+exp(-x/z)$&#39;</span><span class="p">)</span>             <span class="c1"># plot using mathjax , put r before &#39; bla bla&#39; and enclose in $ signs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>returned values are Q, 2*x and sin(z), i.e. -0.5211115802791633 6.2 -0.8715757724135881
</pre></div>
</div>
<img alt="../_images/Python crib_33_1.png" src="../_images/Python crib_33_1.png" />
</div>
</div>
</section>
<section id="recursive-functions">
<h2>9.3 Recursive functions<a class="headerlink" href="#recursive-functions" title="Permalink to this headline">#</a></h2>
<p>It is possible to make functions recursive, calculating a factorial as n! = n.(n-1).(n-2)….1   is the commonly used example and is given below as is one to calculate Hermite polynomials used in determining harmonic oscillator wavefunctions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fact</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>                    <span class="c1"># factorial cannot be used for huge values</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>      <span class="c1"># call the function again until we get 1, jump out and end with return 1</span>
<span class="c1">#-------------------------  </span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number factorial&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> 
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;     &#39;</span><span class="p">,</span><span class="n">fact</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number factorial
   0       1
   1       1
   2       2
   3       6
   4       24
   5       120
   6       720
   7       5040
   8       40320
   9       362880
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Hermite</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>   <span class="c1"># use recursion formula, x is real, n is order. H(n,x) = 2.x.H(n-1,x)-2.(n-1).H(n-2,x)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">Hermite</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hermite</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="c1">#--------------</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>                       <span class="c1"># define x range with 100 points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Hermite</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Hermite</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Hermite</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;some Hermite polynomials&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_36_0.png" src="../_images/Python crib_36_0.png" />
</div>
</div>
</section>
<section id="using-map-f-x-alist-or-f-x-for-x-in-list">
<h2>10 Using map( f(x),  alist )   or    [ f(x) for x in list ]<a class="headerlink" href="#using-map-f-x-alist-or-f-x-for-x-in-list" title="Permalink to this headline">#</a></h2>
<p>This is a way to perform an operation of a list of things without having to use a loop. The <em>map</em> function has  two or more arguments <em>map( function, sequence )</em>. One simple use is to multiply all of a list by some number, you cannot do *<em>[1,2,4,5]<em>2</em></em> for example, but have to use map or list comprehension as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using map</span>
<span class="n">alist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="n">blist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">alist</span><span class="p">)</span> <span class="p">)</span>  <span class="c1"># square list;  note have to add list() to get result.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;blist&#39;</span><span class="p">,</span><span class="n">blist</span><span class="p">)</span>

<span class="c1"># using list comprehension:  does not matter which is used. This method seems clearer to me though</span>
<span class="n">clist</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">alist</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;clist&#39;</span><span class="p">,</span><span class="n">clist</span><span class="p">)</span>

<span class="n">dlist</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="p">,</span> <span class="n">alist</span><span class="p">,</span> <span class="n">blist</span><span class="p">))</span>  <span class="c1"># square alist then add to blist.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">dlist&#39;</span><span class="p">,</span><span class="n">dlist</span><span class="p">)</span>

<span class="n">elist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">dlist</span><span class="p">)</span> <span class="p">)</span>                       <span class="c1"># make sine of each term</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">elist&#39;</span><span class="p">,</span> <span class="n">elist</span><span class="p">)</span>

<span class="n">eelist</span> <span class="o">=</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dlist</span><span class="p">]</span>                    <span class="c1"># alternative </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eelist&#39;</span><span class="p">,</span> <span class="n">eelist</span><span class="p">)</span>

<span class="c1"># make characters from a ascii numbers</span>

<span class="n">numlist</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">84</span> <span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">32</span> <span class="p">,</span><span class="mi">73</span> <span class="p">,</span><span class="mi">83</span> <span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">66</span> <span class="p">,</span><span class="mi">69</span> <span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span> <span class="p">]</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span> <span class="nb">map</span><span class="p">(</span> <span class="nb">chr</span><span class="p">,</span> <span class="n">numlist</span><span class="p">)</span> <span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">remove &#39; and , from output&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>  <span class="c1"># remove &#39; and , </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>blist [1, 4, 16, 25, 49, 81]
clist [1, 4, 16, 25, 49, 81]

dlist [2, 8, 32, 50, 98, 162]

elist [0.9092974268256817, 0.9893582466233818, 0.5514266812416906, -0.26237485370392877, -0.5733818719904229, -0.9784503507933796]
eelist [0.9092974268256817, 0.9893582466233818, 0.5514266812416906, -0.26237485370392877, -0.5733818719904229, -0.9784503507933796]

 [&#39;H&#39;, &#39;A&#39;, &#39;T&#39;, &#39;R&#39;, &#39;X&#39;, &#39; &#39;, &#39;I&#39;, &#39;S&#39;, &#39; &#39;, &#39;B&#39;, &#39;E&#39;, &#39;S&#39;, &#39;T&#39;]

remove &#39; and , from output [H A T R X   I S   B E S T]
</pre></div>
</div>
</div>
</div>
</section>
<section id="algebraic-and-numerical-integration-of-a-function">
<h2>11 Algebraic and numerical integration of a function<a class="headerlink" href="#algebraic-and-numerical-integration-of-a-function" title="Permalink to this headline">#</a></h2>
<p>Now we will do some integration, both algebraic and numerically; we have already imported integrate from scipy; see top of document.</p>
<p>The function to integrate is first defined and plotted.</p>
<p>The calculation of nearest neighbour distances  from one molecule to another has been worked out see Chandrashkar, Rev Mod Phys 1943.</p>
<p>Let <span class="math notranslate nohighlight">\(w(r)\)</span> be the probability that the nearest neighbour occurs between distance  <em>r</em> and <em>r</em>+<em>dr</em>. This must be the probability than no molecules exist closer to the victim molecule that one occurs at a distance <em>r</em> and that this molecule axists in the shell <em>r</em> to <em>r</em>+<em>dr</em>. Thus,</p>
<div class="math notranslate nohighlight">
\[ w(r)=\left(  1-\int_0^r w(r)dr \right)4\pi r^2 n\]</div>
<p>where <em>n</em> is the average number of molecules / unit volume. (1 mol <span class="math notranslate nohighlight">\(\equiv 10^3N_A/10^{27} = 0.6023 \)</span> molecules / nm<span class="math notranslate nohighlight">\(^3\)</span>).</p>
<p>This is hard to solve as it is because <span class="math notranslate nohighlight">\(w(r)\)</span> is also inside the integration, so it is necessary to differentiate to find a result which is;</p>
<div class="math notranslate nohighlight">
\[ w(r)=4\pi r^2n\exp(-4\pi r^3n/3)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting the distribution for some concentrations. Use n in molecs/nm^3, r in nm</span>

<span class="n">w</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">,</span><span class="n">n</span> <span class="p">:</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>   <span class="c1"># define function w(r) with variables r and n</span>

<span class="n">maxr</span> <span class="o">=</span> <span class="mf">15.0</span>       <span class="c1"># max distance in nm</span>
<span class="n">numr</span> <span class="o">=</span> <span class="mi">100</span>        <span class="c1"># number of data popints</span>
<span class="n">n0</span>   <span class="o">=</span> <span class="mf">0.6023</span>     <span class="c1"># number molecs/nm^3 at 1 mole</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxr</span><span class="p">,</span> <span class="n">numr</span><span class="p">)</span>         <span class="c1"># make list of distances</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>                   <span class="c1"># note :  range 1 to 4  </span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n0</span><span class="o">*</span><span class="mf">1e-3</span><span class="o">*</span><span class="n">i</span>                      <span class="c1"># 1e-3 to make millimolar; convert to number/nm^3</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">r</span><span class="p">,</span> <span class="n">w</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:4.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>   <span class="c1"># can put print format into string </span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;w(r)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x /nm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Nearest neighbour distributions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_40_0.png" src="../_images/Python crib_40_0.png" />
</div>
</div>
</section>
<section id="algebraic-integration-example-to-find-average-distance">
<h2>12.1 Algebraic integration; example to find average distance<a class="headerlink" href="#algebraic-integration-example-to-find-average-distance" title="Permalink to this headline">#</a></h2>
<p>The average distance given the distribution <span class="math notranslate nohighlight">\(w(r)\)</span> is <span class="math notranslate nohighlight">\(\displaystyle \langle r \rangle = \int_0^\infty rw(r)dr\)</span>. The integral can be performed in the normal way but we use SymPy to illustrate this. THe steps are to define symbolic constants then do the integration. In SymPy infinity is oo (two lower case letter o). The <em>conds=’none’</em> removes any periodic conditions and so simplified the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># average distance algebraically</span>
<span class="n">n</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39; n, r&#39;</span><span class="p">)</span>                       <span class="c1"># define symbols to use . Note also that pi and exp are known by sympy.</span>

<span class="n">f01</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>       <span class="c1"># note that we do not use np.exp or np.pi as SymPy knows functions</span>
<span class="n">av</span><span class="o">=</span>  <span class="n">integrate</span><span class="p">(</span><span class="n">f01</span><span class="p">,(</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">oo</span><span class="p">),</span> <span class="n">conds</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>  <span class="c1"># use conds =&#39;none&#39; if you are happy that no funny results are expected.</span>
<span class="n">av</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_42_0.png" src="../_images/Python crib_42_0.png" />
</div>
</div>
<p>The result contains the gamma function, if you type <span class="math notranslate nohighlight">\(\mathtt{av.evalf()}\)</span> you can evaluate the numerical parts and find that <span class="math notranslate nohighlight">\(\displaystyle \langle r \rangle = 0.55396n^{-1/3}\)</span>.</p>
</section>
<section id="numerical-integration">
<h2>12.2 Numerical integration<a class="headerlink" href="#numerical-integration" title="Permalink to this headline">#</a></h2>
<p>The same calculation can be done numerically of course, but in that case <em>n</em> has to be defined in each instance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using scipy numerical integration  quad(func, x_start, x_end, arg( arguments in user function other than x))</span>
<span class="c1"># the quad() returns two values the integration and the error bound. </span>
<span class="c1"># the user define function below if called func (we are so imaginative) </span>
<span class="c1"># but could also de defined as _def myfunc(r,n):_ etc.</span>
<span class="c1"># general purpose integration. </span>
<span class="c1"># Must have loaded scipy integration here if not done above.</span>
<span class="c1"># it is always necessary to plot function first otherwise integration range may be unkonwn</span>
<span class="c1"># and integration may still converge properly but the result be in error.</span>

<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="p">:</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>     <span class="c1"># user define function to integrate,</span>

                            <span class="c1"># r is variable  to integrate over, this need not be defined as quad() defines this.</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="o">*</span><span class="mf">0.6023</span>             <span class="c1"># molecules /nm^3</span>
<span class="n">maxr</span> <span class="o">=</span> <span class="mf">30.0</span>                 <span class="c1"># integration range</span>
<span class="n">minr</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">av</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">minr</span><span class="p">,</span> <span class="n">maxr</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>      
                             <span class="c1"># in args only put variable name(s) from function not integrated over.</span>
                             <span class="c1"># err is error bound, you should check this for convergence</span>

<span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:f}{:s}{:f}{:s}{:f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;molecs/nm^3 = &#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39; numerical = &#39;</span><span class="p">,</span> <span class="n">av</span><span class="p">,</span> <span class="s1">&#39; exact = &#39;</span><span class="p">,</span> <span class="mf">0.55396</span><span class="o">/</span><span class="n">n</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;error too large &#39;</span><span class="p">,</span><span class="n">err</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>molecs/nm^3 = 0.000602 numerical = 6.559554 exact = 6.559551
</pre></div>
</div>
</div>
</div>
</section>
<section id="some-other-algebraic-calculations-differentiation-and-series">
<h2>13 Some other algebraic calculations, differentiation  and series<a class="headerlink" href="#some-other-algebraic-calculations-differentiation-and-series" title="Permalink to this headline">#</a></h2>
<p>Sympy can be used in the same way as Maple or Mathematica to perform algebra. It is quite easy but the manuals are very obscure ansd so a couple of examples are given below.</p>
<p>First differentiating then generating series expansion of the funtion produced.  The first step is to define the symbols to be used. We will use the nearest neighbour distribution to begin with.  The best output results are found without using print() as shown below. If you do use print as in print(Q.doit() ) a code type output is produced and the nice output supressed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># assume sympy already loaded.</span>

<span class="n">n</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;n, r&#39;</span><span class="p">)</span>                       <span class="c1"># define symbols to use . Note also that pi and exp are known by sympy.</span>

<span class="n">f01</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span> <span class="n">diff</span><span class="p">(</span><span class="n">f01</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> <span class="p">)</span>                 <span class="c1"># differentiate wrt r and simplify</span>
<span class="n">Q</span>                                           <span class="c1"># do calculation</span>
<span class="c1">#print(Q)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_46_0.png" src="../_images/Python crib_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">series</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>                        <span class="c1"># expand Q (above) about zero and to powers of r**15 if possible </span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_47_0.png" src="../_images/Python crib_47_0.png" />
</div>
</div>
<p>If you want to use the result in subsequent code the ‘big O’ notation can be removed as shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">series</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>   <span class="c1"># expand Q (above) remove big O and then simplify</span>
<span class="n">simplify</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_49_0.png" src="../_images/Python crib_49_0.png" />
</div>
</div>
</section>
<section id="drawing-two-or-more-plots">
<h2>14 Drawing two or more plots<a class="headerlink" href="#drawing-two-or-more-plots" title="Permalink to this headline">#</a></h2>
<p>In this case it is necessary to define a figure and axes rather than using plt. as for just a single graph. Using a figure also allows the plot size to be defined rather than having to use the default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define an inline (lambda) function</span>
<span class="c1"># define a figure  call it fig1 : ( I&#39;m being really imaginative here). We can also define the total size for both figs.</span>

<span class="n">fig1</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">15.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">))</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>           <span class="c1"># the numbers mean form a 2 x 2 plot and call ax0 and then first plot.</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>           <span class="c1"># etc second plot.</span>
<span class="c1"># ax2 = fig1.add_subplot(2,2,4)         # if you remove hash then three plots are drawn </span>

<span class="c1"># the notation on subplot is not very clear!   to draw 4 plots in a square use (2,2,1) (2,2,2), (2,2,3) &amp; (2,2,4)</span>
<span class="c1"># if only two axes are defined then only two are drawn; others are left blank</span>
<span class="c1"># the way the title limits etc are used is different when subplots are used.</span>

<span class="n">f01</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>         <span class="c1"># define function and make variables x and k. </span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;function with x=2 &amp; k=5, is &#39;</span><span class="p">,</span> <span class="n">f01</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">))</span>              <span class="c1"># evaluate with x=2, k=5 , note that we used curved brackets for a function</span>

<span class="n">numx</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">maxx</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">maxx</span><span class="p">,</span><span class="n">numx</span><span class="p">)</span>         <span class="c1"># numx points in range 0 to maxx</span>

<span class="n">k</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f01</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>           <span class="c1"># plot whole function on range x with k=0.02</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f01</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;3k&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>              <span class="c1"># notice that we use set_ etc here compared to plt.xlim for just one graph</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; plot one&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; x /nm&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; amplitude&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>                     <span class="c1"># a peculiarity here as its defined differently to others</span>

<span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f01</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>             <span class="c1"># plot whole function on range x with k=-0.02</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>             <span class="c1"># notice that we use set_ etc here compared to plt.xlim for just one graph</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39; plot two, k = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>   <span class="c1"># str(k) makes a string and adds it to previous string in quotes.</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; x /nm&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39; amplitude&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>                       <span class="c1"># last plot statement note that this is plt. not an axis.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>function with x=2 &amp; k=5, is  4.5399929762484854e-05
</pre></div>
</div>
<img alt="../_images/Python crib_51_1.png" src="../_images/Python crib_51_1.png" />
</div>
</div>
</section>
<section id="numerical-integration-of-differential-equations">
<h2>15 Numerical integration of differential equations<a class="headerlink" href="#numerical-integration-of-differential-equations" title="Permalink to this headline">#</a></h2>
<p>As an example the scheme <span class="math notranslate nohighlight">\(A  \leftrightharpoons B \rightarrow C \)</span> is integrated. This is then done algebraically using sympy in lower down in the document.</p>
<p>The equations are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align} dA/dt&amp;= -k_1A +k_{-1}B \\ dB/dt&amp;= +k_1A -k_{-1}B - k_2B \\ dC/dt&amp; = k_2B \end{align}\end{split}\]</div>
<p>and the initial conditions at <span class="math notranslate nohighlight">\(t=0\)</span> are <span class="math notranslate nohighlight">\(A[0] = X_0, \; B[0] = 0.0, \; C[0] = 0.0\)</span> where <span class="math notranslate nohighlight">\(X_0\)</span> is defined in the code as the initial amount of <em>A</em> present.</p>
<p>The method by which to do this is shown in the code. (For clarity the reverse rate const is now called km1 instead of <span class="math notranslate nohighlight">\(k_{-1}\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>      <span class="c1"># import odeint used for numerical integration of differential equations</span>

<span class="n">dAdt</span><span class="o">=</span> <span class="s1">&#39;-k1*A + km1*B&#39;</span>                   <span class="c1">#  rate equations,put as strings so will not evaluate until variables defined</span>
<span class="n">dBdt</span><span class="o">=</span> <span class="s1">&#39;+k1*A -(km1+k2)*B&#39;</span>
<span class="n">dCdt</span><span class="o">=</span> <span class="s1">&#39;+k2*B&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:s}</span><span class="se">\n</span><span class="si">{:s}{:s}</span><span class="se">\n</span><span class="si">{:s}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;dAdt=&#39;</span><span class="p">,</span><span class="n">dAdt</span><span class="p">,</span><span class="s1">&#39;dBdt =&#39;</span><span class="p">,</span><span class="n">dBdt</span><span class="p">,</span><span class="s1">&#39;dCdt=&#39;</span><span class="p">,</span><span class="n">dCdt</span><span class="p">))</span>

<span class="n">k1</span> <span class="o">=</span> <span class="mf">2.0</span>                                <span class="c1">#  rate const A</span>
<span class="n">km1</span><span class="o">=</span> <span class="mf">1.0</span>                                <span class="c1">#  rate const back to A</span>
<span class="n">k2</span> <span class="o">=</span> <span class="mf">3.0</span>                                <span class="c1">#  C does not decay only forms from B</span>

<span class="n">X0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>                    <span class="c1"># initial conditions: A, B, C  concentrations</span>

<span class="k">def</span> <span class="nf">dX_dt</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">const</span><span class="p">):</span>                 <span class="c1"># returns rates dS/dt, dG/dt, dN/dt add extra terms here if necessary</span>
    <span class="n">k1</span><span class="p">,</span> <span class="n">km1</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="n">const</span>                 <span class="c1"># constants needed for calc&#39;n</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                            <span class="c1"># X[0] values of A, B ,C which are defined in equations dAdt etc.</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="nb">eval</span><span class="p">(</span><span class="n">dAdt</span><span class="p">),</span> <span class="nb">eval</span><span class="p">(</span><span class="n">dBdt</span><span class="p">),</span> <span class="nb">eval</span><span class="p">(</span><span class="n">dCdt</span><span class="p">)])</span>    <span class="c1"># make list;  could be f=[eval(dAdt,...)] </span>
                                                           <span class="c1"># but numpy is faster                                </span>
    <span class="k">return</span> <span class="n">f</span>

<span class="c1"># do calculation here</span>

<span class="n">maxt</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">numt</span> <span class="o">=</span> <span class="mi">500</span>                                      <span class="c1"># number of time points</span>

<span class="n">const</span> <span class="o">=</span><span class="p">[</span>  <span class="n">k1</span><span class="p">,</span> <span class="n">km1</span><span class="p">,</span> <span class="n">k2</span><span class="p">]</span>                          <span class="c1"># constants for calc&#39;n, must be defined bedore here</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maxt</span><span class="p">,</span>  <span class="n">numt</span> <span class="p">)</span>               <span class="c1"># time as initial, final, then number of points in array</span>

<span class="n">soln</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dX_dt</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">const</span><span class="p">,)</span> <span class="p">)</span>     <span class="c1"># solve equations</span>

<span class="n">Aval</span><span class="p">,</span> <span class="n">Bval</span> <span class="p">,</span> <span class="n">Cval</span> <span class="o">=</span> <span class="n">soln</span><span class="o">.</span><span class="n">T</span>                      <span class="c1"># extract results data the .T make the transpose </span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Aval</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Bval</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;B, k2=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k2</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Cval</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">maxt</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time /a.u.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;concentration /a.u.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
<span class="c1">#plt.savefig(&#39;abc-fig1.png&#39;)                    # save figure as png; this will overwrite same name </span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dAdt=-k1*A + km1*B
dBdt =+k1*A -(km1+k2)*B
dCdt=+k2*B
</pre></div>
</div>
<img alt="../_images/Python crib_53_1.png" src="../_images/Python crib_53_1.png" />
</div>
</div>
</section>
<section id="algebraic-solution-using-sympy">
<h2>15.1 Algebraic solution using Sympy<a class="headerlink" href="#algebraic-solution-using-sympy" title="Permalink to this headline">#</a></h2>
<p>The equations are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align} dA/dt&amp;= -k_1A +k_{-1}B \\ dB/dt&amp;= +k_1A -k_{-1}B - k_2B \\ dC/dt&amp; = k_2B \end{align}\end{split}\]</div>
<p>and to solve these it is easy to substitute one expression into the other before using the computer and so make a second order equation. C can be obtained from the conditions that if <span class="math notranslate nohighlight">\(A_0\)</span> is the initial amount <span class="math notranslate nohighlight">\(A_0= A_t + B_t + C_t \)</span> after we have found <span class="math notranslate nohighlight">\(A_t, B_t\)</span>.</p>
<p>Differentiating <em>B</em> gives</p>
<div class="math notranslate nohighlight">
\[\frac{d^2B}{dt^2}= +k_1\frac{dA}{dt} -(k_{-1}+k_2)\frac{dB}{dt} \]</div>
<p>and substituting for <span class="math notranslate nohighlight">\(dA/dt\)</span> and A so that only terms in <em>B</em> remain</p>
<div class="math notranslate nohighlight">
\[\frac{d^2B}{dt^2}+(k_1+k_{-1}+k_2)\frac{dB}{dt} +k_1k_2B =0\]</div>
<p>Using SymPy the method is shown below. First define the symbols then a function <em>B</em> and the equation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">km1</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39; k1, k2, km1, t&#39;</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>               <span class="c1"># unknown function B has t as variable</span>
<span class="n">de</span><span class="o">=</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">k1</span><span class="o">+</span><span class="n">k2</span><span class="o">+</span><span class="n">km1</span><span class="p">)</span><span class="o">*</span><span class="n">Derivative</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">k1</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">de</span> <span class="p">)</span>
<span class="n">s</span>
<span class="c1">#print(s)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_55_0.png" src="../_images/Python crib_55_0.png" />
</div>
</div>
<p>Because constants are produced it is necessary to evaluate these before any further calcuation. At <em>t</em>=0 as <em>B</em>=0 then  <span class="math notranslate nohighlight">\(C_1+C_2=0\)</span> and as the total magnitude of the signal does not matter we can set <span class="math notranslate nohighlight">\(C_1=1\)</span> and <span class="math notranslate nohighlight">\(C_2=-1\)</span>. The plot below shows the algebraic solution for <em>B</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k1</span> <span class="o">=</span> <span class="mf">2.0</span>                                <span class="c1">#  rate const A</span>
<span class="n">km1</span><span class="o">=</span> <span class="mf">1.0</span>                                <span class="c1">#  rate const back to A</span>
<span class="n">k2</span> <span class="o">=</span> <span class="mf">3.0</span>                                <span class="c1">#  C does not decay only forms from B</span>

<span class="n">maxt</span><span class="o">=</span> <span class="mf">5.0</span>
<span class="n">numt</span><span class="o">=</span> <span class="mi">500</span>                                       <span class="c1"># number of time points</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maxt</span><span class="p">,</span>  <span class="n">numt</span> <span class="p">)</span>               <span class="c1"># time as initial, final, then number of points in array</span>
<span class="n">f01</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">k1</span> <span class="o">-</span> <span class="n">k2</span> <span class="o">-</span> <span class="n">km1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k1</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="o">*</span><span class="n">km1</span> <span class="o">+</span> <span class="n">k2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="n">km1</span> <span class="o">+</span> <span class="n">km1</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> \
               <span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">k1</span> <span class="o">-</span> <span class="n">k2</span> <span class="o">-</span> <span class="n">km1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k1</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k1</span><span class="o">*</span><span class="n">km1</span> <span class="o">+</span> <span class="n">k2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="n">km1</span> <span class="o">+</span> <span class="n">km1</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">f01</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;B(t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_57_0.png" src="../_images/Python crib_57_0.png" />
</div>
</div>
</section>
<section id="reading-data-from-files-and-make-a-3d-plot-from-sdf-data">
<h2>16 Reading data from files and make a 3D plot from .sdf data<a class="headerlink" href="#reading-data-from-files-and-make-a-3d-plot-from-sdf-data" title="Permalink to this headline">#</a></h2>
<p>Python has several different ways of reading data and numpy has even more sophisticated methods.
The best way to start with is to use the script <strong><em>with open() as f:</em></strong> as shown below as this aoutmatically closes the file . Use <strong>f.readlines()</strong> get the whole lot of the data. It reads a list so may be text numbers or a mixture; it is up to you to sort this out later on.</p>
<p>The example reads an .sdf file. The first 4 lines are header, line 4 contains the number of atoms and number of connections and this is followed by x y z &amp; atom symbol and then the  connections list. If there are many lines of data the number of atoms and connections can merge so it is necessary to specifically look for this and correct for it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code to read .sdf data and plot 3D graph, xyz contains the coordinates and conect the atom connection list.</span>
<span class="c1"># jupyter cannot animate or move graphs easly if at all</span>

<span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;cyclohexane.sdf&#39;</span>                                    <span class="c1"># put in same folder as notebook as path is not shown</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Reading sdf data = &#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="p">))</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataname</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>                                   <span class="c1"># follow this style using with open() etc.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>                                        <span class="c1"># readlines reads all file &amp; makes list of strings</span>

<span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="s1">&#39; lines read&#39;</span> <span class="p">)</span> <span class="p">)</span>


<span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>                                          <span class="c1"># split data line number 4 as this contains atom numbers</span>
<span class="n">astr</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">astr</span><span class="p">)</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>                                                       <span class="c1"># max number of atoms is 999, and 999 for connections.</span>
    <span class="n">numxyz</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">astr</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>                                   <span class="c1"># note integer division</span>
    <span class="n">numc</span><span class="o">=</span>   <span class="nb">int</span><span class="p">(</span><span class="n">astr</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">numxyz</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">numc</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:4d}{:s}{:4d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;number of atoms =&#39;</span><span class="p">,</span> <span class="n">numxyz</span><span class="p">,</span> <span class="s1">&#39; number of connections =&#39;</span><span class="p">,</span> <span class="n">numc</span><span class="p">))</span>

<span class="n">xyz</span><span class="o">=</span>    <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numxyz</span><span class="p">)]</span>        <span class="c1"># coordinates  xyz[j][i]</span>
<span class="n">atm</span><span class="o">=</span>     <span class="p">[</span><span class="s1">&#39;z&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numxyz</span><span class="p">)]</span>                           <span class="c1"># atom names</span>
<span class="n">conect</span><span class="o">=</span> <span class="p">[[</span>  <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numc</span><span class="p">)]</span>          <span class="c1"># conections</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numxyz</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>                                  <span class="c1"># split list at spaces (default)</span>
    <span class="n">atm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>                                            <span class="c1"># atom symbol in posn 4 e.g Hg, Cl, O etc.</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>                               <span class="c1"># x, y z cordinates</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numc</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">numxyz</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">:</span>                                         <span class="c1"># should be 3 numbers but two may combine</span>
        <span class="n">astr</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                          <span class="c1"># 1 23 2 if small else 234567 2 if large.</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">astr</span><span class="p">)</span>
        <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">astr</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">astr</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="p">])</span>
        <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>       <span class="c1"># make #D plot </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">adict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="s1">&#39;gray&#39;</span><span class="p">}</span>     <span class="c1"># dictionary { key1: index1, key2: index2,....}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numxyz</span><span class="p">):</span>
    <span class="n">col</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span>
    <span class="k">if</span> <span class="n">atm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">adict</span><span class="p">:</span>   
        <span class="n">col</span> <span class="o">=</span> <span class="n">adict</span><span class="p">[</span><span class="n">atm</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>                                                 <span class="c1"># use colour if in dictionary else purple</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">col</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">pass</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numc</span><span class="p">):</span>
    <span class="n">indxa</span> <span class="o">=</span> <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>         <span class="c1"># -1 because list index starts at zero</span>
    <span class="n">indxb</span> <span class="o">=</span> <span class="n">conect</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xyz</span><span class="p">[</span><span class="n">indxa</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">indxb</span><span class="p">][</span><span class="mi">0</span><span class="p">]],[</span><span class="n">xyz</span><span class="p">[</span><span class="n">indxa</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">indxb</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span><span class="n">zs</span><span class="o">=</span><span class="p">[</span><span class="n">xyz</span><span class="p">[</span><span class="n">indxa</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">indxb</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">pass</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">azim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>     <span class="c1"># set view angles</span>
<span class="k">pass</span>
      
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># if you use %matplotlib notebook instead of %matplotlib inline you can rotate image etc.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reading sdf data = cyclohexane.sdf
43  lines read
number of atoms =  18 number of connections =  18
</pre></div>
</div>
<img alt="../_images/Python crib_59_1.png" src="../_images/Python crib_59_1.png" />
</div>
</div>
</section>
<section id="reading-pdb-data">
<h2>16.1 Reading pdb data<a class="headerlink" href="#reading-pdb-data" title="Permalink to this headline">#</a></h2>
<p>The code below finds the number of atoms and produces a list of coordinates. Put the .pdb into the same folder as this notebook</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;4c3c.pdb&#39;</span>                         <span class="c1"># Download data from Brookhaen site https://www.rcsb.org/</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;filename is &#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="p">)</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">get_num_atoms</span><span class="p">(</span><span class="n">astr</span><span class="p">):</span>                    <span class="c1"># find string and parse to get number of atoms, </span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">astr</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>               <span class="c1"># look for &#39;astr&#39; in whole line; if not there find returns -1</span>
        <span class="n">vals</span>  <span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>                 <span class="c1"># split at spaces </span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;looking for number of atoms &#39;</span><span class="p">,</span><span class="n">vals</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>                 <span class="c1"># from format on pdf must be number in pos&#39;n 5 (counting from 0)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>                            <span class="c1"># not found </span>

<span class="n">numatm</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataname</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>                   <span class="c1"># read lines one at a time</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">numatm</span> <span class="o">=</span> <span class="n">numatm</span> <span class="o">+</span> <span class="n">get_num_atoms</span><span class="p">(</span><span class="s1">&#39;PROTEIN ATOMS&#39;</span><span class="p">)</span>
        <span class="n">numatm</span> <span class="o">=</span> <span class="n">numatm</span> <span class="o">+</span> <span class="n">get_num_atoms</span><span class="p">(</span><span class="s1">&#39;HETEROGEN ATOMS&#39;</span><span class="p">)</span>
        <span class="n">numatm</span> <span class="o">=</span> <span class="n">numatm</span> <span class="o">+</span> <span class="n">get_num_atoms</span><span class="p">(</span><span class="s1">&#39;SOLVENT ATOMS&#39;</span><span class="p">)</span>
    <span class="k">pass</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># not necesary but for clarity</span>

<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;number of atoms is &#39;</span><span class="p">,</span><span class="n">numatm</span><span class="p">))</span>

<span class="n">coords</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">numatm</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>               <span class="c1"># use numpy to define a numatm by 3 list filled with zeros    </span>
<span class="n">atm</span><span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numatm</span><span class="p">)]</span>                        <span class="c1"># define an array </span>
<span class="n">cindx</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numatm</span><span class="p">)]</span>
<span class="n">atyp</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numatm</span><span class="p">)]</span>

<span class="c1"># now having found number of atoms go back and read data. This saves reading whole file in one go</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atom       index  separation (Angstrom)      Atom type&#39;</span><span class="p">)</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataname</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ATOM&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HETATM&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">vals</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>                    <span class="c1"># make string into real number</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
            <span class="n">atm</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span>   <span class="n">vals</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
            <span class="n">cindx</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">atyp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span>  <span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="c1">#print(&#39;{:8s} {:4d} {:12.6f} {:12.6f} {:12.6f}   {:10s}&#39;.format( vals[0], int(vals[1]), float(vals[6]), float(vals[7]), float(vals[8]), vals[11]))</span>

            <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>filename is  4c3c.pdb
looking for number of atoms  [&#39;REMARK&#39;, &#39;3&#39;, &#39;PROTEIN&#39;, &#39;ATOMS&#39;, &#39;:&#39;, &#39;1549&#39;]
looking for number of atoms  [&#39;REMARK&#39;, &#39;3&#39;, &#39;HETEROGEN&#39;, &#39;ATOMS&#39;, &#39;:&#39;, &#39;10&#39;]
looking for number of atoms  [&#39;REMARK&#39;, &#39;3&#39;, &#39;SOLVENT&#39;, &#39;ATOMS&#39;, &#39;:&#39;, &#39;165&#39;]
number of atoms is  1724
atom       index  separation (Angstrom)      Atom type
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitting-data-using-non-linear-least-squares">
<h2>17 Fitting data using non-linear least squares<a class="headerlink" href="#fitting-data-using-non-linear-least-squares" title="Permalink to this headline">#</a></h2>
<p>In the example below some noisy data is read then, with a function that is supposed to fit the function, the data is analysed. Graphs are plotted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>                                     <span class="c1"># get this to force size of graphs</span>

<span class="n">fig1</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fig1</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Curve Fitting&#39;</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>   <span class="c1"># make plots different sizes</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">eqn</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$a.\exp(- b.x^2) + c.x^2 + d$&#39;</span>                              <span class="c1">#  eqn can be printed out on graph</span>

<span class="n">fit_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="p">:</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span>   
                                        <span class="c1"># must know type of function to fit to, eval makes string into code</span>
                                        <span class="c1"># double well potential, gaussian in parabola</span>
<span class="c1"># now read in data </span>

<span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;data-to-fit.txt&#39;</span>                          <span class="c1"># put in same folder as notebook as path is not shown</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Reading data, filename used is  &#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="p">))</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dataname</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>                         <span class="c1"># follow this style using with open() etc.</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>                              <span class="c1"># readlines reads all file &amp; makes list of strings</span>

<span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{:4d}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="s1">&#39; lines read&#39;</span> <span class="p">)</span> <span class="p">)</span>

<span class="n">signal</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">tme</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">f01</span><span class="o">=</span>  <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>                             <span class="c1"># split line and get two values t and signal</span>
    <span class="n">tme</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f01</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f01</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">pass</span>

<span class="n">inits</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>                       <span class="c1"># initial values, need not be used in curve_fit</span>

<span class="n">fitP</span><span class="p">,</span> <span class="n">fitC</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit_func</span><span class="p">,</span> <span class="n">tme</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">inits</span><span class="p">)</span>  <span class="c1"># fitP are parameters, a,b,c,d , fitC are covariances</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> </span><span class="si">{:6.3f}</span><span class="s1"> </span><span class="si">{:6.3f}</span><span class="s1"> </span><span class="si">{:6.3f}</span><span class="s1"> </span><span class="si">{:6.3f}</span><span class="s1">&#39;</span><span class="o">.</span>\
      <span class="nb">format</span><span class="p">(</span><span class="s1">&#39;parameters are</span><span class="se">\n</span><span class="s1">   a       b       c    d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fitP</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">fitP</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">fitP</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Covarience Matrix </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fitC</span><span class="p">[</span><span class="n">i</span><span class="p">][:])</span>

<span class="n">the_fit</span> <span class="o">=</span> <span class="n">fit_func</span><span class="p">(</span><span class="n">tme</span><span class="p">,</span><span class="n">fitP</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fitP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">fitP</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">fitP</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">resid</span><span class="o">=</span><span class="p">[</span> <span class="p">(</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">the_fit</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">the_fit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{:s}{:8.3g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Normalised total residual squared &#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">))</span><span class="o">/</span><span class="n">num</span><span class="p">))</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tme</span><span class="p">,</span><span class="n">signal</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tme</span><span class="p">,</span><span class="n">the_fit</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x/nm&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy /cm&#39;</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;$^{-1}$&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;fitted to &#39;</span><span class="o">+</span><span class="n">eqn</span><span class="p">)</span>


<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tme</span><span class="p">,</span><span class="n">resid</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x/nm&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">)</span>

<span class="n">fig1</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reading data, filename used is  data-to-fit.txt
 200  lines read
parameters are
   a       b       c    d
 55.017  1.278  2.485 -0.701
Covarience Matrix 

[ 0.41936546  0.00318249  0.00789851 -0.12121503]
[ 0.00318249  0.00147218 -0.00056136  0.00917061]
[ 0.00789851 -0.00056136  0.00083975 -0.01018475]
[-0.12121503  0.00917061 -0.01018475  0.15947232]

Normalised total residual squared   0.0228
</pre></div>
</div>
<img alt="../_images/Python crib_63_1.png" src="../_images/Python crib_63_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of contour plotting for 2D particle in a box spatial wavefunctions</span>

<span class="n">fig1</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots, alter at will.</span>

<span class="n">ax0</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>           <span class="c1"># 1 row 2 cols in plot then ax0 is plot 1.</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>   
<span class="n">L</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>  <span class="c1"># wavefunction, qnum n at position x</span>

<span class="n">xa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">num</span><span class="p">)</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">num</span><span class="p">)</span>

<span class="n">psiT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span><span class="n">num</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span> <span class="p">)</span>
<span class="n">psiS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span><span class="n">num</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span> <span class="p">)</span>

<span class="n">Xa</span><span class="p">,</span><span class="n">Xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span><span class="n">xb</span><span class="p">)</span>              <span class="c1"># always make grid to do contour plot</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="n">psiT</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Xa</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">Xb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span><span class="n">Xb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">Xa</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">psiS</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Xa</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">Xb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span><span class="n">Xb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">Xa</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span>                      <span class="c1"># color map </span>
<span class="n">ax0</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xa</span><span class="p">,</span><span class="n">Xb</span><span class="p">,</span><span class="n">psiT</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Triplet&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xa</span><span class="p">,</span><span class="n">Xb</span><span class="p">,</span><span class="n">psiS</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Singlet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Python crib_64_0.png" src="../_images/Python crib_64_0.png" />
</div>
</div>
</section>
<section id="data-needed-for-examples-above">
<h2>18 Data needed for examples above<a class="headerlink" href="#data-needed-for-examples-above" title="Permalink to this headline">#</a></h2>
</section>
<section id="data-to-fit-txt">
<h2>‘data-to-fit.txt’<a class="headerlink" href="#data-to-fit-txt" title="Permalink to this headline">#</a></h2>
<p>remove # after copying</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#-5.0             59.854289812   </span>
<span class="c1">#-4.94974874372   58.1802931927  </span>
<span class="c1">#-4.89949748744   55.0711715581  </span>
<span class="c1">#-4.84924623116   58.3405861257  </span>
<span class="c1">#-4.79899497487   56.0883076321  </span>
<span class="c1">#-4.74874371859   53.3290150733  </span>
<span class="c1">#-4.69849246231   51.7838064825  </span>
<span class="c1">#-4.64824120603   55.2710503925  </span>
<span class="c1">#-4.59798994975   48.4442916828  </span>
<span class="c1">#-4.54773869347   51.8376658613  </span>
<span class="c1">#-4.49748743719   49.0465127074  </span>
<span class="c1">#-4.4472361809    48.0187755942  </span>
<span class="c1">#-4.39698492462   46.5301322942  </span>
<span class="c1">#-4.34673366834   50.2059520632  </span>
<span class="c1">#-4.29648241206   46.6593203961  </span>
<span class="c1">#-4.24623115578   44.5577461333  </span>
<span class="c1">#-4.1959798995    41.6161183466  </span>
<span class="c1">#-4.14572864322   44.8301013032  </span>
<span class="c1">#-4.09547738693   42.1573300155  </span>
<span class="c1">#-4.04522613065   38.7209975092  </span>
<span class="c1">#-3.99497487437   40.5125772313  </span>
<span class="c1">#-3.94472361809   37.6602429204  </span>
<span class="c1">#-3.89447236181   37.150204681  </span>
<span class="c1">#-3.84422110553   38.2822017573  </span>
<span class="c1">#-3.79396984925   35.746126679  </span>
<span class="c1">#-3.74371859296   34.8758613307  </span>
<span class="c1">#-3.69346733668   28.840409984  </span>
<span class="c1">#-3.6432160804    35.4019138298  </span>
<span class="c1">#-3.59296482412   31.1633225852  </span>
<span class="c1">#-3.54271356784   31.0986435562  </span>
<span class="c1">#-3.49246231156   26.0433200376  </span>
<span class="c1">#-3.44221105528   28.4339630025  </span>
<span class="c1">#-3.39195979899   27.1203947211  </span>
<span class="c1">#-3.34170854271   29.4839678762  </span>
<span class="c1">#-3.29145728643   24.3877353808  </span>
<span class="c1">#-3.24120603015   22.0094501915  </span>
<span class="c1">#-3.19095477387   26.4406972715  </span>
<span class="c1">#-3.14070351759   20.3370890653  </span>
<span class="c1">#-3.09045226131   19.8680580507  </span>
<span class="c1">#-3.04020100503   21.1385503497  </span>
<span class="c1">#-2.98994974874   23.706714962  </span>
<span class="c1">#-2.93969849246   20.4554585086  </span>
<span class="c1">#-2.88944723618   20.3914079471  </span>
<span class="c1">#-2.8391959799    20.4418840237  </span>
<span class="c1">#-2.78894472362   17.9712929447  </span>
<span class="c1">#-2.73869346734   19.7075282977  </span>
<span class="c1">#-2.68844221106   21.2352734198  </span>
<span class="c1">#-2.63819095477   17.542482082  </span>
<span class="c1">#-2.58793969849   18.667330437  </span>
<span class="c1">#-2.53768844221   15.9276238272  </span>
<span class="c1">#-2.48743718593   15.9312428108  </span>
<span class="c1">#-2.43718592965   9.06098812742  </span>
<span class="c1">#-2.38693467337   12.5254700504  </span>
<span class="c1">#-2.33668341709   12.9622476284  </span>
<span class="c1">#-2.2864321608    13.5685396723  </span>
<span class="c1">#-2.23618090452   7.41425227714  </span>
<span class="c1">#-2.18592964824   12.1667037172  </span>
<span class="c1">#-2.13567839196   11.0931916497  </span>
<span class="c1">#-2.08542713568   12.1111484718  </span>
<span class="c1">#-2.0351758794    13.4308647198  </span>
<span class="c1">#-1.98492462312   6.23366307584  </span>
<span class="c1">#-1.93467336683   9.64816859361  </span>
<span class="c1">#-1.88442211055   7.33582779723  </span>
<span class="c1">#-1.83417085427   10.7674491214  </span>
<span class="c1">#-1.78391959799   9.99187349798  </span>
<span class="c1">#-1.73366834171   7.58676502227  </span>
<span class="c1">#-1.68341708543   6.64575672598  </span>
<span class="c1">#-1.63316582915   11.178297747  </span>
<span class="c1">#-1.58291457286   4.20474298874  </span>
<span class="c1">#-1.53266331658   6.1709410021  </span>
<span class="c1">#-1.4824120603    4.79668508141  </span>
<span class="c1">#-1.43216080402   11.4000667759  </span>
<span class="c1">#-1.38190954774   11.2258541808  </span>
<span class="c1">#-1.33165829146   12.6423644585  </span>
<span class="c1">#-1.28140703518   8.66266769899  </span>
<span class="c1">#-1.23115577889   11.7829956142  </span>
<span class="c1">#-1.18090452261   12.649888449  </span>
<span class="c1">#-1.13065326633   14.7285848384  </span>
<span class="c1">#-1.08040201005   15.2164985858  </span>
<span class="c1">#-1.03015075377   20.2135801278  </span>
<span class="c1">#-0.97989949748   19.5302077452  </span>
<span class="c1">#-0.92964824120   18.5952356839  </span>
<span class="c1">#-0.87939698492   19.873007487  </span>
<span class="c1">#-0.82914572864   26.5176183784  </span>
<span class="c1">#-0.77889447236   25.8641839604  </span>
<span class="c1">#-0.72864321608   29.1445431593  </span>
<span class="c1">#-0.67839195979   28.3252900443  </span>
<span class="c1">#-0.62814070351   31.1448859384  </span>
<span class="c1">#-0.57788944723   36.7784493969  </span>
<span class="c1">#-0.52763819095   32.9978347324  </span>
<span class="c1">#-0.47738693467   37.9428026532  </span>
<span class="c1">#-0.42713567839   43.8161937415  </span>
<span class="c1">#-0.37688442211   47.9485495086  </span>
<span class="c1">#-0.32663316582   50.5189699383  </span>
<span class="c1">#-0.27638190954   48.4301392223  </span>
<span class="c1">#-0.22613065326   46.5524869229  </span>
<span class="c1">#-0.17587939698   51.971823943  </span>
<span class="c1">#-0.12562814070   55.373996853  </span>
<span class="c1">#-0.07537688442    54.889888555  </span>
<span class="c1">#-0.02512562814    51.476646515  </span>
<span class="c1">#0.025125628140   56.3144958669  </span>
<span class="c1">#0.075376884422   58.0827899632  </span>
<span class="c1">#0.125628140704   52.6566776805  </span>
<span class="c1">#0.175879396985   53.3848239047  </span>
<span class="c1">#0.226130653266   51.952833851  </span>
<span class="c1">#0.276381909548   49.5291849722  </span>
<span class="c1">#0.326633165829   49.9880743129  </span>
<span class="c1">#0.376884422111   45.5874144944  </span>
<span class="c1">#0.427135678392   40.862851594  </span>
<span class="c1">#0.477386934673   42.1461871315  </span>
<span class="c1">#0.527638190955   36.2426814817  </span>
<span class="c1">#0.577889447236   36.2412379181  </span>
<span class="c1">#0.628140703518   31.1194568745  </span>
<span class="c1">#0.678391959799   32.8747928811  </span>
<span class="c1">#0.72864321608    27.7905465353  </span>
<span class="c1">#0.778894472362   20.9116561963  </span>
<span class="c1">#0.829145728643   27.2232959121  </span>
<span class="c1">#0.879396984925   22.0091818428  </span>
<span class="c1">#0.929648241206   19.6359338559  </span>
<span class="c1">#0.979899497487   17.8808131284  </span>
<span class="c1">#1.03015075377    15.1549845315  </span>
<span class="c1">#1.08040201005    13.4078832391  </span>
<span class="c1">#1.13065326633    14.9723092915  </span>
<span class="c1">#1.18090452261    12.7402820072  </span>
<span class="c1">#1.23115577889    12.6779642908  </span>
<span class="c1">#1.28140703518    10.2130039923  </span>
<span class="c1">#1.33165829146    11.121922211  </span>
<span class="c1">#1.38190954774    6.60769521041  </span>
<span class="c1">#1.43216080402    11.9067562193  </span>
<span class="c1">#1.4824120603     11.338550556  </span>
<span class="c1">#1.53266331658    5.61432274929  </span>
<span class="c1">#1.58291457286    1.84320695013  </span>
<span class="c1">#1.63316582915    4.40329597508  </span>
<span class="c1">#1.68341708543    6.64204976519  </span>
<span class="c1">#1.73366834171    11.5708199553  </span>
<span class="c1">#1.78391959799    6.46697489345  </span>
<span class="c1">#1.83417085427    4.97813041772  </span>
<span class="c1">#1.88442211055    11.266523161  </span>
<span class="c1">#1.93467336683    10.6697806791  </span>
<span class="c1">#1.98492462312    8.93040002748  </span>
<span class="c1">#2.0351758794     9.86409854585  </span>
<span class="c1">#2.08542713568    8.72359819561  </span>
<span class="c1">#2.13567839196    11.9506496205  </span>
<span class="c1">#2.18592964824    11.4445941924  </span>
<span class="c1">#2.23618090452    9.19973600429  </span>
<span class="c1">#2.2864321608     15.650912152  </span>
<span class="c1">#2.33668341709    13.4897125212  </span>
<span class="c1">#2.38693467337    13.0278794093  </span>
<span class="c1">#2.43718592965    12.6098245829  </span>
<span class="c1">#2.48743718593    16.5277197273  </span>
<span class="c1">#2.53768844221    13.6027091977  </span>
<span class="c1">#2.58793969849    15.5324221186  </span>
<span class="c1">#2.63819095477    18.6648580176  </span>
<span class="c1">#2.68844221106    13.7003463854  </span>
<span class="c1">#2.73869346734    18.6656340432  </span>
<span class="c1">#2.78894472362    19.3472468302  </span>
<span class="c1">#2.8391959799     20.3302568155  </span>
<span class="c1">#2.88944723618    19.5202958812  </span>
<span class="c1">#2.93969849246    18.2578750013  </span>
<span class="c1">#2.98994974874    19.168689628  </span>
<span class="c1">#3.04020100503    23.2991267427  </span>
<span class="c1">#3.09045226131    21.2784084146  </span>
<span class="c1">#3.14070351759    23.8640500851  </span>
<span class="c1">#3.19095477387    25.9162003493  </span>
<span class="c1">#3.24120603015    24.2302051946  </span>
<span class="c1">#3.29145728643    26.7597179616  </span>
<span class="c1">#3.34170854271    27.2784154976  </span>
<span class="c1">#3.39195979899    25.3069253354  </span>
<span class="c1">#3.44221105528    26.7676958713  </span>
<span class="c1">#3.49246231156    27.133221984  </span>
<span class="c1">#3.54271356784    32.5926928722  </span>
<span class="c1">#3.59296482412    32.73068346  </span>
<span class="c1">#3.6432160804     33.4938973905  </span>
<span class="c1">#3.69346733668    29.4353395652  </span>
<span class="c1">#3.74371859296    36.9805795308  </span>
<span class="c1">#3.79396984925    34.3432884545  </span>
<span class="c1">#3.84422110553    35.515022334  </span>
<span class="c1">#3.89447236181    39.4051325332  </span>
<span class="c1">#3.94472361809    35.6274831293  </span>
<span class="c1">#3.99497487437    36.9373145527  </span>
<span class="c1">#4.04522613065    42.9629094387  </span>
<span class="c1">#4.09547738693    43.4929933753  </span>
<span class="c1">#4.14572864322    39.0826673714  </span>
<span class="c1">#4.1959798995     43.930284497  </span>
<span class="c1">#4.24623115578    42.5180750801  </span>
<span class="c1">#4.29648241206    46.1452849314  </span>
<span class="c1">#4.34673366834    47.0994754514  </span>
<span class="c1">#4.39698492462    50.7107095921  </span>
<span class="c1">#4.4472361809     48.9955359405  </span>
<span class="c1">#4.49748743719    50.3015684439  </span>
<span class="c1">#4.54773869347    52.9586025834  </span>
<span class="c1">#4.59798994975    51.2565384742  </span>
<span class="c1">#4.64824120603    57.3076705298  </span>
<span class="c1">#4.69849246231    55.8909899002  </span>
<span class="c1">#4.74874371859    55.8806209266  </span>
<span class="c1">#4.79899497487    57.0427863293  </span>
<span class="c1">#4.84924623116    60.2637609232  </span>
<span class="c1">#4.89949748744    58.1114070291  </span>
<span class="c1">#4.94974874372    60.0270837023  </span>
<span class="c1">#5.0              58.5432052976</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cyclohexane-sdf">
<h2>‘cyclohexane.sdf’<a class="headerlink" href="#cyclohexane-sdf" title="Permalink to this headline">#</a></h2>
<p>copy and paste the parts needed but remove any #</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#test CX</span>
<span class="c1">#  --CCDC--102811    3D                              </span>
<span class="c1">#</span>
<span class="c1"># 18 18  0  0  0  0  0  0  0  0999 V2000</span>
<span class="c1">#    0.7430   -1.2880   -0.2703  C     0 </span>
<span class="c1">#    1.4588   -0.0216    0.2583  C     0 </span>
<span class="c1">#    0.7158    1.2663   -0.1544  C     0 </span>
<span class="c1">#   -0.7158    1.2623    0.2638  C     0 </span>
<span class="c1">#   -1.4392    0.0337   -0.2382  C     0 </span>
<span class="c1">#   -0.7430   -1.2407    0.1609  C     0 </span>
<span class="c1">#    0.7629   -1.3083   -1.2361  H     0 </span>
<span class="c1">#    2.3504    0.0027   -0.0975  H     0 </span>
<span class="c1">#    1.5238   -0.0680    1.2151  H     0 </span>
<span class="c1">#    0.7656    1.3748   -1.1069  H     0 </span>
<span class="c1">#    1.1552    2.0183    0.2502  H     0 </span>
<span class="c1">#   -1.1471    2.0491   -0.0786  H     0 </span>
<span class="c1">#   -0.7681    1.2892    1.2222  H     0 </span>
<span class="c1">#   -1.4997    0.0758   -1.1952  H     0 </span>
<span class="c1">#   -2.3317    0.0318    0.1141  H     0 </span>
<span class="c1">#   -0.7939   -1.3433    1.1144  H     0 </span>
<span class="c1">#   -1.2072   -1.9810   -0.2378  H     0 </span>
<span class="c1">#    1.1386   -2.0189    0.0411  H     0 </span>
<span class="c1">#  2  1  1    </span>
<span class="c1">#  3  2  1    </span>
<span class="c1">#  4  3  1    </span>
<span class="c1">#  5  4  1    </span>
<span class="c1">#  6  1  1    </span>
<span class="c1">#  6  5  1    </span>
<span class="c1">#  7  1  1    </span>
<span class="c1">#  8  2  1    </span>
<span class="c1">#  9  2  1    </span>
<span class="c1"># 10  3  1    </span>
<span class="c1"># 11  3  1    </span>
<span class="c1"># 12  4  1    </span>
<span class="c1"># 13  4  1    </span>
<span class="c1"># 14  5  1    </span>
<span class="c1"># 15  5  1    </span>
<span class="c1"># 16  6  1    </span>
<span class="c1"># 17  6  1    </span>
<span class="c1"># 18  1  1</span>
<span class="c1">#M  END</span>
<span class="c1">#$$$$</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="chapter-11-q20">
<h2>Chapter 11 Q20<a class="headerlink" href="#chapter-11-q20" title="Permalink to this headline">#</a></h2>
</section>
<section id="uk-covid-deaths-txt">
<h2>‘UK-covid-deaths.txt’<a class="headerlink" href="#uk-covid-deaths-txt" title="Permalink to this headline">#</a></h2>
<p>This is a text file. Note that the data is in reverse order so will need to be reversed before using. If the data is read into <span class="math notranslate nohighlight">\(\mathtt{alldata[\,:\,]}\)</span>, then <span class="math notranslate nohighlight">\(\mathtt{revdata[\,:\,]=alldata[\,:\,:\,-1]}\)</span> will reverse it.</p>
<p>160545,
160463,
160356,
160235,
160097,
159967,
159832,
159704,
159551,
159402,
159241,
159077,
158898,
158703,
158527,
158312,
158088,
157836,
157596,
157357,
157099,
156846,
156549,
156288,
156048,
155767,
155516,
155238,
154932,
154679,
154400,
154119,
153827,
153537,
153245,
152973,
152689,
152435,
152169,
151891,
151624,
151385,
151135,
150881,
150669,
150451,
150273,
150096,
149916,
149748,
149558,
149434,
149265,
149125,
149008,
148905,
148778,
148647,
148521,
148421,
148298,
148197,
148089,
147961,
147855,
147744,
147615,
147513,
147393,
147298,
147193,
147068,
146956,
146835,
146697,
146586,
146440,
146311,
146204,
146079,
145983,
145860,
145742,
145635,
145503,
145366,
145250,
145108,
144990,
144885,
144755,
144631,
144495,
144369,
144217,
144043,
143917,
143782,
143633,
143490,
143342,
143193,
143037,
142871,
142703,
142545,
142389,
142224,
142066,
141889,
141701,
141532,
141361,
141168,
141007,
140843,
140710,
140558,
140393,
140257,
140099,
139945,
139817,
139690,
139561,
139428,
139289,
139140,
139020,
138905,
138780,
138684,
138567,
138447,
138324,
138221,
138101,
137998,
137902,
137792,
137663,
137550,
137425,
137317,
137201,
137104,
136979,
136854,
136715,
136564,
136443,
136306,
136181,
136058,
135881,
135730,
135585,
135431,
135321,
135178,
135040,
134894,
134728,
134587,
134432,
134293,
134136,
134002,
133855,
133726,
133608,
133492,
133385,
133256,
133130,
133003,
132887,
132785,
132671,
132556,
132437,
132331,
132214,
132105,
132003,
131893,
131809,
131722,
131626,
131519,
131412,
131324,
131243,
131162,
131082,
130987,
130893,
130791,
130711,
130637,
130556,
130461,
130371,
130265,
130184,
130096,
130024,
129948,
129876,
129803,
129720,
129643,
129588,
129530,
129448,
129381,
129329,
129277,
129225,
129182,
129132,
129091,
129057,
129015,
128968,
128926,
128897,
128864,
128835,
128806,
128777,
128749,
128724,
128703,
128679,
128666,
128644,
128627,
128605,
128582,
128574,
128561,
128545,
128520,
128497,
128485,
128479,
128466,
128445,
128435,
128425,
128411,
128405,
128394,
128385,
128375,
128369,
128361,
128354,
128342,
128330,
128317,
128313,
128305,
128296,
128287,
128279,
128270,
128257,
128250,
128241,
128232,
128228,
128219,
128213,
128208,
128202,
128194,
128186,
128178,
128172,
128165,
128154,
128139,
128129,
128120,
128111,
128099,
128089,
128076,
128066,
128056,
128042,
128033,
128021,
128006,
127990,
127975,
127961,
127946,
127938,
127915,
127898,
127874,
127855,
127837,
127819,
127794,
127776,
127754,
127737,
127716,
127687,
127663,
127638,
127612,
127576,
127548,
127520,
127502,
127475,
127444,
127413,
127381,
127343,
127300,
127264,
127230,
127191,
127143,
127097,
127056,
127004,
126937,
126856,
126792,
126722,
126664,
126584,
126501,
126406,
126309,
126201,
126109,
125985,
125867,
125730,
125586,
125453,
125301,
125132,
124978,
124831,
124647,
124423,
124211,
123981,
123753,
123493,
123218,
122929,
122647,
122321,
121969,
121589,
121171,
120740,
120293,
119775,
119279,
118788,
118254,
117678,
117069,
116458,
115779,
115142,
114440,
113687,
112968,
112110,
111257,
110361,
109466,
108553,
107484,
106374,
105260,
104195,
103026,
101867,
100696,
99451,
98213,
96914,
95550,
94253,
92983,
91672,
90444,
89214,
87995,
86782,
85651,
84553,
83530,
82543,
81547,
80613,
79704,
78859,
78099,
77337,
76587,
75829,
75107,
74447,
73768,
73110,
72453,
71838,
71254,
70688,
70124,
69549,
69043,
68554,
68039,
67501,
67069,
66608,
66129,
65710,
65272,
64819,
64371,
63939,
63503,
63078,
62657,
62262,
61786,
61311,
60924,
60525,
60101,
59635,
59164,
58738,
58304,
57816,
57352,
56888,
56411,
55944,
55490,
55028,
54539,
54095,
53672,
53217,
52783,
52346,
51925,
51534,
51143,
50659,
50244,
49850,
49448,
49068,
48739,
48377,
48038,
47678,
47353,
47013,
46699,
46412,
46144,
45863,
45611,
45398,
45174,
44938,
44717,
44517,
44325,
44164,
43985,
43835,
43684,
43567,
43456,
43343,
43218,
43114,
43034,
42939,
42837,
42766,
42694,
42634,
42567,
42498,
42431,
42374,
42326,
42272,
42223,
42184,
42151,
42116,
42059,
42019,
41992,
41960,
41940,
41916,
41888,
41861,
41843,
41822,
41805,
41787,
41774,
41761,
41751,
41741,
41726,
41717,
41704,
41695,
41685,
41675,
41670,
41660,
41654,
41649,
41638,
41629,
41618,
41606,
41600,
41584,
41575,
41568,
41560,
41556,
41547,
41535,
41531,
41519,
41512,
41503,
41496,
41486,
41473,
41464,
41450,
41437,
41428,
41422,
41408,
41392,
41382,
41371,
41357,
41347,
41335,
41323,
41311,
41294,
41277,
41270,
41254,
41236,
41216,
41204,
41190,
41176,
41158,
41145,
41125,
41104,
41079,
41065,
41044,
41022,
40985,
40961,
40934,
40898,
40871,
40838,
40809,
40766,
40739,
40692,
40653,
40608,
40559,
40518,
40450,
40376,
40311,
40247,
40193,
40133,
40081,
40020,
39961,
39877,
39805,
39719,
39656,
39576,
39496,
39387,
39297,
39172,
39044,
38934,
38811,
38677,
38522,
38354,
38219,
38092,
37929,
37743,
37526,
37329,
37115,
36915,
36719,
36499,
36276,
36038,
35770,
35495,
35202,
34935,
34621,
34307,
33973,
33656,
33335,
33026,
32678,
32300,
31917,
31456,
30996,
30531,
30047,
29597,
29103,
28535,
27984,
27412,
26853,
26258,
25625,
24978,
24295,
23617,
22886,
22141,
21358,
20590,
19790,
18971,
18128,
17250,
16393,
15497,
14539,
13583,
12639,
11638,
10562,
9563,
8668,
7751,
6845,
6005,
5199,
4430,
3769,
3179,
2673,
2237,
1839,
1477,
1174,
937,
751,
587,
457,
348,
275,
207,
155,
108,
76,
54,
38,
25,
17,
14,
9,
6,
6,
6,
3,
3,
1</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="chapter-13">
<h1>Chapter 13<a class="headerlink" href="#chapter-13" title="Permalink to this headline">#</a></h1>
<section id="test-data-txt">
<h2>‘test data.txt’<a class="headerlink" href="#test-data-txt" title="Permalink to this headline">#</a></h2>
<p>remove # after copying</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#200, 36.2, 1.5 </span>
<span class="c1">#220, 42.7, 1.1 </span>
<span class="c1">#240, 44.9, 1.8 </span>
<span class="c1">#260, 51.8, 0.3 </span>
<span class="c1">#280, 57.7, 2.0 </span>
<span class="c1">#300, 60.9, 0.9 </span>
<span class="c1">#320, 64.4, 1.2 </span>
<span class="c1">#340, 68.2, 1.6 </span>
<span class="c1">#360, 76.4, 1.9 </span>
<span class="c1">#380, 80.1, 0.9</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pca-data-txt">
<h2>‘PCA data.txt’<a class="headerlink" href="#pca-data-txt" title="Permalink to this headline">#</a></h2>
<p>remove # after copying</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#2.75, 6.00, -0.52 </span>
<span class="c1">#1.65, 1.75, -0.39 </span>
<span class="c1">#2.42, 7.25, -0.64 </span>
<span class="c1">#2.09, 5.50, -1.17 </span>
<span class="c1">#3.41, 7.50, -1.10 </span>
<span class="c1">#2.53, 6.75, -0.67 </span>
<span class="c1">#2.20, 4.00, -1.01 </span>
<span class="c1">#1.10, 2.75, -0.62 </span>
<span class="c1">#1.65, 4.00, -1.25 </span>
<span class="c1">#1.21, 2.25, -0.61</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exponential-data-txt">
<h2>‘exponential-data.txt’<a class="headerlink" href="#exponential-data-txt" title="Permalink to this headline">#</a></h2>
<p>remove # after copying</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1 , 1927, 1927  </span>
<span class="c1"># 5 , 1329, 1329  </span>
<span class="c1"># 9 , 812 , 812  </span>
<span class="c1"># 13, 568 , 568  </span>
<span class="c1"># 17, 390 , 390  </span>
<span class="c1"># 21, 290 , 290  </span>
<span class="c1"># 25, 171 , 171  </span>
<span class="c1"># 29, 112 , 112  </span>
<span class="c1"># 33, 87  , 87  </span>
<span class="c1"># 37, 48  , 48  </span>
<span class="c1"># 41, 43  , 43  </span>
<span class="c1"># 45, 26  , 26  </span>
<span class="c1"># 49, 26  , 26  </span>
<span class="c1"># 53, 14  , 14  </span>
<span class="c1"># 57, 13  , 13  </span>
<span class="c1"># 61, 10  , 10  </span>
<span class="c1"># 65, 6   , 6  </span>
<span class="c1"># 69, 9   , 9  </span>
<span class="c1"># 73, 8   , 8  </span>
<span class="c1"># 77, 7   , 7  </span>
<span class="c1"># 81, 3   , 3  </span>
<span class="c1"># 85, 9   , 9  </span>
<span class="c1"># 89, 5   , 5  </span>
<span class="c1"># 93, 4   , 4  </span>
<span class="c1"># 97, 8   , 8</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-14"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="chapter14-E.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">1 SI Units, Unit conversions, Scientific Constants</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../references/references-intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">15 References and index</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>