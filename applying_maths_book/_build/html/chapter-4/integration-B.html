
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’ &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 15-30" href="integration-Q15-30.html" />
    <link rel="prev" title="Questions 1-14" href="integration-Q1-14.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1 Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     1 Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     5 Trig, hyperbolic and inverse functions, waves, polar coordinates,  factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     1 Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     1 - 3.8 Differentiation, gradients &amp; basic functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     3.9 Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     4 Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     6 Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     9 Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     10 Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     11 Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     12 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="integration-intro.html">
   4 Integration.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="integration-A.html">
     1 Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-C.html">
     6 Integration and parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-D.html">
     8 Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-E.html">
     9 The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-F.html">
     10 Multiple integrals, Change of variables: Jacobians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-G.html">
     12 Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     1 Series, averages, waves, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     6 Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     8 Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     9 Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     1 Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     6 Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     8 Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     12 Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     15 Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     18 Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     21 Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     1 Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     4 Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     6 Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     7 Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     9 Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     11 Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     12 Solving equations using matrices. Eigenvectors and Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     13 Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     14 Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     15 Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     16 Principal axes and Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     1 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     4 Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     5 Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     1 Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     5 Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     7 Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     11 The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     12 The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     14 Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     1 Basics, Initial and Boundary Value problems, Steady state, Phase portrait, Chemical kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     9 First order equations &amp; Integrating factors. Second order equations, Newton’s laws and equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     12 The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     13 Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     14 Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     15 Partial Differential Equations, PDE. 1D &amp; 2D diffusion, Particle in a box, Lateral flow tests, Diffusion and Reaction, Cable equation, Algal Blooms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     16 PDE continued. Diffusion, Wave and Schroedinger eqns. Solution by the Fourier method. Transient grating.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     1 Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     4 Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     5 Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     6 The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     8 Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     9 Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     1 Monte - Carlo integration &amp; importance sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     2 Solving rate equations. The Gillespie method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     3 Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     4 Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     6 The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     1 Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     6 Modelling data. Least squares, chi squared, residuals, ANNOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     7 Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     10 Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-14/chapter14-intro.html">
   14 SI Units, Scientific Constants, unit conversion, Glossary, Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/chapter14-E.html">
     1 SI Units, Unit conversions, Scientific Constants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/Python%20crib.html">
     5 Appendix:  Some basic Python instructions with a few examples.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../references/references-intro.html">
   15 References and index
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/References.html">
     1 References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/index.html">
     2 Index
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-4/integration-B.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-4/integration-B.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-4/integration-B.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-4/integration-B.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clever-substitution-can-help-to-solve-an-integral">
   3.1 Clever substitution can help to solve an integral
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-1-trig-formulas">
   3.2 Table 1 Trig formulas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definite-integrals-with-substitution">
   3.3 Definite integrals with substitution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-reciprocal-functions">
     <strong>
      (i)
     </strong>
     Reciprocal functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-integrals-of-the-gaussian-type">
     <strong>
      (ii)
     </strong>
     Integrals of the Gaussian type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-integrals-as-products-and-ratios-of-sines-and-cosines-int-cos-n-theta-sin-m-theta-d-theta">
     <strong>
      (iii)  Integrals as products and ratios of sines and cosines
      <span class="math notranslate nohighlight">
       \(\int \cos^n(\theta)\sin^m(\theta)d\theta\)
      </span>
     </strong>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#int-cos-n-theta-sin-theta-d-theta-can-be-solved-with-the-substitution-x-cos-theta">
       <strong>
        (1)
        <span class="math notranslate nohighlight">
         \(\int \cos^n(\theta)\sin(\theta)d\theta\)
        </span>
        can be solved with the substitution
        <span class="math notranslate nohighlight">
         \(x=\cos(\theta)\)
        </span>
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#integrals-such-as-displaystyle-int-cos-4-theta-sin-3-theta-d-theta">
       <strong>
        (2) Integrals such as
        <span class="math notranslate nohighlight">
         \(\displaystyle \int \cos^4(\theta)\sin^3(\theta)d\theta \)
        </span>
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ratios-of-sine-and-cosine-e-g-displaystyle-int-frac-cos-3-theta-sin-2-theta-d-theta">
       <strong>
        (3) Ratios of sine and cosine, e.g.
        <span class="math notranslate nohighlight">
         \(\displaystyle \int \frac{\cos^3(\theta)}{\sin^2(\theta)}d\theta\)
        </span>
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-the-general-integral-int-cos-n-theta-sin-m-theta-d-theta">
     <strong>
      (iv) The general integral
      <span class="math notranslate nohighlight">
       \(\int \cos^n(\theta)\sin^m(\theta)d\theta \)
      </span>
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#three-useful-results-with-a-function-and-its-derivative">
   4 Three useful results with a function and its derivative
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integration-by-parts">
   5 Integration by parts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-displaystyle-int-x-cos-x-dx-int-x-n-sin-x-dx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int x\cos(x)dx, \int x^n\sin(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-int-x-ln-x-dx-quad-int-x-n-ln-x-dx">
     <strong>
      (ii)
      <span class="math notranslate nohighlight">
       \(\int x\ln(x)dx,\quad \int x^n\ln(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-int-e-x-sin-x-dx">
     <strong>
      (iii)
      <span class="math notranslate nohighlight">
       \(\int e^x\sin(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-an-integral-by-parts-and-recursion-displaystyle-i-n-int-x-ne-ax-dx">
     <strong>
      (iv) An integral by parts and recursion,
      <span class="math notranslate nohighlight">
       \(\displaystyle I_n=\int x^ne^{-ax}dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#v-simplifying-the-partition-function-for-the-debye-model-of-a-solid">
     <strong>
      (v) Simplifying the partition function for the Debye model of a solid
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vi-using-summation-and-by-parts-to-evaluate-the-integral-int-0-infty-frac-x-3-e-x-1-dx-from-the-debye-model">
     <strong>
      (vi)  Using summation and ‘by-parts’ to evaluate the integral
      <span class="math notranslate nohighlight">
       \(\int_0^\infty \frac{x^3}{e^x -1}dx\)
      </span>
      from the Debye model
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#small-angle-x-ray-scattering-saxs">
   5.1 Small angle x-ray scattering: SAXS
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#differentiation-under-the-integral-the-leibniz-formula">
   5.2 Differentiation under the Integral. The Leibniz formula
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples">
     <strong>
      Examples
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-int-0-pi-2-sin-t-x-dx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \(\int_0^{\pi/2}\sin(t-x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-f-t-int-0-t-2-x-1-2-dx">
     <strong>
      (ii)
      <span class="math notranslate nohighlight">
       \(F(t)=\int_0^{t^2} x^{1/2}\; dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-partition-function-and-heat-capacity-for-the-debye-model-of-a-solid">
     <strong>
      (iii) Partition function and heat capacity for the Debye model of a solid
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-int-t-t-2-e-xt-dx-using-the-full-leibniz-formula">
     <strong>
      (iv)
      <span class="math notranslate nohighlight">
       \( \int_t^{t^2} e^{xt}dx\)
      </span>
      using the full Leibniz formula
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#v-int-0-infty-e-ax-dx-frac-1-a-by-repeated-differentiation">
     <strong>
      (v)
      <span class="math notranslate nohighlight">
       \( \int_0^\infty e^{-ax}dx=\frac{1}{a}\)
      </span>
      by repeated differentiation
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vi-a-complicated-integral-i-n-int-0-1-x-t-ln-n-x-dx-solved-by-recursion">
     <strong>
      (vi) A complicated integral
      <span class="math notranslate nohighlight">
       \( I_n=\int_0^1 x^t\ln^n(x)dx\)
      </span>
      solved by recursion
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nearest-neighbour-distribution">
   5.3 Nearest Neighbour Distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definite-integrals-using-series">
   5.4 Definite integrals using series
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <strong>
      Examples
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-displaystyle-int-0-1-frac-ln-1-x-x-dx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int_0^1\frac{\ln(1+x)}{x}dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-displaystyle-int-0-1x-ln-1-x-dx">
     <strong>
      (ii)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int_0^1x\ln(1+x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-displaystyle-int-0-1-frac-sin-ln-x-ln-x-dx">
     <strong>
      (iii)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int_0^1\frac{\sin(\ln(x))}{\ln(x)}dx\)
      </span>
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluating-integrals-via-differentiation-and-feynman-s-trick">
   5.5 Evaluating integrals
   <em>
    via
   </em>
   differentiation and  ‘Feynman’s trick’
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Examples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-f-t-int-0-ln-t-e-xdx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \( F(t)= \int_0^{\ln(t)}e^xdx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-a-hard-integral-made-easier-int-0-1-x-1-ln-x-dx">
     <strong>
      (ii) A hard integral made easier:
      <span class="math notranslate nohighlight">
       \( \int_0^1(x-1)/\ln(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-the-sinc-function-sin-ax-ax">
     <strong>
      (iii) The sinc function
      <span class="math notranslate nohighlight">
       \( \sin(ax)/ax\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-harmonic-oscillator">
     <strong>
      (iv) Harmonic Oscillator
     </strong>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#i-expectation-values-and-uncertainty-principle">
       <strong>
        (i) Expectation values and uncertainty principle
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ii-average-position-and-its-uncertainty">
       <strong>
        (ii) Average position and its uncertainty
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iii-average-momentum">
       <strong>
        (iii) Average momentum
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clever-substitution-can-help-to-solve-an-integral">
   3.1 Clever substitution can help to solve an integral
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-1-trig-formulas">
   3.2 Table 1 Trig formulas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definite-integrals-with-substitution">
   3.3 Definite integrals with substitution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-reciprocal-functions">
     <strong>
      (i)
     </strong>
     Reciprocal functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-integrals-of-the-gaussian-type">
     <strong>
      (ii)
     </strong>
     Integrals of the Gaussian type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-integrals-as-products-and-ratios-of-sines-and-cosines-int-cos-n-theta-sin-m-theta-d-theta">
     <strong>
      (iii)  Integrals as products and ratios of sines and cosines
      <span class="math notranslate nohighlight">
       \(\int \cos^n(\theta)\sin^m(\theta)d\theta\)
      </span>
     </strong>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#int-cos-n-theta-sin-theta-d-theta-can-be-solved-with-the-substitution-x-cos-theta">
       <strong>
        (1)
        <span class="math notranslate nohighlight">
         \(\int \cos^n(\theta)\sin(\theta)d\theta\)
        </span>
        can be solved with the substitution
        <span class="math notranslate nohighlight">
         \(x=\cos(\theta)\)
        </span>
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#integrals-such-as-displaystyle-int-cos-4-theta-sin-3-theta-d-theta">
       <strong>
        (2) Integrals such as
        <span class="math notranslate nohighlight">
         \(\displaystyle \int \cos^4(\theta)\sin^3(\theta)d\theta \)
        </span>
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ratios-of-sine-and-cosine-e-g-displaystyle-int-frac-cos-3-theta-sin-2-theta-d-theta">
       <strong>
        (3) Ratios of sine and cosine, e.g.
        <span class="math notranslate nohighlight">
         \(\displaystyle \int \frac{\cos^3(\theta)}{\sin^2(\theta)}d\theta\)
        </span>
       </strong>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-the-general-integral-int-cos-n-theta-sin-m-theta-d-theta">
     <strong>
      (iv) The general integral
      <span class="math notranslate nohighlight">
       \(\int \cos^n(\theta)\sin^m(\theta)d\theta \)
      </span>
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#three-useful-results-with-a-function-and-its-derivative">
   4 Three useful results with a function and its derivative
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integration-by-parts">
   5 Integration by parts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-displaystyle-int-x-cos-x-dx-int-x-n-sin-x-dx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int x\cos(x)dx, \int x^n\sin(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-int-x-ln-x-dx-quad-int-x-n-ln-x-dx">
     <strong>
      (ii)
      <span class="math notranslate nohighlight">
       \(\int x\ln(x)dx,\quad \int x^n\ln(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-int-e-x-sin-x-dx">
     <strong>
      (iii)
      <span class="math notranslate nohighlight">
       \(\int e^x\sin(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-an-integral-by-parts-and-recursion-displaystyle-i-n-int-x-ne-ax-dx">
     <strong>
      (iv) An integral by parts and recursion,
      <span class="math notranslate nohighlight">
       \(\displaystyle I_n=\int x^ne^{-ax}dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#v-simplifying-the-partition-function-for-the-debye-model-of-a-solid">
     <strong>
      (v) Simplifying the partition function for the Debye model of a solid
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vi-using-summation-and-by-parts-to-evaluate-the-integral-int-0-infty-frac-x-3-e-x-1-dx-from-the-debye-model">
     <strong>
      (vi)  Using summation and ‘by-parts’ to evaluate the integral
      <span class="math notranslate nohighlight">
       \(\int_0^\infty \frac{x^3}{e^x -1}dx\)
      </span>
      from the Debye model
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#small-angle-x-ray-scattering-saxs">
   5.1 Small angle x-ray scattering: SAXS
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#differentiation-under-the-integral-the-leibniz-formula">
   5.2 Differentiation under the Integral. The Leibniz formula
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples">
     <strong>
      Examples
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-int-0-pi-2-sin-t-x-dx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \(\int_0^{\pi/2}\sin(t-x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-f-t-int-0-t-2-x-1-2-dx">
     <strong>
      (ii)
      <span class="math notranslate nohighlight">
       \(F(t)=\int_0^{t^2} x^{1/2}\; dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-partition-function-and-heat-capacity-for-the-debye-model-of-a-solid">
     <strong>
      (iii) Partition function and heat capacity for the Debye model of a solid
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-int-t-t-2-e-xt-dx-using-the-full-leibniz-formula">
     <strong>
      (iv)
      <span class="math notranslate nohighlight">
       \( \int_t^{t^2} e^{xt}dx\)
      </span>
      using the full Leibniz formula
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#v-int-0-infty-e-ax-dx-frac-1-a-by-repeated-differentiation">
     <strong>
      (v)
      <span class="math notranslate nohighlight">
       \( \int_0^\infty e^{-ax}dx=\frac{1}{a}\)
      </span>
      by repeated differentiation
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vi-a-complicated-integral-i-n-int-0-1-x-t-ln-n-x-dx-solved-by-recursion">
     <strong>
      (vi) A complicated integral
      <span class="math notranslate nohighlight">
       \( I_n=\int_0^1 x^t\ln^n(x)dx\)
      </span>
      solved by recursion
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nearest-neighbour-distribution">
   5.3 Nearest Neighbour Distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definite-integrals-using-series">
   5.4 Definite integrals using series
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <strong>
      Examples
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-displaystyle-int-0-1-frac-ln-1-x-x-dx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int_0^1\frac{\ln(1+x)}{x}dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-displaystyle-int-0-1x-ln-1-x-dx">
     <strong>
      (ii)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int_0^1x\ln(1+x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-displaystyle-int-0-1-frac-sin-ln-x-ln-x-dx">
     <strong>
      (iii)
      <span class="math notranslate nohighlight">
       \(\displaystyle \int_0^1\frac{\sin(\ln(x))}{\ln(x)}dx\)
      </span>
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluating-integrals-via-differentiation-and-feynman-s-trick">
   5.5 Evaluating integrals
   <em>
    via
   </em>
   differentiation and  ‘Feynman’s trick’
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Examples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-f-t-int-0-ln-t-e-xdx">
     <strong>
      (i)
      <span class="math notranslate nohighlight">
       \( F(t)= \int_0^{\ln(t)}e^xdx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-a-hard-integral-made-easier-int-0-1-x-1-ln-x-dx">
     <strong>
      (ii) A hard integral made easier:
      <span class="math notranslate nohighlight">
       \( \int_0^1(x-1)/\ln(x)dx\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-the-sinc-function-sin-ax-ax">
     <strong>
      (iii) The sinc function
      <span class="math notranslate nohighlight">
       \( \sin(ax)/ax\)
      </span>
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-harmonic-oscillator">
     <strong>
      (iv) Harmonic Oscillator
     </strong>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#i-expectation-values-and-uncertainty-principle">
       <strong>
        (i) Expectation values and uncertainty principle
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ii-average-position-and-its-uncertainty">
       <strong>
        (ii) Average position and its uncertainty
       </strong>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#iii-average-momentum">
       <strong>
        (iii) Average momentum
       </strong>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">init_printing</span><span class="p">()</span>                         <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="integration-by-substitution-and-by-parts-differentiation-and-the-leibniz-formula-feynman-s-trick">
<h1>3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’<a class="headerlink" href="#integration-by-substitution-and-by-parts-differentiation-and-the-leibniz-formula-feynman-s-trick" title="Permalink to this headline">#</a></h1>
<section id="clever-substitution-can-help-to-solve-an-integral">
<h2>3.1 Clever substitution can help to solve an integral<a class="headerlink" href="#clever-substitution-can-help-to-solve-an-integral" title="Permalink to this headline">#</a></h2>
<p>It may appear at first that if an integral is not in a standard form then it cannot be solved - not so! The purpose of substitution is to convert the integral into a standard and therefore simpler form whose solution is known. Choosing a substitution is rather an art and some trial and error is usually required. However, just as in football, a clever substitution can produce the required result.</p>
<p>There are three parts to the method, which will be illustrated with <span class="math notranslate nohighlight">\(\displaystyle\int \sin^2(x)\cos(x)dx\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(1)</strong> Change a complex expression in <span class="math notranslate nohighlight">\(x\)</span> into a simpler one in another variable <span class="math notranslate nohighlight">\(u\)</span> by a substitution,</p>
<p><span class="math notranslate nohighlight">\(\qquad\)</span> For example, <span class="math notranslate nohighlight">\(\sin^2(x)\cos(x)\)</span> is simplified with <span class="math notranslate nohighlight">\(u = \cos(x)\)</span> to <span class="math notranslate nohighlight">\((1 - u^2)u\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(2)</strong> Workout <span class="math notranslate nohighlight">\(dx\)</span> as an expression in <span class="math notranslate nohighlight">\(du\)</span>. In our example, <span class="math notranslate nohighlight">\(du=-\sin(x)dx\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(3)</strong> Change all limits to the new variable.</p>
<p>The usage of <span class="math notranslate nohighlight">\(du\)</span> and <span class="math notranslate nohighlight">\(dx\)</span> as independent entities in themselves in step (2) appears to be different to that of <span class="math notranslate nohighlight">\(du/dx\)</span>, which has previously been used as a ratio. However, it is quite permissible to use <span class="math notranslate nohighlight">\(du\)</span> and <span class="math notranslate nohighlight">\(dx\)</span> and so forth on their own, provided their ratio could still be made by rearranging the equation.</p>
<p>As a rule of thumb with complicated sine and cosine expressions, try sine and cosine substitutions. If you are lucky, your first guess may be the correct one; if not, try again.</p>
<p>Start by guessing that the substitution <span class="math notranslate nohighlight">\(u = \cos(x)\)</span> might work, therefore <span class="math notranslate nohighlight">\(\displaystyle \frac{du}{dx}=-\sin(x)\)</span> or <span class="math notranslate nohighlight">\(dx=-du/\sin(x)\)</span>. Next substituting for <span class="math notranslate nohighlight">\(\cos(x)\)</span> and <span class="math notranslate nohighlight">\(dx\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \sin^2(x)\cos(x)dx = -\int \sin(x)udu = -\int \sqrt{(1 - u^2)}udu\]</div>
<p>and in the last step <span class="math notranslate nohighlight">\(\cos^2(x) + \sin^2(x) = 1\)</span> was used. Notice that no integration has yet been performed, just the substitutions. However, this last integral looks as if it might be possible but it is still a bit complicated, so instead of persevering it is easier to try again and see if a better result is possible. You can always return to this result if necessary. As a second try, substitute <span class="math notranslate nohighlight">\(u = \sin(x)\)</span> and then <span class="math notranslate nohighlight">\(du = \cos(x)dx\)</span> and this turns out to be far simpler:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\sin^2(x)\cos(x)dx=\int u^3du=\frac{u^3}{3}=\frac{\sin^3(x)}{3}\]</div>
<p>Using the right-angled triangle it is possible to substitute trigonometric functions for algebraic ones and vice versa. The triangles and their corresponding trig relationships are shown in table 1.</p>
<p>Consider the integral <span class="math notranslate nohighlight">\(\displaystyle \int \frac{x^2}{\sqrt{4-x^2}}dx\)</span>. The substitution <span class="math notranslate nohighlight">\(\tan(\theta)=x/\sqrt{a^2-x^2}\)</span> with <span class="math notranslate nohighlight">\(a=2\)</span> is appealing. However, when differentiated to substitute <span class="math notranslate nohighlight">\(d\theta\)</span> for <span class="math notranslate nohighlight">\(dx\)</span> it  produces a horrible result. Trying <span class="math notranslate nohighlight">\(\cos(\theta)=\sqrt{ 2^2-x^2}/2\)</span> instead proves to be a good starting place because when differentiated <span class="math notranslate nohighlight">\(d\theta\)</span> produces a reciprocal square root that cancels with that in the integral. Differentiating gives <span class="math notranslate nohighlight">\(2\sin(\theta)d\theta = x/\sqrt{4 - x^2}dx\)</span> changing the integral into</p>
<div class="math notranslate nohighlight">
\[\displaystyle 2\int\sin(x)xd\theta =4\int\sin(\theta)\sqrt{1-\cos^2(\theta)} d\theta=4\int\sin^2(\theta)d\theta\]</div>
<p>This is now a standard form and can be converted to an exponential form (or looked up in Section 4.2.13) and then converted back to <span class="math notranslate nohighlight">\(x\)</span> using trig functions.</p>
<div class="math notranslate nohighlight">
\[4\int\sin^2(\theta)d\theta = 2\theta -2\sin(\theta)\cos(\theta)+c=2\sin^{-1}\left(\frac{x}{2}\right)-\frac{x}{2}\sqrt{4-x^2}+c\]</div>
</section>
<hr class="docutils" />
<section id="table-1-trig-formulas">
<h2>3.2 Table 1 Trig formulas<a class="headerlink" href="#table-1-trig-formulas" title="Permalink to this headline">#</a></h2>
<p><img alt="Drawing" src="../_images/integration-table1.png" /></p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{l|l|l}
\hline
\displaystyle \sin(\theta)=\frac{x}{a} &amp; \displaystyle \sin(\theta)=\frac{\sqrt{x^2-a^2}}{x} &amp; \displaystyle \sin(\theta)=\frac{x}{\sqrt{x^2+a^2}}  \\
\displaystyle \cos(\theta)=\frac{\sqrt{x^2-a^2}}{a} &amp; \displaystyle \cos(\theta)=\frac{a}{x} &amp;\displaystyle \cos(\theta)=\frac{a}{\sqrt{a^2+x^2}}  \\
\displaystyle \tan(\theta)=\frac{x}{\sqrt{a^2-x^2}} &amp;\displaystyle \tan(\theta)=\frac{\sqrt{x^2-a^2}}{a}&amp;\displaystyle \tan(\theta)=\frac{x}{a} \\
\hline \end{array}\end{split}\]</div>
</section>
<section id="definite-integrals-with-substitution">
<h2>3.3 Definite integrals with substitution<a class="headerlink" href="#definite-integrals-with-substitution" title="Permalink to this headline">#</a></h2>
<p>When calculating a definite integral first evaluate the indefinite integral and then using the limits, work out the final value. If a substitution is made it is also <em>necessary to change the limits</em>, thus making it unnecessary to reverse the substitution to obtain the result.</p>
<section id="i-reciprocal-functions">
<h3><strong>(i)</strong> Reciprocal functions<a class="headerlink" href="#i-reciprocal-functions" title="Permalink to this headline">#</a></h3>
<p>Suppose the integral is <span class="math notranslate nohighlight">\(\displaystyle \int_2^8 \frac{3}{(1+2x)^3}dx\)</span>, trying the substitution <span class="math notranslate nohighlight">\(u = 1 + 2x\)</span> seems an obvious choice and therefore <span class="math notranslate nohighlight">\(dx = du/2\)</span>. The limits are <span class="math notranslate nohighlight">\(x = 2\)</span> and  8, which become <span class="math notranslate nohighlight">\(u = 5\)</span> and <span class="math notranslate nohighlight">\(17\)</span> in the new variable, making the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_5^{17}\frac{3}{2u^2}du = -\frac{3}{2u}\bigg|_5^{17} =\frac{18}{85}\]</div>
<p>Alternatively, calculate the integral leaving out the limits to begin with, then convert back to <span class="math notranslate nohighlight">\(x\)</span> and then use the original limits;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\frac{3}{2u^2}du = -\frac{3}{2u} \equiv \frac{3}{2(1+2x))}\bigg|_2^{8}\]</div>
</section>
<section id="ii-integrals-of-the-gaussian-type">
<h3><strong>(ii)</strong> Integrals of the Gaussian type<a class="headerlink" href="#ii-integrals-of-the-gaussian-type" title="Permalink to this headline">#</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty e^{-ax^2/2+bx}dx\]</div>
<p>often occur in quantum problems. The solution to the simpler integral is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty e^{-ax^2/2}dx=\sqrt{2\pi/a}\]</div>
<p>and with a substitution we can solve the more complex integral.</p>
<p>The first step is to ‘complete the square’ which means converting <span class="math notranslate nohighlight">\(-ax^2/2+bx\)</span> into a quadratic. A general quadratic is <span class="math notranslate nohighlight">\(ax^2+bx+c\)</span> and this is changed to  <span class="math notranslate nohighlight">\(a(x-h)^2+k\)</span> where <span class="math notranslate nohighlight">\(h=-b/a, k=c-b^2/4a\)</span>.</p>
<p>In our example <span class="math notranslate nohighlight">\(\displaystyle \frac{-a}{2}x^2+bx \to -\frac{a}{2}\left(x-\frac{b}{a}\right)^2+\frac{b^2}{2a}\)</span>, which means the integral becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty  e^{-a(x-b/a)^2+b^2/2a} dx\]</div>
<p>which is a little simpler and now allows us to make a substitution such as <span class="math notranslate nohighlight">\(z=x-b/a, dz=dx\)</span> and so</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\int_{-\infty}^\infty  e^{-a(x-b/a)^2+b^2/2a} dx &amp;= e^{b^2/2a}\int_{-\infty}^\infty  e^{-az^2/2} dz\\&amp;=\sqrt{\frac{2\pi}{a}}e^{b^2/2a}\end{align}\end{split}\]</div>
</section>
<section id="iii-integrals-as-products-and-ratios-of-sines-and-cosines-int-cos-n-theta-sin-m-theta-d-theta">
<h3><strong>(iii)  Integrals as products and ratios of sines and cosines  <span class="math notranslate nohighlight">\(\int \cos^n(\theta)\sin^m(\theta)d\theta\)</span></strong><a class="headerlink" href="#iii-integrals-as-products-and-ratios-of-sines-and-cosines-int-cos-n-theta-sin-m-theta-d-theta" title="Permalink to this headline">#</a></h3>
<p>The integral <span class="math notranslate nohighlight">\(\int \cos^n(\theta)\sin^m(\theta)d\theta \)</span> can be found when <span class="math notranslate nohighlight">\(n\)</span> or <span class="math notranslate nohighlight">\(m\)</span> or both is an odd number. If the index of the sine is odd let <span class="math notranslate nohighlight">\(x=\cos(\theta)\)</span>, if the index of cosine is odd let <span class="math notranslate nohighlight">\(x=\sin(\theta)\)</span>. If <span class="math notranslate nohighlight">\(n+m\)</span> is a negative even integer then the integral can also be found. This was illustrated above. When <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span> are both even the integral becomes very difficult and then using computer algebra is by far the quickest way to arrive at at solution.</p>
<section id="int-cos-n-theta-sin-theta-d-theta-can-be-solved-with-the-substitution-x-cos-theta">
<h4><strong>(1) <span class="math notranslate nohighlight">\(\int \cos^n(\theta)\sin(\theta)d\theta\)</span> can be solved with the substitution <span class="math notranslate nohighlight">\(x=\cos(\theta)\)</span></strong><a class="headerlink" href="#int-cos-n-theta-sin-theta-d-theta-can-be-solved-with-the-substitution-x-cos-theta" title="Permalink to this headline">#</a></h4>
<p>The integrals <span class="math notranslate nohighlight">\(\int \cos^n(\theta)\sin(\theta)d\theta\)</span> can be solved with the substitution <span class="math notranslate nohighlight">\(x=\cos(\theta)\)</span> and so <span class="math notranslate nohighlight">\(dx=-\sin(\theta)d\theta\)</span>,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \cos^n(\theta)\sin(\theta)d\theta \to -\int x^n dx = \frac{x^{n+1}}{n+1}+c\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is a positive integer and <span class="math notranslate nohighlight">\(c\)</span> a constant. With the definite integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\pi \cos^n(\theta)\sin(\theta)d\theta \to  -\frac{x^{n+1}}{n+1}\bigg|_1^{-1}=-\frac{\cos^{n+1}(\theta)}{n+1}\bigg|_0^\pi\]</div>
<p>the range can be found using <span class="math notranslate nohighlight">\(\theta=0, x=1,\; \theta=\pi, x=-1\)</span> or by substituting for <span class="math notranslate nohighlight">\(x\)</span> directly either way</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\pi \cos^n(\theta)\sin(\theta)d\theta =\frac{(-1)^n +1}{n+1}\]</div>
<p>making all the integrals zero for odd <span class="math notranslate nohighlight">\(n\)</span>.</p>
</section>
<section id="integrals-such-as-displaystyle-int-cos-4-theta-sin-3-theta-d-theta">
<h4><strong>(2) Integrals such as <span class="math notranslate nohighlight">\(\displaystyle \int \cos^4(\theta)\sin^3(\theta)d\theta \)</span></strong><a class="headerlink" href="#integrals-such-as-displaystyle-int-cos-4-theta-sin-3-theta-d-theta" title="Permalink to this headline">#</a></h4>
<p>Again let <span class="math notranslate nohighlight">\(x=\cos(\theta)\)</span> then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \cos^4(\theta)\sin^3(\theta)d\theta =-\int x^4(\theta)\sin^2(\theta)dx \]</div>
<p>Use <span class="math notranslate nohighlight">\(\sin^2(\theta)=1-\cos^2(\theta)\)</span> to make the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle -\int (x^4-x^6) dx=-\frac{x^5}{5}+\frac{x^7}{7}=-\frac{\cos^5{\theta}}{5}+\frac{\cos^7{\theta}}{7}+c\]</div>
</section>
<section id="ratios-of-sine-and-cosine-e-g-displaystyle-int-frac-cos-3-theta-sin-2-theta-d-theta">
<h4><strong>(3) Ratios of sine and cosine, e.g.  <span class="math notranslate nohighlight">\(\displaystyle \int \frac{\cos^3(\theta)}{\sin^2(\theta)}d\theta\)</span></strong><a class="headerlink" href="#ratios-of-sine-and-cosine-e-g-displaystyle-int-frac-cos-3-theta-sin-2-theta-d-theta" title="Permalink to this headline">#</a></h4>
<p>With the substitution <span class="math notranslate nohighlight">\(x=\sin(\theta), dx=\cos(\theta)d\theta\)</span> the integral becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \frac{1-x^2}{x^2}dx=\int \left(\frac{1}{x^2}-1\right)dx=-\frac{1}{x}-x=-\frac{1}{\sin(\theta)}-\sin(\theta)+c\]</div>
</section>
</section>
<section id="iv-the-general-integral-int-cos-n-theta-sin-m-theta-d-theta">
<h3><strong>(iv) The general integral <span class="math notranslate nohighlight">\(\int \cos^n(\theta)\sin^m(\theta)d\theta \)</span></strong><a class="headerlink" href="#iv-the-general-integral-int-cos-n-theta-sin-m-theta-d-theta" title="Permalink to this headline">#</a></h3>
<p>The general integral <span class="math notranslate nohighlight">\(\int \cos^n(\theta)\sin^m(\theta)d\theta \)</span> is hard to integrate whe the conditions given above do not apply, but can be done by iteration which means finding a reduction formula. The method is to start with another related function, differentiate it then integrate the result. The integral we require will then appear in terms of a new function and a new integral that can usually be solved easily. If this is not the case then the process can be repeated until a solvable integral appears.</p>
<p>Start by differentiating</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}&amp;\frac{d}{d\theta}\left(\cos^{n-1}(\theta)\sin^{m+1}(\theta) \right)\\&amp;
=(n-1)\cos^{n-2}(\theta)(-\sin(\theta)\sin^{m+1}(\theta)+(m+1)\sin^m(\theta)\cos(\theta)\cos^{n-1}(\theta)\\&amp; =-(n-1)\cos^{n-2}(\theta)\sin^m(\theta)+(m+n)\sin^m(\theta)\cos^n(\theta)\end{align}\end{split}\]</div>
<p>where to get to the second step involves several manipulations.  Integrating we get <span class="math notranslate nohighlight">\(\cos^{n-1}(\theta)\sin^{m+1}(\theta)\)</span> and rearranging produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \cos^n(\theta)\sin^m(\theta)d\theta=\frac{\cos^{n-1}(\theta)\sin^{m+1}(\theta)}{n+m}+\frac{n-1}{m+n}\int \cos^{n-2}(\theta)\sin^m(\theta)d\theta\]</div>
<p>As an example, let the rather tricky integral be <span class="math notranslate nohighlight">\(\displaystyle \int \cos^2(\theta)\sin^2(\theta)d\theta\)</span> in this case <span class="math notranslate nohighlight">\(m=n=2\)</span> and so the solution is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \cos^2(\theta)\sin^2(\theta)d\theta=\frac{\cos(\theta)\sin^{3}(\theta)}{4}+\frac{1}{4}\int \sin^2(\theta)d\theta\]</div>
<p>and the remaining integral is given above as <span class="math notranslate nohighlight">\(\displaystyle \frac{1}{2}(\theta -\sin(\theta)\cos(\theta))\)</span> and using identities for <span class="math notranslate nohighlight">\(\sin(2\theta)\)</span> and <span class="math notranslate nohighlight">\(\cos(2\theta)\)</span> and after some manipulation gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \cos^2(\theta)\sin^2(\theta)d\theta=\frac{\theta}{8}-\frac{\sin(2\theta)\cos(2\theta)}{16}\]</div>
<p>If the integral was <span class="math notranslate nohighlight">\(\displaystyle \int \cos^4(\theta)\sin^2(\theta)d\theta\)</span> then we would find that we needed the integral <span class="math notranslate nohighlight">\(\displaystyle \int \cos^2(\theta)\sin^2(\theta)d\theta\)</span> which we have just found.</p>
</section>
</section>
<section id="three-useful-results-with-a-function-and-its-derivative">
<h2>4 Three useful results with a function and its derivative<a class="headerlink" href="#three-useful-results-with-a-function-and-its-derivative" title="Permalink to this headline">#</a></h2>
<p>Integrals where the function in the numerator is the derivative of the function in the
denominator, evaluate to logs. For example,</p>
<div class="math notranslate nohighlight">
\[\displaystyle I=\int\frac{f'(x)}{f(x)}dx =\ln(|f(x)|) +c  \qquad\tag{12}\]</div>
<p>where <span class="math notranslate nohighlight">\(f'(x)\)</span> is the derivative of <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(c\)</span> is the constant of integration. The symbols <span class="math notranslate nohighlight">\(| \;|\)</span> indicate that the absolute value of the function must be taken because the log of a negative number is not permissible.</p>
<p>This result can be demonstrated by substitution of <span class="math notranslate nohighlight">\(u = f(x)\)</span> then <span class="math notranslate nohighlight">\(du = f '(x)dx\)</span> into equation 12 giving</p>
<div class="math notranslate nohighlight">
\[I=\int\frac{du}{u}=\ln(u) = \ln(|f(x)|)+c\]</div>
<p>and this result is not surprising when recalling the differential of <span class="math notranslate nohighlight">\(\ln( f (x))\)</span>. A second example is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \frac{1}{\tan(x)}dx=\int \cot(x)dx = \int\frac{\cos(x)}{\sin(x)}=\ln(|\sin(x)|)+c\]</div>
<p>The cosine is the derivative of the sine, and the absolute value is taken because the sine is negative for some values of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Related to equation 12 is the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\frac{f'(x)}{\sqrt{f(x)}}dx=2\sqrt{f(x)}+c  \qquad\tag{13}\]</div>
<p>and this can be verified by letting <span class="math notranslate nohighlight">\(f (x) = u\)</span> and differentiating <span class="math notranslate nohighlight">\(f (x) + c\)</span>. Try this and then integrate both sides of the equation.</p>
<p>The third equation involves a function and its derivative and is the product,</p>
<div class="math notranslate nohighlight">
\[\displaystyle I=\int f(x)f'(x)dx=\frac{1}{2}f(x)^2+c . \qquad\tag{14}\]</div>
<p>Notice that the function is written first, for example,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \cos(x)\sin(x)dx=-\frac{1}{2}\cos^2(x) +c\]</div>
<p>where the function is <span class="math notranslate nohighlight">\(\cos(x)\)</span>. Of course, the integral in this particular case could have been written the other way round. The result would then be <span class="math notranslate nohighlight">\(\displaystyle \int\sin(x)\cos(x)dx=-\frac{1}{2}\sin^2(x) +c\)</span> but because <span class="math notranslate nohighlight">\(\cos^2(x)+\sin^2(x)=1\)</span> this is the same result if the <span class="math notranslate nohighlight">\(1\)</span> is added to the arbitrary constant <span class="math notranslate nohighlight">\(c\)</span>.</p>
</section>
<section id="integration-by-parts">
<h2>5 Integration by parts<a class="headerlink" href="#integration-by-parts" title="Permalink to this headline">#</a></h2>
<p>Very often the products of two functions must be integrated and one way of doing this is to use ‘integration by parts’. Integration by parts is a major tool to integrate seemingly difficult expressions.</p>
<p>In differentiating products of functions (Chapter 3.5.1), such as <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> where <em>each is itself a function of</em> <span class="math notranslate nohighlight">\(x\)</span>, we used the equation,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d}{dx}uv =u\frac{dv}{dx}+v\frac{du}{dx}  \qquad\tag{15}\]</div>
<p>Integrating this equation gives</p>
<div class="math notranslate nohighlight">
\[ uv = \int u\frac{dv}{dx}+\int v\frac{du}{dx}  \qquad \text{or} \qquad uv=\int udv+\int vdu \]</div>
<p>and rearranging gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int u\,dv= u\,v -\int v\,du  \qquad\tag{16}\]</div>
<p>which is the <em>integration by parts</em> formula. This reads:</p>
<p><strong><span class="math notranslate nohighlight">\(\qquad\)</span>   The integral of <span class="math notranslate nohighlight">\(udv\)</span> is <span class="math notranslate nohighlight">\(u\)</span> times the integral of <span class="math notranslate nohighlight">\(dv\)</span>, which is <span class="math notranslate nohighlight">\(v\)</span>, minus the integral of <span class="math notranslate nohighlight">\(v\)</span> times the derivative of <span class="math notranslate nohighlight">\(u\)</span>.</strong></p>
<p>The trick is to find <span class="math notranslate nohighlight">\(u\)</span> that can be differentiated, which is usually easy, and <span class="math notranslate nohighlight">\(v\)</span> that can be integrated, which is sometimes much harder. It is worth exchanging <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> if the resulting integration gets more complicated.</p>
<p>A few examples should make this important method clearer.</p>
<section id="i-displaystyle-int-x-cos-x-dx-int-x-n-sin-x-dx">
<h3><strong>(i) <span class="math notranslate nohighlight">\(\displaystyle \int x\cos(x)dx, \int x^n\sin(x)dx\)</span></strong><a class="headerlink" href="#i-displaystyle-int-x-cos-x-dx-int-x-n-sin-x-dx" title="Permalink to this headline">#</a></h3>
<p>To solve <span class="math notranslate nohighlight">\(\displaystyle \int x\cos(x)dx\)</span> using equation 16</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(1)</strong> Start by trying <span class="math notranslate nohighlight">\(u=x\)</span> and <span class="math notranslate nohighlight">\(dv=\cos(x)dx\)</span></p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(2)</strong> To find <span class="math notranslate nohighlight">\(uv\)</span>, integrate <span class="math notranslate nohighlight">\(v=\cos(x)dx\)</span> to <span class="math notranslate nohighlight">\(v=\sin(x)\)</span> and then multiply this by <span class="math notranslate nohighlight">\(u\equiv x\)</span>, making <span class="math notranslate nohighlight">\(uv=x\sin(x)\)</span></p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(3)</strong> Form the <span class="math notranslate nohighlight">\(vdu\)</span> integral by differentiating <span class="math notranslate nohighlight">\(u\)</span> giving <span class="math notranslate nohighlight">\(du\equiv dx=1 \)</span> and multiply by <span class="math notranslate nohighlight">\(v=\sin(x)\)</span> to give <span class="math notranslate nohighlight">\(\int vdu =\int \sin( x)dy\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span><strong>(4)</strong> ) Combining these terms gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int x\cos(x)dx=x\sin(x)-\int \sin(x)dx = x\sin(x)+\cos(x)+c\]</div>
<p>In the case of a definite integral, such as <span class="math notranslate nohighlight">\(\int_a^bx\sin(x)dx\)</span> the result becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_a^b x\cos(x)dx=x\sin(x)\bigg|_a^b-\int_a^b \sin(x)dx = x\sin(x)\bigg|_a^b+\cos(x)\bigg|_a^b\]</div>
<p>In cases such as <span class="math notranslate nohighlight">\(\int x^n\cos(x)dx\)</span> or <span class="math notranslate nohighlight">\(\int x^n\sin(x)dx\)</span> the process can be repeated but it can be rather laborious, for example with <span class="math notranslate nohighlight">\(\int x^2\sin(x)dx\)</span> choose <span class="math notranslate nohighlight">\(u=x^2\)</span> so that when it is repeatedly differentiated it will eventually become a constant, <span class="math notranslate nohighlight">\(n!\)</span>.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int x^2\sin(x)dx=-x^2\cos(x)+2\int x\cos(x)dx\]</div>
<p>and integrating again gives <span class="math notranslate nohighlight">\(\displaystyle \int x\cos(x)dx=x\sin(x)-\int \sin(x)dx\)</span>, and combining gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int x^2\sin(x)dx=-x^2\cos(x)+2x\sin(x)+2\cos(x) +c\]</div>
</section>
<section id="ii-int-x-ln-x-dx-quad-int-x-n-ln-x-dx">
<h3><strong>(ii) <span class="math notranslate nohighlight">\(\int x\ln(x)dx,\quad \int x^n\ln(x)dx\)</span></strong><a class="headerlink" href="#ii-int-x-ln-x-dx-quad-int-x-n-ln-x-dx" title="Permalink to this headline">#</a></h3>
<p>The integral <span class="math notranslate nohighlight">\(\int x\ln(x)dx\)</span> can be evaluated by parts if <span class="math notranslate nohighlight">\(u=\ln(x)\)</span> and <span class="math notranslate nohighlight">\(dv=xdx\)</span>, producing</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int x\ln(x)=\ln(x)\frac{x^2}{2}-\frac{1}{2}\int\frac{1}{x}x^2dx =\ln(x)\frac{x^2}{2}-\frac{x^2}{4}+c\]</div>
<p>with <span class="math notranslate nohighlight">\(c\)</span> as the integration constant. Trying this integral the other way round with <span class="math notranslate nohighlight">\(u = x\)</span>, and <span class="math notranslate nohighlight">\(dv = \ln(x)dx\)</span> is more difficult because to obtain t we have to know the integral of <span class="math notranslate nohighlight">\(\ln(x)\)</span>. This can be looked up and is <span class="math notranslate nohighlight">\(x\ln(x) - x\)</span>, and has to be integrated again in the next step.</p>
<div class="math notranslate nohighlight">
\[\int x\ln(x)dx=x(x\ln(x)-x) -\int (x\ln(x)-x)dx\]</div>
<p>What has happened here is that the original integral is produced on the right, making the
method recursive in this instance. Rearranging gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle 2\int x\ln(x)dx=x(x\ln(x)-x)+\int x dx= \ln(x)x^2-\frac{x^2}{2}+c\]</div>
<p>which is the same result as by the first method when both sides are divided by two.</p>
<p>The integral <span class="math notranslate nohighlight">\(\int x^n\ln(x) dx\)</span> is also solved by parts and is no harder. let <span class="math notranslate nohighlight">\(u=ln(x)\)</span> and <span class="math notranslate nohighlight">\(dv=x^ndx\)</span> then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle\begin{align} \int x^n\ln(x)dx&amp;= \ln(x)\frac{n^{n+1}}{n+1}-\int \frac{x^{n+1}}{(n+1)}\frac{1}{x}dx+c\\ &amp;=\ln(x)\frac{x^{n+1}}{n+1}-\frac{x^{n+1}}{(n+1)^2}+c\\&amp;=\frac{x^{n+1}(\ln(x^{n+1})-1)  }{(n+1)^2}+c\end{align}\end{split}\]</div>
<p>The integral <span class="math notranslate nohighlight">\(\int x\ln(x)^n dx\)</span> is much more difficult and produces a result using the incomplete gamma function, but the integral  <span class="math notranslate nohighlight">\(\displaystyle\int x\ln(x)^2 dx =\ln(x)^2\frac{x^2}{2}-\int x\ln(x)dx\)</span> and so we can use our previous result and so on for higher log powers in a recursive manner, see 5.2(vi) below.</p>
</section>
<section id="iii-int-e-x-sin-x-dx">
<h3><strong>(iii) <span class="math notranslate nohighlight">\(\int e^x\sin(x)dx\)</span></strong><a class="headerlink" href="#iii-int-e-x-sin-x-dx" title="Permalink to this headline">#</a></h3>
<p>Sometimes successive integration is necessary, as with <span class="math notranslate nohighlight">\(\int e^x\sin(x)dx\)</span>. To integrate this function let <span class="math notranslate nohighlight">\(u = e^x\)</span> and <span class="math notranslate nohighlight">\(dv = \sin(x)dx\)</span>. This produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int e^x\sin(x)dx=-e^x\cos(x)+\int e^x\cos(x)dx \]</div>
<p>It is then necessary to perform the right-hand integration in a similar way, giving</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int e^x\cos(x)dx=e^x\sin(x)-\int e^x\sin(x)dx \]</div>
<p>By substituting this into the first result gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int e^x\sin(x)dx=-e^x\cos(x)+e^x\sin(x)-\int e^x\sin(x)dx\]</div>
<p>which, after rearranging, is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int e^x\sin(x)dx=-\frac{e^x}{2}\big(\sin(x)-\cos(x)\big)+c\]</div>
<p>As a check, differentiate the result. Notice that the integral could more easily be solved by converting the sine to its exponential form. It is often, but not always the case, that more than one method could be used to solve an integral. Which you choose depends on your particular liking for one method over another.</p>
</section>
<section id="iv-an-integral-by-parts-and-recursion-displaystyle-i-n-int-x-ne-ax-dx">
<h3><strong>(iv) An integral by parts and recursion, <span class="math notranslate nohighlight">\(\displaystyle I_n=\int x^ne^{-ax}dx\)</span></strong><a class="headerlink" href="#iv-an-integral-by-parts-and-recursion-displaystyle-i-n-int-x-ne-ax-dx" title="Permalink to this headline">#</a></h3>
<p>The integral <span class="math notranslate nohighlight">\(\displaystyle I_n=\int x^ne^{-ax}dx\)</span> can be solved for <span class="math notranslate nohighlight">\(n=0,1,2\cdots\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is a constant. The first in the series is <span class="math notranslate nohighlight">\(\displaystyle I_0=\int x^0e^{-ax}dx=-\frac{e^{-ax}}{a}\)</span> . The next is integrated by parts, with <span class="math notranslate nohighlight">\(u=x, dv=e^{-ax}dx\)</span>, and <span class="math notranslate nohighlight">\(v=-e^{-ax}/a\)</span>,</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_1= \int xe^{-ax}dx= -\frac{xe^{-ax}}{a}+\frac{1}{a}\int e^{-ax}dx=-\frac{xe^{-ax}}{a}+\frac{e^{-ax}}{a}\]</div>
<p>we note that the rhs. integral is actually that of the first in the series, thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_1=-\frac{xe^{-ax}}{a}+\frac{I_0}{a}\]</div>
<p>which means that it appears that only the first integral has to be worked out and the rest found by recursion. To see if this is correct the next powers are tested</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_2= \int x^2e^{-ax}dx= -\frac{x^2e^{-ax}}{a}+\frac{2}{a}\int xe^{-ax}dx=-\frac{x^2e^{-ax}}{a}+\frac{2I_1}{a}\]</div>
<div class="math notranslate nohighlight">
\[\displaystyle I_3= \int x^3e^{-ax}dx= -\frac{x^3e^{-ax}}{a}+\frac{3}{a}\int x^2e^{-ax}dx=-\frac{x^3e^{-ax}}{a}+\frac{3I_2}{a}\]</div>
<p>and by induction we propose that the <span class="math notranslate nohighlight">\(n^{th}\)</span> term is</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_n= \int x^ne^{-ax}dx= -\frac{x^ne^{-ax}}{a}+\frac{n}{a}\int x^{n-1}e^{-ax}dx=-\frac{x^ne^{-ax}}{a}+\frac{nI_{n-1}}{a}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use Sympy to do an algebraic calculation by recursion</span>
<span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;n,x,a&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">xnexp</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>                                     <span class="c1"># define I(n)= x^n.exp(-ax)/a+I(n-1)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span>                      <span class="c1"># value of integral I0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">xnexp</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">simplify</span><span class="p">(</span><span class="n">xnexp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>                               <span class="c1"># n=3 </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-B_5_0.png" src="../_images/integration-B_5_0.png" />
</div>
</div>
<p>As a check the integral is calculated directly,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simplify</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-B_7_0.png" src="../_images/integration-B_7_0.png" />
</div>
</div>
<p>If limits of <span class="math notranslate nohighlight">\(0\to \infty\)</span> are added to the integral then the last result becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty x^3e^{-a*x}dx=-(a^3x^3+3a^2x^2-6ax-6)\frac{e^{-ax}}{a^4}\bigg|_0^\infty=\frac{6}{x^4}\]</div>
<p>In the limit <span class="math notranslate nohighlight">\(x=0\)</span> all terms in brackets, except the constant, are zero, and the remaining term is multiplied by <span class="math notranslate nohighlight">\(-1\)</span> as it the lower limit, and when <span class="math notranslate nohighlight">\(x=\infty\)</span> the exponential decreases faster than the power of <span class="math notranslate nohighlight">\(x\)</span> increases and the whole becomes zero. The next few integrals are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_0^\infty x^4e^{-ax}dx=\frac{24}{a^5}\\ \int_0^\infty x^5e^{-ax}dx=\frac{120}{a^5}\\ \int_0^\infty x^6e^{-ax}dx=\frac{720}{a^7}\end{split}\]</div>
<p>and after a bit of fiddling around we find that the numbers are <span class="math notranslate nohighlight">\(n!\)</span> thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty x^ne^{-ax}dx=\frac{n!}{a^{n+1}}\]</div>
<p>which defines the Gamma function when <span class="math notranslate nohighlight">\(a=1\)</span>.</p>
</section>
<section id="v-simplifying-the-partition-function-for-the-debye-model-of-a-solid">
<h3><strong>(v) Simplifying the partition function for the Debye model of a solid</strong><a class="headerlink" href="#v-simplifying-the-partition-function-for-the-debye-model-of-a-solid" title="Permalink to this headline">#</a></h3>
<p>In the Debye model of a perfect crystal the partition function <span class="math notranslate nohighlight">\(Z\)</span> is</p>
<div class="math notranslate nohighlight">
\[ \displaystyle \ln(Z)=-9\left(\frac{T}{\theta}\right)^3\int_0^{\theta/T}x^2\ln(1-e^{-x})dx\]</div>
<p>The Debye temperature is <span class="math notranslate nohighlight">\(\theta=\hbar\omega/k_B\)</span> where <span class="math notranslate nohighlight">\(k_B\)</span> is the Boltzmann constant and the Debye frequency <span class="math notranslate nohighlight">\(\omega\)</span> is the highest frequency a phonon can have in the crystal’s lattice. For silver <span class="math notranslate nohighlight">\(\theta\)</span> = <span class="math notranslate nohighlight">\(225\)</span> K.</p>
<p>We try to solve the integral ‘by parts’ letting <span class="math notranslate nohighlight">\(dv=x^2, u=\ln(1-e^{-x})\)</span> then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^{\theta/T}x^2\ln(1-e^{-x})dx= \ln(1-e^{-x})\frac{x^3}{3}\bigg|_0^{\theta/T}-\int_0^{\theta/T} \frac{x^3e^{-x}}{3(1-e^{-x})}dx\]</div>
<p>and therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle \ln(Z)=-3\ln(1-e^{-\theta/T})+3\left(\frac{T}{\theta}\right)^3\int_0^{\theta/T} \frac{x^3}{(e^{x}-1)}dx\]</div>
<p>Unfortunately the integral appears to have no algebraic solution, unless the limits are <span class="math notranslate nohighlight">\(0\to \infty\)</span>, and will have to be evaluated numerically.</p>
</section>
<section id="vi-using-summation-and-by-parts-to-evaluate-the-integral-int-0-infty-frac-x-3-e-x-1-dx-from-the-debye-model">
<h3><strong>(vi)  Using summation and ‘by-parts’ to evaluate the integral <span class="math notranslate nohighlight">\(\int_0^\infty \frac{x^3}{e^x -1}dx\)</span> from the Debye model</strong><a class="headerlink" href="#vi-using-summation-and-by-parts-to-evaluate-the-integral-int-0-infty-frac-x-3-e-x-1-dx-from-the-debye-model" title="Permalink to this headline">#</a></h3>
<p>In calculating the heat capacity of a crystal at low temperatures using the Debye model the integral to be solved is <span class="math notranslate nohighlight">\(I=\displaystyle \int_0^{\theta/T} \frac{x^3}{e^x -1}dx\)</span>. At low temperatures the parameter <span class="math notranslate nohighlight">\(x =\theta/T\)</span> is large and so, without adding any significant error the integral becomes <span class="math notranslate nohighlight">\(I=\displaystyle \int_0^\infty \frac{x^3}{e^x -1}dx\)</span>. The parameter <span class="math notranslate nohighlight">\(\theta\)</span> is the Debye temperature, a constant for each substance.  At first sight this seems very a daunting integral but if the argument is re-written it allows a series expansion to be used because at low temperature only <span class="math notranslate nohighlight">\(e^{-x}\lt 1\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\frac{x^3}{e^x -1}&amp;=x^3\frac{e^{-x}}{1-e^{-x}}=x^3e^{-x}(1+e^{-x}+e^{-2x}+\cdots)\\&amp;=\sum_{n=1}^\infty e^{-nx}x^3 \end{align}\end{split}\]</div>
<p>The integral is now</p>
<div class="math notranslate nohighlight">
\[\displaystyle I= \sum_{n=1}^\infty \int_0^\infty e^{-nx}x^3dx \]</div>
<p>and can be solved with a substitution <span class="math notranslate nohighlight">\(z=nx,\; dz=ndx\)</span> and then repeatedly using the ‘by parts’ method.</p>
<div class="math notranslate nohighlight">
\[\displaystyle I= \sum_{n=1}^\infty \int_0^\infty e^{-nx}x^3dx =\sum_{n=1}^\infty \frac{1}{n^4}\int_0^\infty e^{-z}z^3dz\]</div>
<p>Then choosing <span class="math notranslate nohighlight">\(u=z^3, v  =e^{-z}\)</span></p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty e^{-z}z^3dz =  -e^{-z}z^3\bigg|_0^\infty - 3\int_0^\infty e^{-z}z^2dz\]</div>
<p>and the first term on the right is zero, as it will be in the next integral hence,</p>
<div class="math notranslate nohighlight">
\[\displaystyle - 3\int_0^\infty e^{-z}z^2dz= 3\cdot 2 \int_0^\infty e^{-z}zdz\]</div>
<p>and continuing</p>
<div class="math notranslate nohighlight">
\[\displaystyle 6\int_0^\infty e^{-z}zdz= -6\int_0^\infty e^{-z}dz=6\]</div>
<p>thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle I= \sum_{n=1}^\infty \frac{1}{n^4}\int_0^\infty e^{-nx}x^3dx = 6\sum_{n=1}^\infty \frac{1}{n^4}\]</div>
<p>the summation converges after only a few terms and so can be found numerically, but found analytically it is <span class="math notranslate nohighlight">\(\pi^4/90\)</span></p>
<p>hence</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty \frac{x^3}{e^x -1}dx =\frac{\pi^4}{15}\]</div>
</section>
</section>
<section id="small-angle-x-ray-scattering-saxs">
<h2>5.1 Small angle x-ray scattering: SAXS<a class="headerlink" href="#small-angle-x-ray-scattering-saxs" title="Permalink to this headline">#</a></h2>
<p>A real example of integration by parts can be found when determining the scattering of x-rays by a molecule. In the technique of small angle scattering called SAXS the scattering is determined by the overall ‘shape’ of the electron distribution <span class="math notranslate nohighlight">\(\rho(r)\)</span> at some point <span class="math notranslate nohighlight">\(r\)</span> in a molecule and the wavevector <span class="math notranslate nohighlight">\(q\)</span> of the scattering.</p>
<p>The equation governing the scattering is</p>
<div class="math notranslate nohighlight">
\[ A(q)=\int_0^\infty \rho(r)\frac{\sin(qr)}{qr}4\pi r^2dr\]</div>
<p>In the simplest case of a hard sphere potential <span class="math notranslate nohighlight">\(\rho\)</span> has the value <span class="math notranslate nohighlight">\(1\)</span> up to a distance <span class="math notranslate nohighlight">\(R\)</span> and above this it is zero.  This changes the equation into</p>
<div class="math notranslate nohighlight">
\[\displaystyle  A(q)=\frac{4\pi}{q}\int_0^R \sin(qr) rdr\]</div>
<p>and the integration can be done by parts. Choosing <span class="math notranslate nohighlight">\(dv=rdr\)</span>  does not simplify the resulting equations so we can choose <span class="math notranslate nohighlight">\(dv=\sin(qr)dr\)</span>. This produces the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_0^R \sin(qr) rdr = -\frac{r}{q}\cos(qr)\bigg|_0^R+\frac{1}{q}\int_0^R \cos(qr)dr =\left(-\frac{r}{q}\cos(qr)+\frac{1}{q^2} \sin(qr)\right)\bigg|_0^R \\
=\frac{1}{q^2}\left( \sin(Rq)-Rq\cos(Rq) \right) \end{split}\]</div>
<p>making</p>
<div class="math notranslate nohighlight">
\[\displaystyle A(q)=\frac{4\pi}{q^3}\left( \sin(Rq)-Rq\cos(Rq) \right) \]</div>
<p>Only the absolute value of the scattering is measured in an experiment: negative numbers of photons do not make any sense. The zeros correspond to destructive interference between the incoming and scattered waves.</p>
<p><img alt="Drawing" src="../_images/integration-fig7a.png" /></p>
<p>Figure 7a. Calculated scattering profile as might be measure in a SAXS experiment with a square potential. The inset shows the vectors describing the incoming x-ray <span class="math notranslate nohighlight">\(k_0\)</span> and the scattered ray <span class="math notranslate nohighlight">\(k\)</span> with the wavevector <span class="math notranslate nohighlight">\(q\)</span>.</p>
</section>
<section id="differentiation-under-the-integral-the-leibniz-formula">
<h2>5.2 Differentiation under the Integral. The Leibniz formula<a class="headerlink" href="#differentiation-under-the-integral-the-leibniz-formula" title="Permalink to this headline">#</a></h2>
<p>To differentiate an integral this either must contain a function or have limits that contains a parameter, otherwise the integral is simply a number and differentiation results in zero.  For example the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\int_0^{\pi/2}\sin(tx)dx\]</div>
<p>is still a function of <span class="math notranslate nohighlight">\(t\)</span> after integration and substitution of limits gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=-\frac{\cos(xt)}{t}\bigg|_0^{x\,=\,\pi/2}=\frac{1}{t}\left(1-\cos\left(\frac{\pi t}{2}\right)\right)\]</div>
<p>and naturally this can be differentiated with respect to <span class="math notranslate nohighlight">\(t\)</span>, i.e. we can evaluate <span class="math notranslate nohighlight">\(dF/dt\)</span>.</p>
<p>However, it is permissible to move the derivative to inside the integral and thus differentiation occurs before integration. This can be advantageous because the integral either may not be able to be calculated, or it is very tricky to do so. After differentiation and integration of the result, we may be able to solve the original integral. This is illustrated in next main section after introducing the Leibniz formula.</p>
<p>If <span class="math notranslate nohighlight">\(f(x,t)\)</span> is the function then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF}{dt}=\frac{d }{d t}\int_u^v f(x,t)dx=\int_u^v \frac{\partial f(x,t)}{\partial t}dx\tag{16A}\]</div>
<p>When <span class="math notranslate nohighlight">\(u,v\)</span> are constants this is the limited form of the Leibniz formula. In the general case when <span class="math notranslate nohighlight">\(u,v\)</span> are functions of <span class="math notranslate nohighlight">\(t\)</span> i.e. <span class="math notranslate nohighlight">\(u(t), v(t)\)</span>, then the complete formula is needed for the derivative of an integral. (See Sokolkinoff &amp; Sokolkinoff, ‘Higher Mathematics for Engineers and Physicists’, McGraw Hill for a full derivation).</p>
<p>To derive the Leibniz formula we start with any ordinary function of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(t\)</span>, i.e. <span class="math notranslate nohighlight">\(f(x,t)\)</span> then its integral is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int f(x,t)dx=F(x,t)\tag{16B}\]</div>
<p>so that</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{\partial F}{\partial x}=f(x,t)\tag{16C}\]</div>
<p>and adding limits in the most general way as functions of <span class="math notranslate nohighlight">\(t\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align} F(t)=\int_{u(t)}^{v(t)} f(x,t)dx&amp;=F(x,t)\bigg|_{x\,=\,u(t)}^{x\,=\,v(t)}\\
&amp;=F(v,t)-F(u,t)\end{align}\end{split}\]</div>
<p>Using the chain / function-of-a-function rule the derivative is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF}{dt}=\frac{\partial F(v,t) }{\partial v}\frac{dv}{dt}+\frac{\partial F(v,t)}{\partial t} -\left(\frac{\partial F(u,t) }{\partial u}\frac{du}{dt}+\frac{\partial F(u,t)}{\partial t}\right )\]</div>
<p>which can be rearranged using the definitions above, viz,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\frac{dF}{dt}&amp;=  f(v,t)\frac{dv}{dt}-f(u,t)\frac{du}{dt}+\frac{\partial }{\partial t}\left(F(v,t)-F(u,t)\right)\\ &amp;=
f(v,t)\frac{dv}{dt}-f(u,t)\frac{du}{dt}+\frac{\partial }{\partial t}\int_{u(t)}^{v(t)} f(x,t)dx \end{align}\end{split}\]</div>
<p>where in the partial derivative the differentiation is done with respect to <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(v,u\)</span> are treated as constants. Rearranging this term produces Leibniz’s formula and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF}{dt}= f(v,t)\frac{dv}{dt}-f(u,t)\frac{du}{dt}+\int_{u(t)}^{v(t)} \frac{\partial }{\partial t}f(x,t)dx \qquad\qquad\text{Leibniz formula}\tag{16D}\]</div>
<p>There are three forms to be aware of when using this equation.</p>
<p>(a) When the limits are functions of <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(f\)</span> is a function of <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(x\)</span>, then the full equation (eqn 16D) is used.</p>
<p>(b) When the limits are constants then eqn. 16A can be used, and</p>
<p>(c) If the limits are functions of <span class="math notranslate nohighlight">\(t\)</span>, but <span class="math notranslate nohighlight">\(f\)</span> is not a function of <span class="math notranslate nohighlight">\(t\)</span>, and thus integrates to zero then only the first two terms in eqn. 16D are used.</p>
<section id="examples">
<h3><strong>Examples</strong><a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h3>
</section>
<section id="i-int-0-pi-2-sin-t-x-dx">
<h3><strong>(i)  <span class="math notranslate nohighlight">\(\int_0^{\pi/2}\sin(t-x)dx\)</span></strong><a class="headerlink" href="#i-int-0-pi-2-sin-t-x-dx" title="Permalink to this headline">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(\displaystyle F(t)=\int_0^{\pi/2}\sin(t-x)dx\)</span> then <span class="math notranslate nohighlight">\(\displaystyle \frac{dF}{dt}\)</span> can either be evaluated by direct calculation or by using the simpler form of the Leibniz formula, (eqn. A), since the limits are constants. Using Leibniz produces</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\frac{dF}{dt}&amp;= \int_0^{\pi/2}\frac{\partial }{\partial t}\sin(t-x)dx= \int_0^{\pi/2} \cos(t-x)dx=\sin(t-x)\bigg |_{x\,=\,0}^{x\,=\,\pi/2} \\&amp;= -\sin(t-\pi/2)+\sin(t)=\cos(t)+\sin(t)\end{align}\end{split}\]</div>
</section>
<section id="ii-f-t-int-0-t-2-x-1-2-dx">
<h3><strong>(ii) <span class="math notranslate nohighlight">\(F(t)=\int_0^{t^2} x^{1/2}\; dx\)</span></strong><a class="headerlink" href="#ii-f-t-int-0-t-2-x-1-2-dx" title="Permalink to this headline">#</a></h3>
<p>If <span class="math notranslate nohighlight">\(\displaystyle F(t)=\int_0^{t^2} \sqrt{x}\; dx\)</span> then <span class="math notranslate nohighlight">\(dF/dt\)</span> can be found by integrating first, as the integral is easy, then differentiating or by using the Leibniz formula.</p>
<p>By direct calculation</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\int_0^{t^2} \sqrt{x}\; dx = \frac{2}{3}x^{3/2}\bigg|_0^{x\,=\,t^2} =\frac{2}{3}t^3\]</div>
<p>and differentiating wrt. <span class="math notranslate nohighlight">\(t\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF}{dt}=2t^2\]</div>
<p>Using the Leibniz formula</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\frac{dF}{dt}&amp;=2t\sqrt{t^2}-0+\int_0^{t^2}\frac{d}{dt}\sqrt{x} dx\\
&amp;=2t^2\end{align}\end{split}\]</div>
<p>because the derivative is in <span class="math notranslate nohighlight">\(t\)</span> any term in <span class="math notranslate nohighlight">\(x\)</span> only, such as the integral, is in effect a constant and becomes zero.</p>
</section>
<section id="iii-partition-function-and-heat-capacity-for-the-debye-model-of-a-solid">
<h3><strong>(iii) Partition function and heat capacity for the Debye model of a solid</strong><a class="headerlink" href="#iii-partition-function-and-heat-capacity-for-the-debye-model-of-a-solid" title="Permalink to this headline">#</a></h3>
<p>The internal energy of a system is calculated from the partition function as <span class="math notranslate nohighlight">\(\displaystyle U = RT^2\frac{\partial }{\partial T^2}\ln(Z)\)</span> and the heat capacity <span class="math notranslate nohighlight">\(\displaystyle C_V=\frac{\partial U}{\partial T}\)</span> both at constant volume.</p>
<p>In part 5 example v, the integral in the partition function for the Debye crystal was simplified, here we find the internal energy and heat capacity by differentiating the integral.</p>
<p>The Debye temperature is <span class="math notranslate nohighlight">\(\theta=\hbar\omega/k_B\)</span> where <span class="math notranslate nohighlight">\(k_B\)</span> is the Boltzmann constant and the Debye frequency <span class="math notranslate nohighlight">\(\omega\)</span> is the highest frequency a phonon can have in the crystal’s lattice. For silver <span class="math notranslate nohighlight">\(\theta\)</span> = <span class="math notranslate nohighlight">\(225\)</span> K. The partition function is given by</p>
<div class="math notranslate nohighlight">
\[\displaystyle \ln(Z)=-3\ln(1-e^{-\theta/T})+3\left(\frac{T}{\theta}\right)^3\int_0^{\theta/T} \frac{x^3}{(e^{x}-1)}dx\]</div>
<p>and differentiating the first term wrt. <span class="math notranslate nohighlight">\(T\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle -3\frac{d}{dT}\ln(1-e^{-\theta/T})= \frac{3\theta e^{-\theta/T}}{T^2(1-e^{-\theta/T}) }= \frac{3\theta }{T^2(e^{\theta/T}-1) }\tag{i}\]</div>
<p>and the second term</p>
<div class="math notranslate nohighlight">
\[\displaystyle 9\frac{T^2}{\theta^3}\int_0^{\theta/T} \frac{x^3}{(e^{x}-1)}dx+3\left(\frac{T}{\theta}\right)^3\frac{d}{dT}\int_0^{\theta/T} \frac{x^3}{(e^{x}-1)}dx\tag{ii}\]</div>
<p>and the derivative of the integral is found using the Leibniz formula (with simplification (c) ) and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d}{dT}\int_0^{\theta/T} \frac{x^3}{(e^{x}-1)}dx=-\frac{\theta}{T^2}\frac{(\theta/T)^3}{(e^{\theta/T}-1)}\tag{iii}\]</div>
<p>To form the internal energy add <span class="math notranslate nohighlight">\({i}+{ii}\)</span> and multiply by <span class="math notranslate nohighlight">\(RT^2\)</span> and after simplification the internal energy is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{U}{R}=9T\left(\frac{T}{\theta}\right)^3\int_0^{\theta/T} \frac{x^3}{(e^{x}-1)}dx\]</div>
<p>The heat capacity <span class="math notranslate nohighlight">\(C_V\)</span> is found by differentiating this result by <span class="math notranslate nohighlight">\(T\)</span> and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{C_V}{R}= 36\left(\frac{T}{\theta}\right)^3\int_0^{\theta/T} \frac{x^3}{(e^{x}-1)}dx -9\left(\frac{\theta}{T}\right)\frac{1}{e^{\theta/T}-1} \]</div>
<p>and <span class="math notranslate nohighlight">\(C_V\)</span> ranges between zero and <span class="math notranslate nohighlight">\(3R\)</span> this the high temperature limit as found experimentally by Dulong and Petit for many compounds.</p>
<p>At low temperatures when <span class="math notranslate nohighlight">\(\theta/T\to \infty\)</span> the second term in the heat capacity tends to zero, because the exponential term increases far more rapidly than does <span class="math notranslate nohighlight">\(\theta/T\)</span>. l’Hopital’s rule could also be used. In the first term the integral becomes</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty \frac{x^3}{(e^{x}-1)}dx\]</div>
<p>which as a definite integral is just a number. This integral is solved above, see section 5 example (vi), and is <span class="math notranslate nohighlight">\(\pi^4/15\)</span> making the low temperature heat capacity</p>
<div class="math notranslate nohighlight">
\[\displaystyle C_V= \frac{12\pi^4R}{5}\left(\frac{T}{\theta}\right)^3,\qquad T\to 0 \]</div>
<p>and the <span class="math notranslate nohighlight">\(T^3\)</span> dependence has been amply confirmed by experiment.</p>
</section>
<section id="iv-int-t-t-2-e-xt-dx-using-the-full-leibniz-formula">
<h3><strong>(iv)<span class="math notranslate nohighlight">\( \int_t^{t^2} e^{xt}dx\)</span> using the full Leibniz formula</strong><a class="headerlink" href="#iv-int-t-t-2-e-xt-dx-using-the-full-leibniz-formula" title="Permalink to this headline">#</a></h3>
<p>If <span class="math notranslate nohighlight">\(\displaystyle F(t)=\int_t^{t^2} e^{xt}dx\)</span> to find <span class="math notranslate nohighlight">\(dF/dt\)</span> we must use the full Leibniz formula eqn. D.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF(t)}{dt}=   2te^{t^3}-e^{t^2}+\int_t^{t^2}\frac{\partial }{\partial t}e^{xt} dx\]</div>
<p>The right hand integral evaluates to</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_t^{t^2}\frac{\partial }{\partial t}e^{xt} dx = \int_t^{t^2}x e^{xt}dx=\frac{(tx-1)}{t^2}e^{tx}\bigg|_{x\,=\,t}^{x\,=\,t^2}=\frac{(t^3-1)}{t^2}e^{t^3}-\frac{(t^2-1)}{t^2}e^{t^2}\]</div>
<p>where a standard integral for <span class="math notranslate nohighlight">\(xe^{tx}\)</span> was used, see table in section 2.14. The result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF(t)}{dt}=(3t-1/t^2)e^{t^3}+(1/t^2-2)e^{t^2}\]</div>
</section>
<section id="v-int-0-infty-e-ax-dx-frac-1-a-by-repeated-differentiation">
<h3><strong>(v) <span class="math notranslate nohighlight">\( \int_0^\infty e^{-ax}dx=\frac{1}{a}\)</span> by repeated differentiation</strong><a class="headerlink" href="#v-int-0-infty-e-ax-dx-frac-1-a-by-repeated-differentiation" title="Permalink to this headline">#</a></h3>
<p>The integral <span class="math notranslate nohighlight">\(\displaystyle \int_0^\infty e^{-ax}dx=\frac{1}{a}\)</span> can be differentiated wrt. <span class="math notranslate nohighlight">\(a\)</span> and if we differentiate one side then the other side must also be differentiated, viz</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d}{da}\int_0^\infty e^{-ax}dx =\frac{d}{da}\left(\frac{1}{a}\right)\longrightarrow \int_0^\infty - xe^{-ax}dx =-\frac{1}{a^2}\]</div>
<p>This can be repeated</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d}{da}\int_0^\infty -xe^{-ax}dx =-\frac{d}{da}\left(\frac{1}{a^2}\right)\longrightarrow \int_0^\infty x^2e^{-ax}dx =\frac{2}{a^3}\]</div>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty -x^3e^{-ax}dx =-\frac{2\cdot 3}{a^4},\qquad \int_0^\infty x^4e^{-ax}dx =\frac{2\cdot 3\cdot 4}{a^5}\]</div>
<p>The last equation is the same as <span class="math notranslate nohighlight">\(\displaystyle \int_0^\infty x^4e^{-ax}dx=\frac{4!}{a^5}\)</span> and by induction we can extrapolate to the <span class="math notranslate nohighlight">\(n^{th}\)</span> term as</p>
<div class="math notranslate nohighlight">
\[\displaystyle (-1)^{n}\int_0^\infty x^ne^{-ax}dx=\frac{n!}{a^{n+1}}\]</div>
<p>which has the form of the gamma function when <span class="math notranslate nohighlight">\(a=1\)</span>.</p>
</section>
<section id="vi-a-complicated-integral-i-n-int-0-1-x-t-ln-n-x-dx-solved-by-recursion">
<h3><strong>(vi) A complicated integral <span class="math notranslate nohighlight">\( I_n=\int_0^1 x^t\ln^n(x)dx\)</span> solved by recursion</strong><a class="headerlink" href="#vi-a-complicated-integral-i-n-int-0-1-x-t-ln-n-x-dx-solved-by-recursion" title="Permalink to this headline">#</a></h3>
<p>The complicated integral <span class="math notranslate nohighlight">\(\displaystyle I_n=\int_0^1 x^t\ln^n(x)dx\)</span> can be solved by differentiating wrt. <span class="math notranslate nohighlight">\(t\)</span> starting with <span class="math notranslate nohighlight">\(\displaystyle \int_0^1 x^t dx=(t+1)^{-1}\)</span>. ( The non standard notation <span class="math notranslate nohighlight">\(\ln^n(x) \equiv (\ln(x))^n\)</span> is used for clarity). By using the ‘by parts’ method <span class="math notranslate nohighlight">\(I_n\)</span> can also be evaluated, and this leads to recursion as follows.</p>
<p>Choosing <span class="math notranslate nohighlight">\(u=\ln^n(x), dv=x^t\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align} I_n=\int x^t\ln^n(x)dx &amp;= \ln^n(x)\frac{x^{t+1}}{t+1}-\int \frac{x^{t+1}}{t+1}\frac{n\ln^{n-1}(x)}{x} dx\\&amp;=\ln^n(x)\frac{x^{t+1}}{t+1}-\frac{n}{t+1}\int x^{t}\ln^{n-1}(x)dx \end{align}\end{split}\]</div>
<p>and as <span class="math notranslate nohighlight">\(\displaystyle I_{n-1} = \int x^{t}\ln^{n-1}(x)dx\)</span> the integral can be written recursively as</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_n=\frac{x^{t+1}}{t+1}\ln^n(x)-\frac{n}{t+1}I_{n-1}\]</div>
<p>and the first integral only is required <span class="math notranslate nohighlight">\(\displaystyle I_0 =\int x^tdx\)</span>, but of course the <span class="math notranslate nohighlight">\(I_n\)</span> integral contains very many terms for any reasonably sized <span class="math notranslate nohighlight">\(n\)</span> and no general equation is apparent. When limits <span class="math notranslate nohighlight">\(x=0\to 1\)</span> are added the first term on the rhs. of the recursion equation is zero.</p>
<p>The same integral evaluated by differentiation starts by differentiating both sides of <span class="math notranslate nohighlight">\(\displaystyle \int_0^1 x^t dx=(t+1)^{-1}\)</span>  which produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d}{dt}\int_0^1 x^tdx=\int_0^1 x^t\ln(x)dx=-\frac{1}{(t+1)^2}\]</div>
<p>and repeatedly differentiating gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}&amp;\frac{d}{dt}\int_0^1 x^t\ln(x)dx=\int_0^1 x^t\ln^2(x)dx =2\frac{1}{(t+1)^3}\\
&amp;\frac{d}{dt}\int_0^1 x^t\ln^2(x)dx=\int_0^1 x^t\ln^3(x)dx =-2\cdot3\frac{1}{(t+1)^4}\\
&amp; \frac{d}{dt}\int_0^1 x^t\ln^3(x)dx=\int_0^1 x^t\ln^4(x)dx =2\cdot3\cdot 4\frac{1}{(t+1)^5}\end{align}\\ \vdots\end{split}\]</div>
<p>from which we surmise that</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d}{dt}\int_0^1 x^t\ln^n(x)dx=\int_0^1 x^t\ln^n(x)dx =(-1)^n\frac{n!}{(t+1)^{n+1}}\]</div>
<p>which gives the general form of the integral for any <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(n\ge 0\)</span>.</p>
</section>
</section>
<section id="nearest-neighbour-distribution">
<h2>5.3 Nearest Neighbour Distribution<a class="headerlink" href="#nearest-neighbour-distribution" title="Permalink to this headline">#</a></h2>
<p>We shall now take a small diversion. One interesting, but rather sophisticated example of differentiating integrals occurs when finding the distribution of nearest (closest or first) neighbour molecules in a solution, see Chandrasekhar(1943). This also applies to colloids, proteins and even galaxies.</p>
<p>Let <span class="math notranslate nohighlight">\(w(r)\)</span> be the probability that the nearest neighbour occurs between distance <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(r + dr\)</span>. This must be the probability than no molecules exist up to <span class="math notranslate nohighlight">\(r\)</span> and that the next molecule exists in the shell <span class="math notranslate nohighlight">\(r \to r + dr\)</span>. The molecules are assumed to be positioned at random in the solution. Thus,</p>
<div class="math notranslate nohighlight">
\[\displaystyle  w(r)=\left(  1-\int_0^r w(r)dr \right)4\pi r^2 n \qquad\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the average number of molecules / unit volume. (<span class="math notranslate nohighlight">\(1 \mathrm{\,mol\, m^{-3}}  \equiv 10^3  N_A/10^{27} = 0.6023\)</span> molecules / nm<span class="math notranslate nohighlight">\(^3\)</span>). The term in brackets is 1-probability that a molecule exists, i.e. that it does not exist in <span class="math notranslate nohighlight">\(0 \to r\)</span> and the integral is the probability that it exists in <span class="math notranslate nohighlight">\(0 \to r\)</span>. The <span class="math notranslate nohighlight">\(4\pi r^2 n\)</span> is the number of molecules in the shell <span class="math notranslate nohighlight">\(\delta r\)</span>.</p>
<p>This looks hard to solve because <span class="math notranslate nohighlight">\(w(r)\)</span> is also inside the integration, so it is necessary to isolate the integral first, by dividing both sides by <span class="math notranslate nohighlight">\(4\pi r^2 n\)</span>, and then differentiating both sides to find</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \frac{d}{dr}\left(\frac{w(r)}{4\pi r^2 n}\right)= \frac{d}{dr}\left(1-\int w(r)dr\right) = -w(r)\qquad\]</div>
<p>In the next step we multiply the rhs by one by multiplying top and bottom by the same term,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{d}{dr}\left(\frac{w(r)}{4\pi r^2 n}\right)=-4\pi r^2 n \left(\frac{w(r)}{4\pi r^2 n}\right)\]</div>
<p>The result is seen by inspection if you recognize that by letting <span class="math notranslate nohighlight">\(w(r)/4\pi r^2 n=y\)</span> and integrating the equation it has the form <span class="math notranslate nohighlight">\(\displaystyle \int\frac{dy}{y}=-4\pi n \int r^2dr \)</span> which is a standard integral and gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle  w(r)=4\pi r^2 ne^{-4\pi r^3n/3}\]</div>
<p>The shape of <span class="math notranslate nohighlight">\(w(r)\)</span> can be worked out just by looking at it. The term in <span class="math notranslate nohighlight">\(r^2\)</span> causes <span class="math notranslate nohighlight">\(w(r)\)</span> to increase and the exponential to decrease, thus we expect it to start at zero reach a maximum and fall off to zero at large <span class="math notranslate nohighlight">\(r\)</span>. Physically this is what one might expect, no near neighbour will be at at zero distance and none either at very large distances because they are all present at some shorter distance.</p>
<p><img alt="Drawing" src="../_images/differen-fig5a.png" /></p>
<p>Figure 7b. Probability of a nearest neighbour molecules <span class="math notranslate nohighlight">\(w(r)\)</span> being present at distance <span class="math notranslate nohighlight">\(r\)</span> (nm) at various concentrations in mol/dm<span class="math notranslate nohighlight">\(^3\)</span> assuming that molecules are positioned at random in solution.</p>
</section>
<section id="definite-integrals-using-series">
<h2>5.4 Definite integrals using series<a class="headerlink" href="#definite-integrals-using-series" title="Permalink to this headline">#</a></h2>
<p>One method of integrating which seems not to be used much nowadays is to expand the function as a series and integrate term by term.  If you are lucky the resulting series produced can be neatly summed as in integrating the Debye function, section 5(vi). Euler (1707-1783), who was one of history’s foremost integrators, often used this approach, See W. Dunham. ‘The Calculus Gallery’, Princeton  University press, 2018, chapter 4. Three examples are given below.</p>
<section id="id1">
<h3><strong>Examples</strong><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
</section>
<section id="i-displaystyle-int-0-1-frac-ln-1-x-x-dx">
<h3><strong>(i)<span class="math notranslate nohighlight">\(\displaystyle \int_0^1\frac{\ln(1+x)}{x}dx\)</span></strong><a class="headerlink" href="#i-displaystyle-int-0-1-frac-ln-1-x-x-dx" title="Permalink to this headline">#</a></h3>
<p>The first step is to use the series expansion for <span class="math notranslate nohighlight">\(\ln(1+x)=x-x^2/2+x^3/3\cdots\)</span>, divide by <span class="math notranslate nohighlight">\(x\)</span> then integrate each term, which gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\int_0^1\frac{\ln(1+x)}{x}dx&amp;= \int_0^1 1-\frac{x}{2}+\frac{x^2}{3}-\frac{x^3}{4}\cdots dx\\&amp;=x-\frac{x^2}{2^2}+\frac{x^3}{3^2}-\frac{x^4}{4^2}\cdots \bigg|_0^1\\&amp;=1-\frac{1}{2^2}+\frac{1}{3^2}-\frac{1}{4^2}\cdots \frac{1}{n^2}\cdots\end{align}\end{split}\]</div>
<p>It is necessary to know the series summation to infinity, the simplest way is to look this up or use Sympy to calculate it, otherwise the sum can be calculated numerically to whatever precision is needed. The series is <span class="math notranslate nohighlight">\(\displaystyle\sum_{n=1}^\infty\frac{(-1)^{n+1}}{n^2}=\frac{\pi^2}{12}\)</span>, thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^1\frac{\ln(1+x)}{x}dx=\frac{\pi^2}{12}\]</div>
</section>
<section id="ii-displaystyle-int-0-1x-ln-1-x-dx">
<h3><strong>(ii) <span class="math notranslate nohighlight">\(\displaystyle \int_0^1x\ln(1+x)dx\)</span></strong><a class="headerlink" href="#ii-displaystyle-int-0-1x-ln-1-x-dx" title="Permalink to this headline">#</a></h3>
<p>Expanding the series and integrating term by term gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\int_0^1x\ln(1+x)dx&amp;=\int_0^1 x^2-\frac{x^3}{2}+\frac{x^4}{3}\cdots dx\\&amp;=\frac{x^3}{3\cdot 1}-\frac{x^4}{4\cdot 2}+\frac{x^5}{5\cdot 3}\cdots\bigg |_0^1\\&amp;=
\frac{1}{3}-\frac{1}{8}+\frac{1}{15}-\frac{1}{24}\cdots \\&amp;= \sum_{n=1}^\infty \frac{(-1)^{n+1}}{n(n+2)}\\&amp;=\frac{1}{4}\end{align}\end{split}\]</div>
<p>where working out the form of the summation is somewhat of an art. As in the other examples the summation is known or you can use Sympy to work it out for you.</p>
</section>
<section id="iii-displaystyle-int-0-1-frac-sin-ln-x-ln-x-dx">
<h3><strong>(iii) <span class="math notranslate nohighlight">\(\displaystyle \int_0^1\frac{\sin(\ln(x))}{\ln(x)}dx\)</span></strong><a class="headerlink" href="#iii-displaystyle-int-0-1-frac-sin-ln-x-ln-x-dx" title="Permalink to this headline">#</a></h3>
<p>The integral we try is one that Euler solved in the <span class="math notranslate nohighlight">\(1760\)</span>’s and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^1\frac{\sin(\ln(x))}{\ln(x)}dx\]</div>
<p>and this appears to be extremely difficult, but is clarified is the sine is expanded as a series. This series was known to Euler and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \sin(x) = x-\frac{x^3}{3!}+\frac{x^5}{5!}-\cdots\]</div>
<p>and so</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\frac{\sin(\ln(x))}{\ln(x)}&amp;= \frac{\ln(x)-\ln^3(x)/3!+\ln^5(x)/5!\cdots}{\ln(x)}\\&amp;=1-\frac{\ln^2(x)}{3!}+\frac{\ln^4(x))}{5!}-\cdots\end{align}\end{split}\]</div>
<p>where, for clarity, we use the non-standard notation <span class="math notranslate nohighlight">\(\ln^3(x)\equiv (\ln(x))^3\)</span> etc. This series can now be integrated term by term</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^1\frac{\sin(\ln(x))}{\ln(x)}dx=\int_0^1 dx-\frac{1}{3!}\int_0^1\ln^2(x)dx+\frac{1}{5!}\int_0^1\ln^4(x)dx-\cdots\]</div>
<p>which means that integrals of the form <span class="math notranslate nohighlight">\(\displaystyle \int_0^1\ln^n(x)dx\)</span> are needed where <span class="math notranslate nohighlight">\(n =2,4,6\cdots\)</span>, i.e. even numbers. This integral has already been met in example (vi) section 5.2 as <span class="math notranslate nohighlight">\(\displaystyle \int_0^1x^t\ln^n(x)dx\)</span> and and the result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^1 x^t\ln^n(x)dx =(-1)^n\frac{n!}{(t+1)^{n+1}}\]</div>
<p>As we can let <span class="math notranslate nohighlight">\(t=0\)</span> then</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^1 \ln^n(x)dx =(-1)^n n!\]</div>
<p>then substituting gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\int_0^1\frac{\sin(\ln(x))}{\ln(x)}dx&amp;= 1-\frac{2!}{3!}+\frac{4!}{5!}-\frac{6!}{7!}\\&amp;=1-\frac{1}{3}+\frac{1}{5}-\frac{1}{7}\cdots\end{align}\end{split}\]</div>
<p>and this is called the Leibniz series and its sum is <span class="math notranslate nohighlight">\(\pi/4\)</span> therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^1\frac{\sin(\ln(x))}{\ln(x)}dx=\frac{\pi}{4}\]</div>
<p>Very elegant and quite remarkable!</p>
</section>
</section>
<section id="evaluating-integrals-via-differentiation-and-feynman-s-trick">
<h2>5.5 Evaluating integrals <em>via</em> differentiation and  ‘Feynman’s trick’<a class="headerlink" href="#evaluating-integrals-via-differentiation-and-feynman-s-trick" title="Permalink to this headline">#</a></h2>
<p>Once the derivative of an integral is found we naturally want to evaluate the integral itself. This can be achieved only by knowing the value of the integral <span class="math notranslate nohighlight">\(F(x)\)</span> at, for example, <span class="math notranslate nohighlight">\(F(1)\)</span> or <span class="math notranslate nohighlight">\(F(0)\)</span> etc. because this allows the integration constant to be calculated. The ‘Feynman’s trick’, as integration using derivatives has become known, uses an artificially added parameter with which to differentiate with the purpose of removing some terms in the integral and thereby simplifying it. Finally, this parameter is set to a value as appropriate to re-form the initial integral. Some examples should make this method clearer, but it has to be remembered that a lot of cunning and imagination is often required to make this method work.</p>
<section id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
</section>
<section id="i-f-t-int-0-ln-t-e-xdx">
<h3><strong>(i) <span class="math notranslate nohighlight">\( F(t)= \int_0^{\ln(t)}e^xdx\)</span></strong><a class="headerlink" href="#i-f-t-int-0-ln-t-e-xdx" title="Permalink to this headline">#</a></h3>
<p>To reach a solution it is essential that the integral is known at some value, this is because after differentiation an integration without limits, i.e. an indefinite integral remains, and the integration constant has to be evaluated. To illustrate this the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)= \int_0^{\ln(t)}e^xdx\]</div>
<p>is evaluated using the Leibniz method.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF}{dt}=f'(t)=\frac{d}{dt} \int_0^{\ln(t)}e^x= e^{-\ln(t)}\frac{1}{t}=-1 \]</div>
<p>The derivative <span class="math notranslate nohighlight">\(\displaystyle \int_o^{\ln(t)} \frac{\partial }{\partial t}e^x dx\)</span> is zero because <span class="math notranslate nohighlight">\(\displaystyle \frac{\partial }{\partial t}e^{x}=0\)</span>. Integrating <span class="math notranslate nohighlight">\(dF/dt\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\int f'(t)dt=-t+c\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is a constant of integration. This can only be found if a value of <span class="math notranslate nohighlight">\(F(t)\)</span> is known for some <span class="math notranslate nohighlight">\(t\)</span>. Choosing <span class="math notranslate nohighlight">\(t=1\)</span> gives <span class="math notranslate nohighlight">\(F(0)=0\)</span> because both limits are the same (<span class="math notranslate nohighlight">\(\ln(1)=0\)</span>) and so</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=1-1/t\]</div>
<p>This result could, of course, have been found easily by direct integration, but illustrates the method to be used for far more complex integrals where direct integration is not possible.</p>
</section>
<section id="ii-a-hard-integral-made-easier-int-0-1-x-1-ln-x-dx">
<h3><strong>(ii) A hard integral made easier: <span class="math notranslate nohighlight">\( \int_0^1(x-1)/\ln(x)dx\)</span></strong><a class="headerlink" href="#ii-a-hard-integral-made-easier-int-0-1-x-1-ln-x-dx" title="Permalink to this headline">#</a></h3>
<p>A far harder integral than in example (i) is <span class="math notranslate nohighlight">\(\displaystyle \int_0^1\frac{x-1}{\ln(x)}dx\)</span> which, using the Feynman method by adding a parameter <span class="math notranslate nohighlight">\(t\)</span>, is changed to</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\int_0^1\frac{x^t-1}{\ln(x)}dx\]</div>
<p>and we seek a solution when <span class="math notranslate nohighlight">\(t=1\)</span>. Differentiating gives,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF}{dt}=\int_0^1\frac{d}{dt}\left(\frac{x^t-1}{\ln(x)}\right)dx=\int_0^1 x^t dx = \frac{x^{t+1}}{t+1}\bigg |_0^{x\,=\,1}=\frac{1}{1+t}\]</div>
<p>where <span class="math notranslate nohighlight">\(\displaystyle \frac{d x^t}{dt}=x^t\ln(x)\)</span> was used. Integrating the result gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\int\frac{1}{1+t}dt=\ln(|1+t|)+c\]</div>
<p>To find the constant <span class="math notranslate nohighlight">\(c\)</span> we can use the fact that <span class="math notranslate nohighlight">\(F(t=0)=0\)</span> in the original integral thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\ln(|1+t|)\]</div>
<p>and the value of <span class="math notranslate nohighlight">\(t\)</span> can be chosen as unity for our integral.</p>
</section>
<section id="iii-the-sinc-function-sin-ax-ax">
<h3><strong>(iii) The sinc function <span class="math notranslate nohighlight">\( \sin(ax)/ax\)</span></strong><a class="headerlink" href="#iii-the-sinc-function-sin-ax-ax" title="Permalink to this headline">#</a></h3>
<p>The sinc function has the form <span class="math notranslate nohighlight">\(\displaystyle \frac{\sin(ax)}{ax}\)</span> and is the fourier transform of a rectangular pulse of length <span class="math notranslate nohighlight">\(a\)</span>. The integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty \frac{\sin(x)}{x}dx=2\int_0^\infty \frac{\sin(x)}{x}dx\tag{16E}\]</div>
<p>is very difficult to evaluate. Instead using the Feynman method the integral is changed by introducing a term <span class="math notranslate nohighlight">\(e^{-xt}\)</span> that when differentiated removes <span class="math notranslate nohighlight">\(1/x\)</span> from the integral and which will produce the integral (16E) when <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\int_0^\infty \frac{\sin(x)}{x}e^{-tx}dx\tag{16F}\]</div>
<p>The derivative wrt. <span class="math notranslate nohighlight">\(t\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{dF(t)}{dt}=-\int_0^\infty \sin(x)e^{-tx}dx\]</div>
<p>which can be evaluated by using the ‘by parts’ method or by converting the sine to its exponential form <span class="math notranslate nohighlight">\(\displaystyle \sin(x)=\frac{e^{ix}-e^{-ix}}{2i}\)</span> producing</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle\begin{align} \frac{dF(t)}{dt}&amp;=\frac{-1}{2i}\int_0^\infty \left(e^{ix}-e^{-ix}\right)e^{-tx})dx\\&amp;=\frac{-1}{2i}\left(\frac{e^{(i-t)x}}{i-t}-\frac{e^{-(i+t)x}}{-(i+t)}\right) \bigg |_0^{x\,=\,\infty} =-\frac{1}{1+t^2}\qquad (t \gt 0)\end{align}\end{split}\]</div>
<p>integrating this again to find <span class="math notranslate nohighlight">\(F\)</span> is a standard integral and using tables gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=-\int \frac{1}{1+t^2}dt= -\tan^{-1}(t)+c\]</div>
<p>To find <span class="math notranslate nohighlight">\(c\)</span>, values of <span class="math notranslate nohighlight">\(F(t)\)</span> and <span class="math notranslate nohighlight">\(\tan^{-1}(t)\)</span> must be known at some value of <span class="math notranslate nohighlight">\(t\)</span>. We try <span class="math notranslate nohighlight">\(t\to \infty\)</span>, then <span class="math notranslate nohighlight">\(F(\infty)\to 0\)</span> and <span class="math notranslate nohighlight">\(\tan^{-1}(\infty)\to \pi/2\)</span> thus <span class="math notranslate nohighlight">\(c=\pi/2\)</span>. The integration is therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle F(t)=\frac{\pi}{2}-\tan^{-1}(t)\]</div>
<p>In eqn. (16F) if <span class="math notranslate nohighlight">\(t=0\)</span> then <span class="math notranslate nohighlight">\(e^{-tx}=1\)</span> and we obtain the original integration (16E), thus setting <span class="math notranslate nohighlight">\(t=0\)</span> in the last equation produces <span class="math notranslate nohighlight">\(F(t=0)=\pi/2\)</span> and so</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty \frac{\sin(x)}{x}dx=\pi\]</div>
<p>If the integral were <span class="math notranslate nohighlight">\(\displaystyle \int_{-\infty}^\infty \frac{\sin(ax)}{ax}dx\)</span> by substituting <span class="math notranslate nohighlight">\(z\to ax\; dz=adx\)</span> the result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty \frac{\sin(ax)}{ax}dx=\frac{\pi}{a}\]</div>
</section>
<section id="iv-harmonic-oscillator">
<h3><strong>(iv) Harmonic Oscillator</strong><a class="headerlink" href="#iv-harmonic-oscillator" title="Permalink to this headline">#</a></h3>
<p>The wavefunctions for the Harmonic oscillator, as used to describe the vibrational energy levels of a diatomic molecule, have the form <span class="math notranslate nohighlight">\(\psi_n=N_nH_ne^{-a x^2/2}\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is the quantum number, <span class="math notranslate nohighlight">\(N_n\)</span> is the normalisation, <span class="math notranslate nohighlight">\(H_n\)</span> a Hermite polynomial. The parameter <span class="math notranslate nohighlight">\(x=r-r_e\)</span> where <span class="math notranslate nohighlight">\(r_e\)</span> is the equilibrium bond length and <span class="math notranslate nohighlight">\(a=\sqrt{\mu k}/\hbar\)</span>. The first few wavefunctions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}&amp;\psi_0=N_0e^{-a x^2/2},\qquad \psi_1=N_1xe^{-a x^2/2}\\&amp; \psi_2=N_2(2a x^2-1)e^{-a x^2/2}\qquad \psi_3=N_3(2a x^3-3x)e^{-a x^2/2}\end{align}\end{split}\]</div>
<p>and these wavefunctions have the general form <span class="math notranslate nohighlight">\(x^se^{-ax^2/2}\)</span>, where <span class="math notranslate nohighlight">\(s=0,1,\cdots\)</span>. The normalisation is given by <span class="math notranslate nohighlight">\(N_n^2\displaystyle \int_{-\infty}^\infty\psi_n^*\psi_n dx=1\)</span> which means integrating equations such as <span class="math notranslate nohighlight">\(\displaystyle \int_{-\infty}^\infty x^se^{-ax^2}dx\)</span> where <span class="math notranslate nohighlight">\(s\)</span> is always an even number. If <span class="math notranslate nohighlight">\(s\)</span> is odd then the integral is an odd function and will be zero over any symmetrical integration limits. First the integrations are evaluated then the normalisation calculated.</p>
<p>The integration can be done ‘by parts’ but also by the Feynman method, the only integration we need to know is the first</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty e^{-ax^2/2}dx=\sqrt{\frac{2\pi}{a}}\]</div>
<p>and both sides of this equation will be differentiated. In this instance the ‘trick’ is to recognise that</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty \frac{\partial}{\partial a}e^{-ax^2/2}dx=-\int_{-\infty}^\infty \frac{x^2}{2}e^{-ax^2/2}dx\]</div>
<p>and so the calculation runs backwards as it were;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty x^2e^{-ax^2/2}dx=-2\int_{-\infty}^\infty \frac{\partial }{\partial a}e^{-ax^2/2}dx=-2\frac{\partial }{\partial a}\int_{-\infty}^\infty e^{-ax^2/2}dx=-2\frac{\partial }{\partial a}\sqrt{\frac{2\pi}{a}}=\sqrt{\frac{2\pi}{a^3}} \]</div>
<p>and no further integrations were done. It is now easy to see that by differentiating <span class="math notranslate nohighlight">\(\displaystyle \frac{d}{da}x^2e^{-ax^2/2}=-x^4e^{-ax^2}/2\)</span> is produced and so we can now proceed to calculate all the terms in <span class="math notranslate nohighlight">\(\displaystyle \int_{-\infty}^\infty x^se^{-ax^2/2}dx\)</span> where <span class="math notranslate nohighlight">\(s\)</span> is even, for example</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty x^4e^{-ax^2/2}dx=-2\frac{\partial }{\partial a}\frac{\sqrt{2\pi}}{a^{3/2}}=3\sqrt{\frac{2\pi}{a^5}}\]</div>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{-\infty}^\infty x^6e^{-ax^2/2}dx=-2\frac{\partial }{\partial a}\frac{3\sqrt{2\pi}}{a^{5/2}}=15\sqrt{\frac{2\pi}{a^7}}\]</div>
<p>The normalisations <span class="math notranslate nohighlight">\(N_n\)</span> are calculated as</p>
<div class="math notranslate nohighlight">
\[\displaystyle N_n^2\int \psi_n^*\psi_n dx=1\]</div>
<p>and for <span class="math notranslate nohighlight">\(n=0\)</span> gives a value</p>
<div class="math notranslate nohighlight">
\[\displaystyle N_0^2\sqrt{\frac{\pi}{a}}=1\]</div>
<p>where the change <span class="math notranslate nohighlight">\(a\to 2a\)</span> was made as now the integral is <span class="math notranslate nohighlight">\(\displaystyle \int e^{-ax^2}dx\)</span>. The wavefunction is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi_0= \left(\frac{a}{\pi}\right)^{1/4}e^{-ax^2/2}\]</div>
<p>and for <span class="math notranslate nohighlight">\(\psi_1\)</span> the normalisation is after replaceng <span class="math notranslate nohighlight">\(a\to 2a\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle N_1^2\int x^2e^{-ax^2}dx= N^2_1 \sqrt{\frac{\pi}{4a^3}}=1\]</div>
<p>making <span class="math notranslate nohighlight">\(\displaystyle N_1= \left(\frac{4a^3}{\pi}\right)^{1/4}\)</span> and the wavefunction</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi_1=\left(\frac{4a^3}{\pi}\right)^{1/4} xe^{-ax^2/2}\]</div>
<p>and the normalisations for the other wavefunctions are done similarly, although they are more complicated, without having to do any integrations.</p>
<section id="i-expectation-values-and-uncertainty-principle">
<h4><strong>(i) Expectation values and uncertainty principle</strong><a class="headerlink" href="#i-expectation-values-and-uncertainty-principle" title="Permalink to this headline">#</a></h4>
<p>The expectation values can now be very easily calculated, for example to calculate the average momentum <span class="math notranslate nohighlight">\(\langle p\rangle&gt;\)</span> or  distance or average square distance <span class="math notranslate nohighlight">\(\langle x\rangle, \langle x^2\rangle\)</span>.</p>
<p>The general equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle Q\rangle =\frac{\int_{-\infty}^\infty\psi\,\hat Q\, \psi dx}{\int_{-\infty}^\infty\psi\ \psi dx}\]</div>
<p>and <span class="math notranslate nohighlight">\(\hat Q\)</span> is the operator. The operator is just multiplication by <span class="math notranslate nohighlight">\(x\)</span> for calculating average distance but for momentum is <span class="math notranslate nohighlight">\(\displaystyle -i\hbar\frac{d}{dx}\)</span>.</p>
</section>
<section id="ii-average-position-and-its-uncertainty">
<h4><strong>(ii) Average position and its uncertainty</strong><a class="headerlink" href="#ii-average-position-and-its-uncertainty" title="Permalink to this headline">#</a></h4>
<p>The average displacement for is by definition <span class="math notranslate nohighlight">\(\langle x\rangle\)</span> and for the harmonic oscillator <span class="math notranslate nohighlight">\(\langle x\rangle =0\)</span> for any quantum number as this will always be an odd function. Physically this makes sense as the potential is symmetrical about <span class="math notranslate nohighlight">\(r_e\)</span> for any <span class="math notranslate nohighlight">\(n\)</span>.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle x_n\rangle = \frac{\int\psi_n\,x\,\psi_ndx}{\int \psi_n\psi_ndx}= 0\]</div>
<p>but the average squared term, is finite,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\langle x^2_1\rangle &amp;= \frac{\int\psi_1\,x^2\,\psi_1dx}{\int \psi_1\psi_1dx}=\frac{\int xe^{-ax^2/2}\,(x^2)\,xe^{-ax^2/2}dx}{\int xe^{-ax^2/2}xe^{-ax^2/2}dx}\\&amp;= \frac{\int x^4e^{-ax^2}dx}{\int x^2e^{-ax^2}dx}=3\frac{\sqrt{2\pi/(2a^5)}}{\sqrt{2\pi/(2a)^3}}\\&amp;=\frac{3}{2a}\end{align}\end{split}\]</div>
<p>The standard deviation for any measurement <span class="math notranslate nohighlight">\(Q\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle\sigma_Q = \sqrt{\langle Q^2\rangle-\langle Q\rangle^2}\]</div>
<p>and is a measure of the uncertainty in a measurement. Knowing both values for position when <span class="math notranslate nohighlight">\(n=1\)</span> gives <span class="math notranslate nohighlight">\(\displaystyle \sigma_x=\sqrt{\frac{3}{2a}}\)</span></p>
</section>
<section id="iii-average-momentum">
<h4><strong>(iii) Average momentum</strong><a class="headerlink" href="#iii-average-momentum" title="Permalink to this headline">#</a></h4>
<p>To calculate the expectation values for momentum the operator is <span class="math notranslate nohighlight">\(\displaystyle -i\hbar\frac{d}{dx}\)</span> thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle p\rangle=-i\hbar\int_{-\infty}^\infty \psi_n \frac{d}{dx} \psi_n dx\]</div>
<p>and the denominator is unity as the wavefunctions are normalised. If <span class="math notranslate nohighlight">\(n=1\)</span> the integral is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle p_1\rangle=i\hbar N_1^2\int_{-\infty}^\infty axe^{-ax^2} dx\]</div>
<p>which is an odd symmetry integral and therefore <span class="math notranslate nohighlight">\(\displaystyle \langle p_1\rangle=0\)</span> and this is true for all <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The operator for momentum squared is just the second derivative or <span class="math notranslate nohighlight">\(\displaystyle -\hbar^2\frac{d^2}{dx^2}\)</span>, thus</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle p^2\rangle=-\hbar^2\int_{-\infty}^\infty \psi^*_n \displaystyle\frac{d^2}{dx^2} \psi_n dx\]</div>
<p>the wavefunctions are normalised so the denominator is unity, and for <span class="math notranslate nohighlight">\(n=1\)</span></p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle p^2_1\rangle=-\hbar^2\sqrt{\frac{4a^3}{\pi}} \int_{-\infty}^\infty a e^{-ax^2}ax^2(ax^2-3)dx\]</div>
<p>for which we already have calculated values of the integrals; <span class="math notranslate nohighlight">\(\int x^2e^{-ax^2}dx=\sqrt{\pi/4a^3}\quad\int x^4e^{-ax^2}dx=3\sqrt{\pi/16a^5}\)</span> and so</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle p^2_1\rangle=\hbar^2\frac{3}{2a}\]</div>
<p>and the standard deviation of the momentum is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \sigma_p=\hbar\sqrt{\frac{3}{2a}}\]</div>
<p>Therefore the uncertainty product when <span class="math notranslate nohighlight">\(n=1\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \sigma_x\sigma_p= \frac{3}{2}\hbar \]</div>
<p>which agrees with the Heisenberg Uncertainty Principle that <span class="math notranslate nohighlight">\(\sigma_x\sigma_p \ge \hbar/2\)</span></p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="integration-Q1-14.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 1-14</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="integration-Q15-30.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 15-30</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>