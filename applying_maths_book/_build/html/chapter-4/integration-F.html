
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>10 Multiple integrals, Change of variables: Jacobians &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 78 - 86" href="integration-Q78-86.html" />
    <link rel="prev" title="Questions 73 - 77" href="integration-Q73-77.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Applying Maths in the Chemical and Biomolecular Sciences.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-1/chapter1-intro.html">
   1 Numbers, Equations, Operators, and Algorithms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-A.html">
     1 Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-B.html">
     5 Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-C.html">
     9 Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-D.html">
     10 Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-1/chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     1 Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     3 De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     1 - 3.8 Differentiation, gradients &amp; basic functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     3.9 Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     4 Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     6 Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     9 Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     10 Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     11 Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     12 Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="integration-intro.html">
   4 Integration.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="integration-A.html">
     1 Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-B.html">
     3 Integration by substitution and ‘by parts’. Differentiation and the Leibniz formula. Feynman’s ‘Trick’
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-C.html">
     6 Integration and parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-D.html">
     8 Calculating an Average.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-E.html">
     9 The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     10 Multiple integrals, Change of variables: Jacobians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-G.html">
     12 Calculating the energy of a Chemical Bond using Molecular Orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-H.html">
     13 Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     1 Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     6 Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     8 Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     9 Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     1 Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     6 Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     8 Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     12 Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     15 Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     18 Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     21 Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     1 Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     4 Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     6 Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     7 Rotation matrices: moving molecules. Coordinate transform as rotation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     9 Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     11 Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     12 Solving equations using matrices. Eigenvectors and Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     13 Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     14 Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     15 Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     16 Principal axes and Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61-62.html">
     Question 61 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     1 Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     4 Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     5 Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     1 Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     5 Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     7 Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     9 Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     11 The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     12 The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     14 Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     1 Basics, Initial and Boundary Value problems, Steady state, Phase portrait, Chemical kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     9 First order equations &amp; Integrating factors. Second order equations, Newton’s laws and equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     12 The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     13 Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     14 Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     15 Partial Differential Equations, PDE. 1D &amp; 2D diffusion, Particle in a box, Lateral flow tests, Diffusion and Reaction, Cable equation, Algal Blooms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     16 PDE continued. Diffusion, Wave and Schroedinger eqns. Solution by the Fourier method. Transient grating.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     1 Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     4 Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     5 Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     6 The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     8 Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     9 Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     1 Monte - Carlo integration &amp; importance sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     2 Solving rate equations. The Gillespie method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     3 Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     4 Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     6 The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     1 Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     6 Modelling data. Least squares, chi squared, residuals, ANNOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     7 Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     10 Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-14/chapter14-intro.html">
   14 SI Units, Scientific Constants, unit conversion, Glossary, Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/chapter14-E.html">
     1 SI Units, Unit conversions, Scientific Constants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-14/Python%20crib.html">
     5 Appendix:  Some basic Python instructions with a few examples.
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../references/references-intro.html">
   15 References and index
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/References.html">
     1 References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../references/index.html">
     2 Index
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-4/integration-F.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-4/integration-F.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/subblue/applying-maths-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-4/integration-F.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-4/integration-F.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   10 Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-values-moments-of-inertia-and-centroids">
   10.1 Mean values, moments of inertia, and centroids
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#triple-integrals">
   10.2 Triple integrals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#change-of-variables-in-integrals-jacobians">
   11 Change of variables in integrals: Jacobians
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-a-coordinate-change-may-simplify">
     <strong>
      (i) A coordinate change may simplify
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-covert-to-plane-polar-coordinates">
     <strong>
      (ii) Covert to plane polar coordinates
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-change-to-polar-coordinates">
     <strong>
      (iii) Change to polar coordinates
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-a-second-polar-coordinate-example">
     <strong>
      (iv) A second polar coordinate example
     </strong>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>10 Multiple integrals, Change of variables: Jacobians</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   10 Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-values-moments-of-inertia-and-centroids">
   10.1 Mean values, moments of inertia, and centroids
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#triple-integrals">
   10.2 Triple integrals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#change-of-variables-in-integrals-jacobians">
   11 Change of variables in integrals: Jacobians
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i-a-coordinate-change-may-simplify">
     <strong>
      (i) A coordinate change may simplify
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ii-covert-to-plane-polar-coordinates">
     <strong>
      (ii) Covert to plane polar coordinates
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iii-change-to-polar-coordinates">
     <strong>
      (iii) Change to polar coordinates
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iv-a-second-polar-coordinate-example">
     <strong>
      (iv) A second polar coordinate example
     </strong>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="multiple-integrals-change-of-variables-jacobians">
<h1>10 Multiple integrals, Change of variables: Jacobians<a class="headerlink" href="#multiple-integrals-change-of-variables-jacobians" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">init_printing</span><span class="p">()</span>                         <span class="c1"># allows printing of SymPy results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<section id="introduction">
<h2>10 Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Many functions contain two or more variables; for instance, the distance of the electron in a hydrogen atom depends on its x, y, and z-position from the nucleus. Any point on a plane is given by its x- and y-coordinates or on the earth by its latitude and longitude. To evaluate a double or triple integral, each integral is performed with the same rules as a single integral but care must be taken to sort out the integration limits. The use of multiple integrals quite often involves transforming variables, from Cartesian <span class="math notranslate nohighlight">\(x, y, z\)</span> to different forms of polar or cylindrical coordinates depending on the problem. The only reason for doing this is to simplify the integration and the only difficulty is unfamiliarity with the new coordinates.</p>
<p>Integrating over a surface such as <span class="math notranslate nohighlight">\(f (x, y)\)</span> with the double integral <span class="math notranslate nohighlight">\(\int\int f (x, y)dydx\)</span> means integrating along the x- and y-axes to obtain the volume between the surface and the <span class="math notranslate nohighlight">\(x-y\)</span> plane. The extent of the integration is determined by the limits to the integration in the <span class="math notranslate nohighlight">\(x-y\)</span> plane. Figure 22 shows the case when the limits are constants and then the integral is written as</p>
<div class="math notranslate nohighlight">
\[\displaystyle A=\int_a^b\int_c^d f(x,y)dydx \tag{49}\]</div>
<p><img alt="Drawing" src="../_images/integration-fig22.png" /></p>
<p>Figure 22. A double integral pictured as the volume between a surface, shown as a blue mesh, and the <span class="math notranslate nohighlight">\(x-y\)</span> plane, shown as a circle.</p>
<hr class="docutils" />
<p>The volume produced is like a rectangular rod with a flat base but a top cut to the shape of the function. The next integral is easily evaluated as two separate ones because the integration limits are constants and the terms can be separated. Note how the integral signs and the variables are written - inside to inside and first to last:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\pi\int_0^{\pi/2} \cos(\theta)\sin(\phi)d\theta d\phi =\int_0^\pi \sin(\phi) d\phi\int_0^{\pi /2} \cos(\theta)d\theta=2\]</div>
<p>In quantum mechanics, double and triple integrals often have the form where one coordinate’s function is unity and integration is made over some range of angles; <span class="math notranslate nohighlight">\(\varphi\)</span> ranges from <span class="math notranslate nohighlight">\(0 \to \pi\)</span> in the following integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\pi d\varphi \int_0^{\pi/2} \cos(\theta) \sin(\theta) d\theta=\pi\int_0^{\pi/2} \cos(\theta) \sin(\theta)d\theta=\frac{\pi}{2}\]</div>
<p><img alt="Drawing" src="../_images/integration-fig23.png" /></p>
<p>Figure 23. Limits to the double integral in the <span class="math notranslate nohighlight">\(x-y\)</span> plane. The integral is th volume above the shaded area and towards the reader and extends to the function <span class="math notranslate nohighlight">\(f(x,y)\)</span>.</p>
<hr class="docutils" />
<p>More interesting is the case when the double integral is bounded in the plane by variable limits. As shown in figure 23, <span class="math notranslate nohighlight">\(x\)</span> has limits <span class="math notranslate nohighlight">\(a \to b\)</span> but <span class="math notranslate nohighlight">\(y\)</span> has limits which are the functions <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(h\)</span>, which both depend on <span class="math notranslate nohighlight">\(x\)</span>. As the <span class="math notranslate nohighlight">\(y\)</span> limits are not constant the integral is written as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_R\int f(x,y)dydx \equiv \int_a^b\left( \int_{g(x)}^{h(x)} f(x,y)dy \right)dx \tag{50}\]</div>
<p>Notice also the order of integration. As written, the integration on <span class="math notranslate nohighlight">\(y\)</span> must be performed first and the result is a function of <span class="math notranslate nohighlight">\(x\)</span> and is integrated last. The <span class="math notranslate nohighlight">\(y\)</span> integration has to have limits depending on <span class="math notranslate nohighlight">\(x\)</span> or ones that are constant. It cannot have limits depending on y because the result could not be integrated by <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Suppose that <span class="math notranslate nohighlight">\(f=\ln(x)\)</span> and the two functions <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(h\)</span> are <span class="math notranslate nohighlight">\(g=x^2\)</span> and <span class="math notranslate nohighlight">\(h=2-x^2\)</span> and the <span class="math notranslate nohighlight">\(x\)</span> integration range is from <span class="math notranslate nohighlight">\(-1 \to 1\)</span>, as shown in Figure 24. The double integral is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_R\int f(x,y)dxdy=\int_{-1}^1\int_{x^2}^{2-x^2}\ln(y)dydx \tag{51}\]</div>
<p>The inner integral has to be found first which will give a result in <span class="math notranslate nohighlight">\(x\)</span>. This is then integrated. The inner integral is a standard one and using Sympy to do the calculation and put in limits gives</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">,</span> <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">ansy</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>  
</pre></div>
</div>
</div>
</div>
<p>Integrating this result with <span class="math notranslate nohighlight">\(x\)</span> from <span class="math notranslate nohighlight">\(-1 \to 1\)</span> gives</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simplify</span><span class="p">(</span> <span class="n">integrate</span><span class="p">(</span><span class="n">ansy</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-F_5_0.png" src="../_images/integration-F_5_0.png" />
</div>
</div>
<p>and this result can also be expressed using <span class="math notranslate nohighlight">\(\displaystyle 2\tanh^{-1}(x)=\frac{\ln(1+x)}{\ln(1-x)}\)</span> as <span class="math notranslate nohighlight">\(\displaystyle \int_{-1}^1\int_{x^2}^{2-x^2}\ln(y)dydx=-\frac{64}{9}+\frac{16}{3}\tanh^{-1}\left(\frac{1}{\sqrt{2}} \right)\)</span>.</p>
</section>
<section id="mean-values-moments-of-inertia-and-centroids">
<h2>10.1 Mean values, moments of inertia, and centroids<a class="headerlink" href="#mean-values-moments-of-inertia-and-centroids" title="Permalink to this headline">#</a></h2>
<p>The double integral is useful in obtaining the mean value, centroids and moments of inertia of functions and is an alternative way to that described in Section 8.2. In these equations the order of integration is not necessarily implied by the way in which they are written. The integration order is unimportant if the integration limits are constants but is if they depend on x then the y integral must be done first as in equation 51.</p>
<p>The integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle A=\int\int 1\,dxdy \tag{52}\]</div>
<p>is a <em>volume</em> of unit thickness. The result <span class="math notranslate nohighlight">\(A\)</span> is also called a <em>lamina</em>, which is a sheet of unit but uniform thickness.</p>
<p>The <em>x-centroid</em>, the average position of the x-coordinate of the function is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \langle x\rangle =\frac{1}{A}\int\int x\,dxdy \tag{53}\]</div>
<p>and similarly for the y-coordinate <span class="math notranslate nohighlight">\(\displaystyle \langle y\rangle =\frac{1}{A}\int\int y\,dxdy\)</span>.</p>
<p>If the density is not constant but is described by a function <span class="math notranslate nohighlight">\(f(x, y)\)</span> then the formulae are changed to;</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \langle x\rangle =\frac{1}{A}\int\int xf(x,y)\,dxdy,\quad \langle y\rangle =\frac{1}{A}\int\int yf(x,y)\,dxdy,\quad A=\int\int f(x,y)\,dxdy \tag{54}\]</div>
<p>which is essentially equation 28. The position of the centroids is often called the <em>centre of gravity</em> of the object.</p>
<p>By definition, the moment of inertia of an object about an axis is the product of the distance squared from the axis times the mass; <span class="math notranslate nohighlight">\(I = mL^2\)</span>. If the body is extended, then the integration must be performed over the entire shape. Should the mass is distributed as <span class="math notranslate nohighlight">\(f (x, y)\)</span> then the x-direction moment of inertia depends on the distance from the y-axis and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  I_x=\int\int y^2f(x,y)dydx \tag{55}\]</div>
<p>The y-direction moment is calculated similarly using <span class="math notranslate nohighlight">\(x^2\)</span>,</p>
<div class="math notranslate nohighlight">
\[\displaystyle I_y=\int\int x^2f(x,y)dxdy \]</div>
<p>If the mass is uniform then the function f is a constant and can be taken outside the integration.</p>
<p>These various calculations are now illustrated. To calculate the lamina’s area using equation 52 the limits have to be defined. In Figure 24 the closed area is that bounded by <span class="math notranslate nohighlight">\(g = x^2\)</span> and <span class="math notranslate nohighlight">\(h = 2 - x^2\)</span> from <span class="math notranslate nohighlight">\(x = -1 \to 1\)</span> and these will determine the integration limits. Notice that the <span class="math notranslate nohighlight">\(y\)</span> integral is performed first which produces a result in <span class="math notranslate nohighlight">\(x\)</span> that is then integrated. The area is calculated as</p>
<div class="math notranslate nohighlight">
\[\displaystyle A=\int_{-1}^1\int_{x^2}^{2-x^2} dydx =\int_{-1}^1\left( y\,\bigg|_{x^2}^{2-x^2}\right)dx =\int_{-1}^1 2(1-x^2)dx=\frac{8}{3}\]</div>
<p>The centroids are</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \langle x\rangle =\frac{1}{A}\int_{-1}^1\int_{x^2}^{2-x^2}x  \, dydx =\frac{1}{A}\int_{-1}^1 x \left( y\,\bigg|_{x^2}^{2-x^2}\right)dx =0 \]</div>
<div class="math notranslate nohighlight">
\[\displaystyle  \langle y\rangle =\frac{1}{A}\int_{-1}^1\int_{x^2}^{2-x^2}y\,  dydx =\frac{1}{A}\int_{-1}^1  \left( \frac{y^2}{2}\,\bigg|_{x^2}^{2-x^2}\right)dx =1\]</div>
<p>as would be expected for this symmetrical shape.</p>
<p><img alt="Drawing" src="../_images/integration-fig24.png" /></p>
<p>Figure 24. Area bound by <span class="math notranslate nohighlight">\(x^2\)</span> and <span class="math notranslate nohighlight">\(2 - x^2\)</span> between <span class="math notranslate nohighlight">\(-1\)</span> and <span class="math notranslate nohighlight">\(1\)</span> is shown as the solid line. Rotation about <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> is indicated illustrating that the x-axis moment of inertia will be largest. The centroid (<span class="math notranslate nohighlight">\(0,\,1\)</span>) is marked.</p>
<hr class="docutils" />
<p>The moments of inertia of an object, even with some symmetry, are generally quite different along its various axes and this is the case for the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> moments of inertia of the lamina Figure 24. Using equation 55 with <span class="math notranslate nohighlight">\(y^2\)</span> or <span class="math notranslate nohighlight">\(x^2\)</span> as necessary and assuming uniform density of <span class="math notranslate nohighlight">\(1,\, f (x, y) = 1\)</span> then the moments of inertia <span class="math notranslate nohighlight">\(I_y\)</span> and <span class="math notranslate nohighlight">\(I_x\)</span> about the y- and x-axes are respectively, <span class="math notranslate nohighlight">\(\displaystyle I_y=\int_{-1}^1 \int_{x^2}^{2-x^2} x^2 dydx,\; I_x=\int_{-1}^1 \int_{x^2}^{2-x^2} y^2 dydx\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Ix</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span> <span class="n">integrate</span><span class="p">(</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="p">)</span>
<span class="n">Iy</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span> <span class="n">integrate</span><span class="p">(</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ix</span><span class="p">,</span><span class="s1">&#39;;&#39;</span><span class="p">,</span><span class="n">Iy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>344/105 ; 8/15
</pre></div>
</div>
</div>
</div>
<p>The moment of inertia about the x-axis is greater (by approximately <span class="math notranslate nohighlight">\(6\)</span> times) than that about <span class="math notranslate nohighlight">\(y\)</span> because the rotation about <span class="math notranslate nohighlight">\(x\)</span> involves the whole body rotating around this axis whereas the body is symmetrically disposed about the y-axis and therefore the moment of inertia is smaller. The moments of inertia of molecules are described in Chapter 7.15.</p>
</section>
<section id="triple-integrals">
<h2>10.2 Triple integrals<a class="headerlink" href="#triple-integrals" title="Permalink to this headline">#</a></h2>
<p>Triple integrals are calculated in a similar way to double ones, but instead of producing a volume a density function is produced. This might literally be density if the mass/unit volume of a solid is known, but generally, density is taken to mean the amount of ‘stuff’ in a given volume such as electron density or probability of being at a certain position in an atomic orbital.</p>
<p>One commonly met triple integral is the normalization of a wavefunction <span class="math notranslate nohighlight">\(\psi(r, \theta, \phi)\)</span>; when integrated over all space the product <span class="math notranslate nohighlight">\(\psi^* \psi\)</span> must be unity. This means that</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^{2\pi}\int_0^\pi\int_0^\infty \psi(r, \theta, \phi)^* \psi(r, \theta, \phi) r^2\sin(\theta)drd\theta d\phi =1  \tag{56}\]</div>
<p>where the superscript * indicates a complex conjugate. The <span class="math notranslate nohighlight">\(r^2\sin(\theta)drd\theta d\phi\)</span> term comes from converting the volume element <span class="math notranslate nohighlight">\(dxdydz\)</span> in Cartesian to spherical polar coordinates; see Section 11 where the calculation of this conversion is described. The limits are almost invariably the same for quantum problems. The polar angle <span class="math notranslate nohighlight">\(\theta\)</span> ranges from north to south and can only have values from <span class="math notranslate nohighlight">\(0 \to \pi\)</span>. The azimuthal (equatorial) angle <span class="math notranslate nohighlight">\(\phi\)</span> moves around the equator so ranges from <span class="math notranslate nohighlight">\(0 \to 2\pi\)</span>.</p>
<p>One of the <span class="math notranslate nohighlight">\(3\)</span>p atomic orbitals has quantum numbers <span class="math notranslate nohighlight">\(n = 3,\, s = 1, \, m = 1\)</span>, and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi_{311}=N\frac{r}{a_0}\left( 6-\frac{r}{a_0} \right)e^{-r/3a_0}\sin(\theta)e^{i\phi}  \tag{57}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the normalization constant we want to find. Because <span class="math notranslate nohighlight">\(r, \,\theta, \, \phi\)</span> are separate there being no term in a product such as  <span class="math notranslate nohighlight">\(\theta\phi\)</span> when calculating equation (4.56), the integrals in <span class="math notranslate nohighlight">\(r,\, \theta\)</span>, and <span class="math notranslate nohighlight">\(\phi\)</span> can be treated separately. The integral of <span class="math notranslate nohighlight">\(\psi^*\psi\)</span> just in <span class="math notranslate nohighlight">\(r\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \frac{N^2}{a_0^2}\int_0^\infty r^2\left( 6-\frac{r}{a_0} \right)^2e^{-2r/3a_0}r^2= \frac{19683}{8}a_0N^4  \tag{58}\]</div>
<p>where the second <span class="math notranslate nohighlight">\(r^2\)</span> comes from the volume element, eqn 56. This integral has a standard form, (two terms of the type <span class="math notranslate nohighlight">\(x^ne^{-ax}\)</span>) which can be integrated by parts; see (2.13). Using Sympy, because the calculation while straightforward is involved, gives for the radial part equation 58</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a0</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a0,r,N&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">eq</span><span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="n">r</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a0</span><span class="p">))</span>
<span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">a0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">integrate</span><span class="p">(</span><span class="n">eq</span><span class="p">,(</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">oo</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-F_9_0.png" src="../_images/integration-F_9_0.png" />
</div>
</div>
<p>The angular part of the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^{2\pi}d\phi\int_0^\pi \sin(\theta)e^{i\phi} \sin(\theta)e^{-i\phi} \sin(\theta) d\theta d\phi\]</div>
<p>are simplified by separating the <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> integrals into two then evaluating the complex conjugate first, because <span class="math notranslate nohighlight">\(e^{-i\phi}e^{i\phi} = 1\)</span>. The remaining integral is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^{2\pi}d\phi\int_0^\pi\sin^3(\theta)d\theta = 2\pi\int_0^\pi\sin^3(\theta)d\theta =\frac{8}{3}\pi\]</div>
<p>and the sine integral was worked out by converting to the exponential form. Multiplying the two results and rearranging gives the normalization as <span class="math notranslate nohighlight">\(\displaystyle N=\frac{1}{81\sqrt{\pi}}\sqrt{\frac{1}{a_0^3}}\)</span></p>
</section>
<section id="change-of-variables-in-integrals-jacobians">
<h2>11 Change of variables in integrals: Jacobians<a class="headerlink" href="#change-of-variables-in-integrals-jacobians" title="Permalink to this headline">#</a></h2>
<p>In Section 3 the method of simplifying an integration by a change of variable was described. A commonly used change of variables in multiple integrals is from Cartesian either to plane polar or spherical polar coordinates. The (plane) polar coordinates are two dimensional and spherical polar are three dimensional; see Chapter 1.6.1. They are used only to simplify a calculation by using those coordinates that reflect the underlying symmetry of the problem being studied, thus the shapes of the s, p, d and other atomic wavefunctions (orbitals) are naturally described in terms of three-dimensional spherical polar coordinates with a radius <span class="math notranslate nohighlight">\(r\)</span>, a polar <span class="math notranslate nohighlight">\(\theta\)</span>, and an equatorial (azimuthal) angle <span class="math notranslate nohighlight">\(\phi\)</span>. However, many two or three or higher dimensional integrations can be simplified by a suitable algebraic substitution, which may also be thought of as a change of coordinates. Fortunately, there is a systematic way of doing this using a determinant of derivatives, called the Jacobian and these are described in this section. Determinants are described in Chapter 7.</p>
<p>A one-dimensional example is considered first. An apparently hard integral such as
<span class="math notranslate nohighlight">\(\displaystyle \int_0^b x\sqrt{ a^2 -x^2} dx\)</span> can be simplified by substituting <span class="math notranslate nohighlight">\(u = a^2 - x^2\)</span>, calculating the differential <span class="math notranslate nohighlight">\(du=-2xdx\)</span> and changing the limits. The result is</p>
<div class="math notranslate nohighlight">
\[\displaystyle -\frac{1}{2}\int_{a^2}^{a^2-b^2}\sqrt{u}du = \frac{1}{3}(a^3-(a^2-b^2)^{3/2} )\]</div>
<p>Ignoring the limits for clarity, a general integral of a function <span class="math notranslate nohighlight">\(f(x)\)</span> and its substitution
can be written as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int f(x)dx= \int F(u)\frac{dx}{du}=\int F(u)\,J(x,u)du\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the function <span class="math notranslate nohighlight">\(f\)</span> in the new variable <span class="math notranslate nohighlight">\(u\)</span> and the new function <span class="math notranslate nohighlight">\(J\)</span> contains the terms needed to ‘distort’ <span class="math notranslate nohighlight">\(dx\)</span> into <span class="math notranslate nohighlight">\(du\)</span>. This is done by using the differential <span class="math notranslate nohighlight">\(dx = J(x, u)du\)</span>  where</p>
<div class="math notranslate nohighlight">
\[\displaystyle J(x,u)=\frac{dx}{du}=-\frac{1}{2x}=-\frac{2}{2\sqrt{a^2-u}}\]</div>
<p>A two-dimensional integral in its general form with a change of coordinates is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \int f(x,y)dxdy=\int\int F(u,v) \,J(x,y,u,v)\,dudv\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> is some normal function of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, perhaps <span class="math notranslate nohighlight">\(\sin(y)/\sin(x)\)</span> and <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are functions of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. What these are depends on the particular calculation. In three dimensions, the general equation for the transformation is similar but rather formidable,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int \int\int   f(x,y,z)dxdydz=\int\int\int F(r,\theta,\phi) \,J(x,y,z,r,\theta,\phi )\,dr d\theta d\phi\]</div>
<p><img alt="Drawing" src="../_images/integration-fig25.png" /></p>
<p>Figure 25. An area in <span class="math notranslate nohighlight">\(dxdy\)</span> and morphed to an equal value <span class="math notranslate nohighlight">\(rdrd\theta\)</span> in Cartesian and plane polar coordinates. Infinitesimal lengths <span class="math notranslate nohighlight">\(dx\)</span> etc. are greatly exaggerated relative to the axes. <span class="math notranslate nohighlight">\(\theta\)</span> is the angle formed by moving anticlockwise from zero degrees starting at the horizontal line.</p>
<hr class="docutils" />
<p>The change of coordinates means that the volume <span class="math notranslate nohighlight">\(dxdydz\)</span> has to be distorted or morphed into an equivalent volume in the new coordinates <span class="math notranslate nohighlight">\(drd\theta d\phi\)</span>. Therefore the new function, the <em>Jacobian</em> <span class="math notranslate nohighlight">\(J(x, y, z, r, \theta, \phi)\)</span>, has to be found.</p>
<p>Any coordinate change or substitution has three parts</p>
<p><strong>(a)</strong> Calculating the Jacobian,</p>
<p><strong>(b)</strong> Substituting the new variables into the function <span class="math notranslate nohighlight">\(f\)</span>,</p>
<p><strong>(c)</strong> Changing any limits on the integration to the new coordinates.</p>
<p>These are best illustrated with examples. A point (<span class="math notranslate nohighlight">\(x, y, z\)</span>) is equivalently (<span class="math notranslate nohighlight">\(r, \theta, \varphi\)</span>) in <em>spherical polar</em> coordinates, the connection between the two sets of coordinates is described by geometry and is</p>
<div class="math notranslate nohighlight">
\[x=r\sin(\theta)\cos(\varphi),\qquad y=r\sin(\theta)\sin(\varphi),\qquad z=r\cos(\theta)\]</div>
<p>In <em>plane polar</em> or just <em>polar</em> coordinates the point (<span class="math notranslate nohighlight">\(x, y\)</span>) is represented as (<span class="math notranslate nohighlight">\(r, \theta\)</span>) with</p>
<div class="math notranslate nohighlight">
\[\displaystyle x=r\cos(\theta), \qquad y=r\sin(\theta)\]</div>
<p>In this case the area element <span class="math notranslate nohighlight">\(dxdy\)</span> becomes <span class="math notranslate nohighlight">\(rdrdθ\)</span> and these are shown in Fig. 4.25.</p>
<p>In the case of the polar coordinates the area is relatively easily calculated. The circumference of a circle is <span class="math notranslate nohighlight">\(2\pi r\)</span>, which is the radius times the angle rotated which is <span class="math notranslate nohighlight">\(2\pi\)</span> radians. The length of the arc for a small angle is therefore <span class="math notranslate nohighlight">\(rd\theta\)</span> for angular change <span class="math notranslate nohighlight">\(d\theta\)</span>. The radius extends from <span class="math notranslate nohighlight">\(r \to r + dr\)</span> making the area <span class="math notranslate nohighlight">\(rdrd\theta\)</span>. For other coordinates, the geometrical calculation is complex and an algebraic method is therefore preferred. This method, presented without proof, is to form the <em>Jacobian</em>, which is the determinant of the derivatives of the equation converting one set coordinates into the other.</p>
<p>Consider now the spherical polar coordinates, the function <span class="math notranslate nohighlight">\(J(x, y, z, r, \theta, \varphi)\)</span> is needed
and changing to the conventional notation this is the determinant of the partial derivatives of <span class="math notranslate nohighlight">\(x, y, z\)</span> with <span class="math notranslate nohighlight">\(r, \theta, \varphi\)</span> and is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle  \qquad\qquad J\left( \frac{x,y,z}{r,\theta,\varphi} \right) \equiv \frac{\partial(x,y,z)}{\partial(r,\theta,\varphi)} = 
\begin{vmatrix}
   \displaystyle \frac{\partial x}{\partial r} &amp; \displaystyle\frac{\partial x}{\partial \theta} &amp;\displaystyle \frac{\partial x}{\partial \varphi} \\
    \displaystyle\frac{\partial y}{\partial r} &amp; \displaystyle\frac{\partial y}{\partial \theta} &amp; \displaystyle \frac{\partial y}{\partial \varphi} \\
    \displaystyle\frac{\partial z}{\partial r} &amp; \displaystyle\frac{\partial x}{\partial \theta} &amp; \displaystyle \frac{\partial z}{\partial \varphi} \\
    \end{vmatrix}  \qquad\qquad\qquad\qquad\qquad\qquad\text{(59)}\end{split}\]</div>
<p>Notice the ordering; the old coordinates <span class="math notranslate nohighlight">\(x, y, z\)</span> are on the top of each differentiation. Note also the notation in the brackets with <span class="math notranslate nohighlight">\(J\)</span>. Using equation 59 the determinant is</p>
<div class="math notranslate nohighlight">
\[\begin{split}J\left( \frac{x,y,z}{r,\theta,\varphi} \right)= \begin{vmatrix}
   \sin(\theta)\cos(\varphi) &amp; r\cos(\theta)\cos(\varphi) &amp; -r\sin(\theta)\sin(\varphi) \\
   \sin(\theta)\sin(\varphi) &amp; r\cos(\theta)\sin(\varphi) &amp; r\sin(\theta)\cos(\varphi) \\
    \cos(\theta) &amp; -r\sin(\theta) &amp; 0 \\
    \end{vmatrix}  =r^2\sin(\theta)\end{split}\]</div>
<p>The volume element conversion is then written as</p>
<div class="math notranslate nohighlight">
\[\displaystyle dxdydx=r^2\sin(\theta)dr d\theta d\varphi  \tag{60}\]</div>
<p>In some cases, the determinant may produce a negative answer depending on the order of calculating the derivatives; however, the Jacobian represents an area or volume element so the positive result may legitimately be taken in such cases.</p>
<p>A few examples are now worked through.</p>
<section id="i-a-coordinate-change-may-simplify">
<h3><strong>(i) A coordinate change may simplify</strong><a class="headerlink" href="#i-a-coordinate-change-may-simplify" title="Permalink to this headline">#</a></h3>
<p>A coordinate change will simplify the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\int \frac{1}{\sqrt{(x-y)^2+2(x+y)+1}}dxdy\]</div>
<p>The changes are <span class="math notranslate nohighlight">\(x=u(1+v),\, y=v(1+u)\)</span>. The general form of the equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int\int f(x,y)dxdy=\int\int F(u,v)\frac{\partial(x,y)}{\partial (u,v)}dudv\]</div>
<p>The first two steps in the calculation are necessary because no limits are given. In step (a) the Jacobian is calculated and is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \frac{\partial(x,y)}{\partial (u,v)}= \begin{vmatrix} 1+v &amp; u\\v&amp; 1+u \end{vmatrix}=1+u+v\end{split}\]</div>
<p>Step (b) is substituting into the function to find <span class="math notranslate nohighlight">\(F(u, v)\)</span> and this produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle \frac{1}{\sqrt{(x-y)^2+2(x+y)+1} }= \frac{1}{\sqrt{(u-v)^2+2(u+v)+4uv+1}}=\frac{1}{1+u+v}\]</div>
<p>and multiplying this with the Jacobian makes the integral rather simple:</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \int\int \frac{1}{\sqrt{(x-y)^2+2(x+y)+1}}dxdy=\int\int1 dudv=uv +c\]</div>
</section>
<section id="ii-covert-to-plane-polar-coordinates">
<h3><strong>(ii) Covert to plane polar coordinates</strong><a class="headerlink" href="#ii-covert-to-plane-polar-coordinates" title="Permalink to this headline">#</a></h3>
<p>The integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle I=\int_0^1\int_0^\sqrt{1-x^2} x(1-xy^3)dydx\]</div>
<p>can be solved by converting to (plane) polar coordinates. The limits are converted first. As <span class="math notranslate nohighlight">\(x\)</span> extends from <span class="math notranslate nohighlight">\(0 \to 1\)</span> so does <span class="math notranslate nohighlight">\(r\)</span> as this is the radius in polar coordinates. As <span class="math notranslate nohighlight">\(x = r\cos(\theta)\)</span> and <span class="math notranslate nohighlight">\(y = r\sin(\theta)\)</span> then <span class="math notranslate nohighlight">\(r^2 = x^2 + y^2\)</span>, which represents a circle. The maximum value <span class="math notranslate nohighlight">\(r = 1\)</span>; therefore <span class="math notranslate nohighlight">\(x^2 + y^2 = 1\)</span> and integration is around the first quadrant of a circle of unit radius, in the new coordinates the integration area is a rectangle where <span class="math notranslate nohighlight">\(r\)</span> ranges from <span class="math notranslate nohighlight">\(0 \to 1\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> from <span class="math notranslate nohighlight">\(0 \to \pi/2\)</span>. The angle <span class="math notranslate nohighlight">\(\theta\)</span> varies from <span class="math notranslate nohighlight">\(0 \to \pi/2\)</span> and <span class="math notranslate nohighlight">\(r\)</span> from <span class="math notranslate nohighlight">\(0 \to 1\)</span>, Figure 26, making,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^1\int_0^\sqrt{1-x^2} x(1-xy^3)dydx =\int_0^1\int_0^{\pi/2} \left(r\cos(\theta)-r^2\cos^2(\theta)r^3\sin^3(\theta)\right)r\,d\theta dr\]</div>
<p><img alt="Drawing" src="../_images/integration-fig26.png" /></p>
<p>Figure 26. The integration area in the <span class="math notranslate nohighlight">\(x-y\)</span> and <span class="math notranslate nohighlight">\(r-\theta\)</span> planes, <span class="math notranslate nohighlight">\(r\)</span> ranges from <span class="math notranslate nohighlight">\(0 \to 1\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> from <span class="math notranslate nohighlight">\(0 \to \pi/2\)</span>.</p>
<hr class="docutils" />
<p>Evaluating the integral in <span class="math notranslate nohighlight">\(\theta\)</span> first produces <span class="math notranslate nohighlight">\(\displaystyle r^2-\frac{2}{15}r^6\)</span> which is easily integrated to five <span class="math notranslate nohighlight">\(\displaystyle I=\frac{11}{35}\)</span>. The angular integral using Sympy is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">theta</span><span class="o">=</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x,y,r,theta&#39;</span><span class="p">,</span><span class="n">positive</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">eq</span><span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">-</span><span class="n">r</span><span class="o">**</span><span class="mi">6</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>

<span class="n">integrate</span><span class="p">(</span> <span class="n">eq</span><span class="p">,</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-F_12_0.png" src="../_images/integration-F_12_0.png" />
</div>
</div>
</section>
<section id="iii-change-to-polar-coordinates">
<h3><strong>(iii) Change to polar coordinates</strong><a class="headerlink" href="#iii-change-to-polar-coordinates" title="Permalink to this headline">#</a></h3>
<p>The following integral will be solved by transforming to polar coordinates</p>
<div class="math notranslate nohighlight">
\[\displaystyle I= \int_0^\infty\int_0^x x^2e^{-x^2-y^2}dxdy\]</div>
<p>Using equation 59 gives,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \frac{\partial(x,y)}{\partial(r,\theta)} = \begin{vmatrix}\cos(\theta) &amp; -r\sin(\theta) \\\sin(\theta)  &amp; r\cos(\theta) \\ \end{vmatrix} =r\end{split}\]</div>
<p>as determined also by the geometrical argument in Figure 25. A limit of <span class="math notranslate nohighlight">\(x\)</span> means that this varies as <span class="math notranslate nohighlight">\(y = x\)</span> a line with a gradient of one or at <span class="math notranslate nohighlight">\(45^\mathrm{o}\)</span> to the x-axis which is the same as <span class="math notranslate nohighlight">\(\theta = \pi/4\)</span>. The integration is therefore in the area from <span class="math notranslate nohighlight">\(\theta = 0 \to \pi/4\)</span> and with <span class="math notranslate nohighlight">\(r\)</span> extending from <span class="math notranslate nohighlight">\(0 \to \infty\)</span>.</p>
<p>Substituting into the integral gives</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_0^\infty \int_0^x x^2e^{-x^2-y^2}dxdy =\int_0^\infty \int_0^{\pi/4} r^2\cos^2(\theta)e^{-r^2}rdrd\theta\]</div>
<p>which can be separated into integrals in <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span>, since there is no term in both variables, and the limits of the integration are constants. The integrals are standard ones, see Section 2.13. Using Sympy gives <span class="math notranslate nohighlight">\(\displaystyle I=\frac{1}{8}\left( \frac{\pi}{2}-1  \right)\)</span>. The calculation is shown below without limits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span><span class="n">theta</span><span class="o">=</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r,theta&#39;</span><span class="p">,</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">eqr</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ans_r</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">eqr</span><span class="p">,</span><span class="n">r</span> <span class="p">)</span>
<span class="n">eqt</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ans_theta</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">eqt</span><span class="p">,</span><span class="n">theta</span> <span class="p">)</span>
<span class="n">trigsimp</span><span class="p">(</span> <span class="n">expand</span><span class="p">(</span><span class="n">ans_r</span><span class="o">*</span><span class="n">ans_theta</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-F_14_0.png" src="../_images/integration-F_14_0.png" />
</div>
</div>
<p><img alt="Drawing" src="../_images/integration-fig27.png" /></p>
<p>Figure 27 Example (iv). Integration limits in the <span class="math notranslate nohighlight">\(\theta - r\)</span> plane.</p>
</section>
<hr class="docutils" />
<section id="iv-a-second-polar-coordinate-example">
<h3><strong>(iv) A second polar coordinate example</strong><a class="headerlink" href="#iv-a-second-polar-coordinate-example" title="Permalink to this headline">#</a></h3>
<p>The integral <span class="math notranslate nohighlight">\(\displaystyle I = \int_0^3\int_0^1\frac{x^2}{(x^2+y^2)^{5/2}}dxdy\)</span></p>
<p>can be solved by converting to polar coordinates first then changing the integration limits. Converting produces</p>
<div class="math notranslate nohighlight">
\[\displaystyle I = \int\int\frac{\cos^2(\theta)}{r^2}dr d\theta\]</div>
<p>Changing the limits is more involved in this example. The initial values are a rectangular shaped area bounded by <span class="math notranslate nohighlight">\(x=0 \to 1\)</span> and <span class="math notranslate nohighlight">\(y=1 \to 3\)</span>. When <span class="math notranslate nohighlight">\(x\)</span> is zero <span class="math notranslate nohighlight">\(\theta=\pi/2\)</span>,and the boundary line <span class="math notranslate nohighlight">\(y = 1\)</span> becomes <span class="math notranslate nohighlight">\(r = 1/\sin(\theta)\)</span>, the line <span class="math notranslate nohighlight">\(y = 3, r = 3/\sin(\theta)\)</span> and <span class="math notranslate nohighlight">\(x = 1, r = 1/\cos(\theta)\)</span> and the integration area in the <span class="math notranslate nohighlight">\(r  - \theta\)</span> is that shape enclosed by these curves as shown in Figure 27. (See Dence 1975, p. 109.)</p>
<p>The integration has to be split into two parts because CD is sloping: the areas ABCE and CDE. The coordinates of the points are the intersections of their respective curves, except E, which is at point <span class="math notranslate nohighlight">\(\left(\tan^{-1}(3), 1/\sin(\,\tan^{-1}(3)\,)\right )\)</span>. The integration limits for <span class="math notranslate nohighlight">\(r\)</span> are <span class="math notranslate nohighlight">\(1/\sin(\theta) \to 3/\sin(\theta)\)</span> and for area ABCE, <span class="math notranslate nohighlight">\(\theta = \tan^{-1}(3) \to \pi/2\)</span> and for CDE, <span class="math notranslate nohighlight">\(\theta = \pi/4 \to \tan^{-1}(3)\)</span>.</p>
<p>The calculation in Sympy is shown below and is in two parts The result for the first part is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{\pi/4}^{\tan^{-1}(3)} \int_{1/\sin(\theta)}^{1/\cos(\theta)} \frac{\cos^2(\theta)}{r^2} dr d\theta =\frac{1}{\sqrt{2}}-\frac{16\sqrt{10}}{75}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r, theta&#39;</span><span class="p">,</span> <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
<span class="n">integrate</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span> <span class="n">eq</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="p">)),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">atan</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>  <span class="c1"># Double integral</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-F_16_0.png" src="../_images/integration-F_16_0.png" />
</div>
</div>
<p>and for the second part <span class="math notranslate nohighlight">\(\displaystyle \int_{\tan^{-1}(3)}^{\pi/2} \int_{1/\sin(\theta)}^{3/\sin(\theta)} \frac{\cos^2(\theta)}{r^2} dr d\theta =\frac{\sqrt{10}}{450}\)</span> making the result <span class="math notranslate nohighlight">\(\displaystyle\frac{1}{\sqrt{2}}-\frac{19\sqrt{10}}{90}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span> <span class="n">eq</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="mi">3</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="p">),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">atan</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/integration-F_18_0.png" src="../_images/integration-F_18_0.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="integration-Q73-77.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 73 - 77</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="integration-Q78-86.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 78 - 86</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Godfrey Beddard<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>