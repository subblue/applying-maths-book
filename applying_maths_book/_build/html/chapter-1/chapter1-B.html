
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials &#8212; Applying Maths in the Chemical &amp; Biomolecular Sciences</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Questions 8 - 16" href="chapter1-Q8-16.html" />
    <link rel="prev" title="Questions 1 - 7" href="chapter1-Q1-7.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/book-cover.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Applying Maths in the Chemical & Biomolecular Sciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Applying Maths in the Chemical and Biomolecular Sciences.
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter1-intro.html">
   1. Numbers, Equations, Operators, and Algorithms.
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-A.html">
     Numbers to Algorithms.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-Q8-16.html">
     Questions 8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-C.html">
     Sophisticated Counting.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-Q17-34.html">
     Questions 17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-D.html">
     Modulo arithmetic,
     <span class="math notranslate nohighlight">
      \(\delta\)
     </span>
     functions, types of  series &amp;  estimating quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-answers-1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-answers-8-16.html">
     Solutions Q8 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-answers-17-34.html">
     Solutions Q17 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter1-answers-35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-2/chapter2-intro.html">
   2. Complex numbers.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-A.html">
     Real, imaginary, conjugate and modulus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-1-9.html">
     Questions 1 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-B.html">
     De Moivre’s theorem and integer powers of complex numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-10-13.html">
     Questions 10 -13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-C.html">
     Euler’s theorem, roots of unity, x-ray diffraction structure factor.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-Q-14-29.html">
     Questions 14 - 29
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-2/chapter2-answers.html">
     Solutions Q1 - 27
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-3/differen-intro.html">
   3. Differentiation.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-A.html">
     Differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-B.html">
     Trig functions, logs, power, reciprocals and integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-C-Q-4-11.html">
     Questions 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-D.html">
     Product rule and function of function or chain rule.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-E-Q-12-42.html">
     Questions 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-F.html">
     Limits, l’Hopital’s rule, Maximum, Minimum and Calculus of Variations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-G-Q-43-73.html">
     Questions 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-H.html">
     Numerically finding the roots of an equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-I-Q-74-85.html">
     Questions 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-J.html">
     Minimizing or maximizing with constraints: Lagrange Undetermined Multipliers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-K-Q-86-92.html">
     Questions 86 - 92
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-L.html">
     Partial differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M-Q-93-114.html">
     Questions 93-114
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-M1.html">
     Differentiation of vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-N-answers-1-11.html">
     Solutions Q 1-11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-O-answers-12-42.html">
     Solutions Q 12-42
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-P-answers-43-73.html">
     Solutions Q 43 - 73
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-Q-answers-74-85.html">
     Solutions Q 74 - 85
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-R-answers-86-92.html">
     Solutions Q 86 - 94
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-3/differen-S-answers-93-114.html">
     Solutions Q 93-114
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-4/integration-intro.html">
   4. Integration.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-A.html">
     Integration basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q1-14.html">
     Questions 1-14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-B.html">
     Integration by substitution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q15-30.html">
     Questions 15-30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-C.html">
     Using parametric equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q31-48.html">
     Questions 31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-D.html">
     Calculating an Average Value.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q49-72.html">
     Questions 49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-E.html">
     The Variational Method in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q73-77.html">
     Questions 73 - 77
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-F.html">
     Multiple integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q78-86.html">
     Questions 78 - 86
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-G.html">
     Calculating the energy of a chemical bond using molecular orbitals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-H.html">
     Line integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-Q87-96.html">
     Questions 87 - 96
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-1-14.html">
     Solutions Q1 - 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-15-30.html">
     Solutions Q15 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-31-48.html">
     Solutions Q31 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-49-72.html">
     Solutions Q49 - 72
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-4/integration-answers-73-96.html">
     Solutions Q73 - 96
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-5/chapter-5-intro.html">
   5. Summations, Series and expansion of Functions.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-A.html">
     Series, averages, partition functions, DNA melting, atom entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-B-Q1-13.html">
     Questions 1 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-E.html">
     Maclaurin and Taylor series expansions. Paramagnetic spins. Euler-Maclaurin formula.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-F-Q14-34.html">
     Questions 14 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-G-Q35-44.html">
     Questions 35 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-A.html">
     Perturbation Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-B-Q45-48.html">
     Questions 45 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-C.html">
     Quantum superposition and wavepackets.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-perturbation-D-Q49-52.html">
     Questions 49 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-1-7.html">
     Solutions Q 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-8-13.html">
     Solutions Q8 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-14-26.html">
     Solutions Q 14 - 26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-27-32.html">
     Solutions Q27 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-33-44.html">
     Solutions Q33 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-5/chapter-5-answers-45-52.html">
     Solutions Q45 - 52
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-6/vectors-intro.html">
   6. Vectors.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-A.html">
     Vector basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q1-24.html">
     Questions 1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-B.html">
     Projections and components
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q25-32.html">
     Questions 25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-C.html">
     Axes need not be right-angled or of equal length
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q33-38.html">
     Questions 33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-D.html">
     Basis sets with more than three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q39-46.html">
     Questions 39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-E.html">
     Cross product or vector product
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q47-52.html">
     Questions 47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-F.html">
     Torsion or dihedral angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q53-48.html">
     Questions 53 - 48
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-G.html">
     Torque and angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-Q59-61.html">
     Questions 59 - 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q1-24.html">
     Solutions Q1 - 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q25-32.html">
     Solutions Q25 - 32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q33-38.html">
     Solutions Q33 - 38
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q39-46.html">
     Solutions Q39 - 46
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q47-52.html">
     Solutions Q47 - 52
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-6/vectors-answers-Q53-61.html">
     Solutions Q53 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-7/matrices-intro.html">
   7. Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-A.html">
     Determinants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q1-10.html">
     Questions  1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-B.html">
     Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q11-16.html">
     Questions  11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-C.html">
     Molecular Group Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q17-30.html">
     Questions  17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-D.html">
     Rotation matrices: moving molecules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q31-34.html">
     Questions 31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-E.html">
     Matrices in optics and designing laser cavities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q35-39.html">
     Questions 35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-F.html">
     Polarizing optics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q40-44.html">
     Questions 40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-G.html">
     Solving equations using matrices. Eigenvectors &amp; Eigenvalues.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q45-50.html">
     Questions 45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-H.html">
     Rate equations and Chemical Kinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q51-54.html">
     Questions 51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-I.html">
     Molecular vibrations and pendulums
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q55-58.html">
     Questions 55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-J.html">
     Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q59-60.html">
     Questions 59 - 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-K.html">
     Calculating a bond length using moments of inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q61.html">
     Question 61
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-L.html">
     Principal axes for Moments of Inertia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-Q62.html">
     Question 62
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ1-10.html">
     Solutions Q1 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ11-16.html">
     Solutions Q11 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ17-30.html">
     Solutions Q17 - 30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ31-34.html">
     Solutions Q31 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ35-39.html">
     Solutions Q35 - 39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ40-44.html">
     Solutions Q40 - 44
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ45-50.html">
     Solutions Q45 - 50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ51-54.html">
     Solutions Q51 - 54
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ55-58.html">
     Solutions Q55 - 58
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-7/matrices-answersQ59-61.html">
     Solutions Q59 - 61
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-8/matricesQM-intro.html">
   8. Matrices in Quantum Mechanics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-A.html">
     Matrices in Quantum Mechanics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-B.html">
     Basis sets and bra-ket algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-C.html">
     Continuous basis sets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-8/matricesQM-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-9/Fourier-intro.html">
   9. Fourier Series and Transforms.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-A-B.html">
     Fourier series, Gibbs phenomenon, generalised series.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-C.html">
     Fourier Transforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-7-15.html">
     Questions 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-D.html">
     Convolution and Autocorrelation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-questions-16-21.html">
     Questions 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-E.html">
     Discrete Fourier  (DFT)  and Fast Fourier transforms (FFT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-F.html">
     The Hadamard Transform: Encoding and Decoding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-1-6.html">
     Solutions Q 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-7-15.html">
     Solutions Q 7 - 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-answers-16-21.html">
     Solutions Q 16 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-2D-Diffraction.html">
     The Fourier transform in two dimensions: images and x-ray Diffraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-9/Fourier-tomography.html">
     Computed Tomography
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/Diff-eqns-intro.html">
   10. Differential Equations.
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-A.html">
     Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q1-23.html">
     Questions 1 - 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-B.html">
     First order eqns &amp; Integrating factors. Second order eqns, Newtons laws, equations of motion.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-C.html">
     The ‘D’ operator.  Solving linear differential equations with constant coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-D.html">
     Simultaneous equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-Q24-37.html">
     Questions 24 - 37
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-E.html">
     Linear equations with variable coefficients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-F.html">
     Partial Differential Equations, PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-G.html">
     PDE examples continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-1-21.html">
     Solutions Q1 - 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/Diff-eqns-answers-22-37.html">
     Solutions Q22 - 37
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/num-methods-intro.html">
   11. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-A.html">
     Numerical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q1-7.html">
     Questions 1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-B.html">
     Numerical solution of differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q8-12.html">
     Questions 8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-C.html">
     Coupled equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q13-16.html">
     Questions 13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-D.html">
     The phase plane, nullclines, and stable points
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q17-20.html">
     Questions 17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-E.html">
     Reaction schemes with feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q21-34.html">
     Questions 21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-F.html">
     Boundary value problems.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-Q35-40.html">
     Questions 35 - 40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers1-7.html">
     Solutions Q1 - 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers8-12.html">
     Solutions Q8 - 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers13-16.html">
     Solutions Q13 - 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers17-20.html">
     Solutions Q17 - 20
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers21-34.html">
     Solutions Q21 - 34
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/num-methods-answers35-40.html">
     Solutions Q35 - 40
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-12/monte-carlo-intro.html">
   12. Monte Carlo Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-A.html">
     Monte - Carlo Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q1-6.html">
     Questions 1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-B.html">
     Solving rate equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q7-10.html">
     Questions 7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-CC.html">
     Monte Carlo Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-C.html">
     Energy transfer. Autocatalytic reaction and spreading of fires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-Q11-17.html">
     Questions 11 - 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-D.html">
     The Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers1-6.html">
     Solutions Q1 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers7-10.html">
     Solutions Q7 - 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-12/monte-carlo-answers11-17.html">
     Solutions Q11 - 17
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-13/analysis-intro.html">
   13. Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-A.html">
     Characterizing experimental data. Accuracy, precision, mean and standard deviation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q1-3.html">
     Questions 1 - 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-B.html">
     Modelling data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q4-9.html">
     Questions 4 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-C.html">
     Modelling data is simpler using matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-Q10-11.html">
     Questions 10 - 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-D.html">
     Non-linear least squares. Least absolute deviation. Principal component analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-13/analysis-answers1-11.html">
     Solutions Q1 -11
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter1-E.html">
   SI units, Rounding, converting units &amp; Glossary.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/References.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references/Python%20crib.html">
   Appendix:  Some basic Python instructions with a few examples.
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapter-1/chapter1-B.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/subblue/applying-maths-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/subblue/applying-maths-book/issues/new?title=Issue%20on%20page%20%2Fchapter-1/chapter1-B.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/subblue/applying-maths-book/main?urlpath=lab/tree/applying_maths_book/chapter-1/chapter1-B.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/subblue/applying-maths-book/blob/main/applying_maths_book/chapter-1/chapter1-B.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trig-functions">
   5.1 Trig functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#waves">
   5.2 Waves
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phase-and-group-velocity">
   5.3 Phase and group velocity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#standing-waves">
   5.4 Standing waves
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#superposition-of-waves-of-the-same-frequency">
   5.5 Superposition of waves of the same frequency
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-from-xray-diffraction">
     <strong>
      Example from xray diffraction
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-with-two-waves">
     <strong>
      Example with two waves
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hyperbolic-functions">
   5.6 Hyperbolic functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inverse-functions">
   6 Inverse functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cartesian-and-polar-coordinates">
   7 Cartesian and polar coordinates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#factorials">
   8 Factorials
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stirling-s-formula">
     <strong>
      Stirling’s formula
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recursion-calculating-factorials-and-orthogonal-polynomials">
   8.1 Recursion. Calculating Factorials and Orthogonal Polynomials.
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="trig-hyperbolic-and-inverse-functions-waves-polar-coordinates-factorials">
<h1>Trig, hyperbolic and inverse functions, waves, polar coordinates &amp; factorials<a class="headerlink" href="#trig-hyperbolic-and-inverse-functions-waves-polar-coordinates-factorials" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## import all python add-ons etc that will be needed later on</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">init_printing</span><span class="p">()</span>                      <span class="c1"># allows printing of SymPy results in typeset maths format</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># set font size for plots</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="trig-functions">
<h2>5.1 Trig functions<a class="headerlink" href="#trig-functions" title="Permalink to this headline">¶</a></h2>
<p>The common trigonometric functions, sine and cosine, are circular functions because their values repeat as <span class="math notranslate nohighlight">\(x\)</span> is increased. Together with the tangent, they are defined as ratios of the sides of a right-angled triangle and are illustrated in Figure 9.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\sin(\theta) &amp;= \text{opposite / hypotenuse} = \frac{p}{h} \\[10pt]  
\cos(\theta) &amp;= \text{ adjacent / hypotenuse} = \frac{a}{h}\\[10pt] 
\tan(\theta) &amp;= \text{opposite / adjacent} = \frac{p}{a}\end{align}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\displaystyle \tan(\theta) = \frac{\sin(\theta)}{\cos(\theta)}\]</div>
<p>The cosine is the projection of the hypotenuse onto the x-axis, and the sine the projection onto the y- or vertical axis. The tangent is the gradient of the hypotenuse.</p>
<p>There are very many relationships between the trig functions; some of the most commonly met are, for angles <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are shown below</p>
<div class="math notranslate nohighlight">
\[\displaystyle \textbf{Table of trig relationships}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{array}{lll}\\
\hline
\sin(-x) =-\sin(x) &amp; \cos(-x)=\cos(x)\\[5pt]
\cos^2(x)+\sin^2(x)=1 &amp; \cos^2(x)-\sin^2(x)=2\cos^2(x)-1 = \cos(2x) &amp;\\[5pt]
\cos^2(x)=(1+\cos(2x))/2 &amp; \sin^2(x)=(1-\cos(2x))/2 &amp;\\[5pt]
\sin(2x)=2\sin(x)\cos(x)&amp; \sin(x)+\cos(x)=\sqrt{2}\sin(x + \pi /4)\\[5pt]
\hline
\sin(x\pm y)=\cos(x)\sin(y)\pm\sin(x)\cos(y) &amp; \cos(x\pm y)=\cos(x)\cos(y)\mp\sin(x)\sin(y) \\[5pt] \displaystyle \tan(x\pm y) =\frac{\tan(x)\pm\tan(y)}{1\mp\tan(x)\tan(y)}\\
\hline
\displaystyle \cos(x)+\cos(y)=2\cos\left(\frac{x+y}{2}\right)\cos\left(\frac{x-y}{2}\right)\\
\displaystyle\cos(x)-\cos(y)=-2\sin\left(\frac{x+y}{2}\right)\sin\left(\frac{x-y}{2}\right)\\
\displaystyle\sin(x)\pm\sin(y)=2\sin\left(\frac{x\pm y}{2}\right)\cos\left(\frac{x \mp y}{2}\right)\\
\hline\end{array}\end{split}\]</div>
<p>The sine, cosine, and tangent functions can also be described as series expansions, see Chapter 5, and as complex exponential functions. The equations are given here but described in detail in Chapter 2, which describes complex numbers.</p>
<div class="math notranslate nohighlight">
\[\displaystyle\sin(x)=\frac{e^{ix}-e^{-ix} }{2i}, \qquad \cos(x)=\frac{e^{ix}+e^{-ix}}{2}\]</div>
<p>The word tangent derives from the Latin <em>tangere</em>, which means to touch, and this is also the usage when the tangent is used to define the gradient of a curve at a given point, Figure 10. If the curve is a circle, the tangent is perpendicular to the radius.</p>
<p>Although hand-held calculators usually use degrees to calculate trigonometric functions, this disguises the fact that these functions require the angle to be in <em>radians</em>. A radian is the angle subtended at the centre of a circle by travelling a distance around the circumference that is equal to its radius, thus a complete rotation of <span class="math notranslate nohighlight">\(360^\text{o} \equiv 2\pi\)</span> radians and 1 radian is approximately <span class="math notranslate nohighlight">\(57.5^{\text{o}}\)</span>. Radians are not always included as units; the exception is in the study of NMR where the magnetogyric ratio <span class="math notranslate nohighlight">\(\gamma\)</span>, which is the constant that relates the magnetic dipole to the magnetic field, is always quoted in <span class="math notranslate nohighlight">\(\mathrm{rad\, T^{-1} s^{-1}}\)</span>, the T here representing the unit Tesla. In spectroscopy generally, frequencies are usually quoted either as <span class="math notranslate nohighlight">\(\mathrm{s^{-1}}\)</span>, with the symbol <span class="math notranslate nohighlight">\(\upsilon\)</span>,  or as angular frequencies, <span class="math notranslate nohighlight">\(\omega\)</span> in rad s<span class="math notranslate nohighlight">\(^{-1}\)</span>. These are related as <span class="math notranslate nohighlight">\(2\pi \upsilon = \omega\)</span>.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig9.png" /></p>
<p>Figure 9 Trigonometric relationships in a right-angled triangle and relationships to the x- and y-axes.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig10.png" /></p>
<p>Figure 10 The tangent touches the curve at a point and defines the gradient at that point.</p>
</div>
<div class="section" id="waves">
<h2>5.2 Waves<a class="headerlink" href="#waves" title="Permalink to this headline">¶</a></h2>
<p>In electromagnetic radiation, such as X-rays or radio waves and, more familiarly, visible light, the periodic displacement of the electric and magnetic fields is described by a sine or cosine function. Similarly, sine and cosine describe the periodic displacement of molecules as a sound wave travels through a gas, liquid, or solid, and describe a molecule’s internal vibrational normal modes. Any motion described by a single sine or cosine is called simple harmonic motion (SHM), for example, the motion of a pendulum. A spring is often called a harmonic oscillator and this term is also used to describe molecular vibrations. Mathematically, waves form the basis of the Fourier transforms and Fourier series method described in Chapter 9.</p>
<p>A sine wave is defined by its wavelength, amplitude, and phase. The amplitude is its maximum vertical displacement from zero. The wavelength is one full or two half periods and is the distance from one node to the next but one. A node is any of the points where the wave has zero amplitude.</p>
<p>In a <em>longitudinal wave</em>, such as a sound wave, the gas molecules are made to move about their equilibrium position in simple harmonic motion by the disturbance generating the sound. This simple harmonic motion occurs along the direction that the wave travels. The wave moves through the gas because molecules interact with one another causing regions of increased pressure and rarefaction. Even though each molecule only moves about its equilibrium position as it does so, it influences its neighbour and the wave moves. A Mexican Wave at a football or cricket match is an example of how the wave moves but each particle (a person in this case) does not move from equilibrium. The speed of the wave is governed by how well one molecule (person) interacts with its neighbour and therefore depends on the properties of the medium. In a gas, the speed is <span class="math notranslate nohighlight">\(v = \sqrt{\gamma RT/M}\)</span> where <span class="math notranslate nohighlight">\(\gamma\)</span> is the ratio of heat capacities at constant pressure and volume which is <span class="math notranslate nohighlight">\(1+2/5\)</span> for an ideal diatomic gas and <span class="math notranslate nohighlight">\(5/3\)</span> for an ideal atomic gas such as argon. A helical ‘slinky’ spring toy can be seen to exhibit longitudinal waves.</p>
<p>In <em>transverse waves</em>, such as a water wave, electromagnetic radiation, or a taut wire in a guitar or violin, the displacement of the particles about equilibrium is at right angles to the direction in which the wave is travelling. In a taut wire the wave’s velocity is <span class="math notranslate nohighlight">\(v = \sqrt{T/\mu}\)</span> where <span class="math notranslate nohighlight">\(T\)</span> is the tension ( the force in Newtons ) and <span class="math notranslate nohighlight">\(\mu\)</span> the mass per unit length. The units are <span class="math notranslate nohighlight">\(\displaystyle \left(\frac{N}{(kg/m)}\right)^{1/2}\equiv \left(\frac{kg m/s^2}{(kg/m)}\right)^{1/2} = \frac{m}{s}\)</span>.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig11.png" /></p>
<p>Figure 11 Left: The wave on the left is <span class="math notranslate nohighlight">\(y = \sin(2\pi x/\lambda)\)</span>. The particle (circle) remains at a fixed <span class="math notranslate nohighlight">\(x\)</span> but is displaced and follows SHM motion as the wave passes. After one period, it is at the same displacement. Right: The particle’s motion is shown with time; the wave is <span class="math notranslate nohighlight">\(y = \sin(2\pi \upsilon t)\)</span>. After one or any whole number of periods the particle (circle) is again at the same displacement <span class="math notranslate nohighlight">\(y\)</span>.</p>
<hr class="docutils" />
<p>If a wave is represented as amplitude vs. distance <span class="math notranslate nohighlight">\(x\)</span>, then a particle remains at one <span class="math notranslate nohighlight">\(x\)</span> value and performs simple harmonic or sinusoidal motion at that position as time progresses. Its displacement amplitude is</p>
<div class="math notranslate nohighlight">
\[\displaystyle y = A\sin(kx+\varphi) \]</div>
<p>The term <span class="math notranslate nohighlight">\(k\)</span> is sometimes called the <em>wavevector</em> and is <span class="math notranslate nohighlight">\(k = 2\pi/\lambda\)</span> where <span class="math notranslate nohighlight">\(\lambda\)</span> is the wavelength. The phase is <span class="math notranslate nohighlight">\(\varphi\)</span> (radians) which might be zero, is a constant displacement of the wave. At zero <span class="math notranslate nohighlight">\(x\)</span> the amplitude is <span class="math notranslate nohighlight">\(A\sin(\varphi)\)</span>. Sine and cosine always have a fixed phase difference between them of <span class="math notranslate nohighlight">\(\pi /2\)</span> or <span class="math notranslate nohighlight">\(90^\text{o}\)</span>, thus a sine wave is changed into a cosine, and vice versa by a <span class="math notranslate nohighlight">\(\pi/2\)</span> phase change.</p>
<p>If the plot is one of amplitude vs time then the wave represents how the particle moves in time at a given position. The wavelength is now the period <span class="math notranslate nohighlight">\(T\)</span> of the motion and <span class="math notranslate nohighlight">\(T = 1/\upsilon\)</span> where <span class="math notranslate nohighlight">\(\upsilon\)</span> is the frequency in <span class="math notranslate nohighlight">\(\mathrm{s^{-1}}\)</span>. The angular frequency is <span class="math notranslate nohighlight">\(\omega = 2\pi\upsilon\)</span>, in radian <span class="math notranslate nohighlight">\(\mathrm{s^{-1}}\)</span>, hence the following equations are equivalent</p>
<div class="math notranslate nohighlight">
\[\displaystyle y = A\sin(\omega t+\varphi)= A\sin(2\pi\upsilon t+\varphi) \]</div>
<p>The velocity of the wave <span class="math notranslate nohighlight">\(v\)</span> is the product of frequency and wavelength; <span class="math notranslate nohighlight">\(v = \upsilon\lambda= \omega/k\)</span>. The general equation for a travelling wave, either transverse or longitudinal, is</p>
<div class="math notranslate nohighlight">
\[\displaystyle y = A\sin(\omega t - kx +\varphi) \tag{16}\]</div>
<p>In this equation the sign <span class="math notranslate nohighlight">\(-kx\)</span> means that the wave is travelling to the right, which is positive <span class="math notranslate nohighlight">\(x\)</span>. If the term were written <span class="math notranslate nohighlight">\(+kx\)</span>, then the wave would be travelling to the left. Depending upon whether <span class="math notranslate nohighlight">\(x\)</span> or <span class="math notranslate nohighlight">\(t\)</span> is plotted the similar but different plots in Figure 11 are produced. On the left the displacement <span class="math notranslate nohighlight">\(x\)</span> is plotted and therefore as time progresses the particle moves up and down at fixed <span class="math notranslate nohighlight">\(x\)</span>. On the right the displacement vs time at a fixed <span class="math notranslate nohighlight">\(x\)</span> is plotted.</p>
<p>The phase <span class="math notranslate nohighlight">\(\varphi\)</span> (figure 12) displaces the wave but does not change its frequency or wavelength. The dashed curve, Figure 12 has <span class="math notranslate nohighlight">\(\varphi = +2/3\)</span> radians compared the solid curve where the phase is zero. Note that a positive phase displaces the curve to the left compared to zero phase.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig12.png" /></p>
<p>Figure 12 Comparison of <span class="math notranslate nohighlight">\(\sin(2\pi\upsilon t + 2/3)\)</span> with <span class="math notranslate nohighlight">\(\upsilon = 1\)</span> (dashed line) compared to the sine wave with zero phase.</p>
<hr class="docutils" />
<p>When two waves are added they can reinforce or destroy one another depending on their phase. Clearly, when they are in phase, the phase being zero or integer multiples of <span class="math notranslate nohighlight">\(2\pi\)</span>, the waves add and a double-sized wave is produced. When <span class="math notranslate nohighlight">\(180^\text{o}\)</span> or integer multiples of <span class="math notranslate nohighlight">\(\pi\)</span> out of phase destructive interference occurs.</p>
<p>If the waves are of different frequency then they become out of step with one another, as shown in Figure 13. However, the two waves will periodically have places where both waves have zero amplitude. The effect is called <em>beating</em> and in a sound wave this is heard as a repeating hum, hence ‘beats’, when the second sound wave is turned on. The beat frequency is the difference in frequency of the two individual waves and is twice the lowest frequency of the combined wave. The combined wave has frequencies that are half the sum and half difference of the two fundamental waves. Figure 13 shows this effect on waves with <span class="math notranslate nohighlight">\(\upsilon\)</span> = 5 and 5.5 Hz. The beating is clear when the waves are added together. The dashed line shows the sine wave at the difference frequency, 0.5 Hz. The sum wave is</p>
<div class="math notranslate nohighlight">
\[\displaystyle\cos\left(2\pi\upsilon_1 t\right)+\cos\left(2\pi\upsilon_2 t\right)=2\cos\left(2\pi\frac{\upsilon_1-\upsilon_2}{2}\right)\cos\left(2\pi\frac{\upsilon_1+\upsilon_2}{2}\right)\]</div>
<p><img alt="Drawing" src="../_images/chapter1-fig13.png" /></p>
<p>Figure 13 Left: the two travelling waves of frequency <span class="math notranslate nohighlight">\(\upsilon = 5\)</span> and <span class="math notranslate nohighlight">\(5.5\)</span> quickly become out of step with one another. Right: the sum of the waves shows beating with a beat frequency of 0.5 Hz (red dashed line) and a higher frequency at the sum of the frequencies. (Note that different abscissa are used).</p>
</div>
<hr class="docutils" />
<div class="section" id="phase-and-group-velocity">
<h2>5.3 Phase and group velocity<a class="headerlink" href="#phase-and-group-velocity" title="Permalink to this headline">¶</a></h2>
<p>A wave is defined with an angular frequency <span class="math notranslate nohighlight">\(\omega = 2\pi\nu\)</span> and wavevector</p>
<div class="math notranslate nohighlight">
\[\displaystyle k = 2\pi/\lambda\]</div>
<p>and has the general form of equation (16). The <em>phase velocity</em> is what we would colloquially describe as the velocity of a wave and is</p>
<div class="math notranslate nohighlight">
\[\displaystyle v = \omega/k= \nu\lambda\]</div>
<p>with units distance/time.</p>
<p>If the medium is <em>dispersive</em>, as is air or glass to visible light, then <span class="math notranslate nohighlight">\(\omega/k\)</span> is not constant. Dispersion means that the medium through which the wave is passing affects the wave so that the phase velocity of the wave depends on the frequency; thus, red light is transmitted through the same piece of glass in less time than blue light. The refractive index at short (blue) wavelengths is larger than at longer wavelengths. The speed of light in a medium of refractive index <span class="math notranslate nohighlight">\(n_\lambda\)</span> at wavelength <span class="math notranslate nohighlight">\(\lambda\)</span> is <span class="math notranslate nohighlight">\(c_n = c/n_\lambda\)</span> where <span class="math notranslate nohighlight">\(c\)</span> is the speed of light in vacuum defined as <span class="math notranslate nohighlight">\(c=2.99792458\cdot 10^8 \,\mathrm{m\,s^{-1}}\)</span>.</p>
<p>The <em>group velocity</em> <span class="math notranslate nohighlight">\(v_g\)</span> is a second measure of the speed of a wave-like disturbance. It applies only when a wave is composed of many individual waves of different frequencies and is defined as <span class="math notranslate nohighlight">\(\Delta \omega /\Delta k\)</span>. The superposition of these waves does not remain constant in time and therefore the profile of the disturbance changes with time, although each individual wave moves with its phase velocity. The group velocity is also the speed at which energy is transmitted and is the speed at which the maximum of the combined wave moves.</p>
<p>If the frequencies in the group of waves are similar, then the change <span class="math notranslate nohighlight">\(\Delta \omega /\Delta k \to d\omega /dk = v_g\)</span> can be made.  As the phase velocity is <span class="math notranslate nohighlight">\(v = \omega/k\)</span> then</p>
<div class="math notranslate nohighlight">
\[\displaystyle v_g =\frac{d\omega}{dk} = v + k\frac{dv}{dk}=\nu-\lambda\frac{dv}{d\lambda}\]</div>
<p>If the gradient <span class="math notranslate nohighlight">\(\displaystyle \frac{dv}{d\lambda} \gt 0\)</span> then the medium exhibits what is called normal dispersion (e.g.,visible light in glass); when <span class="math notranslate nohighlight">\(\displaystyle \frac{dv}{d\lambda} \lt 0\)</span>  it is called anomalous dispersion. This is normally the case for electromagnetic waves in an electrical conductor and in the far infrared part of the spectrum. In quantum mechanics, it is sometimes useful to calculate the phase velocity of wave/particle as <span class="math notranslate nohighlight">\(v = E/p\)</span> because the kinetic energy is <span class="math notranslate nohighlight">\(E = p^2/2m\)</span> where <span class="math notranslate nohighlight">\(p\)</span> is momentum. Similarly,</p>
<div class="math notranslate nohighlight">
\[\displaystyle v_g =\frac{d\omega}{dk}=\frac{dE}{dp}\]</div>
<p>is the group velocity.</p>
</div>
<div class="section" id="standing-waves">
<h2>5.4 Standing waves<a class="headerlink" href="#standing-waves" title="Permalink to this headline">¶</a></h2>
<p>The fundamental and overtone waves formed in a taut wire when it is struck, such as on a guitar or violin, or those in the quantum mechanical particle in a box, are standing waves. They rise and fall in time with their nodes remaining at the same place. Thus, sometimes they are completely zero everywhere, and at other times they are maximal. When two similar waves travelling in opposite directions are added, a standing wave is formed. This can be shown if the waves are written as <span class="math notranslate nohighlight">\(y_1 = \sin(k(x - v t))\)</span>, which means that the wave moves to the right along the x-axis with velocity <span class="math notranslate nohighlight">\(v\)</span>, and the wave <span class="math notranslate nohighlight">\(y_2 = A\sin(k(x + v t))\)</span> moves to the left. With some manipulation the sum of these waves is <span class="math notranslate nohighlight">\(y = 2\cos(kvt)\sin(kx)\)</span>, which is a sine wave which remains fixed along <span class="math notranslate nohighlight">\(x\)</span> but whose amplitude rises and falls in time with frequency <span class="math notranslate nohighlight">\(\omega = kv\)</span>.</p>
<p>In practice, if you strike the strings of a violin or piano the motion produced is complex because many fundamental frequencies (called normal modes) are simultaneously excited when the instrument is played. Some calculations that illustrate this are presented in Chapter 7. In musical instruments there are also many overtones produced and it is these that give instruments their characteristic sounds.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig13a.png" /></p>
<p>Figure 13a. A standing wave. The amplitude changes in the way indicated by the arrows, then repeats in the opposite sense and so on  <em>ad infinitum</em>.</p>
</div>
<hr class="docutils" />
<div class="section" id="superposition-of-waves-of-the-same-frequency">
<h2>5.5 Superposition of waves of the same frequency<a class="headerlink" href="#superposition-of-waves-of-the-same-frequency" title="Permalink to this headline">¶</a></h2>
<p>A defining characteristic of waves is that they can form superpositions, which is to say that when added or subtracted a new waveform is produced. When the waves are of the same frequency (or wavelength) this leads to interference and diffraction phenomena. When waves of different frequency are added beats are produced as described above. In quantum mechanics wavepackets are formed as superpositions of wavefunctions and are described in Chapter 5, (Summation and Series).</p>
<div class="section" id="example-from-xray-diffraction">
<h3><strong>Example from xray diffraction</strong><a class="headerlink" href="#example-from-xray-diffraction" title="Permalink to this headline">¶</a></h3>
<p>In x-ray diffraction the x-rays are scattered by the atoms that are present in regular and repeated positions in a crystal. The smallest set of repeated positions is called the unit cell. The Bragg equation <span class="math notranslate nohighlight">\(n\lambda = 2d\sin(\theta) \)</span> defines the angle <span class="math notranslate nohighlight">\(\theta\)</span> that the x-rays are diffracted off planes with a separation <span class="math notranslate nohighlight">\(d\)</span>. Only some angles cause diffraction because <span class="math notranslate nohighlight">\(n\)</span> is an integer and the values of <span class="math notranslate nohighlight">\(d\)</span> are determined by the limited number spacing between atoms. As the incident and diffracted angle are equal at <span class="math notranslate nohighlight">\(\theta\)</span> the diffracted rays can be considered to be reflected off the lattice planes. Only the diffracted (reflected) waves that interfere constructively with one another to produce light spots on the detector. Diffraction with crystals is described in more detail in Chapter 9, Fourier Transforms.</p>
<p>A general wave of frequency <span class="math notranslate nohighlight">\(\omega\)</span> has the form</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi=a\cos(\omega t +\varphi)=a\cos(\omega t)\cos(\varphi)-a\sin(\omega t)\sin(\varphi)\]</div>
<p>where <span class="math notranslate nohighlight">\(\varphi\)</span> is the phase and the expansion formula of <span class="math notranslate nohighlight">\(\cos(x+y)\)</span> was used, see section 5.1. As the phase varies from <span class="math notranslate nohighlight">\(0\to \pi\)</span> the  amplitude of the sine and cosine changes from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(-1\)</span>. The phase can only be in the range <span class="math notranslate nohighlight">\(0\to 2\pi\)</span> any other values simply return values in this range because of the periodic nature of sines and cosines. In x-ray diffraction the phase is proportional to the perpendicular distance <span class="math notranslate nohighlight">\(x_i\)</span> from the lattice plane to each atom and <span class="math notranslate nohighlight">\(\varphi_i=2\pi x_i/d\)</span></p>
<p>The sum of waves from the <span class="math notranslate nohighlight">\(N\)</span> atoms in the unit cell is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi = \sum_{i=1}^N a_i\cos(\omega t)\cos(\varphi_i)-\sum_{i=1}^Na_i\sin(\omega t)\sin(\varphi_i) \]</div>
<p>The number <span class="math notranslate nohighlight">\(N\)</span> will be small for most molecules such as benzene, typically one or two times the number of atoms in the molecule, but is thousands for large proteins. As the x-ray frequency is constant, and does not depend on <span class="math notranslate nohighlight">\(N\)</span> its terms can be removed from the summation,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi = \cos(\omega t)\sum_{i=1}^N a_i\cos(\varphi_i)-\sin(\omega t)\sum_{i=1}^Na_i\sin(\varphi_i) \]</div>
<p>The sum of several cosines is also a cosine, and similarly for sines, thus it follows that if <span class="math notranslate nohighlight">\(a_s\)</span>  and <span class="math notranslate nohighlight">\(\varphi_s\)</span> are the resultant amplitude and phase respectively, that we can write</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle a_s\cos(\varphi_s)=\sum_{i=1}^N a_i\cos(\varphi_i) \\ a_s\sin(\varphi_s)=\sum_{i=1}^N a_i\sin(\varphi_i)\end{split}\]</div>
<p>which means that the amplitude at any point is the sum of that for each wave. The total wave is,</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi = a_s\cos(\omega t)\cos(\varphi_s) - a_s\sin(\omega t)\sin(\varphi_s) \]</div>
<p>In detecting infra-red, visible light or even x-rays the intensity <span class="math notranslate nohighlight">\(I\)</span> is always measured, because of the nature of the interaction of electromagnetic radiation with the atoms and molecules in the detector. The <span class="math notranslate nohighlight">\(\omega t\)</span> terms cannot be measured as the frequency is far too high, and is averaged in the measuring process and can therefore be absorbed into the amplitude and so ignored. The intensity is the square of the wave’s amplitude <span class="math notranslate nohighlight">\(I=a_s^2\)</span> and adding the squares of <span class="math notranslate nohighlight">\(a_s\cos(\varphi_s)\)</span> and <span class="math notranslate nohighlight">\(a_s\sin(\varphi_s)\)</span> and using <span class="math notranslate nohighlight">\(\cos^2(\varphi_s)+\sin^2(\varphi_s)=1\)</span> we find that <span class="math notranslate nohighlight">\(a^2\)</span> is produced as</p>
<div class="math notranslate nohighlight">
\[\displaystyle   I\equiv  a_s^2 = \left(\sum_{i=1}^N a_i\cos(\varphi_i)\right)^2+ \left(\sum_{i=1}^N a_i\sin(\varphi_i)\right)^2 \tag{16a}\]</div>
<p>with overall phase <span class="math notranslate nohighlight">\(\varphi_s\)</span> given by</p>
<div class="math notranslate nohighlight">
\[\displaystyle  \tan(\varphi_s) =\frac{\sum_{i=1}^N a_i\sin(\varphi_i)}{\sum_{i=1}^N a_i\cos(\varphi_i)}\]</div>
<p>A more general derivation of the superposition is given in chapter 9, Fourier Series and Transforms.</p>
<p>To recap, the intensity <span class="math notranslate nohighlight">\(I\)</span> is that due to all atoms in the unit cell in proportion to their phase <span class="math notranslate nohighlight">\(\varphi_i\)</span> and is unique at each possible scattering angle <span class="math notranslate nohighlight">\(\theta\)</span>, thus in x-ray diffraction from crystals the positional information is contained in the intensity of the measured spots on the detector not their position.</p>
</div>
<div class="section" id="example-with-two-waves">
<h3><strong>Example with two waves</strong><a class="headerlink" href="#example-with-two-waves" title="Permalink to this headline">¶</a></h3>
<p>Suppose that there is a grating with small apertures separated by <span class="math notranslate nohighlight">\(d\)</span> and a second set also with separation <span class="math notranslate nohighlight">\(d\)</span> but displaced by <span class="math notranslate nohighlight">\(\alpha d\)</span> as shown in the figure below. We can consider these apertures as point emitters producing equal amplitude waves of the same frequency and in phase. They could be, for example, atoms scattering x-rays. At a certain angle the waves with spacing <span class="math notranslate nohighlight">\(d\)</span> have phase difference <span class="math notranslate nohighlight">\(2\pi n\)</span>, i.e. these waves combine constructively to give a line at order <span class="math notranslate nohighlight">\(n\)</span>. The other source has a phase difference relative to the first of <span class="math notranslate nohighlight">\(\varphi = 2\pi\alpha n\)</span>. On the detector the total wave intensity is observed at orders <span class="math notranslate nohighlight">\(n=0,\pm 1,\pm 2\cdots\)</span> and the phases are <span class="math notranslate nohighlight">\(\varphi_0 = 0,  \varphi_1=2\pi n \alpha\)</span> and from eqn. 16a and assuming the amplitudes are unity for simplicity, the intensity for a wave from each sets is,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle  \begin{align} I &amp;=  \left(\cos(0)+\cos(\varphi_1)\right)^2+ \left( \sin(0)+\sin(\varphi_1)\right)^2\\&amp;= (1+\cos(\varphi_1))^2+\sin^2(\varphi_1)\\
&amp;=2\big(1+\cos(\varphi_1)\big)\end{align}\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(\cos(\varphi_1)+1=0\)</span> or <span class="math notranslate nohighlight">\(\cos(2\pi n\alpha)=-1\)</span> then a bright line will be missing at order <span class="math notranslate nohighlight">\(n\)</span> in the diffraction. This will happen when the cosine has a value of <span class="math notranslate nohighlight">\(-1\)</span> or <span class="math notranslate nohighlight">\(2\pi n\alpha = m\pi\)</span>, i.e. at all odd integer values <span class="math notranslate nohighlight">\(m=\pm 1,\pm 3\cdots \)</span> of <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig13b.png" /></p>
<p>Figure 13b. Two slits (blue dots) each separated by distance <span class="math notranslate nohighlight">\(d\)</span> but one pair is displaced by <span class="math notranslate nohighlight">\(\alpha d\)</span>. This displacement causes a phase shift <span class="math notranslate nohighlight">\(\varphi=2\pi n d\)</span> with respect to the other pair for diffracted order <span class="math notranslate nohighlight">\(n\)</span>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="hyperbolic-functions">
<h2>5.6 Hyperbolic functions<a class="headerlink" href="#hyperbolic-functions" title="Permalink to this headline">¶</a></h2>
<p>The hyperbolic functions are closely related to the circular functions, sine, cosine, etc. of trigonometry. The equation of a (unit) circle is <span class="math notranslate nohighlight">\(x^2 + y^2 = 1\)</span> and in parametric form <span class="math notranslate nohighlight">\(\cos(\theta) = x,\; \sin(\theta) = y\)</span> and any point has coordinates <span class="math notranslate nohighlight">\((\cos(\theta), \sin(\theta))\)</span> }. The equation for a hyperbola is <span class="math notranslate nohighlight">\(x^2 - y^2 = 1\)</span> or, in parametric form, <span class="math notranslate nohighlight">\(\cosh(t) = x,\; \sinh(t) = y\)</span>, but <span class="math notranslate nohighlight">\(t\)</span> is not a measure of angle. The two curves produced are shown in figure 14, and one point plotted on each, at a value of <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(t =2\pi/3\)</span>. The hyperbolic functions are often pronounced, ‘shine’, ‘cosh’ and ‘than’, with emphasis on the ‘th’.</p>
<p>The shape of a freely hanging cable supported at its ends only, follows the equation <span class="math notranslate nohighlight">\(y = \cosh(x)\)</span>, and is called a <em>catenary</em>. The arch in St Louis in the United States follows closely that of an inverted cosh. The equations of the hyperbolic functions are similar to those of normal trig functions, but not identical, for example;</p>
<div class="math notranslate nohighlight">
\[\displaystyle \tanh(x)=\frac{\sinh(x)}{\cosh(x)},\qquad \cosh^2(x)-\sinh^2(x)=1, \qquad \cosh^2(x)+\sinh^2(x)=\cosh(2x)\]</div>
<p>These identities can be checked using SymPy, for example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">simplify</span><span class="p">(</span> <span class="n">cosh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter1-B_4_0.png" src="../_images/chapter1-B_4_0.png" />
</div>
</div>
<p>produces the result <span class="math notranslate nohighlight">\(\cosh(2x)\)</span>.</p>
<p>The circular functions sine, cosine, and tangent can be represented as real functions involving complex exponentials, see Chapter 2. The hyperbolic functions <span class="math notranslate nohighlight">\(\sinh(x),\; \cosh(x),\)</span> and <span class="math notranslate nohighlight">\(\tanh(x)\)</span> are also real functions and can also be represented as real exponentials. The hyperbolic functions are</p>
<div class="math notranslate nohighlight">
\[\displaystyle \sinh(x) = \frac{e^x - e^{-x}}{2},\qquad \cosh(x) = \frac{e^x + e^{-x}}{2},\qquad \tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}\]</div>
<p>Some values are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle\begin{array}{lll}
\sinh(0)=0 &amp; \sinh(\infty)=\infty \\
\cosh(0)=1 &amp; \cosh(\infty)=\infty \\
\tanh(0)=0 &amp; \tanh(\pm\infty)=\pm 1\\
\end{array}\end{split}\]</div>
<p>The functions are plotted in figure 15 and compared to the normal trig functions.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig14.png" /></p>
<p>Figure 14. Circle and hyperbola. The point is at <span class="math notranslate nohighlight">\(\theta\)</span> or <span class="math notranslate nohighlight">\(t= \pi/4\)</span>.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig15.png" /></p>
<p>Figure 15. Some of the hyperbolic and normal trigonometric functions. Notice how  <span class="math notranslate nohighlight">\(\tan(x)\)</span> goes to <span class="math notranslate nohighlight">\(\pm\infty\)</span> in multiples of <span class="math notranslate nohighlight">\(x = \pm\pi/2\)</span>.</p>
</div>
<hr class="docutils" />
<div class="section" id="inverse-functions">
<h2>6 Inverse functions<a class="headerlink" href="#inverse-functions" title="Permalink to this headline">¶</a></h2>
<p>The log and exponential functions are inverses of one another, and similarly <span class="math notranslate nohighlight">\(x^n\)</span> and <span class="math notranslate nohighlight">\(x^{1/n}\)</span> because when one is made a function of the other, the result is <span class="math notranslate nohighlight">\(x;\; \ln(e^x) = x\)</span> and <span class="math notranslate nohighlight">\((x^{1/n})^n = x\)</span>. If the function is written as <span class="math notranslate nohighlight">\(f(x)\)</span> then the inverse is <span class="math notranslate nohighlight">\(f^{-1}(x)\)</span>, therefore</p>
<div class="math notranslate nohighlight">
\[\displaystyle f^{-1}[f(x)] = x\]</div>
<p>However, not all functions have an inverse. When plotted the observation is that one function is the reflection of the other through a straight line of gradient <span class="math notranslate nohighlight">\(\pm 1 \)</span>, such as shown in  figure 8 for the positive exponential and log. More formally, the function and its inverse must have a one-to-one relationship. If an inverse exists when the function <span class="math notranslate nohighlight">\(f (x)\)</span> is solved for <span class="math notranslate nohighlight">\(x\)</span>, then <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> exchanged and the result substituted into the original equation, <span class="math notranslate nohighlight">\(x\)</span> results. For example, if <span class="math notranslate nohighlight">\(f(x) \equiv y = (x + 2)/3\)</span> then <span class="math notranslate nohighlight">\(x = 3y - 2\)</span>, the inverse function is found by swapping <span class="math notranslate nohighlight">\(y\)</span> for <span class="math notranslate nohighlight">\(x\)</span>, giving <span class="math notranslate nohighlight">\(f^{-1}(x) = 3x - 2\)</span>, and then substituting back <span class="math notranslate nohighlight">\(f^{-1}[f(x)] = 3(x + 2)/3 - 2 = x\)</span>.</p>
<p>The function <span class="math notranslate nohighlight">\(y = \sin(x)\)</span> has <span class="math notranslate nohighlight">\(y = \sin^{-1}(x)\)</span> as its inverse function, which can be written as <span class="math notranslate nohighlight">\(\sin(y) = x\)</span>, which is a sine wave moving up the y-axis, as shown in figure 16. Similarly there are inverse functions <span class="math notranslate nohighlight">\(\cos^{-1}(x)\)</span> and <span class="math notranslate nohighlight">\(\tan^{-1}(x)\)</span>. Notice that the computer notation is different to the mathematical one; for example, <span class="math notranslate nohighlight">\(\sin^{-1}(x) \equiv \arcsin(x)\)</span>, the prefix ‘arc’ being added to these inverse functions, but this notation is not universal and in some languages asin may be used instead of arcsin etc.</p>
<p>The inverse trig functions are multi-valued; the principal range for <span class="math notranslate nohighlight">\(\sin^{-1}(x)\)</span> and <span class="math notranslate nohighlight">\(\cos^{-1}(x)\)</span> is <span class="math notranslate nohighlight">\(x = \pm 1\)</span> and the function’s principal values lie between <span class="math notranslate nohighlight">\(y = \pm \pi/2\)</span>. The inverse function <span class="math notranslate nohighlight">\(\tan^{-1}(x)\)</span> is also multi-valued and ranges from <span class="math notranslate nohighlight">\(x = \pm \infty\)</span> and has principal values between <span class="math notranslate nohighlight">\(y = \pm\pi/4\)</span>.</p>
<p>The equations defining inverse trig and hyperbolic functions are shown below, and some of which were obtained using Sympy for example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">asinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter1-B_7_0.png" src="../_images/chapter1-B_7_0.png" />
</div>
</div>
<hr class="docutils" />
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \textbf{Table of inverse functions}\quad i=\sqrt{-1}\\
\begin{array}{lll}
\hline
\sin^{-1}(x) &amp;= -i\log(ix +\sqrt{1-x^2} )\\
\cos^{-1}(x) &amp;= +i\log(ix +\sqrt{1-x^2} ) + \frac{\pi}{2}\\
\tan^{-1}(x) &amp;= \frac{i}{2}\left( \log(1-ix)- \log(1+ix )  \right)\\
\sinh^{-1}(x) &amp; = \log(x+\sqrt{1+x^2})\\
\cosh^{-1}(x) &amp; = \log(x+\sqrt{x^2-1})\\
\tanh^{-1}(x) &amp; =\frac{1}{2} \log(x+1)-\frac{1}{2}\log(1-x)\\
\hline\end{array}\end{split}\]</div>
<hr class="docutils" />
<p><img alt="Drawing" src="../_images/chapter1-fig16.png" /></p>
<p>Figure 16. Inverse trig functions with <span class="math notranslate nohighlight">\(y\)</span> limited to the range <span class="math notranslate nohighlight">\(\pm 2 \pi\)</span>. The <span class="math notranslate nohighlight">\(\tan^{-1}\)</span> functions extend to <span class="math notranslate nohighlight">\(x = \pm\infty\)</span> with a limit of integer multiples of <span class="math notranslate nohighlight">\(y = \pm \pi/2\)</span>.</p>
</div>
<hr class="docutils" />
<div class="section" id="cartesian-and-polar-coordinates">
<h2>7 Cartesian and polar coordinates<a class="headerlink" href="#cartesian-and-polar-coordinates" title="Permalink to this headline">¶</a></h2>
<p>When drawing a graph a right-angled set of axes is normally used. The origin is the point (0, 0) and then any other point is represented by two numbers <span class="math notranslate nohighlight">\((x,\; y)\)</span> in the x-y plane. In three dimensions the coordinates are <span class="math notranslate nohighlight">\((x,\; y,\; z)\)</span>. These coordinates are described as rectilinear when right-angled axes are used and as Cartesian when <span class="math notranslate nohighlight">\((x,\; y,\; z)\)</span> are used.</p>
<p>There are other ways of defining a point in space and some of them will be used when the situation requires it. In crystallography, for example, it is often sensible to define axes of particular crystal types that are not always at 90<span class="math notranslate nohighlight">\(^\text{o}\)</span> to one another and of unequal length. Monoclinic and trigonal crystal types, among others, have these ‘sloping’ axes. On the surface of a sphere, such as the earth, there are no straight lines, and latitude and longitude, which are angles, are used to define a location. In other situations, for example defining the three-dimensional shapes of atomic orbitals, spherical polar coordinates are used and in these coordinates, two angles and a radius define a point. These coordinates are used because they reflect the underlying symmetry of the problem and equations become easier to solve. In the hydrogen molecule, prolate spheroidal coordinates are used. These have two origins, one at each atom, see Figure 30 for a sketch of coordinates. In other situations, cylindrical coordinates are used. There are many other coordinate systems, see Arkfen (1970) for a description.</p>
<p>The reason for using different coordinate systems is not to make life difficult, far from it, but is that calculations are often easier done in these coordinates than in Cartesians; the disadvantage of these other coordinate systems is only unfamiliarity. In each case, it is possible to convert from one coordinate ‘system’ to another. In spherical polar coordinates the radius <span class="math notranslate nohighlight">\(r\)</span> is the distance of a point from the origin, <span class="math notranslate nohighlight">\(\theta\)</span> is the polar angle measured from the z-axis and <span class="math notranslate nohighlight">\(\phi\)</span> the azimuthal or equatorial angle measured in the x-y plane from the x- to the y-axis. The conversion between Cartesian and <em>spherical polar</em> coordinates is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align} x &amp;= r \sin(\theta)\cos(\phi),\qquad &amp;y = r \sin(\theta)\sin(\phi)\\
z&amp;=r\cos(\theta), \qquad   &amp;r^2 =x^2 +y^2 +z^2\end{align}\end{split}\]</div>
<p>The azimuthal angle <span class="math notranslate nohighlight">\(\phi\)</span> is in the x- y plane and measures the angle from the x-axis to the line formed by the projection of the point onto this plane, and has a maximum of 360<span class="math notranslate nohighlight">\(^\text{o}\)</span>. <span class="math notranslate nohighlight">\(\theta\)</span> is the polar angle measured from 0 to 180<span class="math notranslate nohighlight">\(^\text{o}\)</span> from the z-axis.</p>
<p>In two dimensions, <em>plane polar</em> coordinates are used to define a point in the x-y plane. If z is included then these coordinates become the cylindrical coordinates. The relationship of plane polar to Cartesian coordinates is</p>
<div class="math notranslate nohighlight">
\[\displaystyle x=r\cos(\theta),\quad y=r\sin(\theta), \quad r^2 =x^2 +y^2\]</div>
<p>The angle <span class="math notranslate nohighlight">\(\theta\)</span> is measured from the x- to the y-axis, figure 18</p>
<p><img alt="Drawing" src="../_images/chapter1-fig17.png" /></p>
<p>Figure 17. Spherical polar coordinates. The point at <span class="math notranslate nohighlight">\((x,\; y,\; z)\)</span> in Cartesian coordinates is at <span class="math notranslate nohighlight">\((r,\; \theta, \; \phi)\)</span>  in spherical polar coordinates.</p>
<p><img alt="Drawing" src="../_images/chapter1-fig18.png" /></p>
<p>Figure 18. Plane polar coordinates.</p>
</div>
<hr class="docutils" />
<div class="section" id="factorials">
<h2>8 Factorials<a class="headerlink" href="#factorials" title="Permalink to this headline">¶</a></h2>
<p>The factorial function is the product of a set of <em>positive integers</em> from 1 up to n;</p>
<div class="math notranslate nohighlight">
\[\displaystyle n! = n \times (n - 1) \times (n - 2) \times \cdots \times 2 \times 1 \]</div>
<p>with the limits that</p>
<div class="math notranslate nohighlight">
\[\displaystyle 0! = 1,\qquad (-n)! \to \infty\]</div>
<p>The factorials can also be calculated recursively as</p>
<div class="math notranslate nohighlight">
\[\displaystyle (n + 1)! = (n + 1)n!\]</div>
<p>In Figure 19 notice how rapidly the factorials increase as <span class="math notranslate nohighlight">\(n\)</span> increases. The plot is of <span class="math notranslate nohighlight">\(\ln(n!)\)</span> vs <span class="math notranslate nohighlight">\(n\)</span>, which shows that <span class="math notranslate nohighlight">\(n!\)</span> increases more rapidly than does <span class="math notranslate nohighlight">\(e^{n}\)</span>, which would be a line of slope 1 on this graph.</p>
<p>Fractional, negative, and complex factorials are defined by the (complete) gamma function <span class="math notranslate nohighlight">\(\Gamma(n)\)</span>. Positive integer values of this function produce the factorials, and are related as</p>
<div class="math notranslate nohighlight">
\[\displaystyle \Gamma(n) = (n - 1)!\]</div>
<p>The gamma function is the integral</p>
<div class="math notranslate nohighlight">
\[\displaystyle \Gamma(z) = \int_0^\infty t^{z-1}e^{-t}dt\]</div>
<p>which is defined in Python using a special function and imported as <span class="math notranslate nohighlight">\(\mathtt{from\,scipy.special \,import \,gamma}\)</span>. This can then be used to calculate any factorials such as shown in the figure.</p>
<p>Occasionally you may come across double factorials defined as</p>
<div class="math notranslate nohighlight">
\[\displaystyle n!! = n(n - 2)(n - 4) \cdots 5 \cdot 3 \cdot 1\]</div>
<p>if <span class="math notranslate nohighlight">\(n\)</span> is a positive odd integer and</p>
<div class="math notranslate nohighlight">
\[\displaystyle n!! = n(n - 2)(n - 4) \cdots 6 \cdot 4 \cdot 2 \]</div>
<p>if <span class="math notranslate nohighlight">\(n\)</span> is a positive even integer and <span class="math notranslate nohighlight">\(n!! = 1\)</span> if <span class="math notranslate nohighlight">\(n\)</span> is <span class="math notranslate nohighlight">\(-1\)</span> or <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>A ratio of factorials arises from the series</p>
<div class="math notranslate nohighlight">
\[ x(x+1)(x+2)\cdots (x+n-1)=\frac{(x+n-1)!}{(x-1)!} \tag{17}\]</div>
<p>is sometimes given the symbol <span class="math notranslate nohighlight">\((x)_n\)</span> which is called the Pochhammer symbol, although this notation is not universal. Ratios of factorials similar to these occur in quantum mechanics, particularly when angular momentum quantum numbers are involved.</p>
<div class="section" id="stirling-s-formula">
<h3><strong>Stirling’s formula</strong><a class="headerlink" href="#stirling-s-formula" title="Permalink to this headline">¶</a></h3>
<p>The log of the factorial is often used as a way of calculating factorials and Stirling’s formula</p>
<div class="math notranslate nohighlight">
\[\displaystyle \ln(n!) = n \ln(n) - n  \tag{18}\]</div>
<p>is particularly useful for large <span class="math notranslate nohighlight">\(n\)</span>. For smaller values we can use the equivalent formula <span class="math notranslate nohighlight">\(\displaystyle  n!=n^ne^{-n}\)</span>.</p>
<p>The approximations is calculated as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{align}\ln(n!)&amp;=\sum_{j=1}^n \ln(n_j) \approx \int_1^n \ln(x)dx=(n\ln(n)-n)\big|_1^n\\ &amp;= n \ln(n) - n+1\end{align} \end{split}\]</div>
<p>A much more accurate approximation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \ln(n!) = \left(n+\frac{1}{2}\right) \ln(n) - n +\frac{1}{2}\ln(2\pi)\]</div>
<p><img alt="Drawing" src="../_images/chapter1-fig19.png" /></p>
<p>Figure 19. Left: <span class="math notranslate nohighlight">\(\ln(n!)\)</span> vs <span class="math notranslate nohighlight">\(n\)</span>. The curve is not smooth because the factorials are integer numbers. Right: The gamma function (solid line) and the factorial (circles).</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="recursion-calculating-factorials-and-orthogonal-polynomials">
<h2>8.1 Recursion. Calculating Factorials and Orthogonal Polynomials.<a class="headerlink" href="#recursion-calculating-factorials-and-orthogonal-polynomials" title="Permalink to this headline">¶</a></h2>
<p>Recursion is a general method by which certain functions, such as a factorial or a polynomial, can be calculated by starting with one or two values and using these as a seed to generate further values. The recursion equations are sometimes also called difference equations.</p>
<p>The algorithms to calculate the square root, <span class="math notranslate nohighlight">\(e\)</span>, and <span class="math notranslate nohighlight">\(\pi\)</span> are each recursive because a previous result is used to calculate the next one. The factorial is the product of numbers separated by unit values, so starting with one value and an increment, all the rest can be calculated up to a given number. The equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle (n + 1)! = (n + 1)n!\]</div>
<p>An algorithm to calculate factorials up to a value of <span class="math notranslate nohighlight">\(n\)</span>, is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#### Algorithm. Direct calculation of a factorial </span>
<span class="c1">#-----------------</span>
<span class="k">def</span> <span class="nf">fact</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">i</span>
    <span class="k">return</span> <span class="n">f</span>
<span class="c1">#-----------------</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fact</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1307674368000
</pre></div>
</div>
</div>
</div>
<p>returns <span class="math notranslate nohighlight">\(1307674368000\)</span>. In fact the Python language allows the function <span class="math notranslate nohighlight">\(\mathtt{fact(n)}\)</span> itself to be recursive as shown in the next algorithm. It is perhaps more intuitive since the factorial can be defined as <span class="math notranslate nohighlight">\((n + 1 )! = (n + 1)n!\)</span> or as <span class="math notranslate nohighlight">\(n! = n(n-1)!\)</span> which is the form used in the next algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#### Algorithm. Recursive function calculation of factorial</span>
<span class="c1">#---------------------</span>
<span class="k">def</span> <span class="nf">fact</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#---------------------</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fact</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1307674368000
</pre></div>
</div>
</div>
</div>
<p>The polynomials used to define wavefunctions in quantum mechanics can be calculated by recursion and while there are other ways of calculating them, such as the generating function method, see Chapter 9, recursion is often convenient. The Hermite polynomials <span class="math notranslate nohighlight">\(H_n(x)\)</span> describe part of the wavefunctions of the Quantum Harmonic Oscillator, as used to describe vibrations of a molecule, and the other parts multiply the Hermite by a normalization constant and by <span class="math notranslate nohighlight">\(e^{-x^2/2}\)</span>. In the Hermite polynomial, <span class="math notranslate nohighlight">\(n\)</span> is an integer <span class="math notranslate nohighlight">\(n \ge 0\)</span> representing the quantum number, and <span class="math notranslate nohighlight">\(x\)</span> is proportional to the displacement of the oscillator from equilibrium. The wavefunction’s equation is</p>
<div class="math notranslate nohighlight">
\[\displaystyle \psi _{n}(x)={\frac {1}{\sqrt {2^{n}\,n!}}} \left({\frac {m\omega }{\pi \hbar }}\right)^{1/4} e^{-{{m\omega x^{2}}/{2\hbar }}} H_{n}\left({\sqrt {\frac {m\omega }{\hbar }}}\,x\right),\qquad n=0,1,2,\cdots \tag{18a}\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> is the mass and <span class="math notranslate nohighlight">\(\omega=2\pi v\)</span> the frequency.</p>
<p>One recursion formula for the Hermite when <span class="math notranslate nohighlight">\(n \ge 1\)</span> is</p>
<div class="math notranslate nohighlight">
\[\displaystyle H_{n+1}(x) = 2xH_n(x) - 2nH_{n-1}(x); \qquad  H_0(x) = 1\qquad \text{and}\qquad H_1(x) = 2x\]</div>
<p>The next value with <span class="math notranslate nohighlight">\(n = 1\)</span>, is</p>
<div class="math notranslate nohighlight">
\[\displaystyle H_2(x) = 2xH_1(x) - 2H_0(x) = 4x^2 - 2\]</div>
<p>All other values can be obtained in a similar way using the recursion formula given above. Using Sympy this can be automated</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#### Algorithm. Hermite Polynomial Recursion.  (This is slow for large n )</span>

<span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, n&#39;</span><span class="p">)</span>       <span class="c1"># define n and x in SymPy</span>

<span class="c1">#----------------------</span>
<span class="k">def</span> <span class="nf">herm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>             <span class="c1"># define recursion equations returns the nth hermite with argument x </span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> 
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> 
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">herm</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>  <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">herm</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
<span class="c1">#----------------------    </span>
<span class="n">expand</span><span class="p">(</span><span class="n">herm</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>          <span class="c1"># return 10th Hermite as polynomial</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter1-B_14_0.png" src="../_images/chapter1-B_14_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="chapter1-Q1-7.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Questions 1 - 7</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="chapter1-Q8-16.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Questions 8 - 16</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Godfrey Beddard<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>